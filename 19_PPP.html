
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>一物一価と購買力平価 &#8212; Pythonで学ぶマクロ経済学 (中級＋レベル)</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/myadmonitions.css?v=372cf325" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-3FB0WMD39P"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-3FB0WMD39P');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-3FB0WMD39P');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '19_PPP';</script>
    <link rel="canonical" href="https://py4macro.github.io/19_PPP.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="ランダム変数と統計的特徴" href="13a_Random_Variables.html" />
    <link rel="prev" title="所得分布と所得収斂" href="9_Convergence.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content"><p><a href='https://www.saiensu.co.jp/search/?isbn=978-4-88384-416-6&y=2025'><span style='color:white; font-size:90%;'> ✴️ 書籍『経済学のためのPython入門』(発行日：2025年10月10日)　←　クリック！ ✴️ </span></a></p></div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">Pythonで学ぶマクロ経済学 (中級＋レベル)</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Pythonの学習</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://py4basics.github.io">経済学のためのPython入門</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">長期分析</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="5a_Development_Accounting.html">発展会計</a></li>
<li class="toctree-l1"><a class="reference internal" href="5b_Growth_Accounting.html">成長会計</a></li>
<li class="toctree-l1"><a class="reference internal" href="6_Regression.html">回帰分析</a></li>
<li class="toctree-l1"><a class="reference internal" href="7_DifferenceEq.html">差分方程式と経済分析</a></li>
<li class="toctree-l1"><a class="reference internal" href="8_Solow.html">ソロー・モデル</a></li>
<li class="toctree-l1"><a class="reference internal" href="9_Convergence.html">所得分布と所得収斂</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">一物一価と購買力平価</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">短期データ分析</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="13a_Random_Variables.html">ランダム変数と統計的特徴</a></li>
<li class="toctree-l1"><a class="reference internal" href="10_Data_Fluctuation.html">主なマクロ・データの特徴</a></li>
<li class="toctree-l1"><a class="reference internal" href="11a_Okun_Phillips.html">オークンの法則とフィリップス曲線</a></li>
<li class="toctree-l1"><a class="reference internal" href="11b_Money_Inflation.html">インフレとマネーストック</a></li>
<li class="toctree-l1"><a class="reference internal" href="16_data_on_money.html">古典派の二分法と金融政策</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">短期定量分析</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="18_ADAS-1.html">定量的マクロ経済分析：Part 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="18_ADAS-2.html">定量的マクロ経済分析：Part 2</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">短期モデル分析</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="12_IS-MP-PC.html">IS-MP-PCモデル</a></li>
<li class="toctree-l1"><a class="reference internal" href="13b_Stochastic_Solow.html">確率的ソロー・モデル</a></li>
<li class="toctree-l1"><a class="reference internal" href="14_linearsolve.html"><code class="docutils literal notranslate"><span class="pre">linearsolve</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="15_RBC.html">実物的景気循環(RBC)モデル</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">ToDo</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Plan.html">今後の計画</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">参考</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://py4basics.github.io/Gapminder.html">Gapminder</a></li>
<li class="toctree-l1"><a class="reference external" href="https://py4etrics.github.io">Pythonで学ぶ入門計量経済学</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/Py4Macro/py4macro.github.io/source?urlpath=tree/19_PPP.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://haruyama-kobeu.github.io/jlite/github/Py4Macro/py4macro.github.io/blob/source/19_PPP.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>



<a href="https://github.com/Py4Macro/py4macro.github.io" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/19_PPP.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>一物一価と購買力平価</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">はじめに</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">国内での一物一価</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">説明</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">チョコレート</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">アイスクリーム</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">ガソリン</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">結論</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#big-mac">経済間での一物一価：Big Mac</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">はじめに</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">データ</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">一物一価</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">所得の影響</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">購買力平価と物価水準の分布</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ppp">PPPとは</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">PPPレートと市場為替レートのデータ</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">使用するデータ</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">例：日本</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">相対一般物価水準の分布</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">物価水準に対する所得の影響</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">所得の影響</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">所得効果の分離</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">推定</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">ヒストグラムの比較</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id23">所得効果の大きさ</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">所得効果の含意</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id25">PPPレートと市場為替レート：再考</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id26">ペン効果</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gdp">一人当たりGDPの分布</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id27">まとめ</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="chap-19-ppp">
<span id="id1"></span><h1>一物一価と購買力平価<a class="headerlink" href="#chap-19-ppp" title="Link to this heading">#</a></h1>
<div name="html-admonition" style="font-size: 0.8em">
<input type="button" onclick="location.href='https://translate.google.com/translate?hl=&sl=ja&tl=en&u='+window.location;" value="Google translation" style="color:#ffffff;background-color:#008080; height:25px" onmouseover="this.style.background='#99ccff'" onmouseout="this.style.background='#008080'"/> in English or the language of your choice.
</div><br><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">japanize_matplotlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">py4macro</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">statsmodels.formula.api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">smf</span>

<span class="c1"># numpy v1の表示を使用</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">legacy</span><span class="o">=</span><span class="s1">&#39;1.21&#39;</span><span class="p">)</span>
<span class="c1"># 警告メッセージを非表示</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="id2">
<h2>はじめに<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<p>通常，経済の生活水準の指標には一人当たりGDPが使われる。データはそれぞれの国が集めており，日本では<a class="reference external" href="https://www.esri.cao.go.jp/jp/sna/menu.html">内閣府</a>がGDP関連のデータを公表している。当たり前だが，GDPなどの変数はその経済の貨幣単位で表される。自国通貨建てのデータは国内で使うには十分だが，他国と比較する場合は共通の貨幣で表す必要がある。例えば，日本と米国の生活水準や政府の教育関連支出額の違いを知るためには，両国のデータを円もしくは米ドルに返還する必要がある。また，変数の水準だけではなく成長率を考える際も同様である。</p>
<p>では，ある通貨を他の通貨単位に換算する際，新聞やインターネットで見る市場為替レートを使えば良いのだろうか。答えは否である。その理由を理解するのが本章の１つの目的となる。異なる経済のデータを比べる際は購買力平価（PPP; Purchasing Power Parity）と呼ばれる「為替レート」を使う必要がある。実際，<code class="docutils literal notranslate"><span class="pre">py4macro</span></code>モジュールに含まれるデータセット<code class="docutils literal notranslate"><span class="pre">pwt</span></code>（Penn World Table）はPPPで換算したマクロデータを使っている。</p>
<p>以下では、まずPPPと関連が深い一物一価の法則について国内のデータを使い考える。その後，経済間のデータとしてビッグマック（マクドナルドのハンバーガー）のデータを使い経済間での一物一価を考察する。また一般物価水準についても考察し，経済間で一般物価水準が異なる要因として所得水準を考え，所得水準の影響が大きいことを明らかにする。特に，所得水準の影響により，市場為替レートを使い計算した一人当たりGDPの比較をおこなうと，経済間の所得格差が歪められることになる。そのような歪みを排除して経済間の生活水準を比べるためには，PPPレートを使う必要があることを示す。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>私たちの周りには価格が法的に定められたものがある。例えば，</p>
<ul class="simple">
<li><p>鉄道運賃(JR，通学定期，JR西日本，幹線，高校，20km)：38,650円（2023年4月）</p></li>
</ul>
<p>この価格は鉄道事業法（昭和６１年法律第９２号）に基づいている。以下では，法律ではなく<strong>市場</strong>によって価格が決まる財・サービスを考える。</p>
</div>
</section>
<section id="id3">
<h2>国内での一物一価<a class="headerlink" href="#id3" title="Link to this heading">#</a></h2>
<section id="id4">
<h3>説明<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<p>一物一価の法則とは，市場の働きにより同質財・サービスは同じ価格で販売される，ということを意味する。直感的に説明するために，A市とB市で同質財が販売されているとしよう（A市を１つの市場，B市をもう１つの市場と考えると良いだろう）。話を簡単にするために，輸送費用，取引費用や価格の硬直性など市場の「摩擦」が無い理想的な状況の下，A市では80円で，B市では100円で販売されているとしよう。B市で高値で商品が売れるのであれば，A市で安く購入してB市で80円＜価格＜100円の価格で売れば利潤を得ることができる。例えば，ある企業はA市で財をX個仕入れて，それをB市で販売する場合，利潤<span class="math notranslate nohighlight">\(\pi\)</span>は次式となる。</p>
<div class="math notranslate nohighlight" id="equation-eq-19-1">
<span class="eqno">(55)<a class="headerlink" href="#equation-eq-19-1" title="Link to this equation">#</a></span>\[
\pi=p_BX-p_AX=\left(p_B-p_A\right)X&gt;0
\]</div>
<p>ここで<span class="math notranslate nohighlight">\(p_BX\)</span>が総収入であり，<span class="math notranslate nohighlight">\(p_AX\)</span>が総費用である。<span class="math notranslate nohighlight">\(p_B&lt;p_A\)</span>が成立する限り<span class="math notranslate nohighlight">\(\pi&gt;0\)</span>となる。一方で，利潤があれば，同様のことをする企業が参入する。この様な裁定取引により，A市での需要が増加し価格が上昇する。一方，B市では供給が増えるので価格は下落する。参入は利潤がなくなるまで続くことになり，最終的には財の価格は収斂することになる。即ち，</p>
<div class="math notranslate nohighlight" id="equation-eq-19-2">
<span class="eqno">(56)<a class="headerlink" href="#equation-eq-19-2" title="Link to this equation">#</a></span>\[
\pi=0\quad\Rightarrow\quad
p_B=p_A
\]</div>
<p>このように，一物一価は非常に直感的な概念である。では，データではどのようになっているのだろうか。以下では<a class="reference external" href="https://www.stat.go.jp/data/kouri/doukou/index.html">小売物価統計調査（動向編）</a>のデータを用いる。使うデータはチョコレート，アイスクリーム，ガソリンの2022年平均価格であり，<code class="docutils literal notranslate"><span class="pre">pandas</span></code>を使って<a class="reference external" href="https://www.e-stat.go.jp/">e-Stat（政府統計の総合窓口）</a>から直接ダウンロードする。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>手動でダウンロードする場合は，次の順番でリンクを辿っていけば良いだろう。</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.stat.go.jp/data/kouri/doukou/index.html">小売物価統計調査（動向編）</a> → <code class="docutils literal notranslate"><span class="pre">調査の結果</span></code>をクリック → <code class="docutils literal notranslate"><span class="pre">全品目：平成13年(2001年)～2022年</span></code>をクリック → <code class="docutils literal notranslate"><span class="pre">2022年報</span></code>をクリック → <code class="docutils literal notranslate"><span class="pre">統計表</span></code>をクリック → <code class="docutils literal notranslate"><span class="pre">2022年</span></code>をクリック</p>
<ul>
<li><p>チョコレートとアイスクリームのデータは<code class="docutils literal notranslate"><span class="pre">【09】「1701</span> <span class="pre">ようかん」</span> <span class="pre">～</span> <span class="pre">「1784</span> <span class="pre">ゼリー」</span></code>の右側にある<code class="docutils literal notranslate"><span class="pre">EXCEL</span></code>をクリックするとダウンロードできる。</p></li>
<li><p>ガソリンは<code class="docutils literal notranslate"><span class="pre">【26】「7691</span> <span class="pre">鉄道運賃」</span> <span class="pre">～</span> <span class="pre">「7413</span> <span class="pre">通信料」</span></code>の右側にある<code class="docutils literal notranslate"><span class="pre">EXCEL</span></code>をクリックするとダウンロードできる。</p></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="id5">
<h3>チョコレート<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<blockquote>
<div><p>板チョコレート，50～55g，「明治ミルクチョコレート」，「ロッテガーナミルクチョコレート」又は「森永ミルクチョコレート」</p>
</div></blockquote>
<p>このチョコレートの定義に従って作成されたデータをダウンロードし，変数<code class="docutils literal notranslate"><span class="pre">choco</span></code>に<code class="docutils literal notranslate"><span class="pre">DateFrame</span></code>として割り当てる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url_choco</span> <span class="o">=</span> <span class="s1">&#39;https://www.e-stat.go.jp/stat-search/file-download?statInfId=000040047298&amp;fileKind=0&#39;</span>
<span class="n">choco</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">url_choco</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;1761チョコレート&#39;</span><span class="p">,</span>
                      <span class="n">skiprows</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">🐍 コードの説明</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pd.read_excel()</span></code>はExcelファイルを読み込む関数</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">url_choco</span></code>：その上のURLを文字列としてファイルを指定する引数（URLでなくてもファイル名でも良い）</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sheet_name</span></code>：Excelのシート名を指定する引数</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">skiprows</span></code>：最初の何行を飛ばして読み込むかを指定する引数</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">usecols</span></code>：何番目の列を読み込むかを指定する引数</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">pd.read_excel()</span></code>を使うにはモジュール<code class="docutils literal notranslate"><span class="pre">openpyxl</span></code>が事前にインストールされている必要がある。<a class="reference external" href="https://pypi.org/project/openpyxl/">参照リンク</a>。</p></li>
</ul>
</div>
<p>最初の５行を表示してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">choco</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>地域</th>
      <th>年平均</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>札幌市</td>
      <td>227</td>
    </tr>
    <tr>
      <th>1</th>
      <td>函館市</td>
      <td>211</td>
    </tr>
    <tr>
      <th>2</th>
      <td>旭川市</td>
      <td>209</td>
    </tr>
    <tr>
      <th>3</th>
      <td>青森市</td>
      <td>220</td>
    </tr>
    <tr>
      <th>4</th>
      <td>八戸市</td>
      <td>225</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>列ラベルが全角になっている。そのままでも良いが，ここでは次の様に半角に変更する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">choco</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>次にデータ型や欠損値を調べてみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">choco</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 81 entries, 0 to 80
Data columns (total 2 columns):
 #   Column  Non-Null Count  Dtype 
---  ------  --------------  ----- 
 0   area    81 non-null     object
 1   price   81 non-null     int64 
dtypes: int64(1), object(1)
memory usage: 1.4+ KB
</pre></div>
</div>
</div>
</div>
<p>どのような地域が含まれているか確認してみよう。</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">choco</span><span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;札幌市&#39;,
 &#39;函館市&#39;,
 &#39;旭川市&#39;,
 &#39;青森市&#39;,
 &#39;八戸市&#39;,
 &#39;盛岡市&#39;,
 &#39;仙台市&#39;,
 &#39;秋田市&#39;,
 &#39;山形市&#39;,
 &#39;福島市&#39;,
 &#39;郡山市&#39;,
 &#39;水戸市&#39;,
 &#39;日立市&#39;,
 &#39;宇都宮市&#39;,
 &#39;小山市&#39;,
 &#39;前橋市&#39;,
 &#39;さいたま市&#39;,
 &#39;熊谷市&#39;,
 &#39;川口市&#39;,
 &#39;所沢市&#39;,
 &#39;千葉市&#39;,
 &#39;佐倉市&#39;,
 &#39;浦安市&#39;,
 &#39;東京都区部&#39;,
 &#39;八王子市&#39;,
 &#39;立川市&#39;,
 &#39;府中市&#39;,
 &#39;横浜市&#39;,
 &#39;川崎市&#39;,
 &#39;相模原市&#39;,
 &#39;横須賀市&#39;,
 &#39;新潟市&#39;,
 &#39;長岡市&#39;,
 &#39;富山市&#39;,
 &#39;金沢市&#39;,
 &#39;福井市&#39;,
 &#39;甲府市&#39;,
 &#39;長野市&#39;,
 &#39;松本市&#39;,
 &#39;岐阜市&#39;,
 &#39;静岡市&#39;,
 &#39;浜松市&#39;,
 &#39;富士市&#39;,
 &#39;名古屋市&#39;,
 &#39;岡崎市&#39;,
 &#39;津市&#39;,
 &#39;松阪市&#39;,
 &#39;大津市&#39;,
 &#39;京都市&#39;,
 &#39;大阪市&#39;,
 &#39;堺市&#39;,
 &#39;枚方市&#39;,
 &#39;東大阪市&#39;,
 &#39;神戸市&#39;,
 &#39;姫路市&#39;,
 &#39;西宮市&#39;,
 &#39;伊丹市&#39;,
 &#39;奈良市&#39;,
 &#39;和歌山市&#39;,
 &#39;鳥取市&#39;,
 &#39;松江市&#39;,
 &#39;岡山市&#39;,
 &#39;広島市&#39;,
 &#39;福山市&#39;,
 &#39;山口市&#39;,
 &#39;宇部市&#39;,
 &#39;徳島市&#39;,
 &#39;高松市&#39;,
 &#39;松山市&#39;,
 &#39;今治市&#39;,
 &#39;高知市&#39;,
 &#39;福岡市&#39;,
 &#39;北九州市&#39;,
 &#39;佐賀市&#39;,
 &#39;長崎市&#39;,
 &#39;佐世保市&#39;,
 &#39;熊本市&#39;,
 &#39;大分市&#39;,
 &#39;宮崎市&#39;,
 &#39;鹿児島市&#39;,
 &#39;那覇市&#39;]
</pre></div>
</div>
</div>
</div>
<p>兵庫県からは神戸市，姫路市，西宮市，伊丹市が含まれている。</p>
<p>記述統計も確認しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">choco</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count     81.000000
mean     217.604938
std        8.204692
min      192.000000
25%      212.000000
50%      218.000000
75%      223.000000
max      242.000000
Name: price, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>最安値は<span class="pasted-text">192</span>円，最高値は<span class="pasted-text">242</span>円であり，その差は<span class="pasted-text">50</span>円！</p>
<p>価格の分布を調べるために，平均からの乖離率を計算しよう。</p>
<div class="math notranslate nohighlight" id="equation-eq-19-choco">
<span class="eqno">(57)<a class="headerlink" href="#equation-eq-19-choco" title="Link to this equation">#</a></span>\[
\pi_i
=\frac{P_i}{\overline{P}}-1
\]</div>
<p>ここで<span class="math notranslate nohighlight">\(i\)</span>は地域を表しており，<span class="math notranslate nohighlight">\(\overline{P}\)</span>は<span class="math notranslate nohighlight">\(P_i\)</span>の平均である。新たな列<code class="docutils literal notranslate"><span class="pre">mean_deviation</span></code>として追加しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">choco</span><span class="p">[</span><span class="s1">&#39;mean_deviation&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">choco</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">choco</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">choco</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;mean_deviation&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f52e86686162bed1ba40c51bc87853060471d9f41a426118d0a15300255bebfa.png" src="_images/f52e86686162bed1ba40c51bc87853060471d9f41a426118d0a15300255bebfa.png" />
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">0</span></code>は平均と等しいという意味である。<code class="docutils literal notranslate"><span class="pre">0.10</span></code>は平均より<code class="docutils literal notranslate"><span class="pre">10</span></code>％高い価格であり，<code class="docutils literal notranslate"><span class="pre">-0.10</span></code>は平均より<code class="docutils literal notranslate"><span class="pre">10</span></code>％安いチョコレートである。明らかに一物一価は成立していない。</p>
<p>価格のばらつき具合を確認するために標準偏差を計算しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span>
    <span class="n">choco</span><span class="p">[</span><span class="s1">&#39;mean_deviation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.03770453161138014
</pre></div>
</div>
</div>
</div>
<p>乖離率<a class="reference internal" href="#equation-eq-19-choco">(57)</a>の標準偏差は次式で定義される変動係数（Coefficient of Variation）と等しい。</p>
<div class="math notranslate nohighlight" id="equation-eq-19-cc">
<span class="eqno">(58)<a class="headerlink" href="#equation-eq-19-cc" title="Link to this equation">#</a></span>\[
P_iの変動係数=\frac{P_iの標準偏差}{P_iの平均}
\]</div>
<p>試しに変動係数を直接計算してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span> 
    <span class="n">choco</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="o">/</span> <span class="n">choco</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> 
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.03770453161138012
</pre></div>
</div>
</div>
</div>
<p>同じ値である。変動係数の利点は，変数の平均で除している為，単位（ここでは，円）や平均の大小に関係なく，異なるデータのばらつき具合を比べることができることである。</p>
<p>最後に，チョコレートが最安値の地域はどこか確認してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cond</span> <span class="o">=</span> <span class="p">(</span> <span class="n">choco</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">choco</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="p">)</span>
<span class="n">choco</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>area</th>
      <th>price</th>
      <th>mean_deviation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>秋田市</td>
      <td>192</td>
      <td>-0.117667</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><span class="pasted-text">秋田市</span>ではチョコレートが平均よりも約<span class="pasted-text">11.8</span>％も安い。（甘党の楽園かも！？）</p>
</section>
<section id="id6">
<h3>アイスクリーム<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<p>アイスクリームの定義</p>
<blockquote>
<div><p>バニラアイスクリーム，カップ入り（110mL入り），「ハーゲンダッツ バニラ」</p>
</div></blockquote>
<p>データをダウンロードして，変数<code class="docutils literal notranslate"><span class="pre">ice</span></code>に割り当てよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url_ice</span> <span class="o">=</span> <span class="s1">&#39;https://www.e-stat.go.jp/stat-search/file-download?statInfId=000040047298&amp;fileKind=0&#39;</span>
<span class="n">ice</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">url_ice</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;1782アイスクリーム&#39;</span><span class="p">,</span> 
                    <span class="n">skiprows</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>最初の５行の表示</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ice</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>地域</th>
      <th>年平均</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>札幌市</td>
      <td>296</td>
    </tr>
    <tr>
      <th>1</th>
      <td>函館市</td>
      <td>286</td>
    </tr>
    <tr>
      <th>2</th>
      <td>旭川市</td>
      <td>281</td>
    </tr>
    <tr>
      <th>3</th>
      <td>青森市</td>
      <td>260</td>
    </tr>
    <tr>
      <th>4</th>
      <td>八戸市</td>
      <td>258</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>列ラベルの変更</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ice</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>データの確認</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ice</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 81 entries, 0 to 80
Data columns (total 2 columns):
 #   Column  Non-Null Count  Dtype 
---  ------  --------------  ----- 
 0   area    81 non-null     object
 1   price   81 non-null     int64 
dtypes: int64(1), object(1)
memory usage: 1.4+ KB
</pre></div>
</div>
</div>
</div>
<p>記述統計</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ice</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count     81.000000
mean     263.888889
std       18.672172
min      210.000000
25%      258.000000
50%      267.000000
75%      276.000000
max      300.000000
Name: price, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>最安値は<span class="pasted-text">210</span>円，最高値は<span class="pasted-text">300</span>円であり，その差は<span class="pasted-text">90</span>円！（著者のように）ハーゲンダッツ好きにとっては無視できない価格差である。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ice</span><span class="p">[</span><span class="s1">&#39;mean_deviation&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">ice</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">ice</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span>

<span class="n">ice</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;mean_deviation&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/49743baabc5259f1fd28258346d7e370751e72bc1b6973fcfa9bd4c8568ad199.png" src="_images/49743baabc5259f1fd28258346d7e370751e72bc1b6973fcfa9bd4c8568ad199.png" />
</div>
</div>
<p>安いところは平均よりも約<span class="pasted-text">20</span>％もお得！いずれにしろ，一物一価は成立していない。</p>
<p>価格のばらつき具合を確認するために標準偏差（変動係数）を計算してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span>
    <span class="n">ice</span><span class="p">[</span><span class="s1">&#39;mean_deviation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0707577036906862
</pre></div>
</div>
</div>
</div>
<p>チョコレートと比較すると価格のばらつきが大きい。</p>
<p>安い地域と高い地域を確認してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ice</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;price&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>area</th>
      <th>price</th>
      <th>mean_deviation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>80</th>
      <td>那覇市</td>
      <td>300</td>
      <td>0.136842</td>
    </tr>
    <tr>
      <th>0</th>
      <td>札幌市</td>
      <td>296</td>
      <td>0.121684</td>
    </tr>
    <tr>
      <th>35</th>
      <td>福井市</td>
      <td>289</td>
      <td>0.095158</td>
    </tr>
    <tr>
      <th>60</th>
      <td>松江市</td>
      <td>288</td>
      <td>0.091368</td>
    </tr>
    <tr>
      <th>1</th>
      <td>函館市</td>
      <td>286</td>
      <td>0.083789</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>15</th>
      <td>前橋市</td>
      <td>232</td>
      <td>-0.120842</td>
    </tr>
    <tr>
      <th>21</th>
      <td>佐倉市</td>
      <td>223</td>
      <td>-0.154947</td>
    </tr>
    <tr>
      <th>22</th>
      <td>浦安市</td>
      <td>216</td>
      <td>-0.181474</td>
    </tr>
    <tr>
      <th>37</th>
      <td>長野市</td>
      <td>211</td>
      <td>-0.200421</td>
    </tr>
    <tr>
      <th>38</th>
      <td>松本市</td>
      <td>210</td>
      <td>-0.204211</td>
    </tr>
  </tbody>
</table>
<p>81 rows × 3 columns</p>
</div></div></div>
</div>
<p>この順番を見て何か言えることがあるだろうか。考えてみよう！</p>
</section>
<section id="id7">
<h3>ガソリン<a class="headerlink" href="#id7" title="Link to this heading">#</a></h3>
<p>ガソリンの定義</p>
<blockquote>
<div><p>レギュラー・ガソリン１L</p>
</div></blockquote>
<p>変数<code class="docutils literal notranslate"><span class="pre">gas</span></code>に<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>として割り当てよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url_gas</span> <span class="o">=</span> <span class="s1">&#39;https://www.e-stat.go.jp/stat-search/file-download?statInfId=000040047335&amp;fileKind=0&#39;</span>
<span class="n">gas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">url_gas</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;7301ガソリン&#39;</span><span class="p">,</span> 
                    <span class="n">skiprows</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>最初の５行の表示</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gas</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>地域</th>
      <th>年平均</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>札幌市</td>
      <td>167</td>
    </tr>
    <tr>
      <th>1</th>
      <td>函館市</td>
      <td>167</td>
    </tr>
    <tr>
      <th>2</th>
      <td>旭川市</td>
      <td>169</td>
    </tr>
    <tr>
      <th>3</th>
      <td>青森市</td>
      <td>166</td>
    </tr>
    <tr>
      <th>4</th>
      <td>八戸市</td>
      <td>164</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>列ラベルの変更</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gas</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>データの詳細</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gas</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 81 entries, 0 to 80
Data columns (total 2 columns):
 #   Column  Non-Null Count  Dtype 
---  ------  --------------  ----- 
 0   area    81 non-null     object
 1   price   81 non-null     int64 
dtypes: int64(1), object(1)
memory usage: 1.4+ KB
</pre></div>
</div>
</div>
</div>
<p>記述統計</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gas</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count     81.000000
mean     170.604938
std        4.718790
min      160.000000
25%      168.000000
50%      170.000000
75%      174.000000
max      184.000000
Name: price, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>最安値は<span class="pasted-text">160</span>円，最高値は<span class="pasted-text">184</span>円であり，その差は<span class="pasted-text">24</span>円。平均からの乖離のヒストグラムをプロットしよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gas</span><span class="p">[</span><span class="s1">&#39;mean_deviation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gas</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">gas</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span>

<span class="n">gas</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;mean_deviation&#39;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ec8da031f3833a9423c808c113e32c0576ecb788794b8785af42e6126905cfa1.png" src="_images/ec8da031f3833a9423c808c113e32c0576ecb788794b8785af42e6126905cfa1.png" />
</div>
</div>
<p>平均から高くても約<span class="pasted-text">7.9</span>％，安くても約<span class="pasted-text">6.2</span>％程しか違わない。標準偏差（変動係数）を計算してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span>
    <span class="n">gas</span><span class="p">[</span><span class="s1">&#39;mean_deviation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.02765916186178425
</pre></div>
</div>
</div>
</div>
<p>アイスクリームよりも価格のばらつきは小さい。直感的に，ガソリンスタンドへは車やバイクで行くことになり，消費者が価格を比較し少しでも安いスタンドへ行く費用が安いためかも知れない。</p>
<p>最高値の地域は？</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cond</span> <span class="o">=</span> <span class="p">(</span> <span class="n">gas</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">gas</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">)</span>
<span class="n">gas</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>area</th>
      <th>price</th>
      <th>mean_deviation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>77</th>
      <td>大分市</td>
      <td>184</td>
      <td>0.078515</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="id8">
<h3>結論<a class="headerlink" href="#id8" title="Link to this heading">#</a></h3>
<p>データを見る限り一物一価の法則は成立していない。主な理由は，前提となっている条件が満たされていないためである。冒頭でA市とB市の例を挙げたが，離れている場合は輸送費用がかかる。また，距離が遠くなれば情報の収集にもコストが掛かることになるだろうし，市場が異なれば取引費用も違ってくるかも知れない。このような費用を財１単位当たりで<span class="math notranslate nohighlight">\(\tau\)</span>と表すと，利潤<a class="reference internal" href="#equation-eq-19-1">(55)</a>は次式となる。</p>
<div class="math notranslate nohighlight" id="equation-eq-19-3">
<span class="eqno">(59)<a class="headerlink" href="#equation-eq-19-3" title="Link to this equation">#</a></span>\[
\pi=p_BX-p_AX-\tau X=\left(p_B-p_A-\tau\right)X
\]</div>
<p>ここで，<span class="math notranslate nohighlight">\(\tau X\)</span>が輸送費用などを捉えている。利潤がゼロになるまで企業が参入したとしても，</p>
<div class="math notranslate nohighlight" id="equation-eq-19-4">
<span class="eqno">(60)<a class="headerlink" href="#equation-eq-19-4" title="Link to this equation">#</a></span>\[
\pi=0\quad\Rightarrow\quad p_B=p_A+\tau
\]</div>
<p>となり，A市の財ががB市よりも安いままの状態が続くことになる。</p>
</section>
</section>
<section id="big-mac">
<span id="sec-19-bigmac"></span><h2>経済間での一物一価：Big Mac<a class="headerlink" href="#big-mac" title="Link to this heading">#</a></h2>
<section id="id9">
<h3>はじめに<a class="headerlink" href="#id9" title="Link to this heading">#</a></h3>
<p>国内市場では一物一価の法則は成立しないことが分かった。では，経済間ではどうだろうか。国際貿易の輸送費用は更に高く，国境を跨ぐ情報伝達も時間がかかり，ビジネス慣例が違うことにより取引費用もかさむだろう。更には，そもそも貿易されない財・サービス（例えば，理髪）が存在し，裁定取引が成立しない。このように考えると，経済間でも一物一価の法則が成り立たないことは明らかだろう。</p>
<p>しかし，２つ疑問点が残る。第１に，経済間における価格の散らばりの程度はどれくらいなのだろうか。国内市場よりも経済間の価格差の方が大きいと推測できるが，変動係数で考えるとどれほどの差が存在するのだろうか。２倍もしくは10倍だろうか？第２に，経済間の所得格差は大きく，日本の一人当たりGDPの5％に満たない国も存在する（<a class="reference internal" href="5a_Development_Accounting.html#chap-5a-accounting"><span class="std std-ref">発展会計</span></a>を参照）。所得格差は財・サービスの需要の大きさに反映される。正常財であれば，所得が高い経済の需要は高くなり，価格は高くなるのではないかと想像できる。また所得が高い国では生産性も高い。実際，生産性が高く（従って，所得が高い）経済では価格が高い傾向になることが知られている。この節では，世界中で概ね同質財と考えられるマクドナルドのハンバーガーBig Macを取り上げ，これらの問いを考察する。</p>
<div class="admonition-big-mac admonition">
<p class="admonition-title">Big Macの違い</p>
<p>国毎にBig Macは多少の違いがあるようだ。<a class="reference external" href="https://en.wikipedia.org/wiki/Big_Mac_Index#Comparison_issues">このリンクを参照</a>。</p>
</div>
</section>
<section id="id10">
<h3>データ<a class="headerlink" href="#id10" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">py4etrics</span></code>に含まれるデータ・セット<code class="docutils literal notranslate"><span class="pre">bigmac</span></code>を使って議論を進める。まず含まれる変数の定義を表示してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">py4macro</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;bigmac&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    | `year`:          年（2000年〜）
    | `country`:       国名
    | `iso`:           ISO国コード
    | `currency_code`: 通貨コード
    | `price_local`:   Big Macの価格（自国通貨単位）
    | `exr`:           名目為替レート（自国通貨単位/米ドル）
    | `gdppc_local`:   名目一人当たりGDP（自国通貨単位）
    |
    | * 年次データ
    |
    | ＜出典＞
    | https://github.com/TheEconomist/big-mac-data (Copyright The Economist)
</pre></div>
</div>
</div>
</div>
<p>データセットを変数<code class="docutils literal notranslate"><span class="pre">bigmac</span></code>に割り当てて，最初の5行を表示してみる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bigmac</span> <span class="o">=</span> <span class="n">py4macro</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;bigmac&#39;</span><span class="p">)</span>
<span class="n">bigmac</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>country</th>
      <th>iso</th>
      <th>currency_code</th>
      <th>price_local</th>
      <th>exr</th>
      <th>gdppc_local</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000</td>
      <td>Argentina</td>
      <td>ARG</td>
      <td>ARS</td>
      <td>2.50</td>
      <td>1.00</td>
      <td>9283.18</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2000</td>
      <td>Australia</td>
      <td>AUS</td>
      <td>AUD</td>
      <td>2.59</td>
      <td>1.68</td>
      <td>32394.17</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2000</td>
      <td>Brazil</td>
      <td>BRA</td>
      <td>BRL</td>
      <td>2.95</td>
      <td>1.79</td>
      <td>6029.89</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2000</td>
      <td>Canada</td>
      <td>CAN</td>
      <td>CAD</td>
      <td>2.85</td>
      <td>1.47</td>
      <td>31222.68</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2000</td>
      <td>Switzerland</td>
      <td>CHE</td>
      <td>CHF</td>
      <td>5.90</td>
      <td>1.70</td>
      <td>61942.36</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>このでは2023年のデータを使う。2023年のデータだけを抽出し<code class="docutils literal notranslate"><span class="pre">bigmac</span></code>に再割り当てしよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cond</span> <span class="o">=</span> <span class="p">(</span> <span class="n">bigmac</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2023</span> <span class="p">)</span>
<span class="n">bigmac</span> <span class="o">=</span> <span class="n">bigmac</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<p><a class="reference external" href="https://py4basics.github.io/things_to_note.html#pandas">ここで説明</a>している問題を避けるために，メソッド<code class="docutils literal notranslate"><span class="pre">.copy()</span></code>を使っている。ここで使わなくても問題はないが，使わなければ警告が表示されることになる。</p>
</div>
<p>それぞれの変数のデータ型と欠損値を確認しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bigmac</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Index: 72 entries, 1159 to 1230
Data columns (total 7 columns):
 #   Column         Non-Null Count  Dtype  
---  ------         --------------  -----  
 0   year           72 non-null     int64  
 1   country        72 non-null     object 
 2   iso            72 non-null     object 
 3   currency_code  72 non-null     object 
 4   price_local    72 non-null     float64
 5   exr            72 non-null     float64
 6   gdppc_local    72 non-null     float64
dtypes: float64(3), int64(1), object(3)
memory usage: 4.5+ KB
</pre></div>
</div>
</div>
</div>
</section>
<section id="id11">
<h3>一物一価<a class="headerlink" href="#id11" title="Link to this heading">#</a></h3>
<p>これから行う作業を説明するために変数を定義しよう。</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(P_i=\)</span> <span class="math notranslate nohighlight">\(i\)</span>国のBig Macの価格（自国通貨）</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(P_{\text{JP}}=\)</span> 日本のBig Macの価格（円）</p></li>
<li><p><span class="math notranslate nohighlight">\(P_{\text{US}}=\)</span> 米国のBig Macの価格（米ドル）</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bigmac</span></code>の列<code class="docutils literal notranslate"><span class="pre">price_local</span></code>に対応</p></li>
</ul>
</li>
<li><p><span class="math notranslate nohighlight">\(e_i=\)</span> 名目為替レート（<span class="math notranslate nohighlight">\(i\)</span>国通貨/米ドル）</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(e_{\text{JP}}=\)</span> 名目為替レート（円/米ドル）</p></li>
<li><p><span class="math notranslate nohighlight">\(e_{\text{US}}=1\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bigmac</span></code>の列<code class="docutils literal notranslate"><span class="pre">exr</span></code>に対応</p></li>
</ul>
</li>
</ul>
<p>これらの変数を使うと，<span class="math notranslate nohighlight">\(i\)</span>国のBig Macの米ドル表示価格は次式で計算できる。</p>
<div class="math notranslate nohighlight" id="equation-eq-19-5">
<span class="eqno">(61)<a class="headerlink" href="#equation-eq-19-5" title="Link to this equation">#</a></span>\[
i\text{国のBig Macのドル価格：}\;\dfrac{P_i}{e_i}
\]</div>
<p>一物一価が成立する場合は<span class="math notranslate nohighlight">\(\dfrac{P_i}{e_i}\)</span>と<span class="math notranslate nohighlight">\(P_{\text{US}}\)</span>（ドル表示）が等しくなる。</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>単位を確認することで為替レートが入る数式を簡単に理解できる。例えは，<span class="math notranslate nohighlight">\(c_i\)</span>を<span class="math notranslate nohighlight">\(i\)</span>国の通貨単位として，<a class="reference internal" href="#equation-eq-19-5">(61)</a>の右辺を単位で表してみよう。</p>
<div class="math notranslate nohighlight">
\[\dfrac{c_i}{c_i/\$}=\$\]</div>
<p>となり，単位が米ドルになっているのが分かる。また，式<a class="reference internal" href="#equation-eq-19-8">(63)</a>の右辺を考えてみよう。</p>
<div class="math notranslate nohighlight">
\[e_{i\text{JP}}=\dfrac{c_i/\$}{¥/\$}=\frac{c_i}{¥}\]</div>
<p>１円に対する<span class="math notranslate nohighlight">\(i\)</span>国の貨幣単位になっている。次に，実質為替レート<a class="reference internal" href="#equation-eq-19-rexr">(72)</a>の右辺を単位で表してみよう。</p>
<div class="math notranslate nohighlight">
\[\dfrac{\dfrac{c_i}{\$}$}{c_i}\]</div>
<p>となり，貨幣単位がキャンセルされて無くなってしまう。実質為替レートは，実質変数であり貨幣単位から独立しているためである。</p>
</div>
<p>このまま<span class="math notranslate nohighlight">\(i\)</span>国と米国を考えて議論を進めることもできるが，以下では円を基準に置いて分析を進めよう。その場合，<span class="math notranslate nohighlight">\(i\)</span>国のBig Macの円表示価格は次式で計算できる。</p>
<div class="math notranslate nohighlight" id="equation-eq-19-6a">
<span class="eqno">(62)<a class="headerlink" href="#equation-eq-19-6a" title="Link to this equation">#</a></span>\[
i\text{国のBig Macの円価格}
=\dfrac{P_i}{e_{i\text{JP}}}
\]</div>
<p>ここで</p>
<div class="math notranslate nohighlight" id="equation-eq-19-8">
<span class="eqno">(63)<a class="headerlink" href="#equation-eq-19-8" title="Link to this equation">#</a></span>\[
e_{i\text{JP}}\equiv\frac{e_i}{e_{\text{JP}}}
\qquad\left(\text{単位：}
\dfrac{i\text{国の通貨}/\text{米ドル}}{\text{円}/\text{米ドル}}
=\dfrac{i\text{国の通貨}}{\text{円}}
\right)
\]</div>
<p>は<span class="math notranslate nohighlight">\(i\)</span>国通貨/円の市場為替レートである。<span class="math notranslate nohighlight">\(\dfrac{P_i}{e_{iJP}}\)</span>と<span class="math notranslate nohighlight">\(P_{\text{JP}}\)</span>（円表示）が等しくなると一物一価の成立となるが，そうならないことをデータで確認することになる。</p>
<p>国内財と同様に，平均価格を基準にし乖離率を考えることもできるが，日本と比べてどれだけ違うかを計算するために，ここでは日本のBig Macの価格に対しての乖離率を考える。</p>
<div class="math notranslate nohighlight" id="equation-eq-19-7">
<span class="eqno">(64)<a class="headerlink" href="#equation-eq-19-7" title="Link to this equation">#</a></span>\[
i\text{国価格の日本価格からの乖離率（円）}=\dfrac{P_i/e_{i\text{JP}}}{P_{\text{JP}}}-1
\]</div>
<p>まず式<a class="reference internal" href="#equation-eq-19-7">(64)</a>を計算するために，変数<code class="docutils literal notranslate"><span class="pre">ejp</span></code>に円/ドル為替レートを割り当てよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cond</span> <span class="o">=</span> <span class="p">(</span> <span class="n">bigmac</span><span class="p">[</span><span class="s1">&#39;iso&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;JPN&#39;</span> <span class="p">)</span>
<span class="n">ejp</span> <span class="o">=</span> <span class="n">bigmac</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,</span><span class="s1">&#39;exr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ejp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>142.08
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">ejp</span></code>，<code class="docutils literal notranslate"><span class="pre">local_price</span></code>，<code class="docutils literal notranslate"><span class="pre">exr</span></code>を使い各国のBig Macを円表示に変換し，新たな列<code class="docutils literal notranslate"><span class="pre">yen_price</span></code>として<code class="docutils literal notranslate"><span class="pre">bigmac</span></code>に追加しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bigmac</span><span class="p">[</span><span class="s1">&#39;price_yen&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span> <span class="n">bigmac</span><span class="p">[</span><span class="s1">&#39;price_local&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">bigmac</span><span class="p">[</span><span class="s1">&#39;exr&#39;</span><span class="p">]</span> <span class="p">)</span><span class="o">*</span><span class="n">ejp</span>
</pre></div>
</div>
</div>
</div>
<p>日本の価格を確認してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cond</span> <span class="o">=</span> <span class="p">(</span> <span class="n">bigmac</span><span class="p">[</span><span class="s1">&#39;iso&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;JPN&#39;</span> <span class="p">)</span>
<span class="n">bigmac</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,[</span><span class="s1">&#39;price_local&#39;</span><span class="p">,</span><span class="s1">&#39;price_yen&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>price_local</th>
      <th>price_yen</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1195</th>
      <td>450.0</td>
      <td>450.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>米国の価格はどうだろう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cond</span> <span class="o">=</span> <span class="p">(</span> <span class="n">bigmac</span><span class="p">[</span><span class="s1">&#39;iso&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;USA&#39;</span> <span class="p">)</span>
<span class="n">bigmac</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,[</span><span class="s1">&#39;price_local&#39;</span><span class="p">,</span><span class="s1">&#39;price_yen&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>price_local</th>
      <th>price_yen</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1227</th>
      <td>5.58</td>
      <td>792.8064</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>日本の価格<span class="output text_plain">450</span>円と比べると，米国でのBig Macの価格は少し高く感じる。記述統計を確認してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bigmac</span><span class="p">[</span><span class="s1">&#39;price_yen&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count      72.000000
mean      647.093073
std       169.651670
min       339.076894
25%       505.350594
50%       666.820588
75%       767.585089
max      1098.155390
Name: price_yen, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>最安値<span class="pasted-text">339</span>と最高値<span class="pasted-text">1098</span>には大きな差（<span class="pasted-text">759</span>円）があることが分かる。平均価格<span class="pasted-text">647</span>円は日本の価格<span class="pasted-text">450</span>円を上回っている。</p>
<p>次に，日本の価格からの乖離率を計算しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 日本の価格</span>
<span class="n">cond</span> <span class="o">=</span> <span class="p">(</span> <span class="n">bigmac</span><span class="p">[</span><span class="s1">&#39;iso&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;JPN&#39;</span><span class="p">)</span>
<span class="n">yen_price_jpn</span> <span class="o">=</span> <span class="n">bigmac</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,</span><span class="s1">&#39;price_yen&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># 米国の価格に対してi国の価格の乖離率</span>
<span class="n">bigmac</span><span class="p">[</span><span class="s1">&#39;price_yen_deviation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bigmac</span><span class="p">[</span><span class="s1">&#39;price_yen&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">yen_price_jpn</span> <span class="o">-</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<p>ヒストグラムをプロットする。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bigmac</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;price_yen_deviation&#39;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d75a063d4dc06154ab17a0cadb0463e5b4f7bd1722f61cf160947856fb739d9c.png" src="_images/d75a063d4dc06154ab17a0cadb0463e5b4f7bd1722f61cf160947856fb739d9c.png" />
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">0.0</span></code>が日本となる。一番高い国を調べてみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cond</span> <span class="o">=</span> <span class="p">(</span> <span class="n">bigmac</span><span class="p">[</span><span class="s1">&#39;price_yen&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">bigmac</span><span class="p">[</span><span class="s1">&#39;price_yen&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">)</span>
<span class="n">bigmac</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,[</span><span class="s1">&#39;country&#39;</span><span class="p">,</span><span class="s1">&#39;price_yen&#39;</span><span class="p">,</span><span class="s1">&#39;price_yen_deviation&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>price_yen</th>
      <th>price_yen_deviation</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1168</th>
      <td>Switzerland</td>
      <td>1098.15539</td>
      <td>1.440345</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><span class="pasted-text">Switzerland</span>の価格は約<span class="pasted-text">1098</span>円となっている。次に，価格が最も低い国を表示してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cond</span> <span class="o">=</span> <span class="p">(</span> <span class="n">bigmac</span><span class="p">[</span><span class="s1">&#39;price_yen&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">bigmac</span><span class="p">[</span><span class="s1">&#39;price_yen&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="p">)</span>
<span class="n">bigmac</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,[</span><span class="s1">&#39;country&#39;</span><span class="p">,</span><span class="s1">&#39;price_yen&#39;</span><span class="p">,</span><span class="s1">&#39;price_yen_deviation&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>price_yen</th>
      <th>price_yen_deviation</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1224</th>
      <td>Taiwan</td>
      <td>339.076894</td>
      <td>-0.246496</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><span class="pasted-text">Taiwan</span>が一番安く，日本より約<span class="pasted-text">24.6</span>％も安価である。</p>
<p>明らかにBig Macの一物一価は成立していない。</p>
<p>価格のばらつき具合を確認し，上で確認した国内財の価格と比較するために，変動係数（平均からの乖離の標準偏差と同じ）を計算しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span>
    <span class="n">bigmac</span><span class="p">[</span><span class="s1">&#39;price_yen&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="o">/</span> <span class="n">bigmac</span><span class="p">[</span><span class="s1">&#39;price_yen&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.26217506693057535
</pre></div>
</div>
</div>
</div>
<p>国内のチョコレート，アイスクリーム，ガソリン価格の標準偏差よりも非常に大きな値となっている。</p>
<p>理由として次のことが言えるだろう。</p>
<ul class="simple">
<li><p>Big Macは消耗財であり，貿易されずに生産された地域で消費される。言い換えると，消耗財が故に輸送費用は非常に高い非貿易財である。</p></li>
<li><p>非貿易財の場合，国境を超えた競争が妨げられる。神戸のマクドナルドは，ロンドンやシンガポールのマクドナルドと価格競争をしているとは言い難い。</p></li>
</ul>
</section>
<section id="id12">
<h3>所得の影響<a class="headerlink" href="#id12" title="Link to this heading">#</a></h3>
<p>価格が最も高い<code class="docutils literal notranslate"><span class="pre">15</span></code>カ国国をリストアップしてみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bigmac_sorted</span> <span class="o">=</span> <span class="p">(</span>
                 <span class="n">bigmac</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;price_yen&#39;</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="o">.</span><span class="n">loc</span><span class="p">[:,[</span><span class="s1">&#39;country&#39;</span><span class="p">,</span><span class="s1">&#39;price_yen&#39;</span><span class="p">,</span><span class="s1">&#39;price_yen_deviation&#39;</span><span class="p">]]</span>
<span class="p">)</span>
<span class="n">bigmac_sorted</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>price_yen</th>
      <th>price_yen_deviation</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1168</th>
      <td>Switzerland</td>
      <td>1098.155390</td>
      <td>1.440345</td>
    </tr>
    <tr>
      <th>1207</th>
      <td>Norway</td>
      <td>983.106806</td>
      <td>1.184682</td>
    </tr>
    <tr>
      <th>1226</th>
      <td>Uruguay</td>
      <td>974.413346</td>
      <td>1.165363</td>
    </tr>
    <tr>
      <th>1193</th>
      <td>Italy</td>
      <td>908.570106</td>
      <td>1.019045</td>
    </tr>
    <tr>
      <th>1180</th>
      <td>Finland</td>
      <td>900.737605</td>
      <td>1.001639</td>
    </tr>
    <tr>
      <th>1160</th>
      <td>Argentina</td>
      <td>851.628372</td>
      <td>0.892507</td>
    </tr>
    <tr>
      <th>1174</th>
      <td>Germany</td>
      <td>836.511097</td>
      <td>0.858914</td>
    </tr>
    <tr>
      <th>1206</th>
      <td>Netherlands</td>
      <td>834.944597</td>
      <td>0.855432</td>
    </tr>
    <tr>
      <th>1181</th>
      <td>France</td>
      <td>830.245096</td>
      <td>0.844989</td>
    </tr>
    <tr>
      <th>1179</th>
      <td>Euro area</td>
      <td>827.112096</td>
      <td>0.838027</td>
    </tr>
    <tr>
      <th>1221</th>
      <td>Sweden</td>
      <td>814.957088</td>
      <td>0.811016</td>
    </tr>
    <tr>
      <th>1177</th>
      <td>Spain</td>
      <td>814.580095</td>
      <td>0.810178</td>
    </tr>
    <tr>
      <th>1175</th>
      <td>Denmark</td>
      <td>802.961253</td>
      <td>0.784358</td>
    </tr>
    <tr>
      <th>1191</th>
      <td>Ireland</td>
      <td>798.915093</td>
      <td>0.775367</td>
    </tr>
    <tr>
      <th>1227</th>
      <td>United States</td>
      <td>792.806400</td>
      <td>0.761792</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<p>丸括弧<code class="docutils literal notranslate"><span class="pre">()</span></code>の中にコードを書く場合，任意の箇所で改行してもエラーにはならない。1行で長いコードを書く場合に便利なので覚えておこう！</p>
</div>
<p>全て所得が高い先進国となっている。価格が最も安い<code class="docutils literal notranslate"><span class="pre">10</span></code>カ国を確認してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bigmac_sorted</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>price_yen</th>
      <th>price_yen_deviation</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1185</th>
      <td>Hong Kong</td>
      <td>419.023683</td>
      <td>-0.068836</td>
    </tr>
    <tr>
      <th>1204</th>
      <td>Malaysia</td>
      <td>414.360612</td>
      <td>-0.079199</td>
    </tr>
    <tr>
      <th>1225</th>
      <td>Ukraine</td>
      <td>403.948396</td>
      <td>-0.102337</td>
    </tr>
    <tr>
      <th>1212</th>
      <td>Philippines</td>
      <td>400.954028</td>
      <td>-0.108991</td>
    </tr>
    <tr>
      <th>1230</th>
      <td>South Africa</td>
      <td>398.666873</td>
      <td>-0.114074</td>
    </tr>
    <tr>
      <th>1228</th>
      <td>Venezuela</td>
      <td>386.278992</td>
      <td>-0.141602</td>
    </tr>
    <tr>
      <th>1176</th>
      <td>Egypt</td>
      <td>372.141633</td>
      <td>-0.173019</td>
    </tr>
    <tr>
      <th>1190</th>
      <td>India</td>
      <td>361.035298</td>
      <td>-0.197699</td>
    </tr>
    <tr>
      <th>1189</th>
      <td>Indonesia</td>
      <td>358.026525</td>
      <td>-0.204385</td>
    </tr>
    <tr>
      <th>1224</th>
      <td>Taiwan</td>
      <td>339.076894</td>
      <td>-0.246496</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>貧しい国が並んでいる。実は，この結果は偶然ではない。Big Macの価格と所得の散布図を使い相関関係を確かめてみるために，円表示の一人当たりGDPを計算しよう。新たな列<code class="docutils literal notranslate"><span class="pre">gdppc_yen</span></code>を作成する</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bigmac</span><span class="p">[</span><span class="s1">&#39;gdppc_yen&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span> <span class="n">bigmac</span><span class="p">[</span><span class="s1">&#39;gdppc_local&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">bigmac</span><span class="p">[</span><span class="s1">&#39;exr&#39;</span><span class="p">]</span> <span class="p">)</span><span class="o">*</span><span class="n">ejp</span>
</pre></div>
</div>
</div>
</div>
<p>散布図をプロットしよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">bigmac</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;gdppc_yen&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;price_yen&#39;</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;一人当たり実質GDP（円，常用対数）&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Big Mac価格（円）&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9d4f8454fffaa3b52b44f3e9fd18e0f1e40820667edb2d5dc18ff384dbf2b7f7.png" src="_images/9d4f8454fffaa3b52b44f3e9fd18e0f1e40820667edb2d5dc18ff384dbf2b7f7.png" />
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<p>１行目の<code class="docutils literal notranslate"><span class="pre">logx=True</span></code>は，横軸の変数<code class="docutils literal notranslate"><span class="pre">gdppc_yen</span></code>を対数化することを指定している。もし縦軸も対数化したければ<code class="docutils literal notranslate"><span class="pre">logy=True</span></code>を使うと良いだろう。これらの引数を使うことにより，対数化した変数を<code class="docutils literal notranslate"><span class="pre">bigmac</span></code>に追加することなく図示できる。便利なので覚えておこう！</p>
</div>
<p>明らかに所得が高い国ではBig Macの価格は高くなっている。理由は，市場為替レートを使い円に変換していることに起因する。この現象の経済学的な含意については後ほど議論することにする。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>価格水準と所得の正の関係は経済間だけではなく，国内のデータでも観測されている。<a class="reference external" href="https://academic.oup.com/oep/article-abstract/66/4/1070/2912951">Cheung and Fujii (2014)</a>は日本のデータを使い，都道府県の価格と所得の間に正の相関があることを報告している。</p>
</div>
</section>
</section>
<section id="id13">
<h2>購買力平価と物価水準の分布<a class="headerlink" href="#id13" title="Link to this heading">#</a></h2>
<section id="ppp">
<h3>PPPとは<a class="headerlink" href="#ppp" title="Link to this heading">#</a></h3>
<p>前節の分析から分かったことは，市場為替レートで各国のBig Macの価格を共通貨幣単位（上の例では円）で表し価格を比べてみると，一物一価は成立していないということである。また，国内財と比較して分布の幅は大きいことも確認できた。今度は逆に，Big Macの一物一価が成立する場合の交換レートはどのように定義されるかを考えてみよう。</p>
<div class="math notranslate nohighlight" id="equation-eq-19-a">
<span class="eqno">(65)<a class="headerlink" href="#equation-eq-19-a" title="Link to this equation">#</a></span>\[
\frac{P_i}{e_{i}^{\text{BM}}}=P_{\text{US}}
\]</div>
<p><span class="math notranslate nohighlight">\(e_{i}^{\text{BM}}\)</span>がBig Macの一物一価レートであり，単位は「<span class="math notranslate nohighlight">\(i\)</span>国通貨/米ドル」である。左辺では<span class="math notranslate nohighlight">\(e_{i}^{\text{BM}}\)</span>により<span class="math notranslate nohighlight">\(i\)</span>国通貨表示の価格<span class="math notranslate nohighlight">\(P_i\)</span>が米ドルに換算され，右辺の<span class="math notranslate nohighlight">\(P_{\text{US}}\)</span>と等価となっている。この式を書き換えると</p>
<div class="math notranslate nohighlight" id="equation-eq-19-aa">
<span class="eqno">(66)<a class="headerlink" href="#equation-eq-19-aa" title="Link to this equation">#</a></span>\[
e_{i}^{\text{BM}}=\frac{P_i}{P_{\text{US}}}
\]</div>
<p>となる。</p>
<p>Big Macだけではなく財・サービスの種類を大幅に広げて，上述の考えを適用したのが購買力平価（PPP, Purchasing Power Parity）レートである。それぞれの経済で消費される同じような典型的な共通の財・サービスを集めて大きなバスケット（大きな籠）に入れることを想像しよう。多くの財・サービスが入ったバスケットを１つの財（合成財）として考え，バスケット財と呼ぶことにしよう。バスケット財に含まれる様々な財の価格は各経済で異なることになり，その結果，バスケット財の価格も異なる。バスケット財には多種多様の財・サービスが含まれているため，その価格を各国の一般物価水準と考えることができる。購買力平価（PPP）レートとは，バスケット財が等価となる為替レートとして算出される。次式は<span class="math notranslate nohighlight">\(i\)</span>国の対米国PPPレートである。</p>
<div class="math notranslate nohighlight" id="equation-eq-19-20">
<span class="eqno">(67)<a class="headerlink" href="#equation-eq-19-20" title="Link to this equation">#</a></span>\[
\varepsilon_i=\frac{P_i}{P_{\text{US}}}
\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(P_i\)</span>：<span class="math notranslate nohighlight">\(i\)</span>国の自国通貨価格で表した一般物価水準（バスケット財の価格）</p></li>
<li><p><span class="math notranslate nohighlight">\(P_{\text{US}}\)</span>：米国の自国通貨価格（米ドル）で表した一般物価水準（バスケット財の価格）</p></li>
<li><p><span class="math notranslate nohighlight">\(\varepsilon_i\)</span>：<span class="math notranslate nohighlight">\(i\)</span>国のPPPレート（<span class="math notranslate nohighlight">\(i\)</span>国通貨/米ドル）</p></li>
</ul>
<p>式<a class="reference internal" href="#equation-eq-19-20">(67)</a>について４つ説明を加える。</p>
<ol class="arabic">
<li><p>右辺の単位は<span class="math notranslate nohighlight">\(i\)</span>国の通貨/ドルとなり，<span class="math notranslate nohighlight">\(e_i^{\text{BM}}\)</span>と同じ単位である。実際，<span class="math notranslate nohighlight">\(\varepsilon_i\)</span>は為替レートの一種であり，市場為替レートと異なるため特別な呼称「購買力平価レート」が付いている。</p></li>
<li><p>上の式は<span class="math notranslate nohighlight">\(P_i/\varepsilon_i=P_{\text{US}}\)</span>と書くことができる。この式の右辺は米国のバスケット財の価格，即ち，一般物価水準であり，左辺は<span class="math notranslate nohighlight">\(i\)</span>国のバスケット財，即ち，一般物価水準を米ドルに換算した価格である。等号は，それらが等しいことを意味しており，その意味では，バスケット財の一物一価が成立する場合の為替レートということになる。まとめると，PPPレートは次のように解釈することができる。</p>
<blockquote>
<div><p>購買力平価レート<span class="math notranslate nohighlight">\(\varepsilon_i\)</span>は，バスケット財の一物一価が成立する（一般物価水準が同じになる）ために必要な為替レート（注意：バスケット財に含まれる個々の財・サービスの価格が全て等しいとは限らない。）</p>
</div></blockquote>
</li>
<li><p>次の変数を考えよう。</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(Q_i\)</span>と<span class="math notranslate nohighlight">\(Q_{\text{US}}\)</span>：<span class="math notranslate nohighlight">\(i\)</span>国と米国でのバスケット財の数量</p></li>
<li><p><span class="math notranslate nohighlight">\(P_i\)</span>と<span class="math notranslate nohighlight">\(P_{\text{US}}\)</span>：<span class="math notranslate nohighlight">\(i\)</span>国と米国でのバスケット財の価格</p></li>
<li><p><span class="math notranslate nohighlight">\(M_i\)</span>：<span class="math notranslate nohighlight">\(i\)</span>国の自国通貨の数量</p></li>
<li><p><span class="math notranslate nohighlight">\(M_{\text{US}}\)</span>：米ドルの数量</p></li>
</ul>
<p>それぞれの通貨はバスケット財の支出に使われる場合を考えると次の関係になる。</p>
<div class="math notranslate nohighlight" id="equation-eq-19-ppp0">
<span class="eqno">(68)<a class="headerlink" href="#equation-eq-19-ppp0" title="Link to this equation">#</a></span>\[
    M_i=P_iQ_i,\qquad M_{\text{US}}=P_{\text{US}}Q_{\text{US}}
    \]</div>
<p>またバスケット財で測ったそれぞれの通貨の購買力は次式で表される。</p>
<div class="math notranslate nohighlight" id="equation-eq-19-ppp1">
<span class="eqno">(69)<a class="headerlink" href="#equation-eq-19-ppp1" title="Link to this equation">#</a></span>\[
    \frac{M_i}{P_i}=Q_i,\qquad \frac{M_{\text{US}}}{P_{\text{US}}}=Q_{\text{US}}
    \]</div>
<p>それぞれの通貨の購買力が等しくなる場合，<span class="math notranslate nohighlight">\(Q_i=Q_{\text{US}}\)</span>が成立する。即ち，</p>
<div class="math notranslate nohighlight" id="equation-eq-19-ppp2">
<span class="eqno">(70)<a class="headerlink" href="#equation-eq-19-ppp2" title="Link to this equation">#</a></span>\[
    \frac{M_i}{P_i}=\frac{M_{\text{US}}}{P_{\text{US}}}
    \qquad\Rightarrow\qquad
    \frac{M_i}{M_{\text{US}}}=\frac{P_i}{P_{\text{US}}}
    \]</div>
<p>となる。右の式の左辺は，１米ドルと<span class="math notranslate nohighlight">\(i\)</span>国通貨の交換レート（単位は<span class="math notranslate nohighlight">\(i\)</span>国通貨/１米ドル）を表している。それを<span class="math notranslate nohighlight">\(\varepsilon_i\)</span>と置き換えるとPPPレート</p>
<div class="math notranslate nohighlight" id="equation-eq-19-ppp3">
<span class="eqno">(71)<a class="headerlink" href="#equation-eq-19-ppp3" title="Link to this equation">#</a></span>\[
    \varepsilon_i=\frac{P_i}{P_{\text{US}}}
    \]</div>
<p>となる。このことから次のように解釈できる。</p>
<blockquote>
<div><p>購買力平価レート<span class="math notranslate nohighlight">\(\varepsilon_i\)</span>は２つの通貨の購買力を等しくする交換レート</p>
</div></blockquote>
</li>
<li><p>実質為替レートは次式で与えられる。</p>
<div class="math notranslate nohighlight" id="equation-eq-19-rexr">
<span class="eqno">(72)<a class="headerlink" href="#equation-eq-19-rexr" title="Link to this equation">#</a></span>\[
    \eta_i=\frac{e_iP_{\text{US}}}{P_i}=\frac{e_i}{\varepsilon_i}
    \]</div>
<p>ここで<span class="math notranslate nohighlight">\(\varepsilon_i\)</span>は式<a class="reference internal" href="#equation-eq-19-20">(67)</a>で与えられるPPPレートであり，<span class="math notranslate nohighlight">\(e_i\)</span>は市場為替レートである。更に，</p>
<div class="math notranslate nohighlight" id="equation-eq-19-rexra">
<span class="eqno">(73)<a class="headerlink" href="#equation-eq-19-rexra" title="Link to this equation">#</a></span>\[
    \eta_i=1
    \quad\Leftrightarrow\quad
    e_i=\varepsilon_i
    \]</div>
<p>が成立することになる。即ち，実質為替レートが<code class="docutils literal notranslate"><span class="pre">1</span></code>の場合に<span class="math notranslate nohighlight">\(e_i=\varepsilon_i\)</span>となり，「購買力平価が成立した」という。</p>
</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>PPPレートは次のようにも解釈できる。式<a class="reference internal" href="#equation-eq-19-rexr">(72)</a>と<a class="reference internal" href="#equation-eq-19-rexr">(72)</a>から，PPPの下では次式が成立する。</p>
<div class="math notranslate nohighlight" id="equation-eq-19-21">
<span class="eqno">(74)<a class="headerlink" href="#equation-eq-19-21" title="Link to this equation">#</a></span>\[
1=\frac{P_i/\varepsilon_i}{P_{\text{US}}}
\]</div>
<p>分子の<span class="math notranslate nohighlight">\(P_i\)</span>の単位は「<span class="math notranslate nohighlight">\(i\)</span>国の通貨」であり，<span class="math notranslate nohighlight">\(\varepsilon_i\)</span>の単位は「<span class="math notranslate nohighlight">\(i\)</span>国の通貨/ドル」となるため，分子の単位はドルとなることが分かる（<span class="math notranslate nohighlight">\(i\)</span>国の通貨単位がキャンセルされる）。分母の単位はもちろん米ドルである。更に，次のように書き換えよう。</p>
<div class="math notranslate nohighlight" id="equation-eq-19-22">
<span class="eqno">(75)<a class="headerlink" href="#equation-eq-19-22" title="Link to this equation">#</a></span>\[
1=\frac{1万ドル/P_{\text{US}}}{1万ドル/(P_i/\varepsilon_i)}
\]</div>
<p>分子は1万ドルで米国のバスケット財をいくつ購入できるかを表しており，それが米ドルの購買力である。同様に，分母は1万ドルで購入できる<span class="math notranslate nohighlight">\(i\)</span>国のバスケット財の数量を表し，<span class="math notranslate nohighlight">\(i\)</span>国のバスケット財で測った米ドルの購買力となる。即ち，右辺は1万ドルの米国での購買力と<span class="math notranslate nohighlight">\(i\)</span>国での購買力の割合となる。右辺が<code class="docutils literal notranslate"><span class="pre">1</span></code>と等しいということは，1万ドルの米国での購買力と<span class="math notranslate nohighlight">\(i\)</span>国での購買力は同じだということを意味する。</p>
</div>
<p>以上の説明から，一物一価の法則と購買力平価が密接に関係していることは直感的に理解できるだろう。以下では，バスケット財の価格は経済間で大きく異なり，購買力平価は成立していないことを示す。更には，その原因と含意についても考察することにする。</p>
</section>
<section id="id14">
<h3>PPPレートと市場為替レートのデータ<a class="headerlink" href="#id14" title="Link to this heading">#</a></h3>
<section id="id15">
<h4>使用するデータ<a class="headerlink" href="#id15" title="Link to this heading">#</a></h4>
<p>経済間のバスケット財の価格の違いを確認するために，<code class="docutils literal notranslate"><span class="pre">py4macro</span></code>モジュールに含まれるPenn World Tableのデータセットを使う。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pwt</span> <span class="o">=</span> <span class="n">py4macro</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;pwt&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>変数の定義を確認しておこう。</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">py4macro</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;pwt&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable definition</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Identifier variables</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>countrycode</th>
      <td>3-letter ISO country code</td>
    </tr>
    <tr>
      <th>country</th>
      <td>Country name</td>
    </tr>
    <tr>
      <th>currency_unit</th>
      <td>Currency unit</td>
    </tr>
    <tr>
      <th>year</th>
      <td>Year</td>
    </tr>
    <tr>
      <th>Real GDP, employment and population levels</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>rgdpe</th>
      <td>Expenditure-side real GDP at chained PPPs (in mil. 2017US$)</td>
    </tr>
    <tr>
      <th>rgdpo</th>
      <td>Output-side real GDP at chained PPPs (in mil. 2017US$)</td>
    </tr>
    <tr>
      <th>pop</th>
      <td>Population (in millions)</td>
    </tr>
    <tr>
      <th>emp</th>
      <td>Number of persons engaged (in millions)</td>
    </tr>
    <tr>
      <th>avh</th>
      <td>Average annual hours worked by persons engaged</td>
    </tr>
    <tr>
      <th>hc</th>
      <td>Human capital index, based on years of schooling and returns to education; see Human capital in PWT9.</td>
    </tr>
    <tr>
      <th>Current price GDP, capital and TFP</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>ccon</th>
      <td>Real consumption of households and government, at current PPPs (in mil. 2017US$)</td>
    </tr>
    <tr>
      <th>cda</th>
      <td>Real domestic absorption, (real consumption plus investment), at current PPPs (in mil. 2017US$)</td>
    </tr>
    <tr>
      <th>cgdpe</th>
      <td>Expenditure-side real GDP at current PPPs (in mil. 2017US$)</td>
    </tr>
    <tr>
      <th>cgdpo</th>
      <td>Output-side real GDP at current PPPs (in mil. 2017US$)</td>
    </tr>
    <tr>
      <th>cn</th>
      <td>Capital stock at current PPPs (in mil. 2017US$)</td>
    </tr>
    <tr>
      <th>ck</th>
      <td>Capital services levels at current PPPs (USA=1)</td>
    </tr>
    <tr>
      <th>ctfp</th>
      <td>TFP level at current PPPs (USA=1)</td>
    </tr>
    <tr>
      <th>cwtfp</th>
      <td>Welfare-relevant TFP levels at current PPPs (USA=1)</td>
    </tr>
    <tr>
      <th>National accounts-based variables</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>rgdpna</th>
      <td>Real GDP at constant 2017 national prices (in mil. 2017US$)</td>
    </tr>
    <tr>
      <th>rconna</th>
      <td>Real consumption at constant 2017 national prices (in mil. 2017US$)</td>
    </tr>
    <tr>
      <th>rdana</th>
      <td>Real domestic absorption at constant 2017 national prices (in mil. 2017US$)</td>
    </tr>
    <tr>
      <th>rnna</th>
      <td>Capital stock at constant 2017 national prices (in mil. 2017US$)</td>
    </tr>
    <tr>
      <th>rkna</th>
      <td>Capital services at constant 2017 national prices (2017=1)</td>
    </tr>
    <tr>
      <th>rtfpna</th>
      <td>TFP at constant national prices (2017=1)</td>
    </tr>
    <tr>
      <th>rwtfpna</th>
      <td>Welfare-relevant TFP at constant national prices (2017=1)</td>
    </tr>
    <tr>
      <th>labsh</th>
      <td>Share of labour compensation in GDP at current national prices</td>
    </tr>
    <tr>
      <th>irr</th>
      <td>Real internal rate of return</td>
    </tr>
    <tr>
      <th>delta</th>
      <td>Average depreciation rate of the capital stock</td>
    </tr>
    <tr>
      <th>Exchange rates and GDP price levels</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>xr</th>
      <td>Exchange rate, national currency/USD (market+estimated)</td>
    </tr>
    <tr>
      <th>pl_con</th>
      <td>Price level of CCON (PPP/XR), price level of USA GDPo in 2017=1</td>
    </tr>
    <tr>
      <th>pl_da</th>
      <td>Price level of CDA (PPP/XR), price level of USA GDPo in 2017=1</td>
    </tr>
    <tr>
      <th>pl_gdpo</th>
      <td>Price level of CGDPo (PPP/XR), price level of USA GDPo in 2017=1</td>
    </tr>
    <tr>
      <th>Data information variables</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>i_cig</th>
      <td>0/1/2/3/4: relative price data for consumption, investment and government is extrapolated (0), benchmark (1), interpolated (2), ICP PPP timeseries: benchmark or interpolated (3) or  ICP PPP timeseries: extrapolated (4)</td>
    </tr>
    <tr>
      <th>i_xm</th>
      <td>0/1/2: relative price data for exports and imports is extrapolated (0), benchmark (1) or interpolated (2)</td>
    </tr>
    <tr>
      <th>i_xr</th>
      <td>0/1: the exchange rate is market-based (0) or estimated (1)</td>
    </tr>
    <tr>
      <th>i_outlier</th>
      <td>0/1: the observation on pl_gdpe or pl_gdpo is not an outlier (0) or an outlier (1)</td>
    </tr>
    <tr>
      <th>i_irr</th>
      <td>0/1/2/3: the observation for irr is not an outlier (0), may be biased due to a low capital share (1), hit the lower bound of 1 percent (2), or is an outlier (3)</td>
    </tr>
    <tr>
      <th>cor_exp</th>
      <td>Correlation between expenditure shares of the country and the US (benchmark observations only)</td>
    </tr>
    <tr>
      <th>statcap</th>
      <td>Statistical capacity indicator (source: World Bank, developing countries only)</td>
    </tr>
    <tr>
      <th>Shares in CGDPo</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>csh_c</th>
      <td>Share of household consumption at current PPPs</td>
    </tr>
    <tr>
      <th>csh_i</th>
      <td>Share of gross capital formation at current PPPs</td>
    </tr>
    <tr>
      <th>csh_g</th>
      <td>Share of government consumption at current PPPs</td>
    </tr>
    <tr>
      <th>csh_x</th>
      <td>Share of merchandise exports at current PPPs</td>
    </tr>
    <tr>
      <th>csh_m</th>
      <td>Share of merchandise imports at current PPPs</td>
    </tr>
    <tr>
      <th>csh_r</th>
      <td>Share of residual trade and GDP statistical discrepancy at current PPPs</td>
    </tr>
    <tr>
      <th>Price levels, expenditure categories and capital</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>pl_c</th>
      <td>Price level of household consumption,  price level of USA GDPo in 2017=1</td>
    </tr>
    <tr>
      <th>pl_i</th>
      <td>Price level of capital formation,  price level of USA GDPo in 2017=1</td>
    </tr>
    <tr>
      <th>pl_g</th>
      <td>Price level of government consumption,  price level of USA GDPo in 2017=1</td>
    </tr>
    <tr>
      <th>pl_x</th>
      <td>Price level of exports, price level of USA GDPo in 2017=1</td>
    </tr>
    <tr>
      <th>pl_m</th>
      <td>Price level of imports, price level of USA GDPo in 2017=1</td>
    </tr>
    <tr>
      <th>pl_n</th>
      <td>Price level of the capital stock, price level of USA in 2017=1</td>
    </tr>
    <tr>
      <th>pl_k</th>
      <td>Price level of the capital services, price level of USA=1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>以下の分析では次の変数を使う。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">xr</span></code>：市場為替レート（名目，<span class="math notranslate nohighlight">\(i\)</span>国通貨/米ドル）</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pl_gdpo</span></code>：<code class="docutils literal notranslate"><span class="pre">cgdpo</span></code>の計算に使った相対物価水準（米ドル，2017年の米国の値=<code class="docutils literal notranslate"><span class="pre">1</span></code>）</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cgdpo</span></code>：産出データに基づいGDP（2017年百万米ドル）</p>
<ul>
<li><p>時系列的には名目（ある年での経済間の生産能力（水準）の比較に適している）</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pl_gdpo</span></code>を使って計算している</p></li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">cgdpo</span></code>は産出データに基づいたGDPだが，その代わりに支出データに基づいた<code class="docutils literal notranslate"><span class="pre">cgdpe</span></code>を使うこともできる。その場合，相対物価水準の変数には<code class="docutils literal notranslate"><span class="pre">pl_da</span></code>を使う必要がある。試してみよう！</p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">pwt</span></code>の中にはPPPレートのデータは含まれていないが，<code class="docutils literal notranslate"><span class="pre">xr</span></code>と<code class="docutils literal notranslate"><span class="pre">pl_gdpo</span></code>を使い次のように計算することができる。<code class="docutils literal notranslate"><span class="pre">pl_gdpo</span></code>は次式に従い計算されている。</p>
<div class="math notranslate nohighlight" id="equation-eq-19-30">
<span class="eqno">(76)<a class="headerlink" href="#equation-eq-19-30" title="Link to this equation">#</a></span>\[
\text{(列 pl_gdpo)}=\frac{\epsilon_i}{e_i}
=\frac{P_i}{P_{\text{US}}e_i}
\]</div>
<p>ここで<span class="math notranslate nohighlight">\(\epsilon_i\)</span>は式<a class="reference internal" href="#equation-eq-19-20">(67)</a>で与えられるPPPレートであり，<span class="math notranslate nohighlight">\(e_i\)</span>は市場為替レートとなる。従って，<span class="math notranslate nohighlight">\(e_i\)</span>に列<code class="docutils literal notranslate"><span class="pre">xr</span></code>を使い次式でPPPレートを計算することができる。</p>
<div class="math notranslate nohighlight" id="equation-eq-19-31">
<span class="eqno">(77)<a class="headerlink" href="#equation-eq-19-31" title="Link to this equation">#</a></span>\[
\epsilon_i=\text{(列 pl_gdpo)}\times\text{(列 xr)}
\]</div>
<p>この式に従って，新たな列<code class="docutils literal notranslate"><span class="pre">ppp</span></code>を<code class="docutils literal notranslate"><span class="pre">pwt</span></code>に追加しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pwt</span><span class="p">[</span><span class="s1">&#39;ppp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pwt</span><span class="p">[</span><span class="s1">&#39;pl_gdpo&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">pwt</span><span class="p">[</span><span class="s1">&#39;xr&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id16">
<h4>例：日本<a class="headerlink" href="#id16" title="Link to this heading">#</a></h4>
<p>まず，PPPレートと市場為替レートがどれほど違うかを日本の時系列データで確認するために，日本のデータのみを抽出する。日本のPPPと市場為替レートをプロットしてみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cond</span> <span class="o">=</span> <span class="p">(</span> <span class="n">pwt</span><span class="p">[</span><span class="s1">&#39;countrycode&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;JPN&#39;</span> <span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">pwt</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,:]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ppp&#39;</span><span class="p">,</span><span class="s1">&#39;xr&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;PPP&#39;</span><span class="p">,</span><span class="s1">&#39;市場為替レート&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;円/米ドル</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span>
              <span class="sa">r</span><span class="s1">&#39;強い（増価）$\longleftarrow\quad\longrightarrow$弱い（減価）&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f8bffd6fd2e927a770b2e57db225f90db49aca35e43b6fa7d7be7408ebe834e5.png" src="_images/f8bffd6fd2e927a770b2e57db225f90db49aca35e43b6fa7d7be7408ebe834e5.png" />
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>上のプロットの縦軸は円/米ドルであり，値が低く（高く）なると円は強く（弱く）なる。増価，減価とも表現される。分かりにくいようであれば，次のように考えてみてはどうだろう。</p>
<ul class="simple">
<li><p>為替レートが100円/ドルということは，100円で１ドルを買うことができる。</p></li>
<li><p>為替レートが80円/ドルの場合は，80円で１ドルを買うことができる。即ち，より安くドルを買うことができるので，円の購買力は高くなる。そういう意味で，円は強くなった（増価した）と言える。</p></li>
<li><p>為替レートが120円/ドルの場合は，120円で１ドルを買うことになる。即ち，より高い価格でドルを買うことになるので，円の購買力は低下している。そういう意味で，円は弱くなった（減価した）と言える。</p></li>
</ul>
</div>
<p>このプロットから次のことが言える。市場為替レートは1973年2月14日に変動相場制へ移行するまで360円/１米ドルで固定されていた。1980年代半ば頃までは，PPPレートと比べて市場為替レートは高い値となっている。従って，PPPレートを基準とすると円はドルに対して弱すぎる，即ち，過小評価されていたことが分かる。長期的にはPPPレートと為替レートは収斂したことが確認できる。しかし，1980年代半ば以降，市場為替レートはPPPレートの周りを上下していおり，ある程度の乖離は解消されていない。</p>
<p>このように，PPPレートと市場為替レートは乖離することが常であり，異なる要因によって決定されるためである。PPPは式<a class="reference internal" href="#equation-eq-19-20">(67)</a>が示すように財・サービスの価格の比率であり，一般物価水準そしてその変化率（インフレ率）も持続性が高い（粘着生）ためPPPの動きは緩やかである。一方，市場為替レートは貨幣単位の比率であり，国際収支の状況にも大きく依存する。国際収支には（１）経常収支（財・サービスの収支など），（２）資本移転等収支（例えば，特許権などの知的財産権），（３）金融収支（直接投資，証券投資，金融派生商品など金融資産に伴う取引）があるが，特に（２）と（３）は一般物価水準との関係は少なくとも短期的には弱い。従って，市場為替レートは経済情報や政治状況，更には，中央銀行総裁や政治家の発言で影響を受け大きく瞬時に変動することがある。しかし，上の日本のレートのプロットが示すように，長期的には乖離が持続的に拡大するような発散は起きていない。1980年代半ばまでの時系列データが示すように，お互いに時間をかけて収束する経済メカニズムが裏で働いていると考えられる。</p>
<p>上のプロットではPPPレートと市場為替レートを別々にプロットしたが，一つの指標としてまとめる方が分かりやすい場合もある。式<a class="reference internal" href="#equation-eq-19-rexr">(72)</a>を使い日本の実質為替レート<span class="math notranslate nohighlight">\(\eta_{\text{JP}}\)</span>を考えてみよ。</p>
<div class="math notranslate nohighlight" id="equation-eq-19-23">
<span class="eqno">(78)<a class="headerlink" href="#equation-eq-19-23" title="Link to this equation">#</a></span>\[
\eta_{\text{JP}}
=\frac{e_{\text{JP}}P_{\text{US}}}{P_{\text{JP}}}
=\frac{e_{\text{JP}}}{\varepsilon_{\text{JP}}}
\]</div>
<p>ここで<span class="math notranslate nohighlight">\(e_{\text{JP}}\)</span>は市場為替レート（円/米ドル）であり，<span class="math notranslate nohighlight">\(\varepsilon_{\text{JP}}\)</span>はPPPレートである。この式から次のことが分かる。</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\eta_{\text{JP}}=1\quad\Rightarrow\quad e_{\text{JP}}=\varepsilon_{\text{JP}}\)</span></p>
<ul>
<li><p>購買力平価の成立</p></li>
<li><p>日本のバスケット財１単位で米国のバスケット財１単位を購入できる（等価で交換できる）。</p></li>
</ul>
</li>
<li><p><span class="math notranslate nohighlight">\(\eta_{\text{JP}}&lt;1\quad\Rightarrow\quad e_{\text{JP}}&lt;\varepsilon_{\text{JP}}\)</span></p>
<ul>
<li><p>PPPレートと比較しては強すぎる（過大評価）</p></li>
<li><p>例えば，<span class="math notranslate nohighlight">\(\eta_{\text{JP}}=1/2\)</span>の場合，日本のバスケット財１単位で米国のバスケット財２単位も購入できる（交換できる）。そういう意味で，円の購買力は高過ぎる（強過ぎる）。</p></li>
</ul>
</li>
<li><p><span class="math notranslate nohighlight">\(\eta_{\text{JP}}&gt;1\quad\Rightarrow\quad e_{\text{JP}}&gt;\varepsilon_{\text{JP}}\)</span></p>
<ul>
<li><p>PPPレートと比較して円は弱すぎる（過小評価）</p></li>
<li><p>例えば，<span class="math notranslate nohighlight">\(\eta_{\text{JP}}=2\)</span>の場合，日本のバスケット財１単位で米国のバスケット財１/２単位しか購入できない（交換できない）。そういう意味で，円の購買力は低過ぎる（弱過ぎる）</p></li>
</ul>
</li>
</ul>
<p>式<a class="reference internal" href="#equation-eq-19-30">(76)</a>と<a class="reference internal" href="#equation-eq-19-23">(78)</a>を比べると，<span class="math notranslate nohighlight">\(\eta_{\text{JP}}\)</span>は<code class="docutils literal notranslate"><span class="pre">pl_gdpo</span></code>の逆数となることがわかる。実質為替レートを新たな列<code class="docutils literal notranslate"><span class="pre">real_xr</span></code>として<code class="docutils literal notranslate"><span class="pre">pwt</span></code>に追加しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pwt</span><span class="p">[</span><span class="s1">&#39;real_xr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">pwt</span><span class="p">[</span><span class="s1">&#39;pl_gdpo&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>1980年以降のデータをプロットしよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cond_jp</span> <span class="o">=</span> <span class="p">(</span> <span class="n">pwt</span><span class="p">[</span><span class="s1">&#39;countrycode&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;JPN&#39;</span> <span class="p">)</span>
<span class="n">cond_yr</span> <span class="o">=</span> <span class="p">(</span> <span class="n">pwt</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">&gt;=</span><span class="mi">1980</span> <span class="p">)</span>
<span class="n">cond</span> <span class="o">=</span> <span class="n">cond_jp</span> <span class="o">&amp;</span> <span class="n">cond_yr</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">pwt</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,:]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;real_xr&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;実質為替レート（円/米ドル）&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/42799ef690086595ccf8122b705c2348d39c19b37ea3f64b319fe412e8f35b31.png" src="_images/42799ef690086595ccf8122b705c2348d39c19b37ea3f64b319fe412e8f35b31.png" />
</div>
</div>
<p>この図は，上の図の情報を実質為替レート（円/ドル）としてまとめている。実質為替レートでも，縦軸での円安・円高の方向は同じとなることに注意しよう。1980年代半ばまで円高に動いていること（増価）が分かる。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference external" href="https://www.iima.or.jp/research/ppp.html">国際通貨研究所では円（対米ドル）の購買力平価</a>を公表しているが，<code class="docutils literal notranslate"><span class="pre">pwt</span></code>のデータとは大きく異なる。理由は，それぞれの目的とアプローチが違うためである。Penn World Tableで使うPPPは，共通の財・サービスの分類に基づいた<a class="reference external" href="https://www.worldbank.org/en/programs/icp">国際比較プログラム</a>（International Comparison Programme：省略ICP）により計算された情報を使っており，参加国（2017年には176カ国）のGDPや支出項目が比較可能になるPPPの算出を目的としている。従って，大掛かりな作業が必要であり，毎年ではなく数年に一度公表される（1970年, 1973年, 1975年, 1980年, 1985, 1993年, 2005年, 2011年, 2017年）。Penn World Tableのデータでは，それ以外の年は内挿（interpolate）もしくは外挿（extrapolate）することによりPPPを計算している。一方，国際通貨研究所で公表しているPPPは，1973年を基準としてシンプルに日米の消費者物価指数などを使って算出されており，指数の計算に使われる財・サービスは厳密に共通化されている訳ではない。後者は円ドル市場為替相場の予測や日本経済の国際競争力を知る上では有用な情報となるだろう。</p>
</div>
</section>
</section>
<section id="id17">
<h3>相対一般物価水準の分布<a class="headerlink" href="#id17" title="Link to this heading">#</a></h3>
<p>Big Macは世界中で消費され，世界中のBig Macは概ね同質と考えることができる。そのような財でさえ一物一価が成立していないことを考えると，バスケット財の一物一価の成立を疑いたくなる。実際，以下で示すように，データは一般物価の等価は成立しない。では，</p>
<blockquote>
<div><p>バスケット財の価格（一般物価水準）はどのような分布になっているのだろうか。</p>
</div></blockquote>
<p>この問を考察するために，米国を基準とする米ドル表示の相対一般物価水準考えることにする。相対価格で考える利点は，その分布をPPPレートと市場為替レートを使うことにより簡単に計算できることである。</p>
<p>式<a class="reference internal" href="#equation-eq-19-30">(76)</a>から列<code class="docutils literal notranslate"><span class="pre">pl_gdpo</span></code>の定義は次のようになっている。</p>
<div class="math notranslate nohighlight" id="equation-eq-19-plgdpo">
<span class="eqno">(79)<a class="headerlink" href="#equation-eq-19-plgdpo" title="Link to this equation">#</a></span>\[\begin{split}
\begin{align*}
\text{列 pl_gdpo}
&amp;=
\frac{P_i/e_i}{P_{\text{US}}}=
\frac{i\text{国のバスケット財のドル価格}}{\text{米国のバスケット財のドル価格（2017年）}}\\
&amp;=\text{米国（2017年）を基準とした}i\text{国のバスケット財の相対価格（一般物価水準の比率）}
\end{align*}
\end{split}\]</div>
<p>相対一般物価水準の分布を調べるためには<code class="docutils literal notranslate"><span class="pre">pl_gdpo</span></code>を使えば良いということだ。まず2019年のデータを抽出して<code class="docutils literal notranslate"><span class="pre">pwt19</span></code>に割り当てよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cond</span> <span class="o">=</span> <span class="p">(</span> <span class="n">pwt</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2019</span> <span class="p">)</span>
<span class="n">pwt19</span> <span class="o">=</span> <span class="n">pwt</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">pl_gdpo</span></code>が欠損値ではない国の数を確認しておこう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;pl_gdpo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>183
</pre></div>
</div>
</div>
</div>
<p>このデータを使い相対価格のヒストグラムをプロットするが，視覚的に確認し易いように対数化した列を作成し図示する。（試しに，対数を使う目的を理解するために<code class="docutils literal notranslate"><span class="pre">pl_gdpo</span></code>のヒストグラムと比べてみてはどうだろう。）</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;pl_gdpo_log&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span> <span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;pl_gdpo&#39;</span><span class="p">]</span> <span class="p">)</span>

<span class="n">pwt19</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;pl_gdpo_log&#39;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2f3b3e177491d5804e1394c79473e92800e12b2964608f8c5f331f5f65c6eb3c.png" src="_images/2f3b3e177491d5804e1394c79473e92800e12b2964608f8c5f331f5f65c6eb3c.png" />
</div>
</div>
<p>次のような解釈となる。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">0</span></code>と等しい場合：米国の2017年の物価水準と同じ</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">0</span></code>を上回る場合：米国の2017年の物価水準を上回る</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">0</span></code>を下回る場合：米国の2017年の物価水準を下回る</p></li>
</ul>
<p>その内訳を確認してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cond</span> <span class="o">=</span> <span class="p">(</span> <span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;pl_gdpo_log&#39;</span><span class="p">]</span><span class="o">&gt;=</span><span class="mi">0</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;相対一般物価水準が１以上の国の数：</span><span class="si">{</span><span class="n">pwt19</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,:]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">&gt;3</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;相対一般物価水準が１未満の国の数：</span><span class="si">{</span><span class="n">pwt19</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">cond</span><span class="p">,:]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">&gt;3</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>相対一般物価水準が１以上の国の数： 22
相対一般物価水準が１未満の国の数：161
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<p>最後の行に<code class="docutils literal notranslate"><span class="pre">~cond</span></code>となっているが，<code class="docutils literal notranslate"><span class="pre">~</span></code>はビット演算子の一つである。<code class="docutils literal notranslate"><span class="pre">cond</span></code>は<code class="docutils literal notranslate"><span class="pre">True</span></code>もしくは<code class="docutils literal notranslate"><span class="pre">False</span></code>が要素となる<code class="docutils literal notranslate"><span class="pre">Series</span></code>であるが，<code class="docutils literal notranslate"><span class="pre">~</span></code>を<code class="docutils literal notranslate"><span class="pre">cond</span></code>の前に付けると全ての真偽値を反転（<code class="docutils literal notranslate"><span class="pre">True</span></code>は<code class="docutils literal notranslate"><span class="pre">False</span></code>に，<code class="docutils literal notranslate"><span class="pre">False</span></code>は<code class="docutils literal notranslate"><span class="pre">True</span></code>に）させる。ビット演算子には他に<code class="docutils literal notranslate"><span class="pre">&amp;</span></code>，<code class="docutils literal notranslate"><span class="pre">|</span></code>，<code class="docutils literal notranslate"><span class="pre">^</span></code>，などがある。</p>
</div>
<p>一般物価水準の相対価格の分布には大きな偏りが確認できる。<code class="docutils literal notranslate"><span class="pre">pl_gdpo</span></code>（対数ではない）の記述統計を表示してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;pl_gdpo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    183.000000
mean       0.691109
std        1.385720
min        0.139218
25%        0.395466
50%        0.490066
75%        0.741123
max       18.842592
Name: pl_gdpo, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>価格水準が最も低い国は米国（2017年）の物価水準の約<span class="pasted-text">13.9</span>％しかなく，最も高い国は米国（2017年）の約<span class="pasted-text">18.8</span>倍も高い。上位5カ国を表示してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pwt19</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;pl_gdpo&#39;</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)[[</span><span class="s1">&#39;country&#39;</span><span class="p">,</span><span class="s1">&#39;pl_gdpo&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>pl_gdpo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>12389</th>
      <td>Venezuela (Bolivarian Republic of)</td>
      <td>18.842592</td>
    </tr>
    <tr>
      <th>1609</th>
      <td>Bermuda</td>
      <td>2.309026</td>
    </tr>
    <tr>
      <th>11199</th>
      <td>Turks and Caicos Islands</td>
      <td>1.894385</td>
    </tr>
    <tr>
      <th>209</th>
      <td>Anguilla</td>
      <td>1.572530</td>
    </tr>
    <tr>
      <th>3079</th>
      <td>Cayman Islands</td>
      <td>1.491452</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>ベネズエラの<code class="docutils literal notranslate"><span class="pre">pl_gdpo</span></code>の値は突出している。<a class="reference external" href="https://en.wikipedia.org/wiki/Hyperinflation_in_Venezuela">ベネズエラの2018年のインフレは1,700,000％（年率）のハイパーインフレ</a>が発生しており，その影響かもしれないが，他の経済の傾向と大きく異なる「外れ値」の可能性を払拭できない。以下ではベネズエラを除外して分析を進めることにする。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cond</span> <span class="o">=</span> <span class="o">~</span><span class="p">(</span> <span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;countrycode&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;VEN&#39;</span> <span class="p">)</span>
<span class="n">pwt19</span> <span class="o">=</span> <span class="n">pwt19</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>ベネズエラを除いたデータで<code class="docutils literal notranslate"><span class="pre">pl_gdpo</span></code>の変動係数を計算してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span>
    <span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;pl_gdpo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="o">/</span> <span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;pl_gdpo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.536110862365616
</pre></div>
</div>
</div>
</div>
<p>この値をBig Macの値と比べてみよう。Big Macの変動係数は<span class="pasted-text">0.262</span>であり，<code class="docutils literal notranslate"><span class="pre">0.3</span></code>にも満たない。バスケット財に含まれる財・サービスはBig Mac程規格が統一されていないことを考えると一般物価水準の変動係数が大きいことは理解できるのではないだろうか。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>上で計算したBig Mac価格の変動係数は，相対価格ではなくBig Mac価格（円表示）の変動係数である。米国のBig Mac価格に対する相対価格の変動係数を次のコードで計算することができるが，同じ値を返すことになる。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bigmac</span><span class="p">[</span><span class="s1">&#39;price_dollar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bigmac</span><span class="p">[</span><span class="s1">&#39;price_local&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">bigmac</span><span class="p">[</span><span class="s1">&#39;exr&#39;</span><span class="p">]</span>
<span class="n">cond</span> <span class="o">=</span> <span class="p">(</span> <span class="n">bigmac</span><span class="p">[</span><span class="s1">&#39;iso&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;USA&#39;</span> <span class="p">)</span>
<span class="n">bigmac</span><span class="p">[</span><span class="s1">&#39;relative_price_dollar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bigmac</span><span class="p">[</span><span class="s1">&#39;price_dollar&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">bigmac</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,</span><span class="s1">&#39;price_dollar&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">bigmac</span><span class="p">[</span><span class="s1">&#39;relative_price_dollar&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="o">/</span><span class="n">bigmac</span><span class="p">[</span><span class="s1">&#39;relative_price_dollar&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="id18">
<h2>物価水準に対する所得の影響<a class="headerlink" href="#id18" title="Link to this heading">#</a></h2>
<section id="id19">
<h3>所得の影響<a class="headerlink" href="#id19" title="Link to this heading">#</a></h3>
<p>相対物価水準のヒストグラムをプロットしたが，どのような国がどのような順番並んでいるか表示してみよう。表示するリストを見やすくするために，183カ国全てを表示せずに，行<code class="docutils literal notranslate"><span class="pre">avh</span></code>（人的資本ストック）に欠損値がない国だけを表示しよう。このルールに特別な意味はないが，国の数を減らすには丁度良いだろう。</p>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">#1</span></code>：<code class="docutils literal notranslate"><span class="pre">.dropna(subset=['avh</span></code>])<code class="docutils literal notranslate"><span class="pre">を使い列</span></code>avh<code class="docutils literal notranslate"><span class="pre">に欠損値がある行のみを削除し，</span></code>.sort_values(‘pl_gdpo_log’)<code class="docutils literal notranslate"><span class="pre">によって</span></code>pl_gdpo_log<code class="docutils literal notranslate"><span class="pre">の昇順に並び替えた</span></code>DataFrame<code class="docutils literal notranslate"><span class="pre">を</span></code>pwt19_dropped`に割り当てている。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#2</span></code>：<code class="docutils literal notranslate"><span class="pre">.stem()</span></code>はステムプロットを表示するメソッドであり，横軸に列<code class="docutils literal notranslate"><span class="pre">country</span></code>，縦軸に<code class="docutils literal notranslate"><span class="pre">pl_gdpo_log</span></code>を指定している。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#3</span></code>：<code class="docutils literal notranslate"><span class="pre">orientation</span></code>はステムプロットの向きを横向きに指定する引数。この引数により，縦軸・横軸が逆になる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#4</span></code>：<code class="docutils literal notranslate"><span class="pre">bottom</span></code>は値の基準を指定する引数。ここでは<code class="docutils literal notranslate"><span class="pre">0</span></code>に赤い線が引かれる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#5</span></code>：<code class="docutils literal notranslate"><span class="pre">data</span></code>は使用するデータを指定する。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#6</span></code>：横軸の値範囲を指定している。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#7</span></code>：<code class="docutils literal notranslate"><span class="pre">.axhline()</span></code>は横線を表示するメソッド。<code class="docutils literal notranslate"><span class="pre">Japan</span></code>は縦軸の<code class="docutils literal notranslate"><span class="pre">Japan</span></code>で横線を引くことを指定し，<code class="docutils literal notranslate"><span class="pre">linestyle=':'</span></code>は点線を
指定している。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#8</span></code>：<code class="docutils literal notranslate"><span class="pre">pwt19_dropped.shape[0]</span></code>で<code class="docutils literal notranslate"><span class="pre">pwt19_dropped</span></code>の行数を抽出し，<code class="docutils literal notranslate"><span class="pre">f-string</span></code>を使い`結果を表示している。</p></li>
</ul>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#1</span>
<span class="n">pwt19_dropped</span> <span class="o">=</span> <span class="n">pwt19</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;avh&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;pl_gdpo_log&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">13</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="s1">&#39;country&#39;</span><span class="p">,</span> <span class="s1">&#39;pl_gdpo_log&#39;</span><span class="p">,</span>      <span class="c1">#2</span>
        <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span>      <span class="c1">#3</span>
        <span class="n">bottom</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>                      <span class="c1">#4</span>
        <span class="n">data</span><span class="o">=</span><span class="n">pwt19_dropped</span><span class="p">)</span>            <span class="c1">#5</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span>                  <span class="c1">#6</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;米国の2017年の物価水準と比較して</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span>
             <span class="sa">r</span><span class="s1">&#39;低い $\longleftarrow\quad$2019年の物価水準$\quad\longrightarrow$ 高い&#39;</span><span class="p">,</span>
             <span class="n">size</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="s1">&#39;Japan&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>     <span class="c1">#7</span>

<span class="c1">#8</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;このプロットには</span><span class="si">{</span><span class="n">pwt19_dropped</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">カ国が含まれる。&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>このプロットには66カ国が含まれる。
</pre></div>
</div>
<img alt="_images/b75837618077df0fd2f3fc95967a66b48ef1b1656774f2476da4fbe7d33e4c9e.png" src="_images/b75837618077df0fd2f3fc95967a66b48ef1b1656774f2476da4fbe7d33e4c9e.png" />
</div>
</div>
<p>リストの上には所得が高い国が列挙されており，所得が低い国はリストの下の方にある。この傾向はBig Macの場合と同じである。</p>
<p>物価水準と所得の関係を散布図を使って確認するために，一人当たりGDPとその対数値を新たな列<code class="docutils literal notranslate"><span class="pre">cgdpo_pc</span></code>と<code class="docutils literal notranslate"><span class="pre">cgdpo_pc_log</span></code>を追加しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;cgdpo_pc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;cgdpo&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;pop&#39;</span><span class="p">]</span>
<span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;cgdpo_pc_log&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span> <span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;cgdpo_pc&#39;</span><span class="p">]</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>また<code class="docutils literal notranslate"><span class="pre">pl_gdpo</span></code>の対数の値を新たな列<code class="docutils literal notranslate"><span class="pre">pl_gdpo_log</span></code>として追加しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;pl_gdpo_log&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span> <span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;pl_gdpo&#39;</span><span class="p">]</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">cgdpo_pc_log</span></code>を横軸にして<code class="docutils literal notranslate"><span class="pre">pl_gdpo_log</span></code>の散布図を表示しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">pwt19</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;cgdpo_pc_log&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;pl_gdpo_log&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;一人当たりGDP（対数，百万米ドル）&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;米国の2017年価格を基準とした</span><span class="se">\n</span><span class="s1">2019年相対価格（対数）&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d01de89100c5a1b55b8f5fae5d5c509eb8fca99733d845c6e1cf549bd9fc3629.png" src="_images/d01de89100c5a1b55b8f5fae5d5c509eb8fca99733d845c6e1cf549bd9fc3629.png" />
</div>
</div>
<p>直線トレンドを想像してみよう。明らかに右上がりであり，所得が高い経済ほど物価水準が高いことが確認できる。これは<strong>バラッサ・サミュエルソン効果</strong>と呼ばれる。直感的には，所得が高い経済の生産性と価格は高く，多くが貿易財である。一方，所得が低い国の非貿易財（例えば，不動産）やサービス（例えば，散髪）は比較的に安い。右上がりの直線トレンドはそれらの反映と考えられる。</p>
<p>しかし，非線形のトレンドを想像するとどうだろう。U字のトレンドを描くことができないだろうか。所得が高い経済では右上がりとなるが，所得が低い経済では逆に緩やかな右下がりとなり，U字の底が一人当たりGDP（対数）が<code class="docutils literal notranslate"><span class="pre">8.8</span></code>辺りだろうか。この場合，バラッサ・サミュエルソン効果は所得が比較的高い経済では強く現れるが，所得が低い経済では弱いと解釈できる。</p>
<p>このような非線形の相関を考慮して，次節では所得の効果の推定をおこなうことにする。</p>
</section>
<section id="id20">
<h3>所得効果の分離<a class="headerlink" href="#id20" title="Link to this heading">#</a></h3>
<p>ここで考える問題は</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>所得効果を他の影響からどのように分離することができるだろうか。</p></li>
<li><p>所得効果は価格の散らばりの何％を説明できるだろうか。</p></li>
</ol>
</div></blockquote>
<p>ここでは，まず問題１について考える。相対価格の決定要因は次式に従って分解できると仮定しよう。</p>
<div class="math notranslate nohighlight" id="equation-eq-19-9">
<span class="eqno">(80)<a class="headerlink" href="#equation-eq-19-9" title="Link to this equation">#</a></span>\[\begin{split}
p_i= D_i^{\text{所得}}D_i^{\text{その他}}\\
\end{split}\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(p_i\equiv\dfrac{P_{i}/e_i}{P_{\text{US}}}\)</span>：相対価格</p></li>
<li><p><span class="math notranslate nohighlight">\(D_i^{\text{所得}}\)</span>：所得効果の部分</p></li>
<li><p><span class="math notranslate nohighlight">\(D_i^{\text{その他}}\)</span>：所得以外の要因によって決まる部分</p></li>
</ul>
<p>２つの項については次の仮定を置く。</p>
<div class="math notranslate nohighlight" id="equation-eq-19-11">
<span class="eqno">(81)<a class="headerlink" href="#equation-eq-19-11" title="Link to this equation">#</a></span>\[
D_i^{\text{所得}}=x_i^{b+c\log(x_i)},
\qquad
D_i^{\text{その他}}=e^{a+u_i}
\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x_i=\dfrac{i\text{国の一人当たりGDP（米ドル）}}{\text{米国の一人当たりGDP（米ドル）}}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(b\)</span>：所得効果の強さを捉えるパラメーター</p></li>
<li><p><span class="math notranslate nohighlight">\(c\)</span>：所得効果の非線形の効果を捉えるパラメーター</p></li>
<li><p><span class="math notranslate nohighlight">\(a\)</span>：その他の要因によって決定される定数</p></li>
<li><p><span class="math notranslate nohighlight">\(u_i\)</span>：その他のランダムな要因（誤差項）</p></li>
</ul>
<p>（注意） <span class="math notranslate nohighlight">\(D_i^{\text{所得}}\)</span>の右辺にある<span class="math notranslate nohighlight">\(x_i\)</span>の指数は<span class="math notranslate nohighlight">\(b+c\log(x_i)\)</span>となっているが，<span class="math notranslate nohighlight">\(c\log(x_i)\)</span>が上述のU字型の相関関係を捉える項となる。</p>
<p>式<a class="reference internal" href="#equation-eq-19-9">(80)</a>に対数を取ると次式となる。</p>
<div class="math notranslate nohighlight" id="equation-eq-19-10">
<span class="eqno">(82)<a class="headerlink" href="#equation-eq-19-10" title="Link to this equation">#</a></span>\[
\log\left(p_i\right)=d_i^{\text{所得}}+d_i^{\text{その他}}
\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(d_i^{\text{所得}}\equiv\log\left(D_i^{\text{所得}}\right)
=\left[b+c\log\left(x_i\right)\right]\log\left(x_i\right)
=b\log(x_i)+c\left[\log\left(x_i\right)\right]^2\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(d_i^{\text{その他}}\equiv\log\left(D_i^{\text{その他}}\right)=a+u_i\)</span></p></li>
</ul>
<p>式<a class="reference internal" href="#equation-eq-19-10">(82)</a>を回帰式として次のようにまとめることができる。</p>
<div class="math notranslate nohighlight" id="equation-eq-19-12">
<span class="eqno">(83)<a class="headerlink" href="#equation-eq-19-12" title="Link to this equation">#</a></span>\[
\log\left(p_i\right)=a+b\log\left(x_i\right)+c\left[\log\left(x_i\right)\right]^2+u_i
\]</div>
<p>式<a class="reference internal" href="#equation-eq-19-12">(83)</a>をOLS推定し，<span class="math notranslate nohighlight">\(\hat{a}\)</span>，<span class="math notranslate nohighlight">\(\hat{b}\)</span>，<span class="math notranslate nohighlight">\(\hat{c}\)</span>をパラメーターの推定値，<span class="math notranslate nohighlight">\(\hat{u}_i\)</span>を残差とすると，次式が成立する。</p>
<div class="math notranslate nohighlight" id="equation-eq-19-13">
<span class="eqno">(84)<a class="headerlink" href="#equation-eq-19-13" title="Link to this equation">#</a></span>\[
\log\left(p_i\right)=\hat{a}+\hat{b}\log\left(x_i\right)
+\hat{c}\left[\log\left(x_i\right)\right]^2+\hat{u}_i
\]</div>
<p>これらの推定値を使い，次のように<span class="math notranslate nohighlight">\(\log\left(p_i\right)\)</span>を２つの要因にに分解することができる。</p>
<div class="math notranslate nohighlight" id="equation-eq-19-14">
<span class="eqno">(85)<a class="headerlink" href="#equation-eq-19-14" title="Link to this equation">#</a></span>\[
\log\left(p_i\right)=
\hat{d}_i^{\text{所得}}
+\hat{d}_i^{\text{その他}}
\]</div>
<p>ここで</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\hat{d}_i^{\text{所得}}=\hat{b}\log\left(x_i\right)+\hat{c}\left[\log\left(x_i\right)\right]^2\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\hat{d}_i^{\text{その他}}=\hat{a}+\hat{u}_i\)</span></p></li>
</ul>
<p>以下では<span class="math notranslate nohighlight">\(\hat{d}_i^{\text{所得}}\)</span>と<span class="math notranslate nohighlight">\(\hat{d}_i^{\text{その他}}\)</span>を計算し，それぞれの要因によって発生する相対価格の対数<span class="math notranslate nohighlight">\(\log\left(p_i\right)\)</span>のばらつき具合（具体的には，分散）を確認することにする。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>なぜ<span class="math notranslate nohighlight">\(\hat{a}\)</span>は<span class="math notranslate nohighlight">\(\hat{D}_i^{\text{その他}}\)</span>に含まれるか考えてみよう。式<a class="reference internal" href="#equation-eq-19-12">(83)</a>の代わりに次の定数項のみの推定式を使って<span class="math notranslate nohighlight">\(a\)</span>を推定したとしよう。</p>
<div class="math notranslate nohighlight">
\[
\log\left(p_i\right)=a+u_i
\]</div>
<p><a class="reference external" href="https://py4etrics.github.io/13_Dummies.html">Pythonで学ぶ計量経済学</a>で説明しているように，この場合の推定値<span class="math notranslate nohighlight">\(\overline{a}\)</span>は<span class="math notranslate nohighlight">\(\log\left(y_i\right)\)</span>の平均と等しい。ここで重要な点は，<span class="math notranslate nohighlight">\(\overline{a}\)</span>は所得効果を含んだ<span class="math notranslate nohighlight">\(y_i\)</span>の平均値だということである。一方，推定式<a class="reference internal" href="#equation-eq-19-12">(83)</a>には<span class="math notranslate nohighlight">\(x_i\)</span>が入っているため，定数項の推定値<span class="math notranslate nohighlight">\(\hat{a}\)</span>は，所得効果を取り除いた後の<span class="math notranslate nohighlight">\(y_i\)</span>の平均値という解釈が成り立つ。この考え方に従うと，<span class="math notranslate nohighlight">\(\log\left(y_i\right)\)</span>の平均値<span class="math notranslate nohighlight">\(\overline{a}\)</span>は次の２つに分解することができる。</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\overline{a}-\hat{a}\)</span>：<span class="math notranslate nohighlight">\(y_i\)</span>の平均値における所得効果の部分</p></li>
<li><p><span class="math notranslate nohighlight">\(\hat{a}\)</span>：<span class="math notranslate nohighlight">\(y_i\)</span>の平均値におけるその他の部分</p></li>
</ul>
<p>この解釈に基づき，<span class="math notranslate nohighlight">\(\hat{a}\)</span>は<span class="math notranslate nohighlight">\(\hat{D}_i^{\text{その他}}\)</span>に含めている。</p>
</div>
</section>
<section id="id21">
<h3>推定<a class="headerlink" href="#id21" title="Link to this heading">#</a></h3>
<p>OLSを使って式<a class="reference internal" href="#equation-eq-19-12">(83)</a>を推定するが，まず<span class="math notranslate nohighlight">\(\log\left(x_i\right)\)</span>と<span class="math notranslate nohighlight">\([\log\left(x_i\right)]^2\)</span>の変数に使う値を作成する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cond</span> <span class="o">=</span> <span class="p">(</span> <span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;countrycode&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;USA&#39;</span> <span class="p">)</span>
<span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;cgdpo_pc_ratio_log&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span> <span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;cgdpo_pc_log&#39;</span><span class="p">]</span> <span class="o">-</span>
                                <span class="n">pwt19</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,</span><span class="s1">&#39;cgdpo_pc_log&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>
<span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;cgdpo_pc_ratio_log_2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;cgdpo_pc_ratio_log&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<p>この２変数を使い回帰式を推定する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">formula</span> <span class="o">=</span> <span class="s1">&#39;pl_gdpo_log ~ cgdpo_pc_ratio_log + cgdpo_pc_ratio_log_2&#39;</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">pwt19</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">slim</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:            pl_gdpo_log   R-squared:                       0.390
Model:                            OLS   Adj. R-squared:                  0.384
No. Observations:                 182   F-statistic:                     57.32
Covariance Type:            nonrobust   Prob (F-statistic):           5.76e-20
========================================================================================
                           coef    std err          t      P&gt;|t|      [0.025      0.975]
----------------------------------------------------------------------------------------
Intercept               -0.1121      0.059     -1.889      0.060      -0.229       0.005
cgdpo_pc_ratio_log       0.5386      0.073      7.346      0.000       0.394       0.683
cgdpo_pc_ratio_log_2     0.0838      0.019      4.362      0.000       0.046       0.122
========================================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(\hat{b}\)</span>と<span class="math notranslate nohighlight">\(\hat{c}\)</span>の統計的な優位性は非常に高い。また<span class="math notranslate nohighlight">\(\hat{c}&gt;0\)</span>はU字型のトレンドを示している。</p>
<p>データの散布図に回帰線を重ねて表示して当てはまり具合を視覚的に確認してみることにしよう。式<a class="reference internal" href="#equation-eq-19-9">(80)</a>から予測値は</p>
<div class="math notranslate nohighlight">
\[
\log\left(\hat{p}_i\right)=\hat{a}+\hat{b}\log\left(x_i\right)
+\hat{c}\left[\log\left(x_i\right)\right]^2
\]</div>
<p>となる。この式を使い，予測値の値を新たな列として<code class="docutils literal notranslate"><span class="pre">pwt19</span></code>に追加しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># パラメーターの推定値</span>
<span class="n">ahat</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">bhat</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">chat</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="c1"># 予測値</span>
<span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;fitted&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span> <span class="n">ahat</span><span class="o">+</span>
                    <span class="n">bhat</span><span class="o">*</span><span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;cgdpo_pc_ratio_log&#39;</span><span class="p">]</span><span class="o">+</span>
                    <span class="n">chat</span><span class="o">*</span><span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;cgdpo_pc_ratio_log_2&#39;</span><span class="p">]</span>
                  <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>プロットしてみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 散布図</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">pwt19</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;cgdpo_pc_ratio_log&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;pl_gdpo_log&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;米国を基準とした一人当たりGDP（対数，2019年）&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;米国の2017年価格を基準とした</span><span class="se">\n</span><span class="s1">2019年相対価格（対数）&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="c1"># 回帰曲線</span>
<span class="n">pwt19</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;cgdpo_pc_ratio_log&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;cgdpo_pc_ratio_log&#39;</span><span class="p">,</span>  <span class="c1">#1</span>
                                             <span class="n">y</span><span class="o">=</span><span class="s1">&#39;fitted&#39;</span><span class="p">,</span>
                                             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
                                             <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ce44d94238733764c772bee7eca1101efdad7713933ed5a153072310cfa28924.png" src="_images/ce44d94238733764c772bee7eca1101efdad7713933ed5a153072310cfa28924.png" />
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<p><code class="docutils literal notranslate"><span class="pre">#1</span></code>の<code class="docutils literal notranslate"><span class="pre">pwt19.sort_values('cgdpo_pc_ratio_log'))</span></code>は，列<code class="docutils literal notranslate"><span class="pre">cgdpo_pc_ratio_log</span></code>の値に従って<code class="docutils literal notranslate"><span class="pre">pwt19</span></code>を昇順に並び替えている。これによりスムーズな回帰曲線を表示できるようになる。並び替えないとどうなるか試してみよう。</p>
</div>
</section>
<section id="id22">
<h3>ヒストグラムの比較<a class="headerlink" href="#id22" title="Link to this heading">#</a></h3>
<p>式<a class="reference internal" href="#equation-eq-19-14">(85)</a>にある３つの項<span class="math notranslate nohighlight">\(\log\left(p_i\right)\)</span>，<span class="math notranslate nohighlight">\(\hat{d}_i^{\text{所得}}\)</span>，<span class="math notranslate nohighlight">\(\hat{d}_i^{\text{その他}}\)</span>のヒストグラムを比較してみよう。まず，<span class="math notranslate nohighlight">\(\hat{d}_i^{\text{所得}}\)</span>と<span class="math notranslate nohighlight">\(\hat{d}_i^{\text{その他}}\)</span>の定義に基づいて<code class="docutils literal notranslate"><span class="pre">pwt19</span></code>に新たな列を作成しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 所得の影響</span>
<span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;income_effect&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span> <span class="n">bhat</span><span class="o">*</span><span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;cgdpo_pc_ratio_log&#39;</span><span class="p">]</span><span class="o">+</span>
                           <span class="n">chat</span><span class="o">*</span><span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;cgdpo_pc_ratio_log_2&#39;</span><span class="p">]</span>
                         <span class="p">)</span>

<span class="c1"># 所得以外の効果</span>
<span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;other_effect&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ahat</span><span class="o">+</span><span class="n">res</span><span class="o">.</span><span class="n">resid</span>
</pre></div>
</div>
</div>
</div>
<p>３つの変数のヒストグラムを並べて表示する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col_lst</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;pl_gdpo_log&#39;</span><span class="p">,</span><span class="s1">&#39;income_effect&#39;</span><span class="p">,</span><span class="s1">&#39;other_effect&#39;</span><span class="p">]</span>
<span class="n">title_lst</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;相対価格（対数）&#39;</span><span class="p">,</span><span class="s1">&#39;所得効果（対数）&#39;</span><span class="p">,</span><span class="s1">&#39;その他の効果（対数）&#39;</span><span class="p">]</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">pwt19</span><span class="p">[</span><span class="n">col_lst</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                              <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span>
                              <span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                              <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">title_lst</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/86377613e1caf6f8fc93fa933701f9ddeef2856ccbd4b4226c59f2e15d536870.png" src="_images/86377613e1caf6f8fc93fa933701f9ddeef2856ccbd4b4226c59f2e15d536870.png" />
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">0.0</span></code>（縦の点線）で<span class="math notranslate nohighlight">\(\dfrac{P_i/e_i}{P_{\text{US}}}=1\)</span>となることに注意しよう。次のことが言える。</p>
<ul class="simple">
<li><p>所得とその他の効果を足し合わせることで一番上の相対価格の分布となる。言い換えると，相対価格の分布から所得効果を取り除くことにより一番下のその他の効果となる。</p></li>
<li><p>所得効果の分布の最頻値は負の値となっており，米国の物価水準より低い経済において所得効果が大きいということを意味する。</p></li>
<li><p>その他の効果は<code class="docutils literal notranslate"><span class="pre">0.0</span></code>を中心に分布している。若干，相対価格が低い階級に国の数が多いように見える。</p></li>
</ul>
</section>
<section id="id23">
<h3>所得効果の大きさ<a class="headerlink" href="#id23" title="Link to this heading">#</a></h3>
<p>ここでは次の問いを考察する。</p>
<blockquote>
<div><p>相対価格のばらつきの何割が所得効果に起因するのだろうか。</p>
</div></blockquote>
<p><span class="math notranslate nohighlight">\(y_i=\log\left(p_i\right)\)</span>として式<a class="reference internal" href="#equation-eq-19-9">(80)</a>を再掲する。</p>
<div class="math notranslate nohighlight" id="equation-eq-19-15">
<span class="eqno">(86)<a class="headerlink" href="#equation-eq-19-15" title="Link to this equation">#</a></span>\[\begin{split}
y_i= d_i^{\text{所得}}+ d_i^{\text{その他}}\\
\end{split}\]</div>
<p>この式の両辺の分散を次のように計算することにより，所得効果の割合を計算することが可能となる。まず，<span class="math notranslate nohighlight">\(p_i\)</span>の分散を<span class="math notranslate nohighlight">\(d_i^{\text{所得}}\)</span>と<span class="math notranslate nohighlight">\(d_i^{\text{その他}}\)</span>の分散に分解しよう。</p>
<div class="math notranslate nohighlight" id="equation-eq-19-16">
<span class="eqno">(87)<a class="headerlink" href="#equation-eq-19-16" title="Link to this equation">#</a></span>\[\begin{split}
\begin{align*}
\text{Var}(y_i)
&amp;=\text{Var}\left(\hat{d}_i^{\text{所得}}+\hat{d}_i^{\text{その他}}\right)\\
&amp;=\text{Var}\left(\hat{d}_i^{\text{所得}}\right)+
    \text{Var}\left(\hat{d}_i^{\text{その他}}\right)+
    2\text{Cov}\left(\hat{d}_i^{\text{所得}},\hat{d}_i^{\text{その他}}\right)\\
&amp;=\underbrace{
    \text{Var}\left(\hat{d}_i^{\text{所得}}\right)+
    \text{Cov}\left(\hat{d}_i^{\text{所得}},\hat{d}_i^{\text{その他}}\right)
    }_{\text{所得効果}}+
  \underbrace{
    \text{Var}\left(\hat{d}_i^{\text{その他}}\right)+
    \text{Cov}\left(\hat{d}_i^{\text{所得}},\hat{d}_i^{\text{その他}}\right)
    }_{\text{その他の効果}}
\end{align*}
\end{split}\]</div>
<p>上の計算では，<span class="math notranslate nohighlight">\(d_i^{\text{所得}}\)</span>と<span class="math notranslate nohighlight">\(d_i^{\text{その他}}\)</span>の共分散が存在するため，それを所得とその他に等分している。</p>
<p>更に，この結果を次のように書き直すことができる（<a class="reference internal" href="6_Regression.html#sec-6-regression-da"><span class="std std-ref">「回帰分析」の章</span></a>を参照）。</p>
<div class="math notranslate nohighlight" id="equation-eq-19-17">
<span class="eqno">(88)<a class="headerlink" href="#equation-eq-19-17" title="Link to this equation">#</a></span>\[\begin{split}
\begin{align*}
\left(
\begin{split}
&amp;\text{所得効果}\\
&amp;\text{の割合}
\end{split}
\right)
&amp;=\frac{
      \text{Var}\left(\hat{d}_i^{\text{所得}}\right)+
    \text{Cov}\left(\hat{d}_i^{\text{所得}},\hat{d}_i^{\text{その他}}\right)
    }{
    \text{Var}(y_i)}
=\frac{
    \text{Cov}\left(y_i,\hat{d}_i^{\text{所得}}\right)
    }{
    \text{Var}(y_i)}
\end{align*}
\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-19-18">
<span class="eqno">(89)<a class="headerlink" href="#equation-eq-19-18" title="Link to this equation">#</a></span>\[\begin{split}
\begin{align*}
\left(
\begin{split}
&amp;\text{その他の効果}\\
&amp;\text{の割合}
\end{split}
\right)
&amp;=\frac{
      \text{Var}\left(\hat{d}_i^{\text{その他}}\right)+
    \text{Cov}\left(\hat{d}_i^{\text{所得}},\hat{d}_i^{\text{その他}}\right)
    }{
    \text{Var}(y_i)}
=\frac{
    \text{Cov}\left(y_i,\hat{d}_i^{\text{その他}}\right)
    }{
    \text{Var}(y_i)}
\end{align*}
\end{split}\]</div>
<p>この式に従って計算してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 所得効果の割合</span>
<span class="n">income</span> <span class="o">=</span> <span class="n">pwt19</span><span class="p">[[</span><span class="s1">&#39;pl_gdpo_log&#39;</span><span class="p">,</span><span class="s1">&#39;income_effect&#39;</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="n">income</span><span class="o">.</span><span class="n">cov</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">income</span><span class="o">.</span><span class="n">cov</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.3904160748287651
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 所得以外の効果の割合</span>
<span class="n">other</span> <span class="o">=</span> <span class="n">pwt19</span><span class="p">[[</span><span class="s1">&#39;pl_gdpo_log&#39;</span><span class="p">,</span><span class="s1">&#39;other_effect&#39;</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="n">other</span><span class="o">.</span><span class="n">cov</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">other</span><span class="o">.</span><span class="n">cov</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6095839251712349
</pre></div>
</div>
</div>
</div>
<p>分散の割合で考えた場合，所得効果は全体の約<span class="pasted-text">39</span>％を占めている。一般物価水準の一物一価が成立しない大きな理由が所得の差ということが明らかになった。一方で，所得以外の要因も大きな影響を及ぼしている。「その他」の要因は大きく２つに分けることができる。</p>
<ul class="simple">
<li><p>財・サービスの貿易（国際収支における貿易・サービス収支に該当）</p>
<ul>
<li><p>国境をまたぐ国際貿易での輸送費用は非常に大きく，一物一価の大きな妨げとなっている。</p></li>
<li><p>Big Macのように非貿易財（例えば，教育，建設，不動産，政府サービス）も存在する。輸送費用は著しく大きいため，貿易されない財と考えることができる。非貿易財の存在は経済間の一物一価の妨げとなっている。</p></li>
<li><p>一般物価水準を説明する上でバスケット財という合成財を考えた。しかし，全ての国で全く同じ財がある訳ではない。また，一般物価水準を計算する上で，各国の支出データを使いウェイトを算出し加重平均を計算することになるが，経済によって支出割合は異なるためウェイトも異なることになる。</p></li>
</ul>
</li>
<li><p>経済間の金融取引（国際収支における金融収支などに該当）</p>
<ul>
<li><p>経済間では財・サービスだけではなく金融資本の取引がおこなわれる。例えば，直接投資，証券投資，金融派生商品などである。長期的な投資だけではなく，短期的な投資や投機も含まれるため，資金が瞬時に動くことになり市場為替レートが大きな影響を受けることになる。</p></li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>式<a class="reference internal" href="#equation-eq-19-17">(88)</a>は次のように書き直すことも可能である。</p>
<div class="math notranslate nohighlight" id="equation-eq-19-19">
<span class="eqno">(90)<a class="headerlink" href="#equation-eq-19-19" title="Link to this equation">#</a></span>\[\begin{split}\begin{align*}
\left(
\begin{split}
&amp;\text{所得効果}\\
&amp;\text{の割合}
\end{split}
\right)
&amp;=\frac{
    \text{Cov}\left(y_i,\hat{d}_i^{\text{所得}}\right)
    }{
    \text{Var}(y_i)}
=\frac{
    \text{Cov}\left(y_i-\hat{u}_i+\hat{u}_i,\hat{b}x_i+\hat{a}-\hat{a}\right)
    }{
    \text{Var}(y_i)}\\
&amp;=\frac{
    \text{Cov}\left(\hat{p}_i+\hat{u}_i,\hat{y}_i-\hat{a}\right)
    }{
    \text{Var}(y_i)}\\
&amp;=\frac{
    \text{Cov}\left(\hat{y}_i,\hat{y}_i\right)
    -\text{Cov}\left(\hat{y}_i,\hat{a}\right)
    +\text{Cov}\left(\hat{u}_i,\hat{y}_i\right)
    -\text{Cov}\left(\hat{u}_i,\hat{a}\right)
    }{
    \text{Var}(y_i)}\\
&amp;=\frac{
    \text{Cov}(\hat{y}_i,\hat{y}_i)
    }{
    \text{Var}(y_i)}
=\frac{
    \text{Var}(\hat{y}_i)
    }{
    \text{Var}(y_i)}
=R^2\;\text{（決定係数）}
\end{align*}\end{split}\]</div>
<p>回帰分析の結果が含まれる<code class="docutils literal notranslate"><span class="pre">res</span></code>を使って確認してみよう。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">res</span><span class="o">.</span><span class="n">rsquared</span>
</pre></div>
</div>
<p>上で計算した所得効果の割合と等しいことが確認できるはずだ。</p>
</div>
</section>
</section>
<section id="id24">
<h2>所得効果の含意<a class="headerlink" href="#id24" title="Link to this heading">#</a></h2>
<section id="id25">
<h3>PPPレートと市場為替レート：再考<a class="headerlink" href="#id25" title="Link to this heading">#</a></h3>
<p>上の分析で一般物価水準が経済によって大きく異なることを示すために，式<a class="reference internal" href="#equation-eq-19-plgdpo">(79)</a>を使った。その式を式<a class="reference internal" href="#equation-eq-19-30">(76)</a>と<a class="reference internal" href="#equation-eq-19-rexr">(72)</a>を使って次のように表すことができる。</p>
<div class="math notranslate nohighlight" id="equation-eq-19-plgdpoa">
<span class="eqno">(91)<a class="headerlink" href="#equation-eq-19-plgdpoa" title="Link to this equation">#</a></span>\[\begin{split}
\begin{aligned}
\text{(列 pl_gdpo)}
&amp;=
\frac{P_i/e_i}{P_{\text{US}}}\\
&amp;=\text{米国（2017年）を基準とした}i\text{国のバスケット財の相対価格}\\
&amp;=\frac{1}{\eta_i}=\frac{\varepsilon_i}{e_i}
\end{aligned}
\end{split}\]</div>
<p>即ち，相対一般物価水準はPPPレートと市場為替レートに分解することができるということであり，経済間での相対一般物価水準の違いは，PPPレートと市場為替レートの乖離として現れるということである。この点を踏まえると，次のことが分かる。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pl_gdpo</span></code><span class="math notranslate nohighlight">\(=1\)</span>：<span class="math notranslate nohighlight">\(\varepsilon_{i}=e_{i}\)</span></p>
<ul>
<li><p><span class="math notranslate nohighlight">\(i\)</span>国の物価水準は米国と同じ場合，PPPレートと市場為替レートは同じ。</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">pl_gdpo</span></code><span class="math notranslate nohighlight">\(&gt;1\)</span>：<span class="math notranslate nohighlight">\(\varepsilon_{i}&gt;e_{i}\)</span></p>
<ul>
<li><p><span class="math notranslate nohighlight">\(i\)</span>国の物価水準は米国よりも高い場合，PPPレートと比較して<span class="math notranslate nohighlight">\(i\)</span>国の通貨は強すぎる。</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">pl_gdpo</span></code><span class="math notranslate nohighlight">\(&lt;1\)</span>：<span class="math notranslate nohighlight">\(\varepsilon_{i}&lt;e_{i}\)</span></p>
<ul>
<li><p><span class="math notranslate nohighlight">\(i\)</span>国の物価水準は米国よりも低い場合，PPPレートと比較して<span class="math notranslate nohighlight">\(i\)</span>国の通貨は弱すぎる。</p></li>
</ul>
</li>
</ul>
<p>更に，相対一般物価水準の違いは所得水準の違いに大きな影響を受けることが明らかになったが，式<a class="reference internal" href="#equation-eq-19-plgdpoa">(91)</a>によると，所得効果はPPPレートと市場為替レートの乖離にも大きな影響を与えることが分かる。次のようにまとめることができる。</p>
<blockquote>
<div><p>所得が高い経済の通貨は強く，所得が低い経済の通貨は弱い傾向となっている。</p>
</div></blockquote>
</section>
<section id="id26">
<h3>ペン効果<a class="headerlink" href="#id26" title="Link to this heading">#</a></h3>
<p>PPPレートと市場為替レートの乖離は所得水準に影響されることが明らかになったが，その経済学的な含意は次のようにまとめることができる。</p>
<blockquote>
<div><p>市場為替レートを使いGDPを評価すると，貧しい国の貧しさは誇張される。</p>
</div></blockquote>
<p>これは<strong>ペン効果</strong>と呼ばれる。英語ではPenn Effectと呼ばれ，Pennは本章で使ったデータセットPenn World TableのPennから来ている。</p>
<p>ペン効果を簡単な数値例で説明するために，Big Macだけを生産する２国を考えてみよう。A国は豊かな経済であり，B国は貧しい経済としよう。A国は年間<span class="math notranslate nohighlight">\(Y_A=10\)</span>個のBig Mac，B国は<span class="math notranslate nohighlight">\(Y_B=5\)</span>個のBig Macを生産している。A国の貨幣単位は<span class="math notranslate nohighlight">\(\$_A\)</span>であり，B国の貨幣は<span class="math notranslate nohighlight">\(\$_B\)</span>とし，価格は<span class="math notranslate nohighlight">\(P_A=\$_A10\)</span>，<span class="math notranslate nohighlight">\(P_B=\$_B10\)</span>としよう。それぞれの自国通貨で評価すると，A国のGDPは<span class="math notranslate nohighlight">\(10\times\$_A10=\$_A100\)</span>であり，A国のGDPは<span class="math notranslate nohighlight">\(5\times\$_B10=\$_B50\)</span>である。</p>
<p>この場合，PPPレートは</p>
<div class="math notranslate nohighlight" id="equation-eq-19-b00">
<span class="eqno">(92)<a class="headerlink" href="#equation-eq-19-b00" title="Link to this equation">#</a></span>\[
\varepsilon_{B/A}=\frac{P_B}{P_A}=\frac{10}{10}=1
\quad\text{（単位：$\$_B/\$_A$）}
\]</div>
<p>となる。まず，一物一価が成立したとしよう。この場合，市場為替レートを<span class="math notranslate nohighlight">\(e_{B/A}\)</span>（単位：<span class="math notranslate nohighlight">\(\$_B/\$_A\)</span>）とすると，<span class="math notranslate nohighlight">\(\varepsilon_{B/A}=e_{B/A}=1\)</span>が成立することになり，A国の通貨<span class="math notranslate nohighlight">\(\$_A\)</span>で表した相対価格は</p>
<div class="math notranslate nohighlight" id="equation-eq-19-b2">
<span class="eqno">(93)<a class="headerlink" href="#equation-eq-19-b2" title="Link to this equation">#</a></span>\[
\frac{P_B/e_{B/A}}{P_A}=\frac{10/1}{10}=1
\]</div>
<p>となる。購買力平価が成立する場合のGDPの比率は次のようになる。</p>
<div class="math notranslate nohighlight" id="equation-eq-19-b3">
<span class="eqno">(94)<a class="headerlink" href="#equation-eq-19-b3" title="Link to this equation">#</a></span>\[
\frac{Y_BP_B/e_{B/A}}{Y_AP_A}=\frac{5\times10/1}{10\times10}=\frac{50}{100}=\frac{1}{2}
\]</div>
<p>B国のGDPはA国の半分ということだ。</p>
<p>次に，ペン効果を導入する。所得の影響により為替レートは<span class="math notranslate nohighlight">\(e_{B/A}=2\)</span>と仮定しよう。即ち，B国は比較的に貧しいため，B国の通貨は弱いという仮定である。この場合，A国の通貨<span class="math notranslate nohighlight">\(\$_A\)</span>で表した相対価格は</p>
<div class="math notranslate nohighlight" id="equation-eq-19-b0">
<span class="eqno">(95)<a class="headerlink" href="#equation-eq-19-b0" title="Link to this equation">#</a></span>\[
\frac{P_B/e_{B/A}}{P_A}=\frac{10/2}{10}=\frac{5}{10}=\frac{1}{2}&lt;1
\]</div>
<p>となり，A国の価格がB国よりも高く一物一価は成立しない。上述のデータと合致したパターン（豊かな国の価格が高い）となっている。相対的なGDPを計算してみよう。</p>
<div class="math notranslate nohighlight" id="equation-eq-19-b1">
<span class="eqno">(96)<a class="headerlink" href="#equation-eq-19-b1" title="Link to this equation">#</a></span>\[
\frac{Y_BP_B/e_{B/A}}{Y_AP_A}=\frac{5\times10/2}{10\times10}=\frac{25}{100}=\frac{1}{4}
\]</div>
<p>B国のGDPはA国の25％しかない。所得効果がない購買力平価が成立する場合の50％と対照的であり，ペン効果により所得格差が誇張されている。</p>
</section>
<section id="gdp">
<h3>一人当たりGDPの分布<a class="headerlink" href="#gdp" title="Link to this heading">#</a></h3>
<p>上の数値例をデータを使って確認してみよう。ここでは<code class="docutils literal notranslate"><span class="pre">pwt19</span></code>を使い，PPPレートで計算された一人当たりGDPと市場為替レートに基づいた一人当たりGDPを計算し比較する。</p>
<p>変数<code class="docutils literal notranslate"><span class="pre">cgdpo_pc</span></code>はPPPレートで計算した一人当たりGDP（2017年米ドル）である。具体的に説明するために，次の変数を定義しよう。</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(Y_i\)</span>：<span class="math notranslate nohighlight">\(i\)</span>国の産出量</p></li>
<li><p><span class="math notranslate nohighlight">\(P_i\)</span>：<span class="math notranslate nohighlight">\(i\)</span>国の貨幣表示の物価水準</p></li>
<li><p><span class="math notranslate nohighlight">\(L_i\)</span>：<span class="math notranslate nohighlight">\(i\)</span>国の人口</p></li>
<li><p><span class="math notranslate nohighlight">\(\varepsilon_i\)</span>：１米ドル当たりの<span class="math notranslate nohighlight">\(i\)</span>国のPPPレート</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">cgdpo_pc</span></code>は次のように計算されている。</p>
<div class="math notranslate nohighlight" id="equation-eq-19-p0">
<span class="eqno">(97)<a class="headerlink" href="#equation-eq-19-p0" title="Link to this equation">#</a></span>\[
\text{(列 cgdpo_pc)}=\frac{P_iY_i/L_i}{\varepsilon_i}
\]</div>
<p><code class="docutils literal notranslate"><span class="pre">pwt19</span></code>に市場為替レートのGDPを新たな列<code class="docutils literal notranslate"><span class="pre">cgdpo_pc_xr</span></code>として追加するとしよう。<code class="docutils literal notranslate"><span class="pre">cgdpo_pc</span></code>を使うと次の計算となる。</p>
<div class="math notranslate nohighlight" id="equation-eq-19-p0a">
<span class="eqno">(98)<a class="headerlink" href="#equation-eq-19-p0a" title="Link to this equation">#</a></span>\[
\text{(列 cgdpo_pc_xr)}
=\frac{P_iY_i/L_i}{\varepsilon_i}\times\frac{\varepsilon_i}{e_i}
=\text{(列 cgdpo_pc)}\times\frac{\text{(列 ppp)}}{\text{(列 xr)}}
\]</div>
<p>列<code class="docutils literal notranslate"><span class="pre">cgdpo_pc_xr</span></code>を追加する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;cgdpo_pc_xr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;cgdpo_pc&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;ppp&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;xr&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>対数値も作成しておこう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;cgdpo_pc_xr_log&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span> <span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;cgdpo_pc_xr&#39;</span><span class="p">]</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>まず散布図を使ってペン効果を確かめてみる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">pwt19</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;cgdpo_pc_log&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;cgdpo_pc_xr_log&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axline</span><span class="p">((</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;45度線&#39;</span><span class="p">)</span>  <span class="c1">#1</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;一人当たりGDP（PPPレート）&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;一人当たりGDP（市場為替レート）&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d55c33b7b5101ca76eef1ecee9d4d8ae94875a5fb8847450f7a0e58abc0906d4.png" src="_images/d55c33b7b5101ca76eef1ecee9d4d8ae94875a5fb8847450f7a0e58abc0906d4.png" />
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">#1</span></code>：<code class="docutils literal notranslate"><span class="pre">.axline()</span></code>は直線を表示するメソッドであり，引数で指定された座標２つを通過する直線がプロットされる。<code class="docutils literal notranslate"><span class="pre">(9,9)</span></code>は横軸<code class="docutils literal notranslate"><span class="pre">9</span></code>と縦軸<code class="docutils literal notranslate"><span class="pre">9</span></code>の座標であり，<code class="docutils literal notranslate"><span class="pre">(10,10)</span></code>は横軸<code class="docutils literal notranslate"><span class="pre">10</span></code>と縦軸<code class="docutils literal notranslate"><span class="pre">10</span></code>の座標となる。</p></li>
</ul>
</div>
<p>横軸はPPPレートで計算した一人当たりGDPであり，縦軸には市場為替レートに基づく一人当たりGDPとなっている。それぞれのレートで計算した一人当たりGDPが等しければ45度線（赤線）上に観測値は並んでいるはずである。しかし，観測値は45度線よりも下に位置する傾向があり，特に所得が低い経済においては顕著である。即ち，市場為替レートを使い計算した一人当たりGDPは低く算出される傾向にあり，所得が低い経済においてその傾向は強い。</p>
<p>一人当たりGDPの分布を図示するためにカーネル密度推定をプロットしよう。（直感的には，カーネル密度推定とはヒストグラムの情報を使い，そのサンプルを生成した連続的な分布を推定する方法と考えれば良いだろう。）</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">pwt19</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">kde</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cgdpo_pc_log&#39;</span><span class="p">,</span><span class="s1">&#39;cgdpo_pc_xr_log&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;PPPレート&#39;</span><span class="p">,</span><span class="s1">&#39;市場為替レート&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;一人当たりGDP（米ドル，対数）&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b37ff2958fcf9c4521e961b0bf2aee6005b156e8d1cb906cb1d3b416d72ffc04.png" src="_images/b37ff2958fcf9c4521e961b0bf2aee6005b156e8d1cb906cb1d3b416d72ffc04.png" />
</div>
</div>
<p>PPPレートGDPと比べて市場為替レートGDPは全体的に左（小さい値）にシフトしている。所得が中程度の国が減少し，所得が低い国が増加している。</p>
<p>記述統計を比べてみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#1</span>
<span class="n">stats_ppp</span> <span class="o">=</span> <span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;cgdpo_pc_log&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="s1">&#39;PPPレートGDP&#39;</span><span class="p">)</span>
<span class="n">stats_xr</span> <span class="o">=</span> <span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;cgdpo_pc_xr_log&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="s1">&#39;市場為替レートGDP&#39;</span><span class="p">)</span>

<span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">stats_xr</span><span class="p">,</span><span class="n">stats_ppp</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>  <span class="c1">#2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>市場為替レートGDP</th>
      <th>PPPレートGDP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>182.000000</td>
      <td>182.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>8.837957</td>
      <td>9.479314</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.459575</td>
      <td>1.137809</td>
    </tr>
    <tr>
      <th>min</th>
      <td>5.562148</td>
      <td>6.678289</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>7.733357</td>
      <td>8.665637</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>8.898444</td>
      <td>9.585708</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>10.056103</td>
      <td>10.372745</td>
    </tr>
    <tr>
      <th>max</th>
      <td>11.676471</td>
      <td>11.611350</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">#1</span></code>：<code class="docutils literal notranslate"><span class="pre">.describe()</span></code>は記述統計を<code class="docutils literal notranslate"><span class="pre">Series</span></code>として返すメソッド。<code class="docutils literal notranslate"><span class="pre">to_frame('PPPレートGDP')</span></code>は<code class="docutils literal notranslate"><span class="pre">Series</span></code>を<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>に変換するメソッドであり，引数’PPPレートGDP’を列ラベルに使う。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#2</span></code>：<code class="docutils literal notranslate"><span class="pre">pd.concat()</span></code>は<code class="docutils literal notranslate"><span class="pre">Pandas</span></code>の<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を結合する関数。</p>
<ul>
<li><p>引数<code class="docutils literal notranslate"><span class="pre">[stats_xr,stats_ppp]</span></code>は結合する<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>をリストとして指定する。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">axis='columns'</span></code>は各<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を列として結合することを指定している。</p></li>
<li><p>（注意）<code class="docutils literal notranslate"><span class="pre">pd.concat()</span></code>は行ラベルが合っているかはチェックしない。上のコードでは，行ラベルが同じだと分かっているので問題ないが，行ラベルが異なる<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を結合する場合は<code class="docutils literal notranslate"><span class="pre">pd.merge()</span></code>を使うことを勧める。</p></li>
</ul>
</li>
</ul>
</div>
<p>上の結果をまとめると次のようになる。市場為替レートを使うことにより，</p>
<ul class="simple">
<li><p>GDPの平均，最小値，25％分位数，中央値，75％分位数は減少している。</p></li>
<li><p>GDPの標準偏差と最大値は増加している。</p></li>
</ul>
<p>これらは市場為替レートにより経済間の不平等が大きく計測されていることを示唆する。不平等の一つに変動係数（Coefficient of Variation）があるが（式<a class="reference internal" href="#equation-eq-19-cc">(58)</a>を参照），それを使って比較してみよ。</p>
<p>変動係数が大きければ，所得不平等は大きいことを意味する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cc_ppp</span> <span class="o">=</span> <span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;cgdpo_pc_log&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="o">/</span> <span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;cgdpo_pc_log&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">cc_xr</span> <span class="o">=</span> <span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;cgdpo_pc_xr_log&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="o">/</span> <span class="n">pwt19</span><span class="p">[</span><span class="s1">&#39;cgdpo_pc_xr_log&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--- GDPの変動係数 ---&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;PPPレート：</span><span class="si">{</span><span class="n">cc_ppp</span><span class="si">:</span><span class="s1">&gt;8.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;市場為替レート：</span><span class="si">{</span><span class="n">cc_xr</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- GDPの変動係数 ---
PPPレート：   0.120
市場為替レート：0.165
</pre></div>
</div>
</div>
</div>
<p>市場為替レートに含まれる所得の影響がペン効果として現れていることが確認できる。</p>
</section>
</section>
<section id="id27">
<h2>まとめ<a class="headerlink" href="#id27" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>国内市場で財・サービスの一物一価は成立していない。</p></li>
<li><p>経済間でBig Macの価格の一物一価は成立していない。</p></li>
<li><p>経済間で一般物価水準は異なる。</p></li>
<li><p>購買力平価レートは２つの通貨の購買力を等しくする交換レート。</p></li>
<li><p>所得が高い（低い）経済の一般物価水準は高い（低い）傾向にある（所得効果）。</p></li>
<li><p>所得効果により，所得が低い経済の通貨は購買力平価レートと比べて弱い傾向にある。</p></li>
<li><p>市場為替レートを使い共通通貨で一人当たりGDPを比較すると，所得が低い経済の貧しさは誇張される。</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="9_Convergence.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">所得分布と所得収斂</p>
      </div>
    </a>
    <a class="right-next"
       href="13a_Random_Variables.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">ランダム変数と統計的特徴</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">はじめに</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">国内での一物一価</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">説明</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">チョコレート</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">アイスクリーム</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">ガソリン</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">結論</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#big-mac">経済間での一物一価：Big Mac</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">はじめに</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">データ</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">一物一価</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">所得の影響</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">購買力平価と物価水準の分布</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ppp">PPPとは</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">PPPレートと市場為替レートのデータ</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">使用するデータ</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">例：日本</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">相対一般物価水準の分布</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">物価水準に対する所得の影響</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">所得の影響</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">所得効果の分離</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">推定</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">ヒストグラムの比較</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id23">所得効果の大きさ</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">所得効果の含意</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id25">PPPレートと市場為替レート：再考</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id26">ペン効果</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gdp">一人当たりGDPの分布</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id27">まとめ</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By 春山 鉄源  Tetsugen HARUYAMA
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <!-- Default Statcounter code for Py4Macro https://py4macro.github.io --> <script type="text/javascript"> var sc_project=12478906; var sc_invisible=1; var sc_security="e767d225"; </script> <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script> <noscript><div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img class="statcounter" src="https://c.statcounter.com/12478906/0/e767d225/1/" alt="Web Analytics"></a></div></noscript> <!-- End of Statcounter Code -->
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>