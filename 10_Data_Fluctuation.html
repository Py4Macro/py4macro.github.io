
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>GDPと失業及びトレンド &#8212; Pythonで学ぶマクロ経済学 (中級＋レベル)</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/myadmonitions.css?v=372cf325" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-3FB0WMD39P"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-3FB0WMD39P');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-3FB0WMD39P');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '10_Data_Fluctuation';</script>
    <link rel="canonical" href="https://py4macro.github.io/10_Data_Fluctuation.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="法則・曲線・増加率" href="11_Macro_Variables.html" />
    <link rel="prev" title="一物一価と購買力平価" href="19_PPP.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">Pythonで学ぶマクロ経済学 (中級＋レベル)</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Pythonの学習</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://py4basics.github.io">経済学のためのPython入門</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">長期分析</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="5a_Development_Accounting.html">発展会計</a></li>
<li class="toctree-l1"><a class="reference internal" href="5b_Growth_Accounting.html">成長会計</a></li>
<li class="toctree-l1"><a class="reference internal" href="6_Regression.html">回帰分析</a></li>
<li class="toctree-l1"><a class="reference internal" href="7_DifferenceEq.html">差分方程式と経済分析</a></li>
<li class="toctree-l1"><a class="reference internal" href="8_Solow.html">ソロー・モデル</a></li>
<li class="toctree-l1"><a class="reference internal" href="9_Convergence.html">所得分布と所得収斂</a></li>
<li class="toctree-l1"><a class="reference internal" href="19_PPP.html">一物一価と購買力平価</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">短期分析I</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">GDPと失業及びトレンド</a></li>
<li class="toctree-l1"><a class="reference internal" href="11_Macro_Variables.html">法則・曲線・増加率</a></li>
<li class="toctree-l1"><a class="reference internal" href="18_ADAS-1.html">定量的マクロ経済分析：Part 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="18_ADAS-2.html">定量的マクロ経済分析：Part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="12_IS-MP-PC.html">IS-MP-PCモデル</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">短期分析II</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="13_random_TFP.html">ランダム変数と全要素生産性</a></li>
<li class="toctree-l1"><a class="reference internal" href="14_linearsolve.html"><code class="docutils literal notranslate"><span class="pre">linearsolve</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="15_RBC.html">実物的景気循環(RBC)モデル</a></li>
<li class="toctree-l1"><a class="reference internal" href="16_data_on_money.html">古典派の二分法と金融政策</a></li>
<li class="toctree-l1"><a class="reference internal" href="Plan.html">今後の計画</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">参考</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://py4basics.github.io/Gapminder.html">Gapminder</a></li>
<li class="toctree-l1"><a class="reference external" href="https://py4etrics.github.io">Pythonで学ぶ入門計量経済学</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/Py4Macro/py4macro.github.io/source?urlpath=tree/10_Data_Fluctuation.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/Py4Macro/py4macro.github.io/blob/source/10_Data_Fluctuation.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>



<a href="https://github.com/Py4Macro/py4macro.github.io" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/10_Data_Fluctuation.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>GDPと失業及びトレンド</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">はじめに</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">GDPとその変化</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">GDPの構成要素</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">失業率</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">トレンドと変動</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">説明</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">トレンドの計算</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">GDPのトレンドからの乖離率</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">構成要素のトレンドからの乖離率</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">GDPとの相関度</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">復習</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cov-corr"><code class="docutils literal notranslate"><span class="pre">.cov</span></code>と<code class="docutils literal notranslate"><span class="pre">.corr()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">GDPと構成要素との相関係数</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">変動の大きさ</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="gdp">
<span id="chap-10-gdp"></span><h1>GDPと失業及びトレンド<a class="headerlink" href="#gdp" title="Link to this heading">#</a></h1>
<div name="html-admonition" style="font-size: 0.8em">
<input type="button" onclick="location.href='https://translate.google.com/translate?hl=&sl=ja&tl=en&u='+window.location;" value="Google translation" style="color:#ffffff;background-color:#008080; height:25px" onmouseover="this.style.background='#99ccff'" onmouseout="this.style.background='#008080'"/> in English or the language of your choice.
</div><br><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">japanize_matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">py4macro</span>

<span class="c1"># numpy v1の表示を使用</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">legacy</span><span class="o">=</span><span class="s1">&#39;1.21&#39;</span><span class="p">)</span>
<span class="c1"># 警告メッセージを非表示</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Matplotlib is building the font cache; this may take a moment.
</pre></div>
</div>
</div>
</div>
<section id="id1">
<h2>はじめに<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<p>人の心の中を知ることはできない。友人，同僚，パートナー，親族もそうである。また何十年も連れ添った夫婦でさえも完全にお互いの心の中を分かっているとは言い難いだろう。しかし話し言葉やその内容，行動から心の中を推測することは可能である。実際，我々は日常そうしており，人間関係を豊かにする為には必須でる。経済も同じである。経済の動きの裏にある「真のメカニズム」は完全に把握されていない。アダム・スミスの時代に比べると，「熟練夫婦」に匹敵するほど知見は蓄積されたかも知れないが，今でも「真のメカニズム」が100％解明されたとは言い難い。経済学者にとってできることは，経済の「言動」であるデータを観察し「真のメカニズム」について想像を巡らすことである。人の言動に注意を払わずに人の心の中を想像するのは「妄想」となり，データを無視して経済を考えるのは「空想」となってしまう危険性がある。</p>
<blockquote>
<div><p>人の心の中　<span class="math notranslate nohighlight">\(\Longleftrightarrow\)</span>　経済の真のメカニズム</p>
<p>人の言動　<span class="math notranslate nohighlight">\(\Longleftrightarrow\)</span>　経済データ</p>
</div></blockquote>
<p>この章はマクロ・データの特徴を理解することを目的とする。統計量やプロットを駆使して異なるマクロ・データの特性を炙り出し，経済の「言動」に注目しようということである。特に，以下では国内総生産（GDP）とその構成要素に着目し議論を進める。</p>
<p>使うデータは<code class="docutils literal notranslate"><span class="pre">py4macro</span></code>に含まれる日本の四半期データである。1980年から1993年のデータと1994年から2021年までの２つのデータ・セットを組み合わせて作成した。データを読み込むには次のようにする。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">py4macro</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;jpn-q&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>ここで<code class="docutils literal notranslate"><span class="pre">jpn</span></code>はJapan，<code class="docutils literal notranslate"><span class="pre">q</span></code>はquerterlyを表している。変数の定義を表示するには<code class="docutils literal notranslate"><span class="pre">description=True</span></code>の引数を追加する。</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">py4macro</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;jpn-q&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    | `gdp`:         国内総生産（GDP）
    | `consumption`: 消費
    | `investment`:  投資
    | `government`:  政府支出
    | `exports`:     輸出
    | `imports`:     輸入
    | `capital`:     資本ストック
    | `employed`:    就業者数
    | `unemployed`:  失業者数
    | `unemployment_rate`: 失業率
    | `hours`:       労働者一人当たり月平均労働時間
    | `total_hours`: 月平均総労働時間（`employed`X`hours`）
    | `inflation`:   インフレ率
    | `price`:       消費者物価指数
    | `deflator`:    GDPデフレーター
    |
    | * 四半期データ
    |
    | ＜出典＞
    | GDPと各需要項目
    |    * 1994年Q1~2023年Q4
    |        * 実額・四半期・実質季節調整系列（年換算）
    |        * 2015暦年（平成27年）連鎖価格
    |        * 単位：10億円
    |        * 国民経済計算（GDP統計）
    |    * 1980年Q1~1993年Q4
    |        * 実額・四半期・実質季節調整系列（年換算）
    |        * 平成27年基準支出側GDP系列簡易遡及（参考系列であり上のデータと接続可能）
    |        * 単位：10億円
    |        * 国民経済計算（GDP統計）
    |
    | 実質資本ストック
    |   * 1994年Q1~2023年Q4
    |        * 平成25年基準
    |        * 単位：10億円
    |        * 国民経済計算（GDP統計）
    |   * 1980年Q1~1993年Q4
    |        * 平成25年基準遡及系列
    |        * 単位：10億円
    |        * 国民経済計算（GDP統計）
    |
    | 就業者数，失業者数，失業率
    |   * 総務省「労働力調査」
    |   * 単位：万人，％
    |
    | 労働者一人当たり月平均労働時間
    |   * 厚生労働省「毎月勤労統計調査」
    |   * 30 人以上(一般・パート)、月間実労働時間(総実労働時間)
    |   * 2020年の平均を100に基準化
    |
    | インフレ率
    |   * 景気動向指数（速報，改訂値，月次，原数値の前年同月比）から四半期平均として計算
    |
    | 消費者物価指数
    |   * 2020年基準
    |   * 「中分類指数（全国）＜時系列表＞【月次】」の四半期平均として計算
    |   * 簡便的に移動平均を使い季節調整を施している
    |
    | GDPデフレーター
    |   * 1994年Q1~2023年Q4
    |       * 2015年（平成27年）基準
    |       * 季節調整系列
    |   * 1980年Q1~1993年Q4
    |       * 2015年（平成27年）基準遡及系列
    |       * 季節調整系列
</pre></div>
</div>
</div>
</div>
<p>このデータ・セットにはGDPとその構成要素以外も含まれているが，それらは次章で使うことになる。</p>
<p>まずデータを読み込んで最初の５行を表示してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">py4macro</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;jpn-q&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gdp</th>
      <th>consumption</th>
      <th>investment</th>
      <th>government</th>
      <th>exports</th>
      <th>imports</th>
      <th>capital</th>
      <th>employed</th>
      <th>unemployed</th>
      <th>unemployment_rate</th>
      <th>hours</th>
      <th>total_hours</th>
      <th>inflation</th>
      <th>price</th>
      <th>deflator</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1980-01-01</th>
      <td>269747.5</td>
      <td>153290.7</td>
      <td>65029.2</td>
      <td>73039.5</td>
      <td>18383.8</td>
      <td>24278.8</td>
      <td>834219.7</td>
      <td>5506.000000</td>
      <td>107.666667</td>
      <td>1.900000</td>
      <td>124.7</td>
      <td>686598.200000</td>
      <td>5.766667</td>
      <td>NaN</td>
      <td>91.2</td>
    </tr>
    <tr>
      <th>1980-04-01</th>
      <td>268521.8</td>
      <td>153551.9</td>
      <td>65316.6</td>
      <td>72164.5</td>
      <td>18631.4</td>
      <td>25454.5</td>
      <td>843000.2</td>
      <td>5525.666667</td>
      <td>110.000000</td>
      <td>1.966667</td>
      <td>124.8</td>
      <td>689603.200000</td>
      <td>8.166667</td>
      <td>72.917251</td>
      <td>93.4</td>
    </tr>
    <tr>
      <th>1980-07-01</th>
      <td>274183.1</td>
      <td>155580.0</td>
      <td>65765.9</td>
      <td>72663.8</td>
      <td>18449.3</td>
      <td>23885.7</td>
      <td>854753.4</td>
      <td>5561.333333</td>
      <td>116.000000</td>
      <td>2.033333</td>
      <td>124.0</td>
      <td>689605.333333</td>
      <td>8.200000</td>
      <td>73.897654</td>
      <td>94.4</td>
    </tr>
    <tr>
      <th>1980-10-01</th>
      <td>279601.8</td>
      <td>156162.4</td>
      <td>66017.5</td>
      <td>74761.1</td>
      <td>19705.4</td>
      <td>23716.5</td>
      <td>868241.2</td>
      <td>5551.333333</td>
      <td>123.333333</td>
      <td>2.166667</td>
      <td>124.0</td>
      <td>688365.333333</td>
      <td>8.100000</td>
      <td>74.767147</td>
      <td>95.4</td>
    </tr>
    <tr>
      <th>1981-01-01</th>
      <td>281995.7</td>
      <td>156757.7</td>
      <td>66259.0</td>
      <td>76127.6</td>
      <td>20289.5</td>
      <td>24174.1</td>
      <td>879629.9</td>
      <td>5568.666667</td>
      <td>124.333333</td>
      <td>2.200000</td>
      <td>123.6</td>
      <td>688287.200000</td>
      <td>6.833333</td>
      <td>75.690241</td>
      <td>95.6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>列には変数が並んでいるのが確認できる。行は行番号ではなく行ラベルとなっており，年・四半期を示している。<code class="docutils literal notranslate"><span class="pre">1980</span></code>年であれば、次のような行ラベルになっており、各四半期の最初の日がラベルとして使われている。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">1980-01-01</span></code>：第<code class="docutils literal notranslate"><span class="pre">1</span></code>四半期</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">1980-04-01</span></code>：第<code class="docutils literal notranslate"><span class="pre">2</span></code>四半期</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">1980-07-01</span></code>：第<code class="docutils literal notranslate"><span class="pre">3</span></code>四半期</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">1980-10-01</span></code>：第<code class="docutils literal notranslate"><span class="pre">4</span></code>四半期</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">.info()</span></code>を使って確認してみる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
DatetimeIndex: 176 entries, 1980-01-01 to 2023-10-01
Data columns (total 15 columns):
 #   Column             Non-Null Count  Dtype  
---  ------             --------------  -----  
 0   gdp                176 non-null    float64
 1   consumption        176 non-null    float64
 2   investment         176 non-null    float64
 3   government         176 non-null    float64
 4   exports            176 non-null    float64
 5   imports            176 non-null    float64
 6   capital            176 non-null    float64
 7   employed           176 non-null    float64
 8   unemployed         176 non-null    float64
 9   unemployment_rate  176 non-null    float64
 10  hours              176 non-null    float64
 11  total_hours        176 non-null    float64
 12  inflation          176 non-null    float64
 13  price              175 non-null    float64
 14  deflator           176 non-null    float64
dtypes: float64(15)
memory usage: 22.0 KB
</pre></div>
</div>
</div>
</div>
<p>表示の上から２行目に<code class="docutils literal notranslate"><span class="pre">DatetimeIndex</span></code>とあるが，行ラベルのことを表しており，時系列データ用となっている。具体的な説明は割愛するが，時系列データが扱いやすくなりプロットする際にも便利である。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">jpn-q</span></code>に含まれる実質GDPと各需要項目は「連鎖価格」となっている。詳細な説明は<a class="reference external" href="https://www.esri.cao.go.jp/jp/sna/data/data_list/sokuhou/files/old_keisu/pdf/shiryou_rensa.pdf">内閣府の資料</a>を参考にするとして、この実質化の手法により「加法整合性の不成立」と呼ばれる問題が発生する。GDPは３面等価の原則により生産側、分配側、支出側で測ったGDPは等しいが、<code class="docutils literal notranslate"><span class="pre">jpn-q</span></code>には支出側GDPのデータが含まれており、参照年とその翌年以外は、次の問題が内在している。</p>
<div class="math notranslate nohighlight">
\[
\text{支出側GDP}\;\neq\;\text{消費＋投資＋政府支出＋輸出ー輸入}
\]</div>
<p>左辺と右辺（需要項目の合計）は等しくないという意味で「加法整合性の不成立」が発生している。その差は「開差」という項目で内閣府のデータに含まれており、連鎖価格の実質GDPは水準よりも変化率の分析に適していると言われている。では、どれ程の差があるのだろうか。開差の絶対値の平均は公式系列の1994Q1〜2023年Q4のデータでは平均で約<code class="docutils literal notranslate"><span class="pre">0.6</span></code>％（対GDP比）、参考系列の1980〜1993年で約<code class="docutils literal notranslate"><span class="pre">3.2</span></code>％（対GDP比）となっている。驚く程の大きさではないかも知れないが、以下ではこの問題を念頭に置きつつ需要項目の割合などの議論を進めることにする。</p>
</div>
</section>
<section id="id2">
<h2>GDPとその変化<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<p>まずGDPを図示しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;gdp&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;国内総生産&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4abf28530845dc2f82fbf69263a5ba90e2084e6c61e606db18833b80d5297cbd.png" src="_images/4abf28530845dc2f82fbf69263a5ba90e2084e6c61e606db18833b80d5297cbd.png" />
</div>
</div>
<p>長期的には上昇トレンドであることが分かる。これが経済成長である。一方で，よく観察するとギザギザに動いていることも確認できる。景気変動である。小さい上下の動きもあれば，より大きな動きもある。例えば，2008年のリーマン・ショック，そして2020年のコロナ禍の影響でGDPは大きく下落している。</p>
<blockquote>
<div><p>(問４）なぜ景気変動は起こるのか？</p>
</div></blockquote>
<p>これがマクロ経済学のもう一つのBig Questionである。この章以降は問４を中心にマクロ経済を考察することになる。</p>
<p>上の図には2022年第1四半期以降のデータは含まれていない。参考に最新のデータを含む図を下にに表示する。</p>
<div class="cell tag_thebe-init tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">IFrame</span>
<span class="n">IFrame</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="s1">&#39;https://fred.stlouisfed.org/graph/graph-landing.php?g=BOLN&amp;width=420&amp;height=320&#39;</span><span class="p">,</span>
       <span class="n">width</span><span class="o">=</span><span class="mi">450</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">330</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html">
        <iframe
            width="450"
            height="330"
            src="https://fred.stlouisfed.org/graph/graph-landing.php?g=BOLN&width=420&height=320"
            frameborder="0"
            allowfullscreen
            
        ></iframe>
        </div></div>
</div>
<p>この図は<a class="reference external" href="https://fred.stlouisfed.org">米国セントルイス連邦準備銀行が管理するFederal Reserve Economic Data (FRED)</a>と呼ばれるデータ・ベースからライブでダウンロードして表示している。</p>
<p><code class="docutils literal notranslate"><span class="pre">py4macro</span></code>を使った上の図もしくはFREDの図にあるGDPは水準を表しているため，GDPの成長率を直接読み取り異なる時期の成長率を比べることは難しい。しかし，それを可能にするのが対数化したGDPのプロットである。まず，なぜそうなのかを簡単に説明しよう。</p>
<p>変数<code class="docutils literal notranslate"><span class="pre">x</span></code>の成長率<span class="math notranslate nohighlight">\(g_x\)</span>は次の式で定義される。</p>
<div class="math notranslate nohighlight">
\[
1+g_x=\frac{x_{t+1}}{x_{t}}
\]</div>
<p>ここで<span class="math notranslate nohighlight">\(g_x\)</span>の値は，例えば<code class="docutils literal notranslate"><span class="pre">0.02</span></code>（<code class="docutils literal notranslate"><span class="pre">2％</span></code>）のような値となる。この式の両辺に対数を取り，近似を使うと次のように書き直すことができる。</p>
<div class="math notranslate nohighlight">
\[
\log(1+g_x)=\log(x_{t+1})-\log(x_{t})
\]</div>
<div class="math notranslate nohighlight">
\[
\qquad\qquad\quad\Downarrow\text{左辺を近似}\;\log(1+g_x)\approx g_x
\]</div>
<div class="math notranslate nohighlight" id="equation-eq-10-log-growth">
<span class="eqno">(99)<a class="headerlink" href="#equation-eq-10-log-growth" title="Link to this equation">#</a></span>\[
g_x\approx\log(x_{t+1})-\log(x_{t})
\]</div>
<p><code class="docutils literal notranslate"><span class="pre">x</span></code>の成長率である<span class="math notranslate nohighlight">\(g_x\)</span>は，<code class="docutils literal notranslate"><span class="pre">x</span></code>の対数の差分ということになる。即ち，縦軸に<code class="docutils literal notranslate"><span class="pre">x</span></code>の対数，横軸に時間をおけば，プロットの傾きは<code class="docutils literal notranslate"><span class="pre">x</span></code>の成長率と等しいことになる。</p>
<p>では実際にプロットしよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;gdp_log&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;gdp&#39;</span><span class="p">]</span> <span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;gdp_log&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;国内総生産（対数）&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b9c91cb966b11b22294cef4ac3278438877ea1da041b160f60962bfb718f8409.png" src="_images/b9c91cb966b11b22294cef4ac3278438877ea1da041b160f60962bfb718f8409.png" />
</div>
</div>
<p>プロットの傾きは四半期ごとのGDPの成長率であり，成長率が変化しているのがわかる。また，2008年のリーマン・ショックとコロナ禍により成長率が大きく下落していることが確認できる。景気循環により成長率が小刻みに，また時には大きく変化している。</p>
<p>次に，長期的な視点で図を眺めてみよう。1980年から1990年までの間に直線のトレンドを描くことができる。その傾きが平均成長率である。同様に，1990年から2020年までの直線トレンドを描くこともできるが，傾きが緩やかになっていることに気づくのではないだろうか。1991年頃のバブル崩壊の影響により，その後のGDPの伸びが鈍化していることがわかる。「失われた10年」，「失われた20年」と言われていたが，今では「失われた30年」と言われる所以である。</p>
<p>次に<a class="reference internal" href="#equation-eq-10-log-growth">(99)</a>を使い四半期成長率を計算してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;gdp_growth_quarter&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;gdp_log&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>   <span class="c1"># 1</span>

<span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;gdp_growth_quarter&#39;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;GDP四半期成長率（％）&#39;</span><span class="p">,</span>
        <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                    <span class="c1"># 2</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1ba9363421b066506afc37bcd01bfb1839b1182a256d823e62861312e4a3233e.png" src="_images/1ba9363421b066506afc37bcd01bfb1839b1182a256d823e62861312e4a3233e.png" />
</div>
</div>
<div class="code-explanation dropdown admonition">
<p class="admonition-title">コードの説明 🐍</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.diff()</span></code>は差分を計算するメソッドであり，引数の数（デフォルトは<code class="docutils literal notranslate"><span class="pre">1</span></code>）は何期前の値と差分を計算するかを指定する。</p></li>
<li><p>引数<code class="docutils literal notranslate"><span class="pre">grid=True</span></code>はグリッド線を表示する。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Pandas</span></code>のメソッド<code class="docutils literal notranslate"><span class="pre">plot</span></code>は図を表示し，同時に図の「軸（axis）」を返すが，次のコードのように、そのメソッド<code class="docutils literal notranslate"><span class="pre">.grid()</span></code>を使っても同じ表示となる。</p></li>
</ul>
</li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ax_</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;gdp_growth_quarter&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;GDP四半期成長率（％）&#39;</span><span class="p">)</span>
<span class="n">ax_</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>新聞などで「前年同期比成長率」という表現をみたことがあると思うが，<code class="docutils literal notranslate"><span class="pre">diff()</span></code>の引数を<code class="docutils literal notranslate"><span class="pre">4</span></code>にすることにより，前年同期比の成長率を計算することができる。それを図示してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;gdp_growth_annual&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="mi">100</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;gdp_log&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;gdp_growth_annual&#39;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;GDP前年同期比成長率（％）&#39;</span><span class="p">,</span>
        <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/715821c93cc2c4e51ec9de77063989c19780f037169a3f50f76fdf6cabe82d36.png" src="_images/715821c93cc2c4e51ec9de77063989c19780f037169a3f50f76fdf6cabe82d36.png" />
</div>
</div>
<p>上の図と比べると次の特徴がある。</p>
<ul class="simple">
<li><p>縦軸の幅が違う。１四半期と４四半期（１年）の成長率の違いが反映されている。</p></li>
<li><p>四半期データの変動は短期的な変化を追うには適している。しかし，変動が激しいため、長期的な成長率の予測には不向きだろう。一方、前年同期比のデータは，景気の基調を捉えるのに適していると言われている。</p></li>
<li><p>データには季節性があり，前年同期比成長率は季節調整されていないデータに使われることが多い。（ちなみに，<code class="docutils literal notranslate"><span class="pre">df</span></code>に含まれる<code class="docutils literal notranslate"><span class="pre">gdp</span></code>のデータは季節調整済みである。）</p></li>
</ul>
<p>最高値と最小値を計算してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;gdp_growth_annual&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;gdp_growth_annual&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(7.84950729916023, -10.174721491547523)
</pre></div>
</div>
</div>
</div>
<p>1980年代後半ののバブル景気には約<code class="docutils literal notranslate"><span class="pre">7.8</span></code>％増加しているが，コロナ禍では約<code class="docutils literal notranslate"><span class="pre">10</span></code>％以上下落している。</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>次の点を知っておくのも有用だろう。</p>
<ul>
<li><p>次の式を使うと四半期成長率を年率換算することもできる。</p>
<div class="math notranslate nohighlight">
\[
    g_{\text{年率換算成長率}}=\left(1+g_{\text{四半期成長率}}\right)^4-1
    \]</div>
<p><span class="math notranslate nohighlight">\(g_{\text{四半期成長率}}\)</span>は４期続くことを想定した成長率である。</p>
</li>
<li><p>年次データを使うとGDPの値は均されるので変化率は低めに出る。</p></li>
</ul>
</div>
</section>
<section id="id3">
<h2>GDPの構成要素<a class="headerlink" href="#id3" title="Link to this heading">#</a></h2>
<p>次式は所得恒等式である。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    GDP=消費＋投資＋政府支出＋純貿易（輸出ー輸入）
</pre></div>
</div>
<p>GDPに対してそれぞれ構成要素は何％を占め，どのように推移したかを図示する為に，まず変数を計算する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 消費の割合</span>
<span class="n">con_gdp_ratio</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;consumption&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;gdp&#39;</span><span class="p">]</span>

<span class="c1"># 投資の割合</span>
<span class="n">inv_gdp_ratio</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;investment&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;gdp&#39;</span><span class="p">]</span>

<span class="c1"># 政府支出の割合</span>
<span class="n">gov_gdp_ratio</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;government&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;gdp&#39;</span><span class="p">]</span>

<span class="c1"># 純輸出の割合</span>
<span class="n">net_exp_gdp_ratio</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="p">(</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;exports&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;imports&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;gdp&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>それぞれの平均を<code class="docutils literal notranslate"><span class="pre">for</span></code>ループで計算し表示してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ratio_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">con_gdp_ratio</span><span class="p">,</span> <span class="n">inv_gdp_ratio</span><span class="p">,</span>
              <span class="n">gov_gdp_ratio</span><span class="p">,</span> <span class="n">net_exp_gdp_ratio</span><span class="p">]</span>

<span class="n">label_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Consumption&#39;</span><span class="p">,</span> <span class="s1">&#39;Investment&#39;</span><span class="p">,</span> <span class="s1">&#39;Gov Exp&#39;</span><span class="p">,</span> <span class="s1">&#39;Net Exports&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ratio_list</span><span class="p">,</span> <span class="n">label_list</span><span class="p">):</span>
    
    <span class="n">avr</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="si">{</span><span class="n">avr</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Consumption 	55.5
Investment 	21.7
Gov Exp 	25.3
Net Exports 	-1.1
</pre></div>
</div>
</div>
</div>
<p>消費はGDPの<code class="docutils literal notranslate"><span class="pre">50</span></code>％以上あり，GDPの約1/4が政府支出となっている。消費とは対照的に，投資は<code class="docutils literal notranslate"><span class="pre">20</span></code>％程であり消費の約半分以下である。（小数点第一位までしか表示していないため合計は100にならない。）</p>
<p>次に推移を確認する。同じように<code class="docutils literal notranslate"><span class="pre">for</span></code>ループを使うと簡単に表示できる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ratio_list</span><span class="p">,</span><span class="n">label_list</span><span class="p">):</span>
    
    <span class="n">r</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">l</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f90cff04a1bcd42b117b41ba9fc4f071261676ed4425a4f26f42ebef5433eb9d.png" src="_images/f90cff04a1bcd42b117b41ba9fc4f071261676ed4425a4f26f42ebef5433eb9d.png" />
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">zip()</span></code>について説明する。<code class="docutils literal notranslate"><span class="pre">zip()</span></code>はループによく使われる便利な関数である。以下の単純な<code class="docutils literal notranslate"><span class="pre">for</span></code>ループ</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">ratio_list</span><span class="p">:</span>
    <span class="n">r</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>にはループ用の変数が<code class="docutils literal notranslate"><span class="pre">r</span></code>の１種類しかない。これでも図示することは可能である。しかし凡例を追加するためには<code class="docutils literal notranslate"><span class="pre">label_list</span></code>も<code class="docutils literal notranslate"><span class="pre">for</span></code>ループの中で同時に使う必要がある。そのような場合に便利な関数が<code class="docutils literal notranslate"><span class="pre">zip()</span></code>である。引数に<code class="docutils literal notranslate"><span class="pre">ratio_list</span></code>と<code class="docutils literal notranslate"><span class="pre">label_list</span></code>を入れると，同時に順番に要素にアクセスできる。それぞれの要素を割り当てる変数として<code class="docutils literal notranslate"><span class="pre">r</span></code>と<code class="docutils literal notranslate"><span class="pre">l</span></code>を使っている。<code class="docutils literal notranslate"><span class="pre">r</span></code>と<code class="docutils literal notranslate"><span class="pre">l</span></code>の間に<code class="docutils literal notranslate"><span class="pre">,</span></code>を入れることにより，それぞれ別のリストの要素を捉えることができる。</p>
</li>
<li><p>この<code class="docutils literal notranslate"><span class="pre">for</span></code>ループは以下と等しい。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">con_gdp_ratio</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Consumption&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">inv_gdp_ratio</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Investment&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">gov_gdp_ratio</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Gov Exp&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">net_exp_gdp_ratio</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Net Exports&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>もちろんこれでも良いが，コードを書く際は極力同じような行を繰り返すのではなくループを使ってまとめる方が良い。第一の理由は，簡単なエラーの可能性を軽減することができることだ。リピートして書く場合，1行をコピペしその後に1行ずつ修正をするパターンが多いが，最初の１行目が間違っている場合，全ての行を修正する必要が発生する。その際に修正し忘れることがある。第二の理由は，コードの修正も簡単になるためである。例えば，<code class="docutils literal notranslate"><span class="pre">linewidth=2</span></code>を設定したいとしよう。<code class="docutils literal notranslate"><span class="pre">for</span></code>ループの場合は一箇所に加えるだけで済むことになる。</p>
</li>
</ul>
</div>
<p>景気の動向によって上下することがわかる。例えば，リマン・ショック後には投資が大きく下落し少しずつしか上昇しない。一方，景気悪化に反応し政府支出の割合は上昇している。またバブル景気（1986年から1991年まで）ではその逆が起こっており，順位が逆転する程である。コロナ禍の影響もプロットにハッキリと現れている。</p>
</section>
<section id="id4">
<h2>失業率<a class="headerlink" href="#id4" title="Link to this heading">#</a></h2>
<p>次に失業のデータをプロットしてみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;unemployment_rate&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;失業率（％）&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: title={&#39;center&#39;: &#39;失業率（％）&#39;}&gt;
</pre></div>
</div>
<img alt="_images/3c241b80e1b70da931e269d5915234740a8355e3d62e4381ab6102fd8557d03f.png" src="_images/3c241b80e1b70da931e269d5915234740a8355e3d62e4381ab6102fd8557d03f.png" />
</div>
</div>
<p>1995年頃から2015年頃の約<code class="docutils literal notranslate"><span class="pre">20</span></code>年間は、その前後と比較して高い値になっている。
2002年第3四半期の一つ目のピークは<code class="docutils literal notranslate"><span class="pre">5.43</span></code>％であり、バブル崩壊の影響によるものである。就職氷河期と呼ばれる期間である。
2009年第3四半期の二つ目のピークはリーマンショックによる影響であり、同じ<code class="docutils literal notranslate"><span class="pre">5.43</span></code>％である。
2020年第4四半期にも<code class="docutils literal notranslate"><span class="pre">3.07</span></code>％のピークがあるが、コロナ感染症に端を発している。
バブル崩壊による失業率の上昇は比較的にじわじわと動いているが、リーマンショックとコロナショックによる影響は失業率の急上昇として現れている。</p>
<p>少し複雑になるが、<code class="docutils literal notranslate"><span class="pre">for</span></code>ループを使い、<code class="docutils literal notranslate"><span class="pre">10</span></code>年毎の平均失業率を計算し、上の失業率の図に重ねてプロットしてみよう。
まず再度<code class="docutils literal notranslate"><span class="pre">df</span></code>にある<code class="docutils literal notranslate"><span class="pre">unemployment_rate</span></code>を確認しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;unemployment_rate&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>unemployment_rate</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1980-01-01</th>
      <td>1.900000</td>
    </tr>
    <tr>
      <th>1980-04-01</th>
      <td>1.966667</td>
    </tr>
    <tr>
      <th>1980-07-01</th>
      <td>2.033333</td>
    </tr>
    <tr>
      <th>1980-10-01</th>
      <td>2.166667</td>
    </tr>
    <tr>
      <th>1981-01-01</th>
      <td>2.200000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>行ラベルを使い<code class="docutils literal notranslate"><span class="pre">unemployment_rate</span></code>の値にアクセスできるが、行インデックスを使うことも可能である。
例えば、次のコードは最初の行を<code class="docutils literal notranslate"><span class="pre">Series</span></code>として抽出している。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;unemployment_rate&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>unemployment_rate    1.9
Name: 1980-01-01 00:00:00, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>このように以下では、行インデックス番号を使い各<code class="docutils literal notranslate"><span class="pre">10</span></code>年間の平均を計算する。
<code class="docutils literal notranslate"><span class="pre">1</span></code>年間には<code class="docutils literal notranslate"><span class="pre">4</span></code>四半期があるのため、<code class="docutils literal notranslate"><span class="pre">10</span></code>年間には<code class="docutils literal notranslate"><span class="pre">40</span></code>四半期ある。
従って、最初の行のインデックスは<code class="docutils literal notranslate"><span class="pre">0</span></code>なため、各<code class="docutils literal notranslate"><span class="pre">10</span></code>年間の最初の四半期は次のコードで捉えることができる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_decade</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="mi">40</span><span class="p">)</span>

<span class="nb">list</span><span class="p">(</span><span class="n">start_decade</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 40, 80, 120, 160]
</pre></div>
</div>
</div>
</div>
<p>この結果を使い、次のコードで平均失業率を計算することができる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#1</span>
<span class="n">u_idx</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;unemployment_rate&#39;</span><span class="p">)</span>

<span class="c1">#2</span>
<span class="n">u_lst</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">start</span> <span class="ow">in</span> <span class="n">start_decade</span><span class="p">:</span>

    <span class="c1">#3</span>
    <span class="n">u_avr</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">start</span><span class="o">+</span><span class="mi">40</span><span class="p">,</span> <span class="n">u_idx</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="c1">#4</span>
    <span class="n">u_lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">u_avr</span><span class="p">)</span>

<span class="n">u_lst</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2.495, 3.041666666666667, 4.654166666666667, 3.565, 2.6937499999999996]
</pre></div>
</div>
</div>
</div>
<p>このリストの最初の値が<code class="docutils literal notranslate"><span class="pre">1980</span></code>年代の平均失業率であり、最後の値が<code class="docutils literal notranslate"><span class="pre">2020</span></code>年代の平均失業率となる。</p>
<div class="admonition- admonition">
<p class="admonition-title">コードの説明</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">#1</span></code>：右辺では列<code class="docutils literal notranslate"><span class="pre">unemployment_rate</span></code>の列インデックスを抽出し、左辺の変数<code class="docutils literal notranslate"><span class="pre">u_idx</span></code>に割り当てている。右辺では、まず<code class="docutils literal notranslate"><span class="pre">df.columns</span></code>で列ラベルを抽出し、<code class="docutils literal notranslate"><span class="pre">.tolist()</span></code>を使いリストに変換している。これで、列ラベルが要素となるリストが作成される。そのリストのメソッド<code class="docutils literal notranslate"><span class="pre">.index()</span></code>を使うと、リストに含まれる要素のインデックス番号を抽出することができる。ここでは<code class="docutils literal notranslate"><span class="pre">unemployment_rate</span></code>のインデックス番号を抽出している。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#2</span></code>：平均失業率を格納する空のリスト</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#3</span></code>：<code class="docutils literal notranslate"><span class="pre">df.iloc[]</span></code>を使い、各<code class="docutils literal notranslate"><span class="pre">10</span></code>年間の失業率を抽出し、<code class="docutils literal notranslate"><span class="pre">.mean()</span></code>を使い、その平均を計算している。<code class="docutils literal notranslate"><span class="pre">+40</span></code>は<code class="docutils literal notranslate"><span class="pre">10</span></code>年に含まれる四半期の数を表している。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#4</span></code>：<code class="docutils literal notranslate"><span class="pre">#3</span></code>で計算した平均失業率を<code class="docutils literal notranslate"><span class="pre">u_lst</span></code>に追加している。</p></li>
</ul>
</div>
<p>次に図示して確かめてみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;unemployment_rate&#39;</span><span class="p">,</span>       <span class="c1">#1</span>
             <span class="n">label</span><span class="o">=</span><span class="s1">&#39;失業率（％）&#39;</span><span class="p">)</span>          <span class="c1">#2</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">start</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="n">start_decade</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">):</span> <span class="c1">#3</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">u_lst</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>                   <span class="c1">#4</span>
              <span class="n">xmin</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">start</span><span class="p">],</span>       <span class="c1">#5</span>
              <span class="n">xmax</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">start</span><span class="o">+</span><span class="mi">40</span><span class="p">],</span>    <span class="c1">#6</span>
              <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>                <span class="c1">#7</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">start_decade</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>                  <span class="c1">#8</span>

<span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">u_lst</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>                      <span class="c1">#9</span>
          <span class="n">xmin</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">start</span><span class="p">],</span>           <span class="c1">#10</span>
          <span class="n">xmax</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>              <span class="c1">#11</span>
          <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>                    <span class="c1">#12</span>
          <span class="n">label</span><span class="o">=</span><span class="s1">&#39;10年間平均&#39;</span><span class="p">)</span>              <span class="c1">#13</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>                               <span class="c1">#14</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/27f8d2aa9f4373773e8af1908fee377a797cccfad4657333aeb79086ef44713a.png" src="_images/27f8d2aa9f4373773e8af1908fee377a797cccfad4657333aeb79086ef44713a.png" />
</div>
</div>
<div class="admonition- admonition">
<p class="admonition-title">コードの説明</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">#1</span></code>：上の図と同じ<code class="docutils literal notranslate"><span class="pre">unemployment_rate</span></code>のプロットを表示するが、それと同時に軸を<code class="docutils literal notranslate"><span class="pre">ax</span></code>に割り当てる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#2</span></code>：凡例の表示を設定する。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#3</span></code>：<code class="docutils literal notranslate"><span class="pre">start_decade</span></code>の最後の要素以外で<code class="docutils literal notranslate"><span class="pre">for</span></code>ループを実行する。また<code class="docutils literal notranslate"><span class="pre">enumerate()</span></code>関数を使い、<code class="docutils literal notranslate"><span class="pre">start_decade</span></code>の要素のインデックス番号を<code class="docutils literal notranslate"><span class="pre">i</span></code>に割り当て、要素は<code class="docutils literal notranslate"><span class="pre">start</span></code>に割り当てる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#4</span></code>：<code class="docutils literal notranslate"><span class="pre">ax</span></code>のメソッド<code class="docutils literal notranslate"><span class="pre">.hlines()</span></code>を使って、赤い横線を表示する。<code class="docutils literal notranslate"><span class="pre">u_lst[i]</span></code>は横線を引く縦軸の値。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#5</span></code>：<code class="docutils literal notranslate"><span class="pre">xmin</span></code>は横線の始点を指定する引数。<code class="docutils literal notranslate"><span class="pre">df.index[start]</span></code>を使い、各<code class="docutils literal notranslate"><span class="pre">10</span></code>年間の最初の行を指定している。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#6</span></code>：<code class="docutils literal notranslate"><span class="pre">xmax</span></code>は横線の終点を指定する引数。<code class="docutils literal notranslate"><span class="pre">df.index[start+40]</span></code>を使い、各<code class="docutils literal notranslate"><span class="pre">10</span></code>年間の最後の行を指定している。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#7</span></code>：横線の色を赤に設定する。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#8</span></code>：<code class="docutils literal notranslate"><span class="pre">2020</span></code>年代には<code class="docutils literal notranslate"><span class="pre">40</span></code>の四半期がないので別に図示する。<code class="docutils literal notranslate"><span class="pre">2020</span></code>年代の最初の行インデックスを<code class="docutils literal notranslate"><span class="pre">start</span></code>に割り当てる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#9</span></code>：<code class="docutils literal notranslate"><span class="pre">#4</span></code>と同じ。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#10</span></code>：<code class="docutils literal notranslate"><span class="pre">#5</span></code>と同じ。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#11</span></code>：<code class="docutils literal notranslate"><span class="pre">#6</span></code>と同じにすると、<code class="docutils literal notranslate"><span class="pre">2020</span></code>年代には<code class="docutils literal notranslate"><span class="pre">40</span></code>の四半期がないのでエラーが発生する。エラーを避けるために、<code class="docutils literal notranslate"><span class="pre">df.index[-1]</span></code>は最後の行インデックスを抽出している。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#12</span></code>：<code class="docutils literal notranslate"><span class="pre">#7</span></code>と同じ。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#13</span></code>：<code class="docutils literal notranslate"><span class="pre">#2</span></code>と同じ。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#14</span></code>：凡例を表示する。</p></li>
</ul>
</div>
<p>1990年頃から2020年頃の間に、ピークが<code class="docutils literal notranslate"><span class="pre">2</span></code>つある大きな山がそびえ立っている。
一方、その両端の平均成長率は約<code class="docutils literal notranslate"><span class="pre">2.5</span></code>％である。
ここから見えてくるのは、一つのストーリー（考え方、もしくは仮説）である。
<code class="docutils literal notranslate"><span class="pre">2.5</span></code>％程度が長期的な失業率とすると、バブル崩壊とリーマンショックの<code class="docutils literal notranslate"><span class="pre">2</span></code>大ショックにより、長期的均衡から大きく<code class="docutils literal notranslate"><span class="pre">2</span></code>倍以上の値に乖離し、<code class="docutils literal notranslate"><span class="pre">20</span></code>年以上掛けてかけてゆっくりとしたペースで労働市場での大規模な「調整」が発生したようである。
それは<code class="docutils literal notranslate"><span class="pre">10</span></code>年間の平均失業率にもはっきりと現れている。
平均成長率の階段を上り、そして下りる日本経済である。</p>
</section>
<section id="id5">
<h2>トレンドと変動<a class="headerlink" href="#id5" title="Link to this heading">#</a></h2>
<section id="id6">
<h3>説明<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<p>上の分析から明らかなことは，マクロ変数は変動するということであり，正しくそれが景気循環を表している。
ここでは景気循環について，もう一歩踏み込んで考えてみる。</p>
<p>マクロ変数はトレンドと変動（サイクル）に分解することができる。その方法は２つあり、マクロ変数の性質によって次のように使い分ける。</p>
<ul>
<li><p>GDPのように長期的なトレンドが右上がりの変数の場合、<span class="math notranslate nohighlight">\(Y\)</span>をGDPとすると、次式のように２つの項の掛け算で表すことができる。</p>
<div class="math notranslate nohighlight" id="equation-eq-10-decompose">
<span class="eqno">(100)<a class="headerlink" href="#equation-eq-10-decompose" title="Link to this equation">#</a></span>\[
    Y_t=Y_t^{\text{trend}}\times Y_t^{\text{cycle}}
    \]</div>
</li>
<li><p>失業率のように右上がりのトレンドがない場合（自然失業率が一定であればトレンドはないことになる）、<span class="math notranslate nohighlight">\(u\)</span>を失業率とすると、<span class="math notranslate nohighlight">\(u\)</span>を次式のように２つの項の足し算で表すことができる。</p>
<div class="math notranslate nohighlight" id="equation-eq-10-decompose-plus">
<span class="eqno">(101)<a class="headerlink" href="#equation-eq-10-decompose-plus" title="Link to this equation">#</a></span>\[
    u_t=u_t^{\text{trend}}+u_t^{\text{cycle}}
    \]</div>
</li>
</ul>
<p>ここで<span class="math notranslate nohighlight">\(Y_t^{\text{trend}}\)</span>と<span class="math notranslate nohighlight">\(u_t^{\text{trend}}\)</span>は各変数の長期的な傾向や値を表す。
一方，<span class="math notranslate nohighlight">\(Y_t^{\text{cycle}}\)</span>と<span class="math notranslate nohighlight">\(u_t^{\text{cycle}}\)</span>は短期的な景気循環を捉えている。</p>
</section>
<section id="id7">
<h3>トレンドの計算<a class="headerlink" href="#id7" title="Link to this heading">#</a></h3>
<p>内閣府は景気循環を「山」と「谷」の２つに分けて<a class="reference external" href="https://www.esri.cao.go.jp/jp/stat/di/hiduke.html">景気基準日付</a>を発表している。イメージ的には、GDPがトレンドを上回っている期間を「山」，下回っている期間を「谷」と考えて良いだろう。図示すると次のようになる。</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">trend_cycle</span><span class="p">():</span>
    
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
    <span class="kn">import</span> <span class="nn">matplotlib.lines</span> <span class="k">as</span> <span class="nn">mlines</span>
    
    <span class="c1"># フォントのサイズ</span>
    <span class="n">font_largest</span><span class="o">=</span><span class="mi">30</span>
    <span class="n">font_large</span><span class="o">=</span><span class="mi">20</span>

    <span class="c1"># GDPのプロット</span>
    <span class="n">xlow</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">xhigh</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">xlow</span><span class="p">,</span> <span class="n">xhigh</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">yfunc</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mf">0.1</span><span class="o">*</span><span class="n">x</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">yfunc</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;GDP&#39;</span><span class="p">)</span>

    <span class="c1"># トレンド線のプロット</span>
    <span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xlow</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="n">xhigh</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">trend_line</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span> <span class="n">yfunc</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">-</span><span class="n">yfunc</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">yfunc</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">trend_line</span><span class="p">(</span><span class="n">xx</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;トレンド&#39;</span><span class="p">)</span>

    <span class="c1"># 縦点線のプロット</span>
    <span class="n">ylow</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.68</span>
    
    <span class="n">tani0</span> <span class="o">=</span> <span class="n">mlines</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="n">ylow</span><span class="p">,</span> <span class="n">yfunc</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)],</span>  <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="n">yama</span> <span class="o">=</span> <span class="n">mlines</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="n">ylow</span><span class="o">+</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">yfunc</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)],</span>  <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="n">tani1</span> <span class="o">=</span> <span class="n">mlines</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">5</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">5</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="n">ylow</span><span class="p">,</span> <span class="n">yfunc</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">5</span><span class="o">/</span><span class="mi">2</span><span class="p">)],</span>  <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">tani0</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">yama</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">tani1</span><span class="p">)</span>

    <span class="c1"># 矢印のプロット（拡張と後退）</span>
    <span class="k">for</span> <span class="n">dx</span> <span class="ow">in</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">y</span><span class="o">=-</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                 <span class="n">width</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">head_length</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
                 <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">dx</span> <span class="ow">in</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">y</span><span class="o">=-</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                 <span class="n">width</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">head_length</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
                 <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

    <span class="c1"># 矢印のプロット（全循環）</span>
    <span class="n">start_arrow_shift</span> <span class="o">=</span> <span class="mf">0.8</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">start_arrow_shift</span><span class="p">,</span> <span class="n">y</span><span class="o">=-</span><span class="mf">1.5</span><span class="p">,</span>
             <span class="n">dx</span><span class="o">=-</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">-</span><span class="n">start_arrow_shift</span><span class="p">),</span> <span class="n">dy</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
             <span class="n">width</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">head_length</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
             <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">start_arrow_shift</span><span class="p">,</span> <span class="n">y</span><span class="o">=-</span><span class="mf">1.5</span><span class="p">,</span>
             <span class="n">dx</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">-</span><span class="n">start_arrow_shift</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
             <span class="n">width</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">head_length</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
             <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

    <span class="c1"># 注釈の挿入</span>
    <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">5</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">xshift</span> <span class="o">=</span> <span class="mf">0.33</span>
    <span class="n">yshift</span> <span class="o">=</span> <span class="mf">0.2</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;谷&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">x0</span><span class="o">-</span><span class="n">xshift</span><span class="p">,</span> <span class="n">yfunc</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span><span class="o">+</span><span class="n">yshift</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="n">font_largest</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;山&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">xshift</span><span class="p">,</span> <span class="n">yfunc</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span><span class="o">+</span><span class="n">yshift</span><span class="p">),</span> <span class="n">annotation_clip</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">font_largest</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;谷&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">x2</span><span class="o">-</span><span class="n">xshift</span><span class="p">,</span> <span class="n">yfunc</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span><span class="o">+</span><span class="n">yshift</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="n">font_largest</span><span class="p">)</span>

<span class="c1">#     ax.annotate(&#39;好況&#39;, xy=(xlow-1.1,0.2), annotation_clip=False, size=font_large, color=&#39;green&#39;)</span>
<span class="c1">#     ax.annotate(&#39;不況&#39;, xy=(xlow-1.1,-0.5), annotation_clip=False, size=font_large, color=&#39;red&#39;)</span>
<span class="c1">#     ax.annotate(&#39;好況&#39;, xy=(xhigh+0.3,1.25), annotation_clip=False, size=font_large, color=&#39;green&#39;)</span>
<span class="c1">#     ax.annotate(&#39;不況&#39;, xy=(xhigh+0.3,0.55), annotation_clip=False, size=font_large, color=&#39;red&#39;)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;拡張&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span><span class="o">-</span><span class="mf">1.05</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">font_large</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;後退&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="o">-</span><span class="mf">1.05</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">font_large</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;全循環&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="mf">0.65</span><span class="p">,</span><span class="o">-</span><span class="mf">1.6</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">font_large</span><span class="p">)</span>

    <span class="c1"># 横軸のラベル，凡例を追加，縦軸の表示範囲の設定</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;時間&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">font_large</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymax</span><span class="o">=</span><span class="mf">2.3</span><span class="p">)</span>

    <span class="c1"># 縦軸・横軸のラベルと目盛の削除</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>

    <span class="c1"># 枠を削除</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="s1">&#39;bottom&#39;</span><span class="p">]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

<span class="n">trend_cycle</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/4ac340b84e29d9d55118186f3b02d662a6891f174f87088cfcb1acbf23185bf5.png" src="_images/4ac340b84e29d9d55118186f3b02d662a6891f174f87088cfcb1acbf23185bf5.png" />
</div>
</div>
<p>この図から，拡張・後退はGDPの変化を捉えていることが分かる。また，このプロットは<code class="docutils literal notranslate"><span class="pre">NumPy</span></code>のコサイン関数を使って描画しているので，「谷」と「山」が発生した時期を簡単に見分けることができる。しかし，上のGDPデータのプロットを見直すと，「谷」と「山」がいつだったかを決めるのは簡単な問題ではないと想像できるだろう。実際，内閣府は単にGDPのデータを眺めるだけではなく<a class="reference external" href="https://www.esri.cao.go.jp/jp/stat/di/menu_di.html">景気動向指数</a>を含め様々なデータに基づき，「谷」と「山」の時期を確定している。</p>
<p>景気循環を考える上で重要な役割を果たすのがトレンドである。トレンドはどのように計算するのだろうか。実は，決まった計算方法があるわけではなく，いろいろな考え方がある。実際，内閣府と日本銀行は独自の方法でGDPトレンドを算出している。</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www5.cao.go.jp/keizai3/getsurei/getsurei-index.html#sonota">内閣府のデータ</a></p>
<ul>
<li><p>「潜在GDP」がトレンドに対応しており，「GDPギャップ」はトレンドからの％乖離を表している。</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://www.boj.or.jp/research/research_data/gap/index.htm/">日本銀行のデータ</a></p>
<ul>
<li><p>「潜在成長率」はトレンドの成長率に対応しており，「需給ギャップ」がトレンドからの％乖離を表している。</p></li>
</ul>
</li>
</ul>
<p>いずれにしろ，どのようにトレンドを決めたとしても，景気循環が人々の厚生に大きな影響を及ぼすことには変わりはない。不況は失業や様々な社会問題（例えば，犯罪や自殺）につながる。好況でも問題が無いわけではない。例えば，高いインフレが発生し資産価値（例えば，貨幣）が暴落し通常の生活に支障が出ることもある。またバブル景気が示すように「山」は次の「谷」の芽を育む期間となりえる。</p>
<p>以下では，データを使い景気循環<span class="math notranslate nohighlight">\(Y_t^{\text{cycle}}\)</span>の特徴を調べるが，まず上の式<a class="reference internal" href="#equation-eq-10-decompose">(100)</a>を対数化し次式に書き換える。</p>
<div class="math notranslate nohighlight" id="equation-eq-10-decompose-log">
<span class="eqno">(102)<a class="headerlink" href="#equation-eq-10-decompose-log" title="Link to this equation">#</a></span>\[
y_t^{\text{cycle}}=y_t-y_t^{\text{trend}}
\]</div>
<p>ここで小文字は大文字の変数を対数化した値である</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(y_t\equiv\log(Y_t)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(y_t^{\text{cycle}}\equiv\log(Y_t^{\text{cycle}})\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(y_t^{\text{trend}}\equiv\log(Y_t^{\text{trend}})\)</span></p></li>
</ul>
<p><span class="math notranslate nohighlight">\(y_t^{\text{cycle}}\)</span>をより直感的に解釈するために式<a class="reference internal" href="#equation-eq-10-decompose-log">(102)</a>の右辺を次のように近似しよう。</p>
<div class="math notranslate nohighlight" id="equation-eq-10-decompose-log-approx">
<span class="eqno">(103)<a class="headerlink" href="#equation-eq-10-decompose-log-approx" title="Link to this equation">#</a></span>\[
y_t^{\text{cycle}}
=\log\left(\frac{Y_t}{Y_t^{\text{trend}}}\right)
    \approx
    \dfrac{Y_t}{Y_t^{\text{trend}}}-1
    =\dfrac{Y_t-Y_t^{\text{trend}}}{Y_t^{\text{trend}}}
\]</div>
<p>この式から次のことが言える。</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(y_t^{\text{cycle}}\)</span>は変数<span class="math notranslate nohighlight">\(Y_t\)</span>のトレンドからの乖離の割合を表している。</p></li>
<li><p><span class="math notranslate nohighlight">\(100\times y_t^{\text{cycle}}\)</span>は変数<span class="math notranslate nohighlight">\(Y_t\)</span>のトレンドからの％乖離を表している。</p></li>
</ul>
<p>ここまでの説明から，景気循環を捉える項<span class="math notranslate nohighlight">\(y_t^{\text{cycle}}\)</span>は変数の値とトレンドとの残差によって決まることがわかる。換言すると，景気循環の特徴はトレンドをどのように考えるかに依存しており，トレンドの算出方法をどうするか決めるかが重要なポイントとなる。ここでは，内閣府や日本銀行の複雑な手法ではなく，マクロ経済学研究でスタンダードなツールとなっている<a class="reference external" href="https://www.google.co.jp/search?q=Hodrick%E2%80%93Prescott%E3%83%95%E3%82%A3%E3%83%AB%E3%82%BF%E3%83%BC">Hodrick–Prescottフィルター</a>と呼ばれる手法を使うことにする。詳細についての説明は控え，単に<code class="docutils literal notranslate"><span class="pre">py4macro</span></code>に含まれる関数<code class="docutils literal notranslate"><span class="pre">trend</span></code>を使ってトレンド抽出を行うことにする。使い方は次のコードで確認できる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">py4macro</span><span class="o">.</span><span class="n">trend</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function trend in module py4macro.py4macro:

trend(s, lamb=1600)
    |
    | 引数:
    |     s: Seriesもしくは１列のDataFrameとし，行のラベルはDatetimeIndexとすること。
    |     lamb: 四半期用のデータでは通常の値（デフォルト：1600）
    |
    | 返り値:
    |     Hodrick-Prescott filterで計算したtrend（トレンド）のSeries
    |
    | 例: py4macro.trend(df.loc[:,&#39;gdp&#39;])
</pre></div>
</div>
</div>
</div>
<p>使い方は簡単で，トレンドを計算したい変数の<code class="docutils literal notranslate"><span class="pre">Series</span></code>もしくは１列の<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を引数に設定し実行するとトレンドが返される。ただ，HPフィルターは線形トレンドが仮定されているため，次の点に注意すること。</p>
<ul>
<li><p>GDPや消費の様に長期的に増加している変数は対数化し，<code class="docutils literal notranslate"><span class="pre">.trend()</span></code>関数の引数に使うこと。そうすることにより、式<a class="reference internal" href="#equation-eq-10-decompose-log">(102)</a>を使い<span class="math notranslate nohighlight">\(y_t^{\text{cycle}}\)</span>を計算することができる。</p>
<div class="math notranslate nohighlight">
\[
    y_t^{\text{cycle}}=y_t-y_t^{\text{trend}}
    \]</div>
</li>
<li><p>失業率やインフレ率の様に長期的にはトレンドがない変数は，そのまま<code class="docutils literal notranslate"><span class="pre">.trend()</span></code>関数の引数に使うこと。それにより、式<a class="reference internal" href="#equation-eq-10-decompose-plus">(101)</a>に従って、次式を計算することができる。</p>
<div class="math notranslate nohighlight">
\[
    u_t^{\text{cycle}}=u_t-u_t^{\text{trend}}
    \]</div>
</li>
</ul>
<p>まずGDPとその構成要素を対数化した変数とそのトレンドを計算し<code class="docutils literal notranslate"><span class="pre">df</span></code>に追加しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var_lst</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;gdp&#39;</span><span class="p">,</span>
           <span class="s1">&#39;consumption&#39;</span><span class="p">,</span>
           <span class="s1">&#39;investment&#39;</span><span class="p">,</span>
           <span class="s1">&#39;government&#39;</span><span class="p">,</span>
           <span class="s1">&#39;exports&#39;</span><span class="p">,</span>
           <span class="s1">&#39;imports&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">var_lst</span><span class="p">:</span>
    
    <span class="n">df</span><span class="p">[</span><span class="n">v</span><span class="o">+</span><span class="s1">&#39;_log&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">v</span><span class="p">]</span> <span class="p">)</span>  <span class="c1">#1</span>
    <span class="n">df</span><span class="p">[</span><span class="n">v</span><span class="o">+</span><span class="s1">&#39;_log_trend&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">py4macro</span><span class="o">.</span><span class="n">trend</span><span class="p">(</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">v</span><span class="o">+</span><span class="s1">&#39;_log&#39;</span><span class="p">]</span> <span class="p">)</span>  <span class="c1">#2</span>
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">#1</span></code>：対数化した変数を新たな列として追加している。列ラベルを<code class="docutils literal notranslate"><span class="pre">v+'_log'</span></code>としているのは元々の変数名の後に<code class="docutils literal notranslate"><span class="pre">_logを追加するためである。例えば，１回目のループの新たな列ラベルは</span></code>gdp_log<code class="docutils literal notranslate"><span class="pre">となり，２回目のループでは</span></code>consumption_log`となる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#2</span></code>：対数化した変数のトレンドを新たな列として追加している。列ラベルを<code class="docutils literal notranslate"><span class="pre">v+'_log_trend'</span></code>としているのは元々の変数名の後に<code class="docutils literal notranslate"><span class="pre">_log_trend</span></code>を追加するためである。例えば，１回目のループの新たな列ラベルは<code class="docutils literal notranslate"><span class="pre">gdp_log_trend</span></code>となり，２回目のループでは<code class="docutils literal notranslate"><span class="pre">consumption_log_trend</span></code>となる。</p></li>
</ul>
</div>
<p><code class="docutils literal notranslate"><span class="pre">df</span></code>の属性<code class="docutils literal notranslate"><span class="pre">.columns</span></code>を使い，列ラベルを表示して確認してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;gdp&#39;, &#39;consumption&#39;, &#39;investment&#39;, &#39;government&#39;, &#39;exports&#39;, &#39;imports&#39;,
       &#39;capital&#39;, &#39;employed&#39;, &#39;unemployed&#39;, &#39;unemployment_rate&#39;, &#39;hours&#39;,
       &#39;total_hours&#39;, &#39;inflation&#39;, &#39;price&#39;, &#39;deflator&#39;, &#39;gdp_log&#39;,
       &#39;gdp_growth_quarter&#39;, &#39;gdp_growth_annual&#39;, &#39;gdp_log_trend&#39;,
       &#39;consumption_log&#39;, &#39;consumption_log_trend&#39;, &#39;investment_log&#39;,
       &#39;investment_log_trend&#39;, &#39;government_log&#39;, &#39;government_log_trend&#39;,
       &#39;exports_log&#39;, &#39;exports_log_trend&#39;, &#39;imports_log&#39;, &#39;imports_log_trend&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">_log</span></code>と<code class="docutils literal notranslate"><span class="pre">_log_trend</span></code>が追加された変数が新たに作られていることが確認できる。</p>
</section>
<section id="id8">
<h3>GDPのトレンドからの乖離率<a class="headerlink" href="#id8" title="Link to this heading">#</a></h3>
<p>対数化したGDPの変数を作成しトレンドと重ねて図示してみる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;gdp_log&#39;</span><span class="p">,</span><span class="s1">&#39;gdp_log_trend&#39;</span><span class="p">])</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ec54c69cc3449f31835a751675c973e494487d02abc51c67e2a381a256474a9d.png" src="_images/ec54c69cc3449f31835a751675c973e494487d02abc51c67e2a381a256474a9d.png" />
</div>
</div>
<p>トレンドは直線ではなくスムーズな曲線となっている。上下に動く変数を平滑化したものがトレンドなので直線になるとは限らないのである。</p>
<p>次に景気循環の変数を作成するが，トレンドからの乖離を割合で表すために，上でも使った次の関係を利用する。</p>
<div class="math notranslate nohighlight" id="equation-eq-10-devaition">
<span class="eqno">(104)<a class="headerlink" href="#equation-eq-10-devaition" title="Link to this equation">#</a></span>\[
\dfrac{Y_t-Y_t^{\text{trend}}}{Y_t^{\text{trend}}}
\approx\log\left(\frac{Y_t}{Y_t^{\text{trend}}}\right)
=\log(Y_t) - \log(Y_t^{\text{trend}})
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;gdp_cycle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="p">(</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;gdp_log&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;gdp_log_trend&#39;</span><span class="p">]</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">0</span></code>に横線を引いてプロットしてみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax_</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;gdp_cycle&#39;</span><span class="p">,</span>
              <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>       <span class="c1"># 1</span>
              <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span>
              <span class="n">title</span><span class="o">=</span><span class="s1">&#39;GDPのトレンドからの％乖離&#39;</span><span class="p">)</span>
<span class="n">ax_</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>     <span class="c1"># 2</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b42daa13e1ab5dbdd678c04b127cc6a258bb0ae1a4b034ddcba4c0fbfada9f20.png" src="_images/b42daa13e1ab5dbdd678c04b127cc6a258bb0ae1a4b034ddcba4c0fbfada9f20.png" />
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コード説明</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Pandas</span></code>のメソッド<code class="docutils literal notranslate"><span class="pre">plot</span></code>は図を表示すると共に図の「軸（axis）」を返すが，それを変数<code class="docutils literal notranslate"><span class="pre">ax</span></code>に割り当てている。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">marker</span></code>はデータのマーカーを指定する引数であり，<code class="docutils literal notranslate"><span class="pre">'.'</span></code>は小さな点を指定している。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">linestyle</span></code>は線のスタイルを指定する引数であり，<code class="docutils literal notranslate"><span class="pre">':'</span></code>は点線を指定している。</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">ax_</span></code>のメソッド<code class="docutils literal notranslate"><span class="pre">.axhline()</span></code>を使うと横線を描くことができる。</p>
<ul class="simple">
<li><p>縦軸の値<code class="docutils literal notranslate"><span class="pre">0</span></code>は必須の引数</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">color=red</span></code>は色を指定する引数（無くても良い）。</p></li>
</ul>
</li>
</ol>
</div>
<p>まず乖離率の平均を確認してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;gdp_cycle&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6.3767173359833995e-12
</pre></div>
</div>
</div>
</div>
<p>正と負の乖離率は相殺し平均では<code class="docutils literal notranslate"><span class="pre">0</span></code>に非常に近い値となっている。</p>
<p>図を見ると、乖離率の絶対値は負の方が大きいことが分かる。絶対値で、負の乖離率は正の乖離率の何倍かを計算してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">abs</span><span class="p">(</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;gdp_cycle&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="p">)</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;gdp_cycle&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.8222940822022835
</pre></div>
</div>
</div>
</div>
<p>山よりも谷は<code class="docutils literal notranslate"><span class="pre">2</span></code>倍以上深いことが分かる。</p>
<p>負の乖離率の絶対値が大きく、平均は約<code class="docutils literal notranslate"><span class="pre">0</span></code>だということは、正の乖離率が発生した回数が多いということが分かる。確認してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cond</span> <span class="o">=</span> <span class="p">(</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;gdp_cycle&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="p">)</span>
<span class="n">plus</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,:]</span> <span class="p">)</span>
<span class="n">minus</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="n">plus</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;正の乖離の発生回数：</span><span class="si">{</span><span class="n">plus</span><span class="si">}</span><span class="se">\n</span><span class="s1">負の乖離の発生回数：</span><span class="si">{</span><span class="n">minus</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>正の乖離の発生回数：90
負の乖離の発生回数：86
</pre></div>
</div>
</div>
</div>
<p>ヒストグラムを使って分布を確認してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;gdp_cycle&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/bc0956e497538c5d67ed294399d41cea9e2d758cfe883f31428d41d93559394e.png" src="_images/bc0956e497538c5d67ed294399d41cea9e2d758cfe883f31428d41d93559394e.png" />
</div>
</div>
<p>歪んだ分布になっていることが分かる。</p>
<p>もう一度GDP乖離率のプロットを見てみよう。「山」と「谷」の形，幅（期間），高さ（深さ）はまちまちであり，不確実な要素が大きい。言い換えると，景気循環の予測は非常に難しい。この点は確率変数として捉えることができるが，このアプローチは後のトピックで扱う。</p>
</section>
<section id="id9">
<h3>構成要素のトレンドからの乖離率<a class="headerlink" href="#id9" title="Link to this heading">#</a></h3>
<p>次にGDPの構成要素について考えるが，まずトレンドからの乖離の変数を作成する（単位：％）。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">var_lst</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>   <span class="c1"># gdp以外の変数    </span>
    
    <span class="n">df</span><span class="p">[</span><span class="n">v</span><span class="o">+</span><span class="s1">&#39;_cycle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="p">(</span> <span class="n">df</span><span class="p">[</span><span class="n">v</span><span class="o">+</span><span class="s1">&#39;_log&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="n">v</span><span class="o">+</span><span class="s1">&#39;_log_trend&#39;</span><span class="p">]</span> <span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
<p>図示する変数のリスを作成するために，列ラベルを確認しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;gdp&#39;, &#39;consumption&#39;, &#39;investment&#39;, &#39;government&#39;, &#39;exports&#39;, &#39;imports&#39;,
       &#39;capital&#39;, &#39;employed&#39;, &#39;unemployed&#39;, &#39;unemployment_rate&#39;, &#39;hours&#39;,
       &#39;total_hours&#39;, &#39;inflation&#39;, &#39;price&#39;, &#39;deflator&#39;, &#39;gdp_log&#39;,
       &#39;gdp_growth_quarter&#39;, &#39;gdp_growth_annual&#39;, &#39;gdp_log_trend&#39;,
       &#39;consumption_log&#39;, &#39;consumption_log_trend&#39;, &#39;investment_log&#39;,
       &#39;investment_log_trend&#39;, &#39;government_log&#39;, &#39;government_log_trend&#39;,
       &#39;exports_log&#39;, &#39;exports_log_trend&#39;, &#39;imports_log&#39;, &#39;imports_log_trend&#39;,
       &#39;gdp_cycle&#39;, &#39;consumption_cycle&#39;, &#39;investment_cycle&#39;,
       &#39;government_cycle&#39;, &#39;exports_cycle&#39;, &#39;imports_cycle&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>列ラベルに<code class="docutils literal notranslate"><span class="pre">_cycle</span></code>がついている変数だけを選ぶために<code class="docutils literal notranslate"><span class="pre">cycle_lst</span></code>を作成する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle_lst</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">:]</span>   <span class="c1"># 最後の6変数</span>
<span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">cycle_lst</span><span class="p">,</span> <span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/bb997e37c7e6f733da5406e4210772e2bf029d90a1ae06f3c96628816ec08f11.png" src="_images/bb997e37c7e6f733da5406e4210772e2bf029d90a1ae06f3c96628816ec08f11.png" />
</div>
</div>
<p>この図に基づいて次の点について考える。</p>
<ol class="arabic simple">
<li><p>GDPと順循環的（pro-cyclical）か反循環的（counter- cyclical）かどうか</p></li>
<li><p>変動の大きさの比較</p></li>
</ol>
</section>
<section id="id10">
<h3>GDPとの相関度<a class="headerlink" href="#id10" title="Link to this heading">#</a></h3>
<section id="id11">
<h4>復習<a class="headerlink" href="#id11" title="Link to this heading">#</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">2</span></code>つのランダム変数<span class="math notranslate nohighlight">\(X_i\)</span>と<span class="math notranslate nohighlight">\(Y_i\)</span>, <span class="math notranslate nohighlight">\(i=1,2,3,\cdots,n\)</span>を考えよう。
<code class="docutils literal notranslate"><span class="pre">2</span></code>変数の不偏分散は次のように定義される。</p>
<div class="math notranslate nohighlight">
\[
\sigma_{X}^2=\frac{1}{n-1}\sum_{i=1}^{n}
\left(X_i-\overline{X}\right)^2
\qquad
\sigma_{Y}^2=\frac{1}{n-1}\sum_{i=1}^{n}
\left(Y_i-\overline{Y}\right)^2
\]</div>
<p>ここで<span class="math notranslate nohighlight">\(\overline{X}\)</span>と<span class="math notranslate nohighlight">\(\overline{Y}\)</span>は平均を表し、それぞれの標準偏差は<span class="math notranslate nohighlight">\(\sigma_{X}\)</span>と<span class="math notranslate nohighlight">\(\sigma_{Y}\)</span>となる。</p>
<p>ここでは<code class="docutils literal notranslate"><span class="pre">2</span></code>変数の相関度を考えたい訳だが、その尺度として共分散が使われ、次のように定義される。</p>
<div class="math notranslate nohighlight">
\[
\sigma_{XY}=\frac{1}{n-1}\sum_{i=1}^{n}
\left(X_i-\overline{X}\right)\left(Y_i-\overline{Y}\right)
\]</div>
<p>次の解釈となる。</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\sigma_{XY}=0\)</span>：無相関</p></li>
<li><p><span class="math notranslate nohighlight">\(\sigma_{XY}&gt;0\)</span>：正の相関</p></li>
<li><p><span class="math notranslate nohighlight">\(\sigma_{XY}&lt;0\)</span>：負の相関</p></li>
</ul>
<p>また上の定義から次が成立することが簡単に理解できる。</p>
<div class="math notranslate nohighlight">
\[
\sigma_{XX}=\sigma_{X}^2,
\qquad
\sigma_{YY}=\sigma_{Y}^2,
\]</div>
<p>別々の<code class="docutils literal notranslate"><span class="pre">2</span></code>変数を使うことにより共分散を計算することができるが、その<code class="docutils literal notranslate"><span class="pre">2</span></code>変数が同じな場合（<code class="docutils literal notranslate"><span class="pre">X</span></code>と<code class="docutils literal notranslate"><span class="pre">X</span></code>の<code class="docutils literal notranslate"><span class="pre">2</span></code>変数もしくは<code class="docutils literal notranslate"><span class="pre">Y</span></code>と<code class="docutils literal notranslate"><span class="pre">Y</span></code>の<code class="docutils literal notranslate"><span class="pre">2</span></code>変数）は分散となる。</p>
<p>共分散の重要な特徴は<span class="math notranslate nohighlight">\(X_i\)</span>と<span class="math notranslate nohighlight">\(Y_i\)</span>の単位に依存することになり、単位が異なる<code class="docutils literal notranslate"><span class="pre">2</span></code>つの相関度の比較には向いていない。
その点を克服するのが<strong>相関係数</strong>であり、次のように定義される。</p>
<div class="math notranslate nohighlight">
\[
\rho_{XY}=
\frac{\sigma_{XY}}{\sigma_X\sigma_Y}
\]</div>
<p>次の特徴がある。</p>
<ul class="simple">
<li><p>分母は必ず正となるので，分子の共分散が符号を決定する。</p></li>
<li><p><span class="math notranslate nohighlight">\(\rho_{XY}\)</span>の値は<code class="docutils literal notranslate"><span class="pre">-1</span></code>から<code class="docutils literal notranslate"><span class="pre">1</span></code>の間の値を取り、単位に依存しない。この特徴は、分母に<span class="math notranslate nohighlight">\(X\)</span>と<span class="math notranslate nohighlight">\(Y\)</span>の標準偏差の積を積を置く事により単位をキャンセルしているためである。</p></li>
</ul>
<p><span class="math notranslate nohighlight">\(\rho_{XX}\)</span>を考えてみよう。</p>
<div class="math notranslate nohighlight">
\[
\rho_{XX}=
\frac{\sigma_{XX}}{\sigma_X\sigma_X}
=\frac{\sigma_{X}^2}{\sigma_X^2}
=1
\]</div>
<p>分母は<code class="docutils literal notranslate"><span class="pre">X</span></code>の分散と等しく，分母も<code class="docutils literal notranslate"><span class="pre">X</span></code>の分散と等しくなり、<code class="docutils literal notranslate"><span class="pre">1</span></code>となる。即ち、<code class="docutils literal notranslate"><span class="pre">X</span></code>と<code class="docutils literal notranslate"><span class="pre">X</span></code>は完璧に相関しているため相関係数は<code class="docutils literal notranslate"><span class="pre">1</span></code>となる。また，<span class="math notranslate nohighlight">\(X\)</span>と<span class="math notranslate nohighlight">\(-X\)</span>の相関係数は<span class="math notranslate nohighlight">\(\rho_{X-X}=-1\)</span>となり，完璧な負の相関となる。一般的には，<span class="math notranslate nohighlight">\(\rho_{XY}\)</span>の絶対値は<code class="docutils literal notranslate"><span class="pre">1</span></code>よりも小さな値となる。相関係数の重要な特徴は単位には依存しないため，単位が異なる変数の相関度を比較するには有用な指標となる。</p>
</section>
<section id="cov-corr">
<h4><code class="docutils literal notranslate"><span class="pre">.cov</span></code>と<code class="docutils literal notranslate"><span class="pre">.corr()</span></code><a class="headerlink" href="#cov-corr" title="Link to this heading">#</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>には分散と共分散を計算するメソッド<code class="docutils literal notranslate"><span class="pre">.cov()</span></code>が用意されている。例として、<code class="docutils literal notranslate"><span class="pre">gdp_cycle</span></code>と<code class="docutils literal notranslate"><span class="pre">consumption_cycle</span></code>を抽出して<code class="docutils literal notranslate"><span class="pre">.cov()</span></code>を使ってみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">varcov</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;gdp_cycle&#39;</span><span class="p">,</span> <span class="s1">&#39;government_cycle&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">cov</span><span class="p">()</span>
<span class="n">varcov</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gdp_cycle</th>
      <th>government_cycle</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>gdp_cycle</th>
      <td>2.200185</td>
      <td>-0.333983</td>
    </tr>
    <tr>
      <th>government_cycle</th>
      <td>-0.333983</td>
      <td>1.735850</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">varcov</span></code>は分散共分散行列と呼ばれる。
左上と右下の対角線上にあるのは、<code class="docutils literal notranslate"><span class="pre">gdp_cycle</span></code>と<code class="docutils literal notranslate"><span class="pre">government_cycle</span></code>の不偏分散である。
一方、右上と左下の値（同じ値となる）が<strong>共分散</strong>であり、この場合は負の値となっている。</p>
<p><code class="docutils literal notranslate"><span class="pre">varcov</span></code>を使い相関係数を計算してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">varcov</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span> <span class="n">varcov</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">varcov</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mf">0.5</span> <span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.17089852439087916
</pre></div>
</div>
</div>
</div>
<p>相関係数はメソッド<code class="docutils literal notranslate"><span class="pre">.corr()</span></code>を使って求めることもできる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;gdp_cycle&#39;</span><span class="p">,</span> <span class="s1">&#39;government_cycle&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gdp_cycle</th>
      <th>government_cycle</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>gdp_cycle</th>
      <td>1.000000</td>
      <td>-0.170899</td>
    </tr>
    <tr>
      <th>government_cycle</th>
      <td>-0.170899</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>左下もしくは右上の値が相関係数であり、上の「手計算」と等しい。</p>
</section>
<section id="id12">
<h4>GDPと構成要素との相関係数<a class="headerlink" href="#id12" title="Link to this heading">#</a></h4>
<p>GDPと構成要素との相関係数を<code class="docutils literal notranslate"><span class="pre">for</span></code>ループを使って計算しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;GDPの変動との相関係数</span><span class="se">\n</span><span class="s1">------------------------&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">cycle_lst</span><span class="p">:</span>
    <span class="n">corr</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;gdp_cycle&#39;</span><span class="p">,</span> <span class="n">v</span><span class="p">]]</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># 1</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s1">&lt;19</span><span class="si">}{</span><span class="n">corr</span><span class="si">:</span><span class="s1">&gt;5.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>                 <span class="c1"># 2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GDPの変動との相関係数
------------------------
gdp_cycle           1.00
consumption_cycle   0.77
investment_cycle    0.78
government_cycle   -0.17
exports_cycle       0.76
imports_cycle       0.65
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.corr()</span></code>は相関係数を計算するメソッドであり，2x2の行列を返す。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">iloc[0,1]</span></code>は相関係数の値を抽出している。<code class="docutils literal notranslate"><span class="pre">iloc[1,0]</span></code>でも同じ結果となる。</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">f-string</span></code>を使っている。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;19</span></code>は<code class="docutils literal notranslate"><span class="pre">v</span></code>の文字列の長さを空白を足して<code class="docutils literal notranslate"><span class="pre">19</span></code>にし左詰めにする。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&gt;5</span></code>は<code class="docutils literal notranslate"><span class="pre">corr</span></code>の文字列の長さを空白を足して<code class="docutils literal notranslate"><span class="pre">5</span></code>にし右詰めにする。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.2f</span></code>は小数点第二位までの表示を設定している。</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&gt;5</span></code>と<code class="docutils literal notranslate"><span class="pre">.2f</span></code>の順番を逆にするとエラーが発生する。</p></li>
</ul>
</li>
</ul>
</li>
</ol>
</div>
<p>政府支出以外は全て相関係数は正の値であり，値も大きい。即ち，順循環的である（裏にあるメカニズムを考えてみよう）。下の図はGDPと投資の散布図であり，正の相関を確認できる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;gdp_cycle&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;investment_cycle&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/fb16cbf84463c4b8bc71bbac5cb7431afe65e6f074c3d27027245a46f91d440f.png" src="_images/fb16cbf84463c4b8bc71bbac5cb7431afe65e6f074c3d27027245a46f91d440f.png" />
</div>
</div>
<p>一方，政府支出の値は負であり，景気循環をコントロールしようとする政府の政策の現れと解釈できる。値が小さいのは，時間的なラグがあるためだと思われる。景気に関するデータを集計するには数ヶ月かかり，国会審議や支出の実行にも時間を取られることになる。時間的なラグを捉えるために，<code class="docutils literal notranslate"><span class="pre">Series</span></code>のメソッド<code class="docutils literal notranslate"><span class="pre">.shift()</span></code>を使って相関係数を再計算してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  GDPとの相関係数</span><span class="se">\n</span><span class="s1">-----------------------&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">):</span>
    
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;gov_cycle_shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;government_cycle&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="n">n</span><span class="p">)</span>     <span class="c1">#1</span>
    
    <span class="n">corr</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;gdp_cycle&#39;</span><span class="p">,</span> <span class="s1">&#39;gov_cycle_shift&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">n</span><span class="si">:</span><span class="s1">&gt;3</span><span class="si">}</span><span class="s1">期先の政府支出: </span><span class="si">{</span><span class="n">corr</span><span class="si">:</span><span class="s1">&gt;6.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    
    <span class="k">del</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;gov_cycle_shift&#39;</span><span class="p">]</span>                                    <span class="c1">#2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  GDPとの相関係数
-----------------------
  1期先の政府支出: -0.318
  2期先の政府支出: -0.392
  3期先の政府支出: -0.396
  4期先の政府支出: -0.327
  5期先の政府支出: -0.277
  6期先の政府支出: -0.149
  7期先の政府支出: -0.026
  8期先の政府支出:  0.074
  9期先の政府支出:  0.122
 10期先の政府支出:  0.126
 11期先の政府支出:  0.124
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">#1</span></code>：<code class="docutils literal notranslate"><span class="pre">.shift()</span></code>の引数は値を先に何期ずらすかを指定する。比べたいのは<span class="math notranslate nohighlight">\(t\)</span>期のGDPと<span class="math notranslate nohighlight">\(t+n\)</span>期の政府支出なので，後にずらす必要があるためマイナス符号を付けて<code class="docutils literal notranslate"><span class="pre">.shift(-t)</span></code>としている。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#2</span></code>：列<code class="docutils literal notranslate"><span class="pre">gov_cycle_shift</span></code>は必要ないので削除する。</p></li>
</ul>
</div>
<p>GDPの乖離は<code class="docutils literal notranslate"><span class="pre">3</span></code>四半期先の政府支出との相関係数が最大となっている。景気循環に対する政府の姿勢が確認できる一方，政府の対応には長いの時間が掛かることを示す結果となっている。</p>
</section>
</section>
<section id="id13">
<h3>変動の大きさ<a class="headerlink" href="#id13" title="Link to this heading">#</a></h3>
<p>次に変動の大きさを考えるために，GDPの標準偏差に対するそれぞれの構成要素の標準偏差の比率を計算しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">cycle_lst</span><span class="p">:</span>
    
    <span class="n">var</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;gdp_cycle&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s1">&lt;19</span><span class="si">}{</span><span class="n">var</span><span class="si">:</span><span class="s1">&gt;5.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>gdp_cycle           1.00
consumption_cycle   0.81
investment_cycle    3.15
government_cycle    0.89
exports_cycle       3.76
imports_cycle       3.26
</pre></div>
</div>
</div>
</div>
<p>投資，輸出，輸入の値はGDPの3倍以上であり，政府支出の値はGDPより低く，消費の変動は更に小さい。これは消費者の不確実性を嫌う姿勢が反映されていると解釈できる。GDPの構成要素を対GDP比率で検討した際，消費は投資よりも比率が大きかったことを思い出そう。変動に関しては，順位が逆転し投資が大きく上回っている。この点を図示して視覚的に確認してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">cycle_lst</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/159b747c490d78df88778a4a8d9b08e4750eac111f0a35238a8d3f43ffbce187.png" src="_images/159b747c490d78df88778a4a8d9b08e4750eac111f0a35238a8d3f43ffbce187.png" />
</div>
</div>
<p>これらの結果を説明するために，効用最大化に基づく消費者理論があり，利潤最大化に基づく企業行動に関するモデルが使われている。</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="19_PPP.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">一物一価と購買力平価</p>
      </div>
    </a>
    <a class="right-next"
       href="11_Macro_Variables.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">法則・曲線・増加率</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">はじめに</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">GDPとその変化</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">GDPの構成要素</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">失業率</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">トレンドと変動</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">説明</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">トレンドの計算</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">GDPのトレンドからの乖離率</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">構成要素のトレンドからの乖離率</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">GDPとの相関度</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">復習</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cov-corr"><code class="docutils literal notranslate"><span class="pre">.cov</span></code>と<code class="docutils literal notranslate"><span class="pre">.corr()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">GDPと構成要素との相関係数</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">変動の大きさ</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By 春山 鉄源  Tetsugen HARUYAMA
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <!-- Default Statcounter code for Py4Macro https://py4macro.github.io --> <script type="text/javascript"> var sc_project=12478906; var sc_invisible=1; var sc_security="e767d225"; </script> <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script> <noscript><div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img class="statcounter" src="https://c.statcounter.com/12478906/0/e767d225/1/" alt="Web Analytics"></a></div></noscript> <!-- End of Statcounter Code -->
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>