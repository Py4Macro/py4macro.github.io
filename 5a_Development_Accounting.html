
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>発展会計 &#8212; Pythonで学ぶマクロ経済学 (中級＋レベル)</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=9c3e77be" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/myadmonitions.css?v=372cf325" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=1ae7504c"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-3FB0WMD39P"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-3FB0WMD39P');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-3FB0WMD39P');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '5a_Development_Accounting';</script>
    <link rel="canonical" href="https://py4macro.github.io/5a_Development_Accounting.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="成長会計" href="5b_Growth_Accounting.html" />
    <link rel="prev" title="Pythonで学ぶマクロ経済学 (中級＋レベル)" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content"><p><a href='https://www.saiensu.co.jp/search/?isbn=978-4-88384-416-6&y=2025'><span style='color:white; font-size:90%;'> ✴️ 書籍『経済学のためのPython入門』(発行日：2025年10月10日)　←　クリック！ ✴️ </span></a></p></div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">Pythonで学ぶマクロ経済学 (中級＋レベル)</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Pythonの学習</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://py4basics.github.io">経済学のためのPython入門</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">長期分析</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">発展会計</a></li>
<li class="toctree-l1"><a class="reference internal" href="5b_Growth_Accounting.html">成長会計</a></li>
<li class="toctree-l1"><a class="reference internal" href="6_Regression.html">回帰分析</a></li>
<li class="toctree-l1"><a class="reference internal" href="7_DifferenceEq.html">差分方程式と経済分析</a></li>
<li class="toctree-l1"><a class="reference internal" href="8_Solow.html">ソロー・モデル</a></li>
<li class="toctree-l1"><a class="reference internal" href="9_Convergence.html">所得分布と所得収斂</a></li>
<li class="toctree-l1"><a class="reference internal" href="19_PPP.html">一物一価と購買力平価</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">短期データ分析</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="13a_Random_Variables.html">ランダム変数と統計的特徴</a></li>
<li class="toctree-l1"><a class="reference internal" href="10_Data_Fluctuation.html">主なマクロ・データの特徴</a></li>
<li class="toctree-l1"><a class="reference internal" href="11a_Okun_Phillips.html">オークンの法則とフィリップス曲線</a></li>
<li class="toctree-l1"><a class="reference internal" href="11b_Money_Inflation.html">インフレとマネーストック</a></li>
<li class="toctree-l1"><a class="reference internal" href="16_data_on_money.html">古典派の二分法と金融政策</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">短期定量分析</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="18_ADAS-1.html">定量的マクロ経済分析：Part 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="18_ADAS-2.html">定量的マクロ経済分析：Part 2</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">短期モデル分析</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="12_IS-MP-PC.html">IS-MP-PCモデル</a></li>
<li class="toctree-l1"><a class="reference internal" href="13b_Stochastic_Solow.html">確率的ソロー・モデル</a></li>
<li class="toctree-l1"><a class="reference internal" href="14_linearsolve.html"><code class="docutils literal notranslate"><span class="pre">linearsolve</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="15_RBC.html">実物的景気循環(RBC)モデル</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">ToDo</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Plan.html">今後の計画</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">参考</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://py4basics.github.io/Gapminder.html">Gapminder</a></li>
<li class="toctree-l1"><a class="reference external" href="https://py4etrics.github.io">Pythonで学ぶ入門計量経済学</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/Py4Macro/py4macro.github.io/source?urlpath=tree/5a_Development_Accounting.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/Py4Macro/py4macro.github.io/blob/source/5a_Development_Accounting.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>



<a href="https://github.com/Py4Macro/py4macro.github.io" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/5a_Development_Accounting.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>発展会計</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">はじめに</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">データ</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">発展会計の考え方</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5"><span class="pasted-text">2023</span>年</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gdp">一人当たりGDP</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">物的資本</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">人的資本サービス</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sec-5a-tfp">全要素生産性</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">相関係数</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sec-5-tfp-factors">全要素生産性と蓄積生産要素の寄与度</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">表の作成</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="chap-5a-accounting">
<span id="id1"></span><h1>発展会計<a class="headerlink" href="#chap-5a-accounting" title="Link to this heading">#</a></h1>
<div name="html-admonition" style="font-size: 0.8em">
<input type="button" onclick="location.href='https://translate.google.com/translate?hl=&sl=ja&tl=en&u='+window.location;" value="Google translation" style="color:#ffffff;background-color:#008080; height:25px" onmouseover="this.style.background='#99ccff'" onmouseout="this.style.background='#008080'"/> in English or the language of your choice.
</div><br><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">import</span><span class="w"> </span><span class="nn">japanize_matplotlib</span>
<span class="linenos"> 2</span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="linenos"> 3</span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="linenos"> 4</span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="linenos"> 5</span><span class="kn">import</span><span class="w"> </span><span class="nn">py4macro</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="c1"># numpy v1の表示を使用</span>
<span class="linenos"> 8</span><span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">legacy</span><span class="o">=</span><span class="s1">&#39;1.21&#39;</span><span class="p">)</span>
<span class="linenos"> 9</span><span class="c1"># 警告メッセージを非表示</span>
<span class="linenos">10</span><span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="linenos">11</span><span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="id2">
<h2>はじめに<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<p>一人当たりGDP（国内総生産）は経済の豊かさを示す一つの尺度として使われるが，下の左の図は2019年の世界経済での一人当たりGDPの分布を示している。日本と他の国・地域との比較を容易にするために、日本の一人当たりGDPを100として相対的な所得分布を表している。日本は38位で、１位であるルクセンブルグの一人当たりGDPは日本のそれより2倍強あり（米国は159.9で10位）、最下位のベネズエラは日本の一人当たりGDPの0.63％である。また、一人当たりGDPが日本の10％に満たない国・地域が107ある。こういった数字が示すように、世界の所得分布は大きな偏りがあり、非常に不平等である。</p>
<blockquote>
<div><p>（問１）なぜある国は豊かで他の国は貧しいのだろうか？</p>
</div></blockquote>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">gdppc_distribution</span><span class="p">():</span>
    <span class="c1"># データ</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">py4macro</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;pwt&#39;</span><span class="p">)</span>

    <span class="c1"># 一人当たりGDP</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;GDPpc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;rgdpe&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;pop&#39;</span><span class="p">]</span>

    <span class="c1"># 最新年</span>
    <span class="n">latest_year</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    
    <span class="c1"># 最新年だけを取り出す</span>
    <span class="n">cond</span> <span class="o">=</span> <span class="p">(</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">latest_year</span> <span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;country&#39;</span><span class="p">,</span><span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="s1">&#39;GDPpc&#39;</span><span class="p">]]</span>

    <span class="c1"># 日本の値を抽出</span>
    <span class="n">jp</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;country==&quot;Japan&quot;&#39;</span><span class="p">)[</span><span class="s1">&#39;GDPpc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

    <span class="c1"># 日本を100として計算</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;GDPpc_normalized&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;GDPpc&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">jp</span>

    <span class="c1"># プロット</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;GDPpc_normalized&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;国の数&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;日本を100として，</span><span class="si">{</span><span class="n">latest_year</span><span class="si">}</span><span class="s1">年, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="si">}</span><span class="s1">の国・地域, PWT11.0&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;１人当たり実質GDPの分布&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>

<span class="n">gdppc_distribution</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/417b13f5fca2245d0bbe158fabd70137ac2eb84a3c468330a3a2c8f561c36060.png" src="_images/417b13f5fca2245d0bbe158fabd70137ac2eb84a3c468330a3a2c8f561c36060.png" />
</div>
</div>
<p>この問いはマクロ経済学の根本的な問いである。この重要な問題を考える上で、経済成長率に関する考察を無視できない。経済成長率とは、一人当たりGDP等の変数がある一定期間（例えば、一年間）にどれだけ変化したかをパーセントで表している。「現在の所得水準は過去に達成した成長率に依存し、またこれからの成長率が将来の所得水準を決定する」という質的な結果は直感的に理解できる。では、成長率と所得水準にはどういった量的な関係があるのだろうか。これを理解するために、<a class="reference internal" href="#tab-growth"><span class="std std-numref">Table 1</span></a>を見てみよう。</p>
<div class="pst-scrollable-table-container"><table class="table" id="tab-growth">
<caption><span class="caption-number">Table 1 </span><span class="caption-text">現在の一人当たりGDPを100として</span><a class="headerlink" href="#tab-growth" title="Link to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>成長率</p></th>
<th class="head"><p>2.0%</p></th>
<th class="head"><p>2.5%</p></th>
<th class="head"><p>3.0%</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1年後</p></td>
<td><p>102.0</p></td>
<td><p>102.5</p></td>
<td><p>103.0</p></td>
</tr>
<tr class="row-odd"><td><p>10年後</p></td>
<td><p>121.9</p></td>
<td><p>128.0</p></td>
<td><p>134.4</p></td>
</tr>
<tr class="row-even"><td><p>50年後</p></td>
<td><p>269.2</p></td>
<td><p>343.7</p></td>
<td><p>438.4</p></td>
</tr>
<tr class="row-odd"><td><p>100年後</p></td>
<td><p>724.5</p></td>
<td><p>1181.4</p></td>
<td><p>1921.9</p></td>
</tr>
</tbody>
</table>
</div>
<p>現在の一人当たりGDPを100単位として，３つの異なる率で成長した場合、所得がどう変化するかを示している。2％と3％のケースを考えると、成長率が１％上昇するだけで、100年後の所得は約2.7倍に膨らんでいる。では、実際に各国の成長率はどれほど差があるのだろうか。それを示したのが次の図である。</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># データ</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">py4macro</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;pwt&#39;</span><span class="p">)</span>

<span class="c1"># 一人当たりGDP</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;naGDPpc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;rgdpna&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;pop&#39;</span><span class="p">]</span>

<span class="c1"># 1960~最新年</span>
<span class="n">first_year</span> <span class="o">=</span> <span class="mi">1960</span>
<span class="n">latest_year</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">df_growth</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;year==@first_year | year==@latest_year&#39;</span><span class="p">)</span>

<span class="c1"># 1960と最新年の両年でGDPのデータある国・地域を抽出</span>
<span class="n">notna_check</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="n">cond</span> <span class="o">=</span> <span class="n">df_growth</span><span class="p">[[</span><span class="s1">&#39;country&#39;</span><span class="p">,</span><span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="s1">&#39;naGDPpc&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;country&#39;</span><span class="p">)[</span><span class="s1">&#39;naGDPpc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">notna_check</span><span class="p">)</span>
<span class="n">df_growth</span> <span class="o">=</span> <span class="n">df_growth</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,:]</span>

<span class="c1"># 成長率の計算</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">latest_year</span> <span class="o">-</span> <span class="n">first_year</span>

<span class="k">def</span><span class="w"> </span><span class="nf">fun</span><span class="p">(</span><span class="n">col</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">100</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">col</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">t</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span> <span class="p">)</span>
<span class="n">growth</span> <span class="o">=</span> <span class="n">df_growth</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;country&#39;</span><span class="p">)[[</span><span class="s1">&#39;naGDPpc&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">fun</span><span class="p">)</span>

<span class="c1"># # 日本の平均成長率</span>
<span class="n">jp_growth</span> <span class="o">=</span> <span class="n">growth</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Japan&#39;</span><span class="p">,:]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># # プロット</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">growth</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">jp_growth</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;国の数&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">first_year</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">latest_year</span><span class="si">}</span><span class="s1">年，</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">growth</span><span class="p">)</span><span class="si">}</span><span class="s1">の国・地域, PWT11.0&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;１人当たり実質GDPの平均成長率(％)の分布&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/b48a1a1a2837b8d4031e3795695257eb2cf94af61d7174a9e5eaea6fd09a9d1a.png" src="_images/b48a1a1a2837b8d4031e3795695257eb2cf94af61d7174a9e5eaea6fd09a9d1a.png" />
</div>
</div>
<p>日本の平均成長率は<span class="pasted-text">2.99</span>％であり、図では赤い直線で示している。最も高い成長率は<span class="pasted-text">China</span>の<span class="pasted-text">6.31</span>％であり，最も低い成長率は<span class="pasted-text">D.R. of the Congo</span>の<span class="pasted-text">-1.46</span>％である。実に、最高と最低成長率の差は<span class="pasted-text">7.77</span>％ある。また、マイナスの成長率とは一人当たり所得の減少を意味するが、<span class="pasted-text">111</span>の国・地域のうち<span class="pasted-text">6</span>が約60年の間平均して所得が縮小しているのである。</p>
<blockquote>
<div><p>（問２）なぜ国々の経済成長率は大きく異なるのか？</p>
</div></blockquote>
<p>経済学者は、問１と２に対する完璧な答えを提示できておらず、今でも活発に研究がおこなわれている。この章ではまず問１についてデータと簡単な数式を使い議論する。特に，技術水準と蓄積生産要素（物的資本と人的資本）がどれだけ一人当たりGDPに貢献しているかを考え，その貢献度の違いを使い問１について考察する。</p>
</section>
<section id="id3">
<h2>データ<a class="headerlink" href="#id3" title="Link to this heading">#</a></h2>
<p>データは<a class="reference external" href="https://www.rug.nl/ggdc/productivity/pwt/?lang=en">Penn World Talbe 11.0</a>を使うが，ここではデータをインポートするために<code class="docutils literal notranslate"><span class="pre">py4macro</span></code>モジュールを使う。このモジュールにはデータ・セットなどが含まれており，ここでは<code class="docutils literal notranslate"><span class="pre">data</span></code>関数を使ってデータをインポートする。使い方は次のコードで確認できる。</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">py4macro</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function data in module py4macro.py4macro:

data(dataset=None, description=0)
    |
    | 引数：
    |     datasets: (文字列)
    |         &#39;bigmac&#39;: Big Macインデックス
    |         &#39;debts&#39;：政府負債に関する長期時系列データ
    |         &#39;dates&#39;: 景気循環日付と拡張・後退期間
    |         &#39;ex&#39;: 円/ドル為替レートなど
    |         &#39;jpn-money&#39;: 日本の四半期データ（マネーストックなど）
    |         &#39;jpn-q&#39;: 日本の四半期データ（GDPなど）
    |         &#39;jpn-yr&#39;: 日本の年次データ（GDPなど）
    |         &#39;mad&#39;: country data of Maddison Project Database 2023
    |         &#39;mad-region&#39;: regional data of Maddison Project Database 2020
    |         &#39;pwt&#39;: Penn World Table 11.0
    |         &#39;weo&#39;: IMF World Economic Outlook 2025
    |         &#39;world-money&#39;: 177ヵ国のマネーストックなど
    |         &#39;data1&#39;: 書籍「経済学のためのPython入門」用
    |         &#39;data2&#39;: 書籍「経済学のためのPython入門」用
    |         &#39;data3&#39;: 書籍「経済学のためのPython入門」用
    |         &#39;data4&#39;: 書籍「経済学のためのPython入門」用
    |         &#39;data5&#39;: 書籍「経済学のためのPython入門」用
    |
    |     description (デフォルト：0, 整数型):
    |         0: データのDataFrameを返す
    |            * 全てのデータセット
    |         1: 変数の定義を全て表示する
    |            * 全てのデータセット
    |         2: 変数の定義のDataFrameを返す
    |            * `&#39;pwt&#39;`，`&#39;weo&#39;`のみ
    |
    | 返り値：
    |     DataFrame もしくは DataFrameの表示
    |
    | 例１：py4macro.data(&#39;weo&#39;)
    |         -&gt; IMF World Economic OutlookのDataFrameを返す。
    |
    | 例２：py4macro.data(&#39;weo&#39;, description=1)
    |         -&gt; IMF World Economic Outlookの変数定義の全てを表示する。
    |
    | 例３：py4macro.data(&#39;weo&#39;, description=2)
    |         -&gt; IMF World Economic Outlookの変数定義のDataFrameを返す。
    |
    |
    | ----- Penn World Tableについて -------------------------------------------
    |
    | PWTには以下の列が追加されている。
    |
    | * oecd：1990年代に始まった中央ヨーロッパへの拡大前にOECDメンバー国であれば1，そうでなければ0
    |
    | * income_group：世界銀行が所得水準に従って分けた４つのグループ
    |         High income
    |         Upper middle income
    |         Lower middle income
    |         Low income
    |
    | * region：世界銀行が国・地域に従って分けた７つのグループ化
    |         East Asia &amp; Pacific
    |         Europe &amp; Central Asia
    |         Latin America &amp; Caribbean
    |         Middle East &amp; North Africa
    |         North America
    |         South Asia
    |         Sub-Saharan Africa
    |
    | * continent：南極以外の6大陸
    |         Africa
    |         Asia
    |         Australia
    |         Europe
    |         North America
    |         South America
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">py4macro</span></code>を事前にインストールする必要があるが，次のコマンドでインストールすることができる。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">py4macro</span>
</pre></div>
</div>
</div>
<p>まず含まれていいる変数の定義を表示してみよう。<code class="docutils literal notranslate"><span class="pre">data()</span></code>の引数に<code class="docutils literal notranslate"><span class="pre">'pwt'</span></code>（文字列）と<code class="docutils literal notranslate"><span class="pre">description=1</span></code>を指定する。</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">py4macro</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;pwt&#39;</span><span class="p">,</span><span class="n">description</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable definition</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Identifier variables</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>countrycode</th>
      <td>3-letter ISO country code</td>
    </tr>
    <tr>
      <th>country</th>
      <td>Country name</td>
    </tr>
    <tr>
      <th>currency_unit</th>
      <td>Currency unit</td>
    </tr>
    <tr>
      <th>year</th>
      <td>Year</td>
    </tr>
    <tr>
      <th>Real GDP, employment and population levels</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>rgdpe</th>
      <td>Expenditure-side real GDP at chained PPPs (in mil. 2021US$)</td>
    </tr>
    <tr>
      <th>rgdpo</th>
      <td>Output-side real GDP at chained PPPs (in mil. 2021US$)</td>
    </tr>
    <tr>
      <th>pop</th>
      <td>Population (in millions)</td>
    </tr>
    <tr>
      <th>emp</th>
      <td>Number of persons engaged (in millions)</td>
    </tr>
    <tr>
      <th>avh</th>
      <td>Average annual hours worked by persons engaged</td>
    </tr>
    <tr>
      <th>hc</th>
      <td>Human capital index, based on years of schooling and returns to education; see Human capital in PWT9.</td>
    </tr>
    <tr>
      <th>Current price GDP, capital and TFP</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>ccon</th>
      <td>Real consumption of households and government, at current PPPs (in mil. 2021US$)</td>
    </tr>
    <tr>
      <th>cda</th>
      <td>Real domestic absorption, (real consumption plus investment), at current PPPs (in mil. 2021US$)</td>
    </tr>
    <tr>
      <th>cgdpe</th>
      <td>Expenditure-side real GDP at current PPPs (in mil. 2021US$)</td>
    </tr>
    <tr>
      <th>cgdpo</th>
      <td>Output-side real GDP at current PPPs (in mil. 2021US$)</td>
    </tr>
    <tr>
      <th>cn</th>
      <td>Capital stock at current PPPs (in mil. 2021US$)</td>
    </tr>
    <tr>
      <th>ck</th>
      <td>Capital services levels at current PPPs (USA=1)</td>
    </tr>
    <tr>
      <th>ctfp</th>
      <td>TFP level at current PPPs (USA=1)</td>
    </tr>
    <tr>
      <th>cwtfp</th>
      <td>Welfare-relevant TFP levels at current PPPs (USA=1)</td>
    </tr>
    <tr>
      <th>National accounts-based variables</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>rgdpna</th>
      <td>Real GDP at constant 2021 national prices (in mil. 2021US$)</td>
    </tr>
    <tr>
      <th>rconna</th>
      <td>Real consumption at constant 2021 national prices (in mil. 2021US$)</td>
    </tr>
    <tr>
      <th>rdana</th>
      <td>Real domestic absorption at constant 2021 national prices (in mil. 2021US$)</td>
    </tr>
    <tr>
      <th>rnna</th>
      <td>Capital stock at constant 2021 national prices (in mil. 2021US$)</td>
    </tr>
    <tr>
      <th>rkna</th>
      <td>Capital services at constant 2021 national prices (2021=1)</td>
    </tr>
    <tr>
      <th>rtfpna</th>
      <td>TFP at constant national prices (2021=1)</td>
    </tr>
    <tr>
      <th>rwtfpna</th>
      <td>Welfare-relevant TFP at constant national prices (2021=1)</td>
    </tr>
    <tr>
      <th>labsh</th>
      <td>Share of labour compensation in GDP at current national prices</td>
    </tr>
    <tr>
      <th>irr</th>
      <td>Real internal rate of return</td>
    </tr>
    <tr>
      <th>delta</th>
      <td>Average depreciation rate of the capital stock</td>
    </tr>
    <tr>
      <th>Exchange rates and GDP price levels</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>xr</th>
      <td>Exchange rate, national currency/USD (market+estimated)</td>
    </tr>
    <tr>
      <th>pl_con</th>
      <td>Price level of CCON (PPP/XR), price level of USA GDPo in 2021=1</td>
    </tr>
    <tr>
      <th>pl_da</th>
      <td>Price level of CDA (PPP/XR), price level of USA GDPo in 2021=1</td>
    </tr>
    <tr>
      <th>pl_gdpo</th>
      <td>Price level of CGDPo (PPP/XR), price level of USA GDPo in 2021=1</td>
    </tr>
    <tr>
      <th>Data information variables</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>i_cig</th>
      <td>0/1/2/3/4: relative price data for consumption, investment and government is extrapolated (0), benchmark (1), interpolated (2), ICP PPP timeseries: benchmark or interpolated (3) or  ICP PPP timeseries: extrapolated (4)</td>
    </tr>
    <tr>
      <th>i_xm</th>
      <td>0/1/2: relative price data for exports and imports is extrapolated (0), benchmark (1) or interpolated (2)</td>
    </tr>
    <tr>
      <th>i_xr</th>
      <td>0/1: the exchange rate is market-based (0) or estimated (1)</td>
    </tr>
    <tr>
      <th>i_outlier</th>
      <td>0/1: the observation on pl_gdpe or pl_gdpo is not an outlier (0) or an outlier (1)</td>
    </tr>
    <tr>
      <th>i_irr</th>
      <td>0/1/2/3: the observation for irr is not an outlier (0), may be biased due to a low capital share (1), hit the lower bound of 1 percent (2), or is an outlier (3)</td>
    </tr>
    <tr>
      <th>cor_exp</th>
      <td>Correlation between expenditure shares of the country and the US (benchmark observations only)</td>
    </tr>
    <tr>
      <th>Shares in CGDPo</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>csh_c</th>
      <td>Share of household consumption at current PPPs</td>
    </tr>
    <tr>
      <th>csh_i</th>
      <td>Share of gross capital formation at current PPPs</td>
    </tr>
    <tr>
      <th>csh_g</th>
      <td>Share of government consumption at current PPPs</td>
    </tr>
    <tr>
      <th>csh_x</th>
      <td>Share of merchandise exports at current PPPs</td>
    </tr>
    <tr>
      <th>csh_m</th>
      <td>Share of merchandise imports at current PPPs</td>
    </tr>
    <tr>
      <th>csh_r</th>
      <td>Share of residual trade and GDP statistical discrepancy at current PPPs</td>
    </tr>
    <tr>
      <th>Price levels, expenditure categories and capital</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>pl_c</th>
      <td>Price level of household consumption,  price level of USA GDPo in 2021=1</td>
    </tr>
    <tr>
      <th>pl_i</th>
      <td>Price level of capital formation,  price level of USA GDPo in 2021=1</td>
    </tr>
    <tr>
      <th>pl_g</th>
      <td>Price level of government consumption,  price level of USA GDPo in 2021=1</td>
    </tr>
    <tr>
      <th>pl_x</th>
      <td>Price level of exports, price level of USA GDPo in 2021=1</td>
    </tr>
    <tr>
      <th>pl_m</th>
      <td>Price level of imports, price level of USA GDPo in 2021=1</td>
    </tr>
    <tr>
      <th>pl_n</th>
      <td>Price level of the capital stock, price level of USA in 2021=1</td>
    </tr>
    <tr>
      <th>pl_k</th>
      <td>Price level of the capital services, price level of USA=1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">countrycode</span></code>は3つのアルファベットで表した標準的な国名コードであり，日本は<code class="docutils literal notranslate"><span class="pre">JPN</span></code>となる。よく使われるので，<a class="reference external" href="https://ja.wikipedia.org/wiki/ISO_3166-1">このサイト</a>を参考に主な国の表記を覚えておくと良いだろう。</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><code class="docutils literal notranslate"><span class="pre">description=1</span></code>は表示するだけなので，<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>として扱いたい場合は<code class="docutils literal notranslate"><span class="pre">description=2</span></code>とする。</p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">'pwt'</span></code>だけを引数に使うとデータ自体を読み込むことになる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">py4macro</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;pwt&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>次に<code class="docutils literal notranslate"><span class="pre">.head()</span></code>を使って最初の5行を表示してみよう。</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>countrycode</th>
      <th>country</th>
      <th>oecd</th>
      <th>income_group</th>
      <th>region</th>
      <th>continent</th>
      <th>year</th>
      <th>rgdpe</th>
      <th>rgdpo</th>
      <th>pop</th>
      <th>...</th>
      <th>csh_x</th>
      <th>csh_m</th>
      <th>csh_r</th>
      <th>pl_c</th>
      <th>pl_i</th>
      <th>pl_g</th>
      <th>pl_x</th>
      <th>pl_m</th>
      <th>pl_n</th>
      <th>pl_k</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ABW</td>
      <td>Aruba</td>
      <td>0</td>
      <td>High income</td>
      <td>Latin America &amp; Caribbean</td>
      <td>North America</td>
      <td>1950</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ABW</td>
      <td>Aruba</td>
      <td>0</td>
      <td>High income</td>
      <td>Latin America &amp; Caribbean</td>
      <td>North America</td>
      <td>1951</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ABW</td>
      <td>Aruba</td>
      <td>0</td>
      <td>High income</td>
      <td>Latin America &amp; Caribbean</td>
      <td>North America</td>
      <td>1952</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ABW</td>
      <td>Aruba</td>
      <td>0</td>
      <td>High income</td>
      <td>Latin America &amp; Caribbean</td>
      <td>North America</td>
      <td>1953</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ABW</td>
      <td>Aruba</td>
      <td>0</td>
      <td>High income</td>
      <td>Latin America &amp; Caribbean</td>
      <td>North America</td>
      <td>1954</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 54 columns</p>
</div></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">df</span></code>に含まれているのは年次データだが、最初と最後の年を調べてみる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_yr</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>   <span class="c1"># 最初の年</span>
<span class="n">latest_yr</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>  <span class="c1"># 最後の年</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;データセットには</span><span class="si">{</span><span class="n">first_yr</span><span class="si">}</span><span class="s1">から</span><span class="si">{</span><span class="n">latest_yr</span><span class="si">}</span><span class="s1">年が含まれている&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>データセットには1950から2023年が含まれている
</pre></div>
</div>
</div>
</div>
<p>また，次の変数は上の定義のリストには含まれていないので，ここで簡単に紹介する。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">oecd</span></code>：1990年代に始まった中央ヨーロッパへの拡大前にOECDメンバー国であれば<code class="docutils literal notranslate"><span class="pre">1</span></code>，そうでなければ<code class="docutils literal notranslate"><span class="pre">0</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">income_group</span></code>：世界銀行は所得水準に従って国を次の４つに分けている。</p>
<ul>
<li><p>High income</p></li>
<li><p>Upper middle income</p></li>
<li><p>Lower middle income</p></li>
<li><p>Low income</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">region</span></code>：世界銀行が国・地域に従って分けた７つのグループ化</p>
<ul>
<li><p>East Asia &amp; Pacific</p></li>
<li><p>Europe &amp; Central Asia</p></li>
<li><p>Latin America &amp; Caribbean</p></li>
<li><p>Middle East &amp; North Africa</p></li>
<li><p>North America</p></li>
<li><p>South Asia</p></li>
<li><p>Sub-Saharan Africa</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">continent</span></code>：南極以外の6大陸</p>
<ul>
<li><p>Africa</p></li>
<li><p>Asia</p></li>
<li><p>Australia</p></li>
<li><p>Europe</p></li>
<li><p>North America</p></li>
<li><p>South America</p></li>
</ul>
</li>
</ul>
<p><span class="pasted-text">2023</span>年のデータを使い内訳を確認してみよう。その際に便利なのが<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>と<code class="docutils literal notranslate"><span class="pre">Series</span></code>のメソッド<code class="docutils literal notranslate"><span class="pre">.value_counts()</span></code>である。これを使うと簡単に要素の個数や頻度を表示できる。</p>
<p>まず<code class="docutils literal notranslate"><span class="pre">oecd</span></code>を考えるが，条件に従って行を抽出しその数を数えてみる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cond</span> <span class="o">=</span> <span class="p">(</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">latest_yr</span> <span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,</span><span class="s1">&#39;oecd&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>oecd
0    161
1     24
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">oecd</span></code>には24カ国あることがわかる。</p>
<p>同様に<code class="docutils literal notranslate"><span class="pre">income_group</span></code>，<code class="docutils literal notranslate"><span class="pre">region</span></code>，<code class="docutils literal notranslate"><span class="pre">continent</span></code>の内訳を確認してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,</span><span class="s1">&#39;income_group&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>income_group
High income            65
Upper middle income    48
Lower middle income    44
Low income             26
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,</span><span class="s1">&#39;region&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>region
Europe &amp; Central Asia         48
Sub-Saharan Africa            47
Latin America &amp; Caribbean     40
Middle East &amp; North Africa    20
East Asia &amp; Pacific           20
South Asia                     7
North America                  3
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,</span><span class="s1">&#39;continent&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>continent
Africa           51
Asia             48
Europe           39
North America    32
South America    12
Australia         3
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">.value_counts()</span></code>に引数<code class="docutils literal notranslate"><span class="pre">normalize=True</span></code>を追加すると，頻度（パーセント）として表示できる。</p>
<p>属性<code class="docutils literal notranslate"><span class="pre">.columns</span></code>を使い全ての列名を表示してみよう。</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;countrycode&#39;, &#39;country&#39;, &#39;oecd&#39;, &#39;income_group&#39;, &#39;region&#39;, &#39;continent&#39;,
       &#39;year&#39;, &#39;rgdpe&#39;, &#39;rgdpo&#39;, &#39;pop&#39;, &#39;emp&#39;, &#39;avh&#39;, &#39;hc&#39;, &#39;ccon&#39;, &#39;cda&#39;,
       &#39;cgdpe&#39;, &#39;cgdpo&#39;, &#39;cn&#39;, &#39;ck&#39;, &#39;ctfp&#39;, &#39;cwtfp&#39;, &#39;rgdpna&#39;, &#39;rconna&#39;,
       &#39;rdana&#39;, &#39;rnna&#39;, &#39;rkna&#39;, &#39;rtfpna&#39;, &#39;rwtfpna&#39;, &#39;labsh&#39;, &#39;irr&#39;, &#39;delta&#39;,
       &#39;xr&#39;, &#39;pl_con&#39;, &#39;pl_da&#39;, &#39;pl_gdpo&#39;, &#39;i_cig&#39;, &#39;i_xm&#39;, &#39;i_xr&#39;,
       &#39;i_outlier&#39;, &#39;i_irr&#39;, &#39;cor_exp&#39;, &#39;csh_c&#39;, &#39;csh_i&#39;, &#39;csh_g&#39;, &#39;csh_x&#39;,
       &#39;csh_m&#39;, &#39;csh_r&#39;, &#39;pl_c&#39;, &#39;pl_i&#39;, &#39;pl_g&#39;, &#39;pl_x&#39;, &#39;pl_m&#39;, &#39;pl_n&#39;,
       &#39;pl_k&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>また任意の列を選択するとメソッド<code class="docutils literal notranslate"><span class="pre">.unique()</span></code>が使えるようになる。これを使うことにより，選択した列に重複したデータがある場合，ユニークなものだけを抽出できる。このメソッドを使ってデータ・セットに含まれる国・地域名を確認してみよう。</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">country_list</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">country_list</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Aruba&#39;, &#39;Angola&#39;, &#39;Anguilla&#39;, &#39;Albania&#39;, &#39;United Arab Emirates&#39;,
       &#39;Argentina&#39;, &#39;Armenia&#39;, &#39;Antigua and Barbuda&#39;, &#39;Australia&#39;,
       &#39;Austria&#39;, &#39;Azerbaijan&#39;, &#39;Burundi&#39;, &#39;Belgium&#39;, &#39;Benin&#39;,
       &#39;Burkina Faso&#39;, &#39;Bangladesh&#39;, &#39;Bulgaria&#39;, &#39;Bahrain&#39;, &#39;Bahamas&#39;,
       &#39;Bosnia and Herzegovina&#39;, &#39;Belarus&#39;, &#39;Belize&#39;, &#39;Bermuda&#39;,
       &#39;Bolivia (Plurinational State of)&#39;, &#39;Brazil&#39;, &#39;Barbados&#39;,
       &#39;Brunei Darussalam&#39;, &#39;Bhutan&#39;, &#39;Botswana&#39;,
       &#39;Central African Republic&#39;, &#39;Canada&#39;, &#39;Switzerland&#39;, &#39;Chile&#39;,
       &#39;China&#39;, &quot;Côte d&#39;Ivoire&quot;, &#39;Cameroon&#39;, &#39;D.R. of the Congo&#39;, &#39;Congo&#39;,
       &#39;Colombia&#39;, &#39;Comoros&#39;, &#39;Cabo Verde&#39;, &#39;Costa Rica&#39;, &#39;Curaçao&#39;,
       &#39;Cayman Islands&#39;, &#39;Cyprus&#39;, &#39;Czechia&#39;, &#39;Germany&#39;, &#39;Djibouti&#39;,
       &#39;Dominica&#39;, &#39;Denmark&#39;, &#39;Dominican Republic&#39;, &#39;Algeria&#39;, &#39;Ecuador&#39;,
       &#39;Egypt&#39;, &#39;Spain&#39;, &#39;Estonia&#39;, &#39;Ethiopia&#39;, &#39;Finland&#39;, &#39;Fiji&#39;,
       &#39;France&#39;, &#39;Gabon&#39;, &#39;United Kingdom&#39;, &#39;Georgia&#39;, &#39;Ghana&#39;, &#39;Guinea&#39;,
       &#39;Gambia&#39;, &#39;Guinea-Bissau&#39;, &#39;Equatorial Guinea&#39;, &#39;Greece&#39;,
       &#39;Grenada&#39;, &#39;Guatemala&#39;, &#39;Guyana&#39;, &#39;China, Hong Kong SAR&#39;,
       &#39;Honduras&#39;, &#39;Croatia&#39;, &#39;Haiti&#39;, &#39;Hungary&#39;, &#39;Indonesia&#39;, &#39;India&#39;,
       &#39;Ireland&#39;, &#39;Iran (Islamic Republic of)&#39;, &#39;Iraq&#39;, &#39;Iceland&#39;,
       &#39;Israel&#39;, &#39;Italy&#39;, &#39;Jamaica&#39;, &#39;Jordan&#39;, &#39;Japan&#39;, &#39;Kazakhstan&#39;,
       &#39;Kenya&#39;, &#39;Kyrgyzstan&#39;, &#39;Cambodia&#39;, &#39;Saint Kitts and Nevis&#39;,
       &#39;Republic of Korea&#39;, &#39;Kuwait&#39;, &quot;Lao People&#39;s DR&quot;, &#39;Lebanon&#39;,
       &#39;Liberia&#39;, &#39;Saint Lucia&#39;, &#39;Sri Lanka&#39;, &#39;Lesotho&#39;, &#39;Lithuania&#39;,
       &#39;Luxembourg&#39;, &#39;Latvia&#39;, &#39;China, Macao SAR&#39;, &#39;Morocco&#39;,
       &#39;Republic of Moldova&#39;, &#39;Madagascar&#39;, &#39;Maldives&#39;, &#39;Mexico&#39;,
       &#39;North Macedonia&#39;, &#39;Mali&#39;, &#39;Malta&#39;, &#39;Myanmar&#39;, &#39;Montenegro&#39;,
       &#39;Mongolia&#39;, &#39;Mozambique&#39;, &#39;Mauritania&#39;, &#39;Montserrat&#39;, &#39;Mauritius&#39;,
       &#39;Malawi&#39;, &#39;Malaysia&#39;, &#39;Namibia&#39;, &#39;Niger&#39;, &#39;Nigeria&#39;, &#39;Nicaragua&#39;,
       &#39;Netherlands&#39;, &#39;Norway&#39;, &#39;Nepal&#39;, &#39;New Zealand&#39;, &#39;Oman&#39;,
       &#39;Pakistan&#39;, &#39;Panama&#39;, &#39;Peru&#39;, &#39;Philippines&#39;, &#39;Poland&#39;, &#39;Portugal&#39;,
       &#39;Paraguay&#39;, &#39;State of Palestine&#39;, &#39;Qatar&#39;, &#39;Romania&#39;,
       &#39;Russian Federation&#39;, &#39;Rwanda&#39;, &#39;Saudi Arabia&#39;, &#39;Sudan&#39;, &#39;Senegal&#39;,
       &#39;Singapore&#39;, &#39;Sierra Leone&#39;, &#39;El Salvador&#39;, &#39;Somalia&#39;, &#39;Serbia&#39;,
       &#39;South Sudan&#39;, &#39;Sao Tome and Principe&#39;, &#39;Suriname&#39;, &#39;Slovakia&#39;,
       &#39;Slovenia&#39;, &#39;Sweden&#39;, &#39;Eswatini&#39;, &#39;Sint Maarten (Dutch part)&#39;,
       &#39;Seychelles&#39;, &#39;Syrian Arab Republic&#39;, &#39;Turks and Caicos Islands&#39;,
       &#39;Chad&#39;, &#39;Togo&#39;, &#39;Thailand&#39;, &#39;Tajikistan&#39;, &#39;Turkmenistan&#39;,
       &#39;Trinidad and Tobago&#39;, &#39;Tunisia&#39;, &#39;Türkiye&#39;, &#39;Taiwan&#39;,
       &#39;U.R. of Tanzania: Mainland&#39;, &#39;Uganda&#39;, &#39;Ukraine&#39;, &#39;Uruguay&#39;,
       &#39;United States&#39;, &#39;Uzbekistan&#39;, &#39;St. Vincent and the Grenadines&#39;,
       &#39;Venezuela (Bolivarian Republic of)&#39;, &#39;British Virgin Islands&#39;,
       &#39;Viet Nam&#39;, &#39;Yemen&#39;, &#39;South Africa&#39;, &#39;Zambia&#39;, &#39;Zimbabwe&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
<p>類似するメソッドに<code class="docutils literal notranslate"><span class="pre">.nunique()</span></code>がある。これを使うと，ユニークなデータの数を確認できる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>185
</pre></div>
</div>
</div>
</div>
<p><span class="pasted-text">185</span>の国・地域が含まれるということである。<code class="docutils literal notranslate"><span class="pre">unique()</span></code>でデータの年を確認することもできる。</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1950, 1951, 1952, 1953, 1954, 1955, 1956, 1957, 1958, 1959, 1960,
       1961, 1962, 1963, 1964, 1965, 1966, 1967, 1968, 1969, 1970, 1971,
       1972, 1973, 1974, 1975, 1976, 1977, 1978, 1979, 1980, 1981, 1982,
       1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993,
       1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004,
       2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015,
       2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023])
</pre></div>
</div>
</div>
</div>
<p>最初の年は<span class="pasted-text">1950</span>であり、最後の年は<span class="pasted-text">2023</span>であることが分かる。</p>
<p>データを扱う際，必ずしもデータ・セットは完璧な形で提供されているわけではないことを念頭に置く必要がある。<code class="docutils literal notranslate"><span class="pre">df</span></code>の場合，必ずしも全ての国で全ての年のデータが揃っているわけではない。それを確認する必要があるが，役に立つのが<code class="docutils literal notranslate"><span class="pre">df</span></code>のメソッド<code class="docutils literal notranslate"><span class="pre">info()</span></code>である。</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 13690 entries, 0 to 13689
Data columns (total 54 columns):
 #   Column        Non-Null Count  Dtype  
---  ------        --------------  -----  
 0   countrycode   13690 non-null  object 
 1   country       13690 non-null  object 
 2   oecd          13690 non-null  int64  
 3   income_group  13542 non-null  object 
 4   region        13690 non-null  object 
 5   continent     13690 non-null  object 
 6   year          13690 non-null  int64  
 7   rgdpe         11201 non-null  float64
 8   rgdpo         11201 non-null  float64
 9   pop           11201 non-null  float64
 10  emp           10307 non-null  float64
 11  avh           5015 non-null   float64
 12  hc            9217 non-null   float64
 13  ccon          11201 non-null  float64
 14  cda           11201 non-null  float64
 15  cgdpe         11201 non-null  float64
 16  cgdpo         11201 non-null  float64
 17  cn            11028 non-null  float64
 18  ck            7747 non-null   float64
 19  ctfp          6988 non-null   float64
 20  cwtfp         6988 non-null   float64
 21  rgdpna        11201 non-null  float64
 22  rconna        11201 non-null  float64
 23  rdana         11201 non-null  float64
 24  rnna          11028 non-null  float64
 25  rkna          7747 non-null   float64
 26  rtfpna        6988 non-null   float64
 27  rwtfpna       6988 non-null   float64
 28  labsh         8215 non-null   float64
 29  irr           8201 non-null   float64
 30  delta         11028 non-null  float64
 31  xr            11201 non-null  float64
 32  pl_con        11201 non-null  float64
 33  pl_da         11201 non-null  float64
 34  pl_gdpo       11201 non-null  float64
 35  i_cig         11201 non-null  object 
 36  i_xm          11201 non-null  object 
 37  i_xr          11201 non-null  object 
 38  i_outlier     11201 non-null  object 
 39  i_irr         8201 non-null   object 
 40  cor_exp       2112 non-null   float64
 41  csh_c         11201 non-null  float64
 42  csh_i         11201 non-null  float64
 43  csh_g         11201 non-null  float64
 44  csh_x         11201 non-null  float64
 45  csh_m         11201 non-null  float64
 46  csh_r         11201 non-null  float64
 47  pl_c          11201 non-null  float64
 48  pl_i          11201 non-null  float64
 49  pl_g          11201 non-null  float64
 50  pl_x          11201 non-null  float64
 51  pl_m          11201 non-null  float64
 52  pl_n          11028 non-null  float64
 53  pl_k          7747 non-null   float64
dtypes: float64(42), int64(2), object(10)
memory usage: 5.6+ MB
</pre></div>
</div>
</div>
</div>
<p>この出力の読み方については<a class="reference external" href="https://py4basics.github.io/3_Pandas.html#id2">Pandasの章</a>で解説したので，ここでリピートする必要はないと思うが，次の点が重要となる。</p>
<ul class="simple">
<li><p>行のインデックスは<span class="pasted-text">0</span>から<span class="pasted-text">13689</span>まであり，合計<span class="pasted-text">13690</span>行ある。<code class="docutils literal notranslate"><span class="pre">countrycode</span></code>をみると<span class="pasted-text">13690</span><code class="docutils literal notranslate"><span class="pre">non-null</span></code>となっており，<code class="docutils literal notranslate"><span class="pre">non-null</span></code>は「非欠損値（欠損値ではない）」となるため，その列の欠損値は<span class="pasted-text">0</span>であることを意味する。一方，<code class="docutils literal notranslate"><span class="pre">hc</span></code>は<span class="pasted-text">9217</span><code class="docutils literal notranslate"><span class="pre">non-null</span></code>となっており，<span class="pasted-text">13690</span><span class="math notranslate nohighlight">\(-\)</span><span class="pasted-text">9217</span><code class="docutils literal notranslate"><span class="pre">non-null</span></code><span class="math notranslate nohighlight">\(=\)</span><span class="pasted-text">4473</span>の欠損値が存在する。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">float64</span></code>は浮動小数点型データであり，<code class="docutils literal notranslate"><span class="pre">object</span></code>は文字列のデータと考えて良いだろう。</p></li>
</ul>
<p>また、<code class="docutils literal notranslate"><span class="pre">object</span></code>に関しては少し注意が必要となる。列に文字列が１つ混じっていて，他は<code class="docutils literal notranslate"><span class="pre">float</span></code>であっても<code class="docutils literal notranslate"><span class="pre">object</span></code>となるので注意が必要である。次の例がそれを示している。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">]})</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 6 entries, 0 to 5
Data columns (total 1 columns):
 #   Column  Non-Null Count  Dtype 
---  ------  --------------  ----- 
 0   a       6 non-null      object
dtypes: object(1)
memory usage: 180.0+ bytes
</pre></div>
</div>
</div>
</div>
<p>そしてもう一つ。<code class="docutils literal notranslate"><span class="pre">hc</span></code>には欠損値があると分かったが，その定義を個別で確認したい場合，<code class="docutils literal notranslate"><span class="pre">py4macro</span></code>の引数<code class="docutils literal notranslate"><span class="pre">description=2</span></code>を使うと<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>が返されるので，それを使うと良いだろう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">teigi</span> <span class="o">=</span> <span class="n">py4macro</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;pwt&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">teigi</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s1">&#39;hc&#39;</span><span class="p">],:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable definition</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>hc</th>
      <td>Human capital index, based on years of schooli...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>ただ，これだと定義の説明が全て表示できない。その場合は<code class="docutils literal notranslate"><span class="pre">py4macro.show()</span></code>関数を使うとフルに表示できる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">py4macro</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">teigi</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s1">&#39;hc&#39;</span><span class="p">],:])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable definition</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>hc</th>
      <td>Human capital index, based on years of schooling and returns to education; see Human capital in PWT9.</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>上のコードで<code class="docutils literal notranslate"><span class="pre">.loc['hc',:]</span></code>とすると<code class="docutils literal notranslate"><span class="pre">Series</span></code>が返されるので，表示が少し異なることになる。</p>
</div>
<p>実際にデータを使う前に，含まれているGDPの変数について簡単に説明する。世界中の経済のGDPを比較可能な形でデータを作成するのは非常に難しい。経済によって消費・生産・輸出・輸入する財の種類・量も違えば，価格も違う。それに購買力平価（PPPs; Purchasing Power Parities; <a class="reference external" href="https://www.worldbank.org/en/programs/icp">PWTで使うPPPs</a>）を使って経済間のGDPを共通の貨幣単位に変換したとしても，時系列的に実質化するには更なる調整が必要となる。またGDPの３面等価により，概念的には産出，支出，所得データを使いGDPを計算することができるが，どのデータを使うかという点も考慮する必要がある。このような問題に対処するために，PWTには５つのGDPの変数が用意されている。</p>
<ul class="simple">
<li><p>使える過去のPPPsのデータに基づき経済間の価格の違いを考慮している。</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">cgdpo</span></code>：産出データに基づいている。それぞれの年の物価水準は米国の物価水準に対しての相対価格として表されているため，そういう意味において経済間では実質と言える。しかし，時系列的には名目。<strong>ある年</strong>で経済間の生産能力<strong>水準</strong>の比較に適している。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cgdpe</span></code>：支出データに基づいている。<code class="docutils literal notranslate"><span class="pre">cgdpo</span></code>と同様に経済間では実質と言える。しかし，時系列的には名目。<strong>ある年</strong>で経済間の生活<strong>水準</strong>の比較に適している。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rgdpo</span></code>：産出データに基づいている。<code class="docutils literal notranslate"><span class="pre">cgdpo</span></code>と同様に経済間では実質と言える。また，時系列的には実質。<strong>ある期間</strong>で経済間の生産能力<strong>水準</strong>の比較に適している。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rgdpe</span></code>：支出データに基づいている。<code class="docutils literal notranslate"><span class="pre">cgdpo</span></code>と同様に経済間では実質と言える。また，時系列的には実質。<strong>ある期間</strong>で経済間の生活<strong>水準</strong>の比較に適している。</p></li>
<li><p>上記４つの変数は，過去のPPPsのデータに基づいて計算されているため，成長率を計算するとPPPsに影響を受けることになる。従って，成長率の比較には使わない方が良いだろう。</p></li>
</ul>
</li>
<li><p>ある基準年のPPPsだけに基づき経済間の価格の違いを考慮している。</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">rgdpna</span></code>：それぞれの経済の国民経済計算を使っており，時系列的には実質。GDPの<strong>成長率</strong>の比較に適している。</p></li>
</ul>
</li>
</ul>
</section>
<section id="id4">
<h2>発展会計の考え方<a class="headerlink" href="#id4" title="Link to this heading">#</a></h2>
<p>経済間の所得格差の要因を探るために，次の生産関数を考えよう。</p>
<div class="math notranslate nohighlight" id="equation-eq-5-production">
<span class="eqno">(1)<a class="headerlink" href="#equation-eq-5-production" title="Link to this equation">#</a></span>\[
Y_i=A_iK_i^\alpha\left(h_iH_iL_i\right)^{1-\alpha}
,\quad
0&lt;\alpha&lt;1
\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(i\)</span>：経済<code class="docutils literal notranslate"><span class="pre">i</span></code></p></li>
<li><p><span class="math notranslate nohighlight">\(Y_i\)</span>：GDP</p></li>
<li><p><span class="math notranslate nohighlight">\(K_i\)</span>：物的資本</p></li>
<li><p><span class="math notranslate nohighlight">\(A_i\)</span>：全要素生産性（TFP）</p></li>
<li><p><span class="math notranslate nohighlight">\(H_i\)</span>：労働者一人当たりの人的資本</p></li>
<li><p><span class="math notranslate nohighlight">\(h_i\)</span>：労働者一人当たりの平均労働時間</p></li>
<li><p><span class="math notranslate nohighlight">\(L_i\)</span>：労働者数</p></li>
</ul>
<p>GDPは労働，物的人的資本とTFPによって決定されると考える，ということである。このアプローチは大雑把な印象を否めないが，データを使う事により，重要な知見を得ることが可能となる。次に，生産関数を一人当たりに書き換えよう。</p>
<div class="math notranslate nohighlight" id="equation-eq-5-yi">
<span class="eqno">(2)<a class="headerlink" href="#equation-eq-5-yi" title="Link to this equation">#</a></span>\[
\frac{Y_i}{L_i}=A_i
\left(
    \frac{K_i}{L_i}
\right)^{\alpha}
\left(
h_iH_i
\right)^{1-\alpha}
\quad\Rightarrow\quad
y_i=A_ik_i^{\alpha}\left(h_iH_i\right)^{1-\alpha}
\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(y_i=\dfrac{Y_i}{L_i}\)</span>：一人当たりGDP</p></li>
<li><p><span class="math notranslate nohighlight">\(k_i=\dfrac{K_i}{L_i}\)</span>：一人当たり物的資本</p></li>
</ul>
<p>この式を使い経済間の一人当たりGDPの違いを考察する事になる。即ち，<span class="math notranslate nohighlight">\(A_i\)</span>，<span class="math notranslate nohighlight">\(k_i\)</span>，<span class="math notranslate nohighlight">\(h_i\)</span>，<span class="math notranslate nohighlight">\(H_i\)</span>の違いを使って<span class="math notranslate nohighlight">\(y_i\)</span>の違いを説明しようという事である。以下では，<span class="math notranslate nohighlight">\(h_iH_i\)</span>と<span class="math notranslate nohighlight">\(k_i\)</span>，<span class="math notranslate nohighlight">\(h_i\)</span>，<span class="math notranslate nohighlight">\(H_i\)</span>を合わせた項を次のように呼ぶ事にする。</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
&amp;\text{（労働者一人当たり）人的資本サービス： } h_iH_i\\
&amp;\text{（労働者一人当たり）蓄積生産要素： } k_i^{\alpha}\left(h_iH_i\right)^{1-\alpha}
\end{align*}
\end{split}\]</div>
<p>使うデータ・セットには，<span class="math notranslate nohighlight">\(y_i\)</span>，<span class="math notranslate nohighlight">\(k_i\)</span>，<span class="math notranslate nohighlight">\(h_i\)</span>に対応する変数があり，蓄積生産要素がどれだけ一人当たりGDPに寄与するかを数値で表すことができる。一方，全要素生産性は次の式で求めることができる。</p>
<div class="math notranslate nohighlight" id="equation-eq-5-ai">
<span class="eqno">(3)<a class="headerlink" href="#equation-eq-5-ai" title="Link to this equation">#</a></span>\[
A_i=\dfrac{y_i}{k_i^{\alpha}\left(h_iH_i\right)^{1-\alpha}}
\]</div>
<p>これらの式とデータを使って，一人当たりGDPに対する蓄積生産要素と全要素生産性の寄与度を数量化する事になる。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>生産関数<a class="reference internal" href="#equation-eq-5-production">(1)</a>の仮定のもとで<span class="math notranslate nohighlight">\(A_i\)</span>が上昇したとしよう。物的人的資本の限界生産性が上昇するため，<span class="math notranslate nohighlight">\(k_i\)</span>と<span class="math notranslate nohighlight">\(H_i\)</span>は増加することになる。即ち，<span class="math notranslate nohighlight">\(A_i\)</span>の上昇により一人当たりGDPは上昇するが，間接的に<span class="math notranslate nohighlight">\(k_i\)</span>と<span class="math notranslate nohighlight">\(H_i\)</span>も増加させ<span class="math notranslate nohighlight">\(y_i\)</span>が増加する。これにより本来<span class="math notranslate nohighlight">\(A_i\)</span>による効果が<span class="math notranslate nohighlight">\(k_i\)</span>と<span class="math notranslate nohighlight">\(H_i\)</span>の寄与度に算入されることになり，全要素生産性の寄与度の過小評価につながる可能性がある。この問題は練習問題で取り上げることにする。</p>
</div>
<p>データ・セットに含まれるどの変数を使うかという問題があるが，ここでは次のデータを使うことにする。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">rgdpo</span></code>：生産面から計算したGDP（current PPPs; in mil. 2011US$）</p>
<ul>
<li><p>経済間では一定な価格を使い計算されているが、時系列的には実質</p></li>
<li><p>ある年に経済間の比較をするのに適している</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">emp</span></code>：雇用者数（in millions）</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">avh</span></code>：年間平均労働時間</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ck</span></code>：資本サービス水準（current PPPs (USA=1)）</p>
<ul>
<li><p>資本ストックを生産に使うことにより得るサービス</p></li>
<li><p>USA=1と基準化されているが，米国との比率を考えるため，基準化による問題はなくなる。</p></li>
<li><p>データ・セットには次に２つが含まれている。</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">cn</span></code>：資本ストック（current PPPs, in mil. 2011US$，タクシーを例にすると車体の価額)。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ck</span></code>：資本サービス（current PPPs, USA=1，タクシーを例にするとそのサービス（走行距離など）)。</p></li>
</ul>
</li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">hc</span></code>：一人当たり人的資本の指標</p>
<ul>
<li><p>教育年数と教育の収益から計算されている</p></li>
</ul>
</li>
</ul>
<p>式に当てはめると次のようになる。</p>
<ul class="simple">
<li><p>一人当たりGDP：<span class="math notranslate nohighlight">\(y_i\equiv\dfrac{Y_i}{L_i}=\)</span> <code class="docutils literal notranslate"><span class="pre">cgdpo</span></code>/<code class="docutils literal notranslate"><span class="pre">emp</span></code></p></li>
<li><p>一人当たり資本：<span class="math notranslate nohighlight">\(k_i\equiv\dfrac{K_i}{L_i}=\)</span> <code class="docutils literal notranslate"><span class="pre">ck</span></code>/<code class="docutils literal notranslate"><span class="pre">emp</span></code></p></li>
<li><p>労働者一人当たり人的資本サービス：<span class="math notranslate nohighlight">\(h_iH_i=\)</span> <code class="docutils literal notranslate"><span class="pre">avh</span></code>x<code class="docutils literal notranslate"><span class="pre">hc</span></code></p></li>
<li><p>資本の所得シャア：<span class="math notranslate nohighlight">\(\alpha=1/3\)</span>を仮定</p></li>
</ul>
<p>これに従ってコードを書いていこう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 資本の所得シャア</span>
<span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mf">3.0</span>

<span class="c1"># 労働者一人当たりGDP</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;cgdpo&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;emp&#39;</span><span class="p">]</span>

<span class="c1"># 一人当たり資本</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;kpc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;ck&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;emp&#39;</span><span class="p">]</span>

<span class="c1"># 蓄積生産要素</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;factors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;kpc&#39;</span><span class="p">]</span><span class="o">**</span><span class="n">a</span> <span class="o">*</span> <span class="p">(</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;hc&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;avh&#39;</span><span class="p">]</span> <span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">a</span><span class="p">)</span>

<span class="c1"># 全要素生産性</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;tfp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;factors&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id5">
<h2><span class="pasted-text">2023</span>年<a class="headerlink" href="#id5" title="Link to this heading">#</a></h2>
<p><span class="pasted-text">2023</span>年だけを抽出する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cond</span> <span class="o">=</span> <span class="p">(</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">latest_yr</span> <span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,:]</span>
</pre></div>
</div>
</div>
</div>
<section id="gdp">
<h3>一人当たりGDP<a class="headerlink" href="#gdp" title="Link to this heading">#</a></h3>
<p>わかりやすくするために，全ての国の一人当たりGDPを米国の一人当たりGDPで割り、米国を１（基準）として議論を進める事にする。先に，米国だけのデータを抽出する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cond</span> <span class="o">=</span> <span class="p">(</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;country&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;United States&quot;</span> <span class="p">)</span>
<span class="n">us</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,:]</span>
</pre></div>
</div>
</div>
</div>
<p>次に，米国を基準とした相対的な一人当たりGDP作成し，<code class="docutils literal notranslate"><span class="pre">df</span></code>に新たな列として代入によう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;y_relative&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">us</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<p>右辺の<code class="docutils literal notranslate"><span class="pre">df['y']</span></code>と<code class="docutils literal notranslate"><span class="pre">us['y']</span></code>は<code class="docutils literal notranslate"><span class="pre">Series</span></code>だが，要素数が異なる。従って，分母の<code class="docutils literal notranslate"><span class="pre">us['y']</span></code>をそのまま使うとエラーが発生する。<code class="docutils literal notranslate"><span class="pre">iloc[0]</span></code>を使うことにより，<code class="docutils literal notranslate"><span class="pre">us['y']</span></code>に一つだけある要素を抽出し，エラーの発生を防いでいる。<code class="docutils literal notranslate"><span class="pre">iloc[0]</span></code>の代わりに<code class="docutils literal notranslate"><span class="pre">NumPy</span></code>の<code class="docutils literal notranslate"><span class="pre">array</span></code>に変換するメソッドである<code class="docutils literal notranslate"><span class="pre">.to_numpy()</span></code>を使うことも可能である。</p>
</div>
<p>ヒストグラムをプロットしてみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;y_relative&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b46b6f8de63a35a418900e42121f7c7d2b7d9e201b899f230fc6b86ec1686594.png" src="_images/b46b6f8de63a35a418900e42121f7c7d2b7d9e201b899f230fc6b86ec1686594.png" />
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Matplotlibを直接使う場合</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-0" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" for="sd-tab-item-0">
方法１</label><div class="sd-tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="s1">&#39;y_relative&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-1" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" for="sd-tab-item-1">
方法２</label><div class="sd-tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="s1">&#39;y_relative&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-2" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" for="sd-tab-item-2">
方法３</label><div class="sd-tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="s1">&#39;y_relative&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
</div>
<p>最小値と最大値を計算してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;y_relative&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;y_relative&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.0019305570483580342, 1.7583029058702404)
</pre></div>
</div>
</div>
</div>
<p>最貧国は米国の一人当たりGDPの約<span class="pasted-text">0.193</span>％である。一方、米国の約<span class="pasted-text">1.758</span>倍の国もある。</p>
</section>
<section id="id6">
<h3>物的資本<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<p>物的資本についても同様に，全ての国の<code class="docutils literal notranslate"><span class="pre">k_pc</span></code>を米国の<code class="docutils literal notranslate"><span class="pre">k_pc</span></code>で割り基準化する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;kpc_relative&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;kpc&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">us</span><span class="p">[</span><span class="s1">&#39;kpc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>データを散布図で確認しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;kpc_relative&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;y_relative&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8bd2b9d7aa9aa746ef8ff39d61c429f0210b338b0042774cf8b2ac5021bf35fd.png" src="_images/8bd2b9d7aa9aa746ef8ff39d61c429f0210b338b0042774cf8b2ac5021bf35fd.png" />
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Matplotlibを直接使う場合</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-3" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" for="sd-tab-item-3">
方法１</label><div class="sd-tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;kpc_relative&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;y_relative&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-4" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" for="sd-tab-item-4">
方法２</label><div class="sd-tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;kpc_relative&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;y_relative&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-5" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" for="sd-tab-item-5">
方法３</label><div class="sd-tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;kpc_relative&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;y_relative&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
</div>
<p>正の関係があることが確認できる。またデータの曲線トレンドは凹関数のようである。<code class="docutils literal notranslate"><span class="pre">y_relative</span></code>に対する<code class="docutils literal notranslate"><span class="pre">k_pc_relative</span></code>増加の影響は，<code class="docutils literal notranslate"><span class="pre">k_pc_relative</span></code>が低いと大きく，<code class="docutils literal notranslate"><span class="pre">k_pc_relative</span></code>が高いと小さくなる。即ち，資本の限界生産性の逓減の反映と考えられる。ただ，この効果のみで上の図を解釈するには問題がある。第一に，異なる経済のクロスセクション・データ（横断面データ）であるため，経済間の様々な異質性が反映されている。即ち，全ての観測値は同じ生産関数から生成されている訳ではない。第二に，資本の限界生産性の逓減という概念は，労働や他の投入が一定のもとでの比較静学の結果である。しかし，他の投入は一定に固定されている訳ではない。これらを考慮しつつ図の解釈をするべきではあるが，データの裏には資本の限界生産性の逓減のメカニズムが働いていると考えるのは自然であろう。</p>
</section>
<section id="id7">
<h3>人的資本サービス<a class="headerlink" href="#id7" title="Link to this heading">#</a></h3>
<p>まず人的資本<code class="docutils literal notranslate"><span class="pre">hc</span></code>を考察する事にする。それにより労働時間<code class="docutils literal notranslate"><span class="pre">avh</span></code>の効果も理解できるだろう。
全ての国の<code class="docutils literal notranslate"><span class="pre">hc</span></code>を米国の<code class="docutils literal notranslate"><span class="pre">hc</span></code>で割り，米国を<code class="docutils literal notranslate"><span class="pre">1</span></code>とする人的資本インデックスを作成する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;hc_relative&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;hc&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">us</span><span class="p">[</span><span class="s1">&#39;hc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>散布図で確認してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;hc_relative&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;y_relative&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/fe7c01284b5a6f0fa1ef8db5835e4537b8f4cbcd4b41aced6d79b170a607d8e9.png" src="_images/fe7c01284b5a6f0fa1ef8db5835e4537b8f4cbcd4b41aced6d79b170a607d8e9.png" />
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Matplotlibを直接使う場合</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-6" name="sd-tab-set-2" type="radio">
<label class="sd-tab-label" for="sd-tab-item-6">
方法１</label><div class="sd-tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;hc_relative&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;y_relative&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-7" name="sd-tab-set-2" type="radio">
<label class="sd-tab-label" for="sd-tab-item-7">
方法２</label><div class="sd-tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;hc_relative&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;y_relative&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-8" name="sd-tab-set-2" type="radio">
<label class="sd-tab-label" for="sd-tab-item-8">
方法３</label><div class="sd-tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;hc_relative&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;y_relative&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
</div>
<p>正の関係があることがわかる。即ち，人的資本ストックが高ければ，一人当たり所得も増えるという事であり，非常に直感的でもある。一方，物的資本と比べると，曲線トレンドは凸関数になっている。裏にあるメカニズムとして様々なことが想定できる。</p>
<ul class="simple">
<li><p>労働者のスキルが高いため，同じ時間でより多くの財を生産できる。</p></li>
<li><p>学習能力が高いため，生産活動をとおして更にスキル向上，生産性向上につながる（学習効果）。</p></li>
<li><p>人的資本には，人に教える能力も含まれる（例えば，教師）。それにより，さらなる人的資本ストックの増加につながる。</p></li>
<li><p>人から学ぶ能力も高いため，技術・知識の伝播の速度を速め，経済全体の生産性を向上させる。</p></li>
<li><p>新しい技術・知識の創出，即ち，イノベーションを起こす必要不可欠な要素である。</p></li>
<li><p>海外からの技術移転にも貢献する。</p></li>
<li><p>リスクに対する理解が深まり，リスクは高いがより生産性が高い活動への投資につながる。</p></li>
<li><p>などなど</p></li>
</ul>
<p>ここで見えてくるのは人的資本の「外部性」の効果である。典型的な例が，学習効果である。人的資本が増えると，生産量が高くなり学習する機会が増え，更なる人的資本の増加につながる。それが更なる生産量の増加となり，相乗効果として凸関数トレンドとして現れていると解釈できる。また，能力が上がれば，それだけ新しい知識や技術をより簡単に吸収することが可能となるだろう。更には，周りに優れた人に囲まれて仕事や勉強をすれば，それに引っ張られて自分の能力も増してくる事になるのは多くの人が経験していることではないだろうか。労働者はこのような効果を意識して（例えば，他人への効果を考慮して）行動しているわけではない。即ち，外部性が一つの基本メカニズムとして働いているという解釈が成り立つ。</p>
<p>一方で，違う見方を可能である。閾値効果である。図を見ると，<code class="docutils literal notranslate"><span class="pre">h_relative</span></code>が低いところから増加しても<code class="docutils literal notranslate"><span class="pre">y_relative</span></code>は大きく増加しないが，0.7あたりから増加率が増している。0.7付近で接続される２つの直線からなる折れ線グラフのようなトレンドが想定できるのではないだろうか。変数<code class="docutils literal notranslate"><span class="pre">hc</span></code>は，教育年数が一つの決定要因となっており，<code class="docutils literal notranslate"><span class="pre">hc</span></code>が低い経済では初等教育はある程度整っているが，高等教育が十分ではないと考えられる。従って，初等教育よりも高等教育の方が生産により大きな効果をもたらすとも考えられる。</p>
<p>人的資本の効果がある程度わかったので，次に人的資本サービスについて考えよう。全ての国の<code class="docutils literal notranslate"><span class="pre">hav</span></code>x<code class="docutils literal notranslate"><span class="pre">hc</span></code>を米国の<code class="docutils literal notranslate"><span class="pre">hav</span></code>x<code class="docutils literal notranslate"><span class="pre">hc</span></code>で割り基準化する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;human_relative&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;avh&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;hc&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">/</span> \
                       <span class="p">(</span> <span class="n">us</span><span class="p">[</span><span class="s1">&#39;avh&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">us</span><span class="p">[</span><span class="s1">&#39;hc&#39;</span><span class="p">]</span> <span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>散布図で確認してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;human_relative&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;y_relative&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1aa38619d3e4a84791a9c418363f4f29411d7f0a3b824fd414169f697b75cfdf.png" src="_images/1aa38619d3e4a84791a9c418363f4f29411d7f0a3b824fd414169f697b75cfdf.png" />
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Matplotlibを直接使う場合</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-9" name="sd-tab-set-3" type="radio">
<label class="sd-tab-label" for="sd-tab-item-9">
方法１</label><div class="sd-tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;human_relative&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;y_relative&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-10" name="sd-tab-set-3" type="radio">
<label class="sd-tab-label" for="sd-tab-item-10">
方法２</label><div class="sd-tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;human_relative&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;y_relative&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-11" name="sd-tab-set-3" type="radio">
<label class="sd-tab-label" for="sd-tab-item-11">
方法３</label><div class="sd-tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;human_relative&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;y_relative&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
</div>
<p>正の関係であることは変わらないが，相関度は減少している。これは労働時間の影響であるり，一人当たりGDPとの散布図をプロットして確認してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;avh_relative&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;avh&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">us</span><span class="p">[</span><span class="s1">&#39;avh&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;avh_relative&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;y_relative&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/37f67f35b294cda2005995df18a104e0eaad3d3af94b172594a5af1188f5bbaf.png" src="_images/37f67f35b294cda2005995df18a104e0eaad3d3af94b172594a5af1188f5bbaf.png" />
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Matplotlibを直接使う場合</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-12" name="sd-tab-set-4" type="radio">
<label class="sd-tab-label" for="sd-tab-item-12">
方法１</label><div class="sd-tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;avh_relative&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;y_relative&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-13" name="sd-tab-set-4" type="radio">
<label class="sd-tab-label" for="sd-tab-item-13">
方法２</label><div class="sd-tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;avh_relative&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;y_relative&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-14" name="sd-tab-set-4" type="radio">
<label class="sd-tab-label" for="sd-tab-item-14">
方法３</label><div class="sd-tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;avh_relative&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;y_relative&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
</div>
<p>負の相関関係にあると言えるだろう。即ち，豊かな経済では労働時間が短くなる傾向にある。この傾向は，ミクロ経済学の授業で習った消費者の労働供給モデルを考えて解釈することができる。所得が上昇すると，所得効果により労働供給は減少するが，代替効果により労働時間は上昇する。上の図は，所得効果が代替効果を上回っている結果の反映と考えることが可能である。一方で，経済間では所得だけではなく他の要因も異なることも念頭においておこう。いずれにしろ，労働時間の負の関係により，人的資本サービスと一人当たりGDPの相関は弱くなっている。</p>
</section>
<section id="sec-5a-tfp">
<span id="id8"></span><h3>全要素生産性<a class="headerlink" href="#sec-5a-tfp" title="Link to this heading">#</a></h3>
<p>米国を<code class="docutils literal notranslate"><span class="pre">1</span></code>に基準化して一人当たりGDPと全要素生産性との関係を図示する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;tfp_relative&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;tfp&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">us</span><span class="p">[</span><span class="s1">&#39;tfp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;tfp_relative&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;y_relative&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/aa85fc899c22dbb37a3082d8296c9ebe40cf0713e08c6d1838e3385dec12538c.png" src="_images/aa85fc899c22dbb37a3082d8296c9ebe40cf0713e08c6d1838e3385dec12538c.png" />
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Matplotlibを直接使う場合</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-15" name="sd-tab-set-5" type="radio">
<label class="sd-tab-label" for="sd-tab-item-15">
方法１</label><div class="sd-tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;tfp_relative&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;y_relative&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-16" name="sd-tab-set-5" type="radio">
<label class="sd-tab-label" for="sd-tab-item-16">
方法２</label><div class="sd-tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;tfp_relative&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;y_relative&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-17" name="sd-tab-set-5" type="radio">
<label class="sd-tab-label" for="sd-tab-item-17">
方法３</label><div class="sd-tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;tfp_relative&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;y_relative&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
</div>
<p>正の相関関係にあることは明らかであり，直線のトレンドであることがわかる。物的資本の場合は凹関数トレンドで，限界生産性の逓減の反映とも解釈できた。人的資本の場合は凸関数トレンドで，外部性の効果が示唆された。全要素生産性の直線トレンドの解釈はどうなるのだろう。まず，物的資本のように，限界生産性の逓減があれば凹型トレンドになるはずだが，それを抑えるメカニズムが働いていると考えられる。それが正の外部性の存在である。</p>
<p>全要素生産性は，蓄積生産要素で説明できない一人当たりGDPとして定義されているが，広く使われる解釈が技術水準である。技術水準はイノベーションなどにより決定され，外部性の役割が大きいと理解されている。それを説明するために，アイザック・ニュートンが言ったとされる次の引用を考えてみよう。</p>
<blockquote>
<div><p>If I have seen further, it is by standing on the shoulders of Giants.</p>
</div></blockquote>
<p>ここでのhave seen furtherとはニュートンの天才的な能力・発見を指し，the shoulders of Giantsは先人が築き上げた知識・知見を意味する。ここで重要な点は，ニュートンは殆ど無料（書籍代や読書の機会費用はあるだろうが）で当時までに蓄積された知識を使うことができたということである。また多くの「先人」はニュートンがアイデアを参考にするとは想定していない，もしくはアイデアを使う対価を受け取っていないと思われれ，まさしく正の外部性が存在している（研究開発には負の外部性もある）。このようなことは，今でも発生している。新薬や新しいくゲーム・ソフトを作る場合，まず市場にある財を参考にする。知的財産権で守られているためコピー商品は違法だが，特許で開示されている技術やデザインなどを参考に新たな財を作り出すことは日常茶飯事である。この考えを使って上のデータを解釈してみよう。全世界的に技術水準が低ければ，他から学ぶ土壌が乏しく，TFPの一人当たりGDPに対する影響は限定的になる。一方，経済間の技術水準に大きな差がある場合，遅れている経済は進んでいる経済から学ぶことができる。更には，技術水準が高い経済同士も異なる考え方などをお互いから多くを学ぶ環境が存在することになる。これにより，TFPの効果はより大きなものとなって現れていると考えられ，技術水準の限界生産性の逓減が中和されることにより直線トレンドとしてあらわれていると解釈できる。</p>
<p>関連する問題として，生産関数の仮定と全要素生産性の関係について次の点を付け加えておく。TFPを計算する上でコブ・ダグラス生産関数を使ったが，規模に対して収穫一定を仮定している。もしこの仮定が間違っていて，規模に関して収穫逓増が正しい場合どのようなバイアスが発生するのだろうか。この点を明らかにするために，真の生産関数が次式で与えられるとしよう。</p>
<div class="math notranslate nohighlight">
\[
Y_i=\tilde{A}_i\left(K_i^\alpha H_i^{1-\alpha}\right)^\mu,
\quad\mu&gt;1
\]</div>
<p><span class="math notranslate nohighlight">\(\mu=1\)</span>を仮定したわけだが，<span class="math notranslate nohighlight">\(\mu&gt;1\)</span>の場合は規模に関して収穫逓増となる。<span class="math notranslate nohighlight">\(\tilde{A}_i\)</span>は真のTFPを指しており，<span class="math notranslate nohighlight">\(\mu=1\)</span>と<span class="math notranslate nohighlight">\(\mu&gt;1\)</span>の場合のTFPの比率は次の式で表される。</p>
<div class="math notranslate nohighlight">
\[
\dfrac{A_i}{\tilde{A}_i}
=\dfrac{
        \dfrac{Y_i}{K_i^\alpha H_i^{1-\alpha}}
        }{
        \dfrac{Y_i}{\left(K_i^\alpha H_i^{1-\alpha}\right)^\mu}
        }
=\left(K_i^\alpha H_i^{1-\alpha}\right)^{\mu-1}
&gt;1
\]</div>
<p><span class="math notranslate nohighlight">\(K_i^\alpha H_i^{1-\alpha}&gt;1\)</span>と考えると，収穫一定のTFPは真のTFPを過大評価する事がわかる。何が起こっているのだろうか。<span class="math notranslate nohighlight">\(\mu&gt;1\)</span>の場合に収穫一定を仮定すると，</p>
<div class="math notranslate nohighlight">
\[
K_i^\alpha H_i^{1-\alpha}
&lt;
\left(K_i^\alpha H_i^{1-\alpha}\right)^\mu
\]</div>
<p>となり，蓄積生産要素の効果が過小評価されることになる。これにより物的人的資本の効果の一部をTFPの貢献だと間違って判断しTFPの過大評価になっている。では，なぜ規模に関して収穫逓増になり得るのだろうか。それが技術水準や蓄積生産要素の外部性である。技術水準と人的資本の外部性について簡単に説明したが，物的資本ストックも外部性を発生させると考えられる。物的資本ストックが増えると一人当たりGDPを増加させる。それにより，人的資本の学習効果を強める事になる。また研究開発のヒントを与えるようなきっかけにもなるかもしれない。そのような相乗効果により規模に関して収穫逓増になる生産関数を想定することも可能である。しかし多くの研究では規模に関して収穫一定の下で議論が進められており，以下ではそれを踏襲して<span class="math notranslate nohighlight">\(\mu=1\)</span>とする。</p>
</section>
<section id="id9">
<h3>相関係数<a class="headerlink" href="#id9" title="Link to this heading">#</a></h3>
<p>一人当たりGDPと全要素生産性の散布図から，両変数の相関度は非常に高いと思われる。相関係数を計算してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,[</span><span class="s1">&#39;y_relative&#39;</span><span class="p">,</span><span class="s1">&#39;tfp_relative&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>y_relative</th>
      <th>tfp_relative</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>y_relative</th>
      <td>1.000000</td>
      <td>0.928328</td>
    </tr>
    <tr>
      <th>tfp_relative</th>
      <td>0.928328</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<p><code class="docutils literal notranslate"><span class="pre">.corr()</span></code>は相関係数を計算するメソッド</p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">y_relative</span></code>と<code class="docutils literal notranslate"><span class="pre">tfp_relative</span></code>の相関係数は約<span class="output text_plain">0.928</span>であり、非常に高いことがわかる。</p>
<p>次に，蓄積生産要素と一人当たりGDPの散布図を作成し，相関係数を計算してみよう図示する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;factors_relative&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;factors&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">us</span><span class="p">[</span><span class="s1">&#39;factors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;factors_relative&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;y_relative&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a28dfe84d2f97195746fa59741573f0b0c2aeccb01455b64f8ea418cf5f5a685.png" src="_images/a28dfe84d2f97195746fa59741573f0b0c2aeccb01455b64f8ea418cf5f5a685.png" />
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Matplotlibを直接使う場合</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-18" name="sd-tab-set-6" type="radio">
<label class="sd-tab-label" for="sd-tab-item-18">
方法１</label><div class="sd-tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;factors_relative&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;y_relative&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-19" name="sd-tab-set-6" type="radio">
<label class="sd-tab-label" for="sd-tab-item-19">
方法２</label><div class="sd-tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;factors_relative&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;y_relative&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-20" name="sd-tab-set-6" type="radio">
<label class="sd-tab-label" for="sd-tab-item-20">
方法３</label><div class="sd-tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;factors_relative&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;y_relative&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
</div>
<p>視覚的には，TFPと比べて相関度は若干低いようである。コードで確認しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,[</span><span class="s1">&#39;y_relative&#39;</span><span class="p">,</span><span class="s1">&#39;factors_relative&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>y_relative</th>
      <th>factors_relative</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>y_relative</th>
      <td>1.000000</td>
      <td>0.862849</td>
    </tr>
    <tr>
      <th>factors_relative</th>
      <td>0.862849</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>TFPより相関係数は低いことが確認できた。</p>
</section>
</section>
<section id="sec-5-tfp-factors">
<span id="id10"></span><h2>全要素生産性と蓄積生産要素の寄与度<a class="headerlink" href="#sec-5-tfp-factors" title="Link to this heading">#</a></h2>
<p>全要素生産性と蓄積生産要素はそれぞれ一人当たりGDPにどれだけ寄与しているかを考えるために，次の方法を考える。まず生産関数を使い以下を定義する。</p>
<div class="math notranslate nohighlight" id="equation-eq-5-relative-production">
<span class="eqno">(4)<a class="headerlink" href="#equation-eq-5-relative-production" title="Link to this equation">#</a></span>\[
R_i^y=R_i^{\text{tfp}}R_i^{\text{factors}}
\]</div>
<p>ここで</p>
<div class="math notranslate nohighlight">
\[
R_i^y\equiv\dfrac{y_i}{y_{\text{US}}},\quad
R_i^{\text{tfp}}\equiv\dfrac{A_i}{A_{\text{US}}},\quad
R_i^{\text{factors}}\equiv
\dfrac{k_i^a\left(h_iH_i\right)^{1-a}}{k_{\text{US}}^a\left(h_{\text{US}}H_{\text{US}}\right)^{1-a}}
\]</div>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(R_i^y\)</span>：米国を基準とした相対所得</p></li>
<li><p><span class="math notranslate nohighlight">\(R_i^{\text{tfp}}\)</span>：米国を基準とした相対全要素生産性</p></li>
<li><p><span class="math notranslate nohighlight">\(R_i^{\text{factors}}\)</span>：米国を基準とした相対蓄積生産要素</p></li>
</ol>
<p>これらの変数と<code class="docutils literal notranslate"><span class="pre">df</span></code>の列は次のように対応している。</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(R_i^y\)</span>：<code class="docutils literal notranslate"><span class="pre">y_relative</span></code></p></li>
<li><p><span class="math notranslate nohighlight">\(R_i^{\text{tfp}}\)</span>：<code class="docutils literal notranslate"><span class="pre">tfp_relative</span></code></p></li>
<li><p><span class="math notranslate nohighlight">\(R_i^{\text{factors}}\)</span>：<code class="docutils literal notranslate"><span class="pre">factors_relative</span></code></p></li>
</ul>
<p>次に<a class="reference internal" href="#equation-eq-5-relative-production">(4)</a>の両辺に対数を取ると次式となる。</p>
<div class="math notranslate nohighlight" id="equation-eq-riy-decomposition">
<span class="eqno">(5)<a class="headerlink" href="#equation-eq-riy-decomposition" title="Link to this equation">#</a></span>\[
r_i^y =
r_i^{\text{tfp}} +
r_i^{\text{factors}}
\]</div>
<p>ここで，</p>
<div class="math notranslate nohighlight">
\[
r_i^y\equiv \log\left(R_i^y\right),\quad
r_i^{\text{tfp}}\equiv\log\left(R_i^{\text{tfp}}\right),\quad
r_i^{\text{factors}}\equiv\log\left(R_i^{\text{factors}}\right)
\]</div>
<p>実際に変数を作成しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;y_relative_log&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;y_relative&#39;</span><span class="p">]</span> <span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;tfp_relative_log&#39;</span><span class="p">]</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;tfp_relative&#39;</span><span class="p">]</span> <span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;factors_relative_log&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;factors_relative&#39;</span><span class="p">]</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>視覚的に<code class="docutils literal notranslate"><span class="pre">y_relative_log</span></code>の分布を確認するためにヒストグラムをプロットしてみる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;y_relative_log&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5d5b86f115b591bf3285624762f84072eab96efcb8aa35922669b398a8ff725b.png" src="_images/5d5b86f115b591bf3285624762f84072eab96efcb8aa35922669b398a8ff725b.png" />
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Matplotlibを直接使う場合</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-21" name="sd-tab-set-7" type="radio">
<label class="sd-tab-label" for="sd-tab-item-21">
方法１</label><div class="sd-tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="s1">&#39;y_relative_log&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-22" name="sd-tab-set-7" type="radio">
<label class="sd-tab-label" for="sd-tab-item-22">
方法２</label><div class="sd-tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="s1">&#39;y_relative_log&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-23" name="sd-tab-set-7" type="radio">
<label class="sd-tab-label" for="sd-tab-item-23">
方法３</label><div class="sd-tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="s1">&#39;y_relative_log&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">0.0</span></code>が米国となる。対数を使うと，貧しい国の分布がより明確になるのではないだろうか。
対数を使っても使わなくても，相対的一人当たりGDPの分布の広がりは大きいことは既に確認したことだが，その広がり幅は分散で測ることができる。
問題は，その分散が何に依存しているか，ということである。
この問いに答えるために，<span class="math notranslate nohighlight">\(X\)</span>をランダム変数をすると分散と共分散には次の関係があることを思い出そう。
（分散と共分散のルールについては<a class="reference internal" href="18_ADAS-2.html#sec-18-2-appendix-c"><span class="std std-ref">ここを参照しよう</span></a>）。</p>
<div class="math notranslate nohighlight" id="equation-eq-varx-covxx">
<span class="eqno">(6)<a class="headerlink" href="#equation-eq-varx-covxx" title="Link to this equation">#</a></span>\[
\text{Var}\left(X\right)=\text{Cov}\left(X,X\right)
\]</div>
<p><span class="math notranslate nohighlight">\(X\)</span>の分散は<span class="math notranslate nohighlight">\(X\)</span>と<span class="math notranslate nohighlight">\(X\)</span>の共分散と等しい。</p>
<p>この関係を使い，式<a class="reference internal" href="#equation-eq-riy-decomposition">(5)</a>の分散を書き換えていこう。</p>
<div class="math notranslate nohighlight" id="equation-eq-riy-decomposition-log">
<span class="eqno">(7)<a class="headerlink" href="#equation-eq-riy-decomposition-log" title="Link to this equation">#</a></span>\[\begin{split}
\begin{aligned}
\text{Var}\left(r_i^y\right)
&amp;=\text{Cov}\left(r_i^y,r_i^y\right)\\
&amp;=\text{Cov}\left(r_i^y,r_i^{\text{tfp}} + r_i^{\text{factors}}\right)\\
&amp;=\text{Cov}\left(r_i^y,r_i^{\text{tfp}}\right)+\text{Cov}\left(r_i^y,r_i^{\text{factors}}\right)
\end{aligned}
\end{split}\]</div>
<p>＜計算の説明＞</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code>行目：式<a class="reference internal" href="#equation-eq-varx-covxx">(6)</a>を利用する。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code>行目：式<a class="reference internal" href="#equation-eq-riy-decomposition">(5)</a>を代入する。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">3</span></code>行目：<span class="math notranslate nohighlight">\(r_i^{\text{tfp}}+r_i^{\text{factors}}\)</span>は線形となっているため，それぞれの共分散として展開することができる。</p></li>
</ul>
<p>この式は<span class="math notranslate nohighlight">\(r_i^y\)</span>の分散は<code class="docutils literal notranslate"><span class="pre">2</span></code>つの共分散に分解する事ができることを示している。</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\text{Var}\left(r_i^{\text{y}}\right)\)</span>：相対所得（対数; 米国＝１）の変動</p></li>
<li><p><span class="math notranslate nohighlight">\(\text{Cov}\left(r_i^{\text{y}},r_i^{\text{tfp}}\right)\)</span>：相対所得と相対全要素生産性の共分散（それぞれ対数; 米国＝１）</p></li>
<li><p><span class="math notranslate nohighlight">\(\text{Cov}\left(r_i^{\text{y}},r_i^{\text{factors}}\right)\)</span>：相対所得と相対蓄積生産要素の共分散（それぞれ対数; 米国＝１）</p></li>
</ul>
<p>更に，<a class="reference internal" href="#equation-eq-riy-decomposition-log">(7)</a>の両辺を<span class="math notranslate nohighlight">\(\text{Var}(r_i^y)\)</span>で割ると，次のように書くことができる。</p>
<div class="math notranslate nohighlight">
\[
1= \text{全要素生産性の寄与度}
+\text{蓄積生産要素の寄与度}
\]</div>
<p>ここで</p>
<div class="math notranslate nohighlight" id="equation-eq-tfp-contribution">
<span class="eqno">(8)<a class="headerlink" href="#equation-eq-tfp-contribution" title="Link to this equation">#</a></span>\[
\text{全要素生産性の寄与度}=
\dfrac{
    \text{Cov}\left(r_i^{\text{y}},r_i^{\text{tfp}}\right)
    }{
    \text{Var}(r_i^y)
    }
\]</div>
<div class="math notranslate nohighlight" id="equation-eq-factor-contribution">
<span class="eqno">(9)<a class="headerlink" href="#equation-eq-factor-contribution" title="Link to this equation">#</a></span>\[
\text{蓄積生産要素の寄与度}=
\dfrac{
    \text{Cov}\left(r_i^{\text{y}},r_i^{\text{factors}}\right)
    }{
    \text{Var}(r_i^y)
    }    
\]</div>
<p>と定義する。</p>
<p>（考え方）</p>
<p>式<a class="reference internal" href="#equation-eq-tfp-contribution">(8)</a>と<a class="reference internal" href="#equation-eq-factor-contribution">(9)</a>の分母は<span class="math notranslate nohighlight">\(\log(R_i^y)\)</span>の分散であり，それに対して分子はどれだけ変動しているかで寄与度を計算しようということである。分母に対して分子の変動が大きければ大きい程，説明力が高いと判断する。極端な例として、全ての経済の全要素生産性が同じで蓄積生産要素だけが異なる場合を考えてみよう。即ち，</p>
<div class="math notranslate nohighlight">
\[
\text{Var}\left(r_i^{\text{tfp}}\right)=0\quad\Rightarrow\quad
\text{Cov}\left(r_i^{\text{y}},r_i^{\text{tfp}}\right)
=0
\]</div>
<p>この場合、蓄積生産要素だけで一人当たりGDPの違いを説明できることになるため、全要素生産性の寄与度は<code class="docutils literal notranslate"><span class="pre">0</span></code>であり蓄積生産要素は<code class="docutils literal notranslate"><span class="pre">1</span></code>である。即ち、全要素生産性は変化しないため一人当たりGDP（対数）の分散を説明できないが，一方，蓄積生産要素の変動のみで一人当たりGDPの変動を説明している事になる。</p>
<p>以下では分散・共分散を計算するが，その前に欠損値である<code class="docutils literal notranslate"><span class="pre">NaN</span></code>がある行を削除し<code class="docutils literal notranslate"><span class="pre">df</span></code>に再割り当てする。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;y_relative_log&#39;</span><span class="p">,</span> <span class="s1">&#39;tfp_relative_log&#39;</span><span class="p">,</span> <span class="s1">&#39;factors_relative_log&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="n">cols</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<p>１行目で使った<code class="docutils literal notranslate"><span class="pre">.dropna()</span></code>は，引数なしでそのまま使うと１つでも<code class="docutils literal notranslate"><span class="pre">NaN</span></code>がある行は削除される。引数の<code class="docutils literal notranslate"><span class="pre">subset=[]</span></code>に列を指定すると，その列に<code class="docutils literal notranslate"><span class="pre">NaN</span></code>がある行だけが削除される。</p>
</div>
<p>これで
<span class="math notranslate nohighlight">\(\text{Var}\left(r_i^{y}\right)\)</span>，
<span class="math notranslate nohighlight">\(\text{Cov}\left(r_i^{\text{y}},r_i^{\text{tfp}}\right)\)</span>，
<span class="math notranslate nohighlight">\(\text{Cov}\left(r_i^{\text{y}},r_i^{\text{factors}}\right)\)</span>を計算する準備が整ったので，<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>のメソッド<code class="docutils literal notranslate"><span class="pre">.cov()</span></code>を使って分散共分散を計算しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vcov</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">cov</span><span class="p">()</span>
<span class="n">vcov</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>y_relative_log</th>
      <th>tfp_relative_log</th>
      <th>factors_relative_log</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>y_relative_log</th>
      <td>1.006052</td>
      <td>0.580623</td>
      <td>0.42543</td>
    </tr>
    <tr>
      <th>tfp_relative_log</th>
      <td>0.580623</td>
      <td>0.373833</td>
      <td>0.20679</td>
    </tr>
    <tr>
      <th>factors_relative_log</th>
      <td>0.425430</td>
      <td>0.206790</td>
      <td>0.21864</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>対角線にある値は各変数の分散となり，その他が各変数間の共分散となる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># yの分散</span>
<span class="n">y_relative_log_var</span> <span class="o">=</span> <span class="n">vcov</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># yとtfp共分散</span>
<span class="n">y_tfp_relative_log_cov</span> <span class="o">=</span> <span class="n">vcov</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># yとfactors共分散</span>
<span class="n">y_factors_relative_log_cov</span> <span class="o">=</span> <span class="n">vcov</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p><strong>全要素生産性の寄与度</strong></p>
<p>式<a class="reference internal" href="#equation-eq-tfp-contribution">(8)</a>に従って，全要素生産性の寄与度を計算しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_tfp_relative_log_cov</span> <span class="o">/</span> <span class="n">y_relative_log_var</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5771296812280919
</pre></div>
</div>
</div>
</div>
<p><strong>蓄積生産要素の寄与度</strong></p>
<p>次に式<a class="reference internal" href="#equation-eq-factor-contribution">(9)</a>を使い，蓄積生産要素の寄与度を計算しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_factors_relative_log_cov</span> <span class="o">/</span> <span class="n">y_relative_log_var</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.4228703187719081
</pre></div>
</div>
</div>
</div>
<p><strong>結果</strong></p>
<p>2019年の相対的一人当たりGDPの約<span class="output text_plain">57</span>%は全要素生産性によって説明され，残りの<span class="output text_plain">42</span>%は蓄積生産要素によって説明される。即ち，一人当たりGDPの決定要因としての全要素生産性の重要性は，蓄積生産要素と同等もしくはそれ以上である。</p>
</section>
<section id="id11">
<h2>表の作成<a class="headerlink" href="#id11" title="Link to this heading">#</a></h2>
<p>最後に，全要素生産性と蓄積生産要素の主要な国のデータを表にまとめてみる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1</span>
<span class="n">country_table</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Japan&#39;</span><span class="p">,</span> <span class="s1">&#39;United Kingdom&#39;</span><span class="p">,</span><span class="s1">&#39;United States&#39;</span><span class="p">,</span> <span class="s1">&#39;Norway&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Mexico&#39;</span><span class="p">,</span><span class="s1">&#39;Peru&#39;</span><span class="p">,</span><span class="s1">&#39;India&#39;</span><span class="p">,</span><span class="s1">&#39;China&#39;</span><span class="p">,</span><span class="s1">&#39;Zimbabwe&#39;</span><span class="p">,</span><span class="s1">&#39;Niger&#39;</span><span class="p">]</span>

<span class="c1"># 2</span>
<span class="n">cond</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">country_table</span><span class="p">)</span>

<span class="c1"># 3</span>
<span class="n">col</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;country&#39;</span><span class="p">,</span><span class="s1">&#39;y_relative&#39;</span><span class="p">,</span><span class="s1">&#39;tfp_relative&#39;</span><span class="p">,</span><span class="s1">&#39;factors_relative&#39;</span><span class="p">]</span>

<span class="c1"># 4</span>
<span class="n">table2019</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;country&#39;</span><span class="p">)</span> \
                  <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;y_relative&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> \
                  <span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> \
                  <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;y_relative&#39;</span><span class="p">:</span><span class="s1">&#39;一人当たりGDP&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;tfp_relative&#39;</span><span class="p">:</span><span class="s1">&#39;全要素生産性&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;factors_relative&#39;</span><span class="p">:</span><span class="s1">&#39;蓄積生産要素&#39;</span><span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;米国を１として&#39;</span><span class="p">)</span>
<span class="n">table2019</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>米国を１として
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>一人当たりGDP</th>
      <th>全要素生産性</th>
      <th>蓄積生産要素</th>
    </tr>
    <tr>
      <th>country</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Norway</th>
      <td>1.22</td>
      <td>1.33</td>
      <td>0.92</td>
    </tr>
    <tr>
      <th>United States</th>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>United Kingdom</th>
      <td>0.69</td>
      <td>0.82</td>
      <td>0.85</td>
    </tr>
    <tr>
      <th>Japan</th>
      <td>0.54</td>
      <td>0.63</td>
      <td>0.86</td>
    </tr>
    <tr>
      <th>Mexico</th>
      <td>0.29</td>
      <td>0.59</td>
      <td>0.50</td>
    </tr>
    <tr>
      <th>China</th>
      <td>0.28</td>
      <td>0.41</td>
      <td>0.67</td>
    </tr>
    <tr>
      <th>Peru</th>
      <td>0.17</td>
      <td>0.33</td>
      <td>0.52</td>
    </tr>
    <tr>
      <th>India</th>
      <td>0.13</td>
      <td>0.30</td>
      <td>0.42</td>
    </tr>
    <tr>
      <th>Zimbabwe</th>
      <td>0.06</td>
      <td>0.19</td>
      <td>0.32</td>
    </tr>
    <tr>
      <th>Niger</th>
      <td>0.03</td>
      <td>0.21</td>
      <td>0.16</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<ol class="arabic simple">
<li><p>表示する国のリスト</p></li>
<li><p>列<code class="docutils literal notranslate"><span class="pre">country</span></code>に<code class="docutils literal notranslate"><span class="pre">country_list</span></code>にある国名と同じであれば<code class="docutils literal notranslate"><span class="pre">True</span></code>、異なる場合は<code class="docutils literal notranslate"><span class="pre">False</span></code>を返す条件を作成している。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.isin()</span></code>はそのためのメソッド</p></li>
</ul>
</li>
<li><p>表の列ラベルに使う変数リスト</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を作成する。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.loc[cond,col]</span></code>を使い、<code class="docutils literal notranslate"><span class="pre">cond</span></code>の条件に合った行、そして<code class="docutils literal notranslate"><span class="pre">col</span></code>の列を抽出する。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.set_index('country')</span></code>は<code class="docutils literal notranslate"><span class="pre">country</span></code>の列を行ラベルに設定するメソッド。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.sort_values()</span></code>は<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を列<code class="docutils literal notranslate"><span class="pre">y_relative</span></code>に従って並び替えるメソッドであり、<code class="docutils literal notranslate"><span class="pre">ascending=False</span></code>は降順を指定している。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.round(2)</span></code>は表示する小数点を第二桁までで四捨五入することを指定するメソッド。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.rename()</span></code>は列ラベルを変更するメソッド。</p></li>
</ul>
</li>
</ol>
<p>＜コメント＞ <code class="docutils literal notranslate"><span class="pre">print()</span></code>関数を使うとテキストとして表示される。</p>
</div>
<p>この表から日本の全要素生産性は米国の<span class="output text_plain">63</span>%であり，蓄積生産要素は米国の<span class="output text_plain">86</span>%であることが分かる。</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Pythonで学ぶマクロ経済学 (中級＋レベル)</p>
      </div>
    </a>
    <a class="right-next"
       href="5b_Growth_Accounting.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">成長会計</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">はじめに</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">データ</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">発展会計の考え方</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5"><span class="pasted-text">2023</span>年</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gdp">一人当たりGDP</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">物的資本</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">人的資本サービス</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sec-5a-tfp">全要素生産性</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">相関係数</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sec-5-tfp-factors">全要素生産性と蓄積生産要素の寄与度</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">表の作成</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By 春山 鉄源  Tetsugen HARUYAMA
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2026.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <!-- Default Statcounter code for Py4Macro https://py4macro.github.io --> <script type="text/javascript"> var sc_project=12478906; var sc_invisible=1; var sc_security="e767d225"; </script> <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script> <noscript><div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img class="statcounter" src="https://c.statcounter.com/12478906/0/e767d225/1/" alt="Web Analytics"></a></div></noscript> <!-- End of Statcounter Code -->
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>