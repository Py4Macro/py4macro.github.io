
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>発展会計と成長会計 &#8212; Pythonで学ぶマクロ経済学 (中級＋レベル)</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/my_style.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://py4macro.github.io/5_Income_Differences.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="回帰分析" href="6_Regression.html" />
    <link rel="prev" title="Matplotlib" href="4_matplotlib.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      <h1 class="site-logo" id="site-title">Pythonで学ぶマクロ経済学 (中級＋レベル)</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <p class="caption">
 <span class="caption-text">
  Pythonの学習
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="1_Python_Basics.html">
   Pythonの基礎
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2_NumPy.html">
   NumPy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="3_Pandas.html">
   Pandas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="4_matplotlib.html">
   Matplotlib
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  マクロ経済学 - 長期分析
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   発展会計と成長会計
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="6_Regression.html">
   回帰分析
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="7_DifferenceEq.html">
   差分方程式と経済分析
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="8_Solow.html">
   ソロー・モデル
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="9_Convergence.html">
   所得分布と所得収斂
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  マクロ経済学 - 短期分析
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="10_Data_Fluctuation.html">
   GDPと構成要素
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="11_Macro_Variables.html">
   法則・曲線・増加率
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="12_IS-MP-PC.html">
   IS-MP-PCモデル
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="13_NumPy_random.html">
   ランダム変数と全要素生産性
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="16_data_on_money.html">
   古典派の二分法と金融政策
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Plan.html">
   今後の計画
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  参考
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="pandas_plot.html">
   Pandas：プロット
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ScipyOptimize.html">
   解の求め方と最適化問題
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://py4etrics.github.io/6_things_to_note.html">
   Tipsと注意点
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://py4etrics.github.io/Grade.html">
   成績の分析
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://py4etrics.github.io">
   Pythonで学ぶ入門計量経済学
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  <a  href="https://github.com/Py4Macro/py4macro.github.io">&#128200;&#127891;&#128202;<!-- Default Statcounter code for Py4Macro https://py4macro.github.io --> <script type="text/javascript"> var sc_project=12478906; var sc_invisible=1; var sc_security="e767d225"; </script> <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script> <noscript><div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img class="statcounter" src="https://c.statcounter.com/12478906/0/e767d225/1/" alt="Web Analytics"></a></div></noscript> <!-- End of Statcounter Code --></a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/5_Income_Differences.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/Py4Macro/py4macro.github.io/source?urlpath=tree/5_Income_Differences.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/Py4Macro/py4macro.github.io/blob/source/5_Income_Differences.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   はじめに
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   データ
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id4">
   発展会計
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     説明
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     2019年
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id7">
       物的資本
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id8">
       人的資本サービス
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sec-5-tfp">
       全要素生産性
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id10">
       相関係数
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sec-5-tfp-factors">
     全要素生産性と蓄積生産要素の寄与度
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id12">
     表の作成
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id13">
   成長会計
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id14">
     説明
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id15">
     平均成長率の計算
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id16">
     蓄積生産要素の成長率
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id17">
     全要素生産性
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id18">
     全要素生産性と蓄積生産要素の貢献度
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id19">
       方法１
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id20">
       方法２
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id21">
     表の作成
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id22">
     日本
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="chap-5-accounting">
<span id="id1"></span><h1>発展会計と成長会計<a class="headerlink" href="#chap-5-accounting" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">japanize_matplotlib</span>
<span class="kn">import</span> <span class="nn">py4macro</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id2">
<h2>はじめに<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div name="html-admonition">
Do you want to read in a differnt language? Open the 
<input type="button" onclick="location.href='https://translate.google.com/translate?hl=&sl=ja&tl=en&u='+window.location;" value="Google translated version" style="color:#ffffff;background-color:#008080;" onmouseover="this.style.background='#99ccff'" onmouseout="this.style.background='#008080'"/>
in English or the language of your choice.
</div>
</div>
<p>一人当たりGDP（国内総生産）は経済の豊かさを示す一つの尺度として使われるが，下の左の図は2019年の世界経済での一人当たりGDPの分布を示している。日本と他の国・地域との比較を容易にするために、日本の一人当たりGDPを100として相対的な所得分布を表している。日本は38位で、１位であるルクセンブルグの一人当たりGDPは日本のそれより2倍強あり（米国は159.9で10位）、最下位のベネズエラは日本の一人当たりGDPの0.63％である。また、一人当たりGDPが日本の10％に満たない国・地域が107ある。こういった数字が示すように、世界の所得分布は大きな偏りがあり、非常に不平等である。</p>
<blockquote>
<div><p>（問１）なぜある国は豊かで他の国は貧しいのだろうか？</p>
</div></blockquote>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># データ</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">py4macro</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;pwt&#39;</span><span class="p">)</span>

<span class="c1"># 一人当たりGDP</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;GDPpc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;rgdpe&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;pop&#39;</span><span class="p">]</span>

<span class="c1"># 2019だけを取り出す</span>
<span class="n">cond</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2019</span><span class="p">)</span>
<span class="n">df2019</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;country&#39;</span><span class="p">,</span><span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="s1">&#39;GDPpc&#39;</span><span class="p">]]</span>

<span class="c1"># 日本の値を抽出</span>
<span class="n">jp</span> <span class="o">=</span> <span class="n">df2019</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;country==&quot;Japan&quot;&#39;</span><span class="p">)[</span><span class="s1">&#39;GDPpc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

<span class="c1"># 日本を100として計算</span>
<span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;GDPpc_normalized&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;GDPpc&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">jp</span>

<span class="c1"># プロット</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;GDPpc_normalized&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;国の数&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;日本を100として，2019年, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df2019</span><span class="p">)</span><span class="si">}</span><span class="s1">の国・地域, PWT10.0&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;１人当たり実質GDPの分布&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5_Income_Differences_5_0.png" src="_images/5_Income_Differences_5_0.png" />
</div>
</div>
<p>この問いはマクロ経済学の根本的な問いである。この重要な問題を考える上で、経済成長率に関する考察を無視できない。経済成長率とは、一人当たりGDP等の変数がある一定期間（例えば、一年間）にどれだけ変化したかをパーセントで表している。「現在の所得水準は過去に達成した成長率に依存し、またこれからの成長率が将来の所得水準を決定する」という質的な結果は直感的に理解できる。では、成長率と所得水準にはどういった量的な関係があるのだろうか。これを理解するために、<a class="reference internal" href="#tab-growth"><span class="std std-numref">Table 1</span></a>を見てみよう。</p>
<table class="table" id="tab-growth">
<caption><span class="caption-number">Table 1 </span><span class="caption-text">現在の一人当たりGDPを100として</span><a class="headerlink" href="#tab-growth" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>成長率</p></th>
<th class="head"><p>2.0%</p></th>
<th class="head"><p>2.5%</p></th>
<th class="head"><p>3.0%</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1年後</p></td>
<td><p>102.0</p></td>
<td><p>102.5</p></td>
<td><p>103.0</p></td>
</tr>
<tr class="row-odd"><td><p>10年後</p></td>
<td><p>121.9</p></td>
<td><p>128.0</p></td>
<td><p>134.4</p></td>
</tr>
<tr class="row-even"><td><p>50年後</p></td>
<td><p>269.2</p></td>
<td><p>343.7</p></td>
<td><p>438.4</p></td>
</tr>
<tr class="row-odd"><td><p>100年後</p></td>
<td><p>724.5</p></td>
<td><p>1181.4</p></td>
<td><p>1921.9</p></td>
</tr>
</tbody>
</table>
<p>現在の一人当たりGDPを100単位として，３つの異なる率で成長した場合、所得がどう変化するかを示している。2％と3％のケースを考えると、成長率が１％上昇するだけで、100年後の所得は約2.7倍に膨らんでいる。では、実際に各国の成長率はどれほど差があるのだろうか。それを示したのが次の図である。</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 一人当たりGDP</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;naGDPpc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;rgdpna&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;pop&#39;</span><span class="p">]</span>

<span class="c1"># 1960を閾値とする</span>
<span class="n">yr</span> <span class="o">=</span> <span class="mi">1960</span>
<span class="n">df_growth</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;year &gt;= @yr&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># yr以降で全ての年でGDPのデータある国・地域を抽出</span>
<span class="n">notna_check</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="n">cond</span> <span class="o">=</span> <span class="n">df_growth</span><span class="p">[[</span><span class="s1">&#39;country&#39;</span><span class="p">,</span><span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="s1">&#39;naGDPpc&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;country&#39;</span><span class="p">)[</span><span class="s1">&#39;naGDPpc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">notna_check</span><span class="p">)</span>
<span class="n">df_growth</span> <span class="o">=</span> <span class="n">df_growth</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,:]</span>

<span class="c1"># 成長率の計算</span>
<span class="k">def</span> <span class="nf">fun</span><span class="p">(</span><span class="n">col</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">100</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">col</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">col</span><span class="p">))</span><span class="o">-</span><span class="mi">1</span> <span class="p">)</span>
<span class="n">growth</span> <span class="o">=</span> <span class="n">df_growth</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;country&#39;</span><span class="p">)[[</span><span class="s1">&#39;naGDPpc&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">fun</span><span class="p">)</span>

<span class="c1"># # 日本の平均成長率</span>
<span class="n">jp_growth</span> <span class="o">=</span> <span class="n">growth</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Japan&#39;</span><span class="p">,:][</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># # プロット</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">growth</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">jp_growth</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;国の数&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">yr</span><span class="si">}</span><span class="s1">-2019年，</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">growth</span><span class="p">)</span><span class="si">}</span><span class="s1">の国・地域, PWT10.0&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;１人当たり実質GDPの平均成長率(％)の分布&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5_Income_Differences_7_0.png" src="_images/5_Income_Differences_7_0.png" />
</div>
</div>
<p>日本の平均成長率は3.1％であり、図では赤い直線で示している。最も高い成長率は台湾の5.61％であり，最も低い成長率はコンゴ民主共和国のマイナス1.62％である。実に、最高と最低成長率の差は7.23％ある。また、マイナスの成長率とは一人当たり所得の減少を意味するが、111の国・地域のうち8（約7.2％）が約60年の間平均して所得が縮小しているのである。</p>
<blockquote>
<div><p>（問２）なぜ国々の経済成長率は大きく異なるのか？</p>
</div></blockquote>
<p>経済学者は、問１と２に対する完璧な答えを提示できておらず、今でも活発に研究がおこなわれている。この章では、問１と２についてデータと簡単な数式を使い考察する。</p>
</div>
<div class="section" id="id3">
<h2>データ<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>データは<a class="reference external" href="https://www.rug.nl/ggdc/productivity/pwt/?lang=en">Penn World Talbe 10.0</a>を使うが，ここではデータをインポートするために<code class="docutils literal notranslate"><span class="pre">py4macro</span></code>モジュールを使う。このモジュールにはデータ・セットなどが含まれており，ここでは<code class="docutils literal notranslate"><span class="pre">data</span></code>関数を使ってデータをインポートする。使い方は次のコードで確認できる。</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">py4macro</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function data in module py4macro.py4macro:

data(dataset=None, description=0)
    |
    | 引数：
    |     dataset: (文字列)
    |         &#39;pwt&#39;:   Penn World Table 10.0
    |         &#39;weo&#39;:   IMF World Economic Outlook 2021
    |         &#39;mad&#39;:   country data of Maddison Project Database 2020
    |         &#39;mad-regions&#39;:   regional data of Maddison Project Database 2020
    |         &#39;jpn-q&#39;: 日本の四半期データ（GDPなど）
    |         &#39;jpn-money&#39;: 日本の四半期データ（マネーストックなど）
    |         &#39;world-money&#39;: 177ヵ国のマネーストックなど
    |         &#39;ex&#39;: 円/ドル為替レートなど
    |
    |     description (デフォルト：0, 整数型):
    |         0: データのDataFrameを返す
    |            * 全てのデータセット
    |         1: 変数の定義を全て表示する
    |            * 全てのデータセット
    |         2: 変数の定義のDataFrameを返す
    |            * `&#39;pwt&#39;`，`&#39;weo&#39;``&#39;mad&#39;`のみ
    |        -1: 何年以降から予測値なのかを全て示す
    |            * `&#39;weo&#39;`のみ
    |        -2: 何年以降から予測値なのかを示すDataFrameを返す
    |            * `&#39;weo&#39;`のみ
    |
    | 返り値：
    |     DataFrame もしくは DataFrameの表示
    |
    | 例１：py4macro.data(&#39;weo&#39;)
    |         -&gt; IMF World Economic OutlookのDataFrameを返す。
    |
    | 例２：py4macro.data(&#39;weo&#39;, description=1)
    |         -&gt; IMF World Economic Outlookの変数定義の全てを表示する。
    |
    | 例３：py4macro.data(&#39;weo&#39;, description=2)
    |         -&gt; IMF World Economic Outlookの変数定義のDataFrameを返す。
    |
    | 例４：py4macro.data(&#39;weo&#39;, description=-1)
    |         -&gt; IMF World Economic Outlookの変数の推定値の開始年を全て表示する。
    |
    | 例５：py4macro.data(&#39;weo&#39;, description=-2)
    |         -&gt; IMF World Economic Outlookの変数の推定値の開始年のDataFrameを返す。
    |
    |
    | ----- Penn World Tableについて ---------------------------------------------
    |
    | PWTには以下の列が追加されている。
    |
    | * oecd：1990年代に始まった中央ヨーロッパへの拡大前にOECDメンバー国であれば1，そうでなければ0
    |
    | * income_group：世界銀行が所得水準に従って分けた４つのグループ
    |         High income
    |         Upper middle income
    |         Lower middle income
    |         Low income
    |
    | * region：世界銀行が国・地域に従って分けた７つのグループ化
    |         East Asia &amp; Pacific
    |         Europe &amp; Central Asia
    |         Latin America &amp; Caribbean
    |         Middle East &amp; North Africa
    |         North America
    |         South Asia
    |         Sub-Saharan Africa
    |
    | * region：南極以外の6大陸
    |         Africa
    |         Asia
    |         Australia
    |         Europe
    |         North America
    |         South America
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">py4macro</span></code>を事前にインストールする必要があるが，次のコマンドでインストールすることができる。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">py4macro</span>
</pre></div>
</div>
</div>
<p>まず含まれていいる変数の定義を表示してみよう。<code class="docutils literal notranslate"><span class="pre">data()</span></code>の引数に<code class="docutils literal notranslate"><span class="pre">'pwt'</span></code>（文字列）と<code class="docutils literal notranslate"><span class="pre">description=1</span></code>を指定する。</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">py4macro</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;pwt&#39;</span><span class="p">,</span><span class="n">description</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable definition</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Identifier variables</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>countrycode</th>
      <td>3-letter ISO country code</td>
    </tr>
    <tr>
      <th>country</th>
      <td>Country name</td>
    </tr>
    <tr>
      <th>currency_unit</th>
      <td>Currency unit</td>
    </tr>
    <tr>
      <th>year</th>
      <td>Year</td>
    </tr>
    <tr>
      <th>Real GDP, employment and population levels</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>rgdpe</th>
      <td>Expenditure-side real GDP at chained PPPs (in mil. 2017US$)</td>
    </tr>
    <tr>
      <th>rgdpo</th>
      <td>Output-side real GDP at chained PPPs (in mil. 2017US$)</td>
    </tr>
    <tr>
      <th>pop</th>
      <td>Population (in millions)</td>
    </tr>
    <tr>
      <th>emp</th>
      <td>Number of persons engaged (in millions)</td>
    </tr>
    <tr>
      <th>avh</th>
      <td>Average annual hours worked by persons engaged</td>
    </tr>
    <tr>
      <th>hc</th>
      <td>Human capital index, based on years of schooling and returns to education; see Human capital in PWT9.</td>
    </tr>
    <tr>
      <th>Current price GDP, capital and TFP</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>ccon</th>
      <td>Real consumption of households and government, at current PPPs (in mil. 2017US$)</td>
    </tr>
    <tr>
      <th>cda</th>
      <td>Real domestic absorption, (real consumption plus investment), at current PPPs (in mil. 2017US$)</td>
    </tr>
    <tr>
      <th>cgdpe</th>
      <td>Expenditure-side real GDP at current PPPs (in mil. 2017US$)</td>
    </tr>
    <tr>
      <th>cgdpo</th>
      <td>Output-side real GDP at current PPPs (in mil. 2017US$)</td>
    </tr>
    <tr>
      <th>cn</th>
      <td>Capital stock at current PPPs (in mil. 2017US$)</td>
    </tr>
    <tr>
      <th>ck</th>
      <td>Capital services levels at current PPPs (USA=1)</td>
    </tr>
    <tr>
      <th>ctfp</th>
      <td>TFP level at current PPPs (USA=1)</td>
    </tr>
    <tr>
      <th>cwtfp</th>
      <td>Welfare-relevant TFP levels at current PPPs (USA=1)</td>
    </tr>
    <tr>
      <th>National accounts-based variables</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>rgdpna</th>
      <td>Real GDP at constant 2017 national prices (in mil. 2017US$)</td>
    </tr>
    <tr>
      <th>rconna</th>
      <td>Real consumption at constant 2017 national prices (in mil. 2017US$)</td>
    </tr>
    <tr>
      <th>rdana</th>
      <td>Real domestic absorption at constant 2017 national prices (in mil. 2017US$)</td>
    </tr>
    <tr>
      <th>rnna</th>
      <td>Capital stock at constant 2017 national prices (in mil. 2017US$)</td>
    </tr>
    <tr>
      <th>rkna</th>
      <td>Capital services at constant 2017 national prices (2017=1)</td>
    </tr>
    <tr>
      <th>rtfpna</th>
      <td>TFP at constant national prices (2017=1)</td>
    </tr>
    <tr>
      <th>rwtfpna</th>
      <td>Welfare-relevant TFP at constant national prices (2017=1)</td>
    </tr>
    <tr>
      <th>labsh</th>
      <td>Share of labour compensation in GDP at current national prices</td>
    </tr>
    <tr>
      <th>irr</th>
      <td>Real internal rate of return</td>
    </tr>
    <tr>
      <th>delta</th>
      <td>Average depreciation rate of the capital stock</td>
    </tr>
    <tr>
      <th>Exchange rates and GDP price levels</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>xr</th>
      <td>Exchange rate, national currency/USD (market+estimated)</td>
    </tr>
    <tr>
      <th>pl_con</th>
      <td>Price level of CCON (PPP/XR), price level of USA GDPo in 2017=1</td>
    </tr>
    <tr>
      <th>pl_da</th>
      <td>Price level of CDA (PPP/XR), price level of USA GDPo in 2017=1</td>
    </tr>
    <tr>
      <th>pl_gdpo</th>
      <td>Price level of CGDPo (PPP/XR), price level of USA GDPo in 2017=1</td>
    </tr>
    <tr>
      <th>Data information variables</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>i_cig</th>
      <td>0/1/2/3/4: relative price data for consumption, investment and government is extrapolated (0), benchmark (1), interpolated (2), ICP PPP timeseries: benchmark or interpolated (3) or  ICP PPP timeseries: extrapolated (4)</td>
    </tr>
    <tr>
      <th>i_xm</th>
      <td>0/1/2: relative price data for exports and imports is extrapolated (0), benchmark (1) or interpolated (2)</td>
    </tr>
    <tr>
      <th>i_xr</th>
      <td>0/1: the exchange rate is market-based (0) or estimated (1)</td>
    </tr>
    <tr>
      <th>i_outlier</th>
      <td>0/1: the observation on pl_gdpe or pl_gdpo is not an outlier (0) or an outlier (1)</td>
    </tr>
    <tr>
      <th>i_irr</th>
      <td>0/1/2/3: the observation for irr is not an outlier (0), may be biased due to a low capital share (1), hit the lower bound of 1 percent (2), or is an outlier (3)</td>
    </tr>
    <tr>
      <th>cor_exp</th>
      <td>Correlation between expenditure shares of the country and the US (benchmark observations only)</td>
    </tr>
    <tr>
      <th>statcap</th>
      <td>Statistical capacity indicator (source: World Bank, developing countries only)</td>
    </tr>
    <tr>
      <th>Shares in CGDPo</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>csh_c</th>
      <td>Share of household consumption at current PPPs</td>
    </tr>
    <tr>
      <th>csh_i</th>
      <td>Share of gross capital formation at current PPPs</td>
    </tr>
    <tr>
      <th>csh_g</th>
      <td>Share of government consumption at current PPPs</td>
    </tr>
    <tr>
      <th>csh_x</th>
      <td>Share of merchandise exports at current PPPs</td>
    </tr>
    <tr>
      <th>csh_m</th>
      <td>Share of merchandise imports at current PPPs</td>
    </tr>
    <tr>
      <th>csh_r</th>
      <td>Share of residual trade and GDP statistical discrepancy at current PPPs</td>
    </tr>
    <tr>
      <th>Price levels, expenditure categories and capital</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>pl_c</th>
      <td>Price level of household consumption,  price level of USA GDPo in 2017=1</td>
    </tr>
    <tr>
      <th>pl_i</th>
      <td>Price level of capital formation,  price level of USA GDPo in 2017=1</td>
    </tr>
    <tr>
      <th>pl_g</th>
      <td>Price level of government consumption,  price level of USA GDPo in 2017=1</td>
    </tr>
    <tr>
      <th>pl_x</th>
      <td>Price level of exports, price level of USA GDPo in 2017=1</td>
    </tr>
    <tr>
      <th>pl_m</th>
      <td>Price level of imports, price level of USA GDPo in 2017=1</td>
    </tr>
    <tr>
      <th>pl_n</th>
      <td>Price level of the capital stock, price level of USA in 2017=1</td>
    </tr>
    <tr>
      <th>pl_k</th>
      <td>Price level of the capital services, price level of USA=1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">countrycode</span></code>は3つのアルファベットで表した標準的な国名コードであり，日本は<code class="docutils literal notranslate"><span class="pre">JPN</span></code>となる。よく使われるので，<a class="reference external" href="https://ja.wikipedia.org/wiki/ISO_3166-1">このサイト</a>を参考に主な国の表記を覚えておくと良いだろう。</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><code class="docutils literal notranslate"><span class="pre">description=1</span></code>は表示するだけなので，<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>として扱いたい場合は<code class="docutils literal notranslate"><span class="pre">description=2</span></code>とする。</p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">'pwt'</span></code>だけを引数に使うとデータ自体を読み込むことになる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">py4macro</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;pwt&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>次に<code class="docutils literal notranslate"><span class="pre">.head()</span></code>を使って最初の5行を表示してみよう。</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>countrycode</th>
      <th>country</th>
      <th>oecd</th>
      <th>income_group</th>
      <th>region</th>
      <th>continent</th>
      <th>year</th>
      <th>rgdpe</th>
      <th>rgdpo</th>
      <th>pop</th>
      <th>...</th>
      <th>csh_x</th>
      <th>csh_m</th>
      <th>csh_r</th>
      <th>pl_c</th>
      <th>pl_i</th>
      <th>pl_g</th>
      <th>pl_x</th>
      <th>pl_m</th>
      <th>pl_n</th>
      <th>pl_k</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ABW</td>
      <td>Aruba</td>
      <td>0</td>
      <td>High income</td>
      <td>Latin America &amp; Caribbean</td>
      <td>North America</td>
      <td>1950</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ABW</td>
      <td>Aruba</td>
      <td>0</td>
      <td>High income</td>
      <td>Latin America &amp; Caribbean</td>
      <td>North America</td>
      <td>1951</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ABW</td>
      <td>Aruba</td>
      <td>0</td>
      <td>High income</td>
      <td>Latin America &amp; Caribbean</td>
      <td>North America</td>
      <td>1952</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ABW</td>
      <td>Aruba</td>
      <td>0</td>
      <td>High income</td>
      <td>Latin America &amp; Caribbean</td>
      <td>North America</td>
      <td>1953</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ABW</td>
      <td>Aruba</td>
      <td>0</td>
      <td>High income</td>
      <td>Latin America &amp; Caribbean</td>
      <td>North America</td>
      <td>1954</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 55 columns</p>
</div></div></div>
</div>
<p>次の変数は上の定義のリストには含まれていないので，ここで簡単に紹介する。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">oecd</span></code>：1990年代に始まった中央ヨーロッパへの拡大前にOECDメンバー国であれば<code class="docutils literal notranslate"><span class="pre">1</span></code>，そうでなければ<code class="docutils literal notranslate"><span class="pre">0</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">income_group</span></code>：世界銀行は所得水準に従って国を次の４つに分けている。</p>
<ul>
<li><p>High income</p></li>
<li><p>Upper middle income</p></li>
<li><p>Lower middle income</p></li>
<li><p>Low income</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">region</span></code>：世界銀行が国・地域に従って分けた７つのグループ化</p>
<ul>
<li><p>East Asia &amp; Pacific</p></li>
<li><p>Europe &amp; Central Asia</p></li>
<li><p>Latin America &amp; Caribbean</p></li>
<li><p>Middle East &amp; North Africa</p></li>
<li><p>North America</p></li>
<li><p>South Asia</p></li>
<li><p>Sub-Saharan Africa</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">continent</span></code>：南極以外の6大陸</p>
<ul>
<li><p>Africa</p></li>
<li><p>Asia</p></li>
<li><p>Australia</p></li>
<li><p>Europe</p></li>
<li><p>North America</p></li>
<li><p>South America</p></li>
</ul>
</li>
</ul>
<p>属性<code class="docutils literal notranslate"><span class="pre">.columns</span></code>を使うと全ての列名を表示できる。</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;countrycode&#39;, &#39;country&#39;, &#39;oecd&#39;, &#39;income_group&#39;, &#39;region&#39;, &#39;continent&#39;,
       &#39;year&#39;, &#39;rgdpe&#39;, &#39;rgdpo&#39;, &#39;pop&#39;, &#39;emp&#39;, &#39;avh&#39;, &#39;hc&#39;, &#39;ccon&#39;, &#39;cda&#39;,
       &#39;cgdpe&#39;, &#39;cgdpo&#39;, &#39;cn&#39;, &#39;ck&#39;, &#39;ctfp&#39;, &#39;cwtfp&#39;, &#39;rgdpna&#39;, &#39;rconna&#39;,
       &#39;rdana&#39;, &#39;rnna&#39;, &#39;rkna&#39;, &#39;rtfpna&#39;, &#39;rwtfpna&#39;, &#39;labsh&#39;, &#39;irr&#39;, &#39;delta&#39;,
       &#39;xr&#39;, &#39;pl_con&#39;, &#39;pl_da&#39;, &#39;pl_gdpo&#39;, &#39;i_cig&#39;, &#39;i_xm&#39;, &#39;i_xr&#39;,
       &#39;i_outlier&#39;, &#39;i_irr&#39;, &#39;cor_exp&#39;, &#39;statcap&#39;, &#39;csh_c&#39;, &#39;csh_i&#39;, &#39;csh_g&#39;,
       &#39;csh_x&#39;, &#39;csh_m&#39;, &#39;csh_r&#39;, &#39;pl_c&#39;, &#39;pl_i&#39;, &#39;pl_g&#39;, &#39;pl_x&#39;, &#39;pl_m&#39;,
       &#39;pl_n&#39;, &#39;pl_k&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>また任意の列を選択するとメソッド<code class="docutils literal notranslate"><span class="pre">.unique()</span></code>が使えるようになる。これを使うことにより，選択した列に重複したデータがある場合，ユニークなものだけを抽出できる。このメソッドを使ってデータ・セットに含まれる国・地域名を確認してみよう。</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">country_list</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">country_list</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Aruba&#39;, &#39;Angola&#39;, &#39;Anguilla&#39;, &#39;Albania&#39;, &#39;United Arab Emirates&#39;,
       &#39;Argentina&#39;, &#39;Armenia&#39;, &#39;Antigua and Barbuda&#39;, &#39;Australia&#39;,
       &#39;Austria&#39;, &#39;Azerbaijan&#39;, &#39;Burundi&#39;, &#39;Belgium&#39;, &#39;Benin&#39;,
       &#39;Burkina Faso&#39;, &#39;Bangladesh&#39;, &#39;Bulgaria&#39;, &#39;Bahrain&#39;, &#39;Bahamas&#39;,
       &#39;Bosnia and Herzegovina&#39;, &#39;Belarus&#39;, &#39;Belize&#39;, &#39;Bermuda&#39;,
       &#39;Bolivia (Plurinational State of)&#39;, &#39;Brazil&#39;, &#39;Barbados&#39;,
       &#39;Brunei Darussalam&#39;, &#39;Bhutan&#39;, &#39;Botswana&#39;,
       &#39;Central African Republic&#39;, &#39;Canada&#39;, &#39;Switzerland&#39;, &#39;Chile&#39;,
       &#39;China&#39;, &quot;Côte d&#39;Ivoire&quot;, &#39;Cameroon&#39;, &#39;D.R. of the Congo&#39;, &#39;Congo&#39;,
       &#39;Colombia&#39;, &#39;Comoros&#39;, &#39;Cabo Verde&#39;, &#39;Costa Rica&#39;, &#39;Curaçao&#39;,
       &#39;Cayman Islands&#39;, &#39;Cyprus&#39;, &#39;Czech Republic&#39;, &#39;Germany&#39;,
       &#39;Djibouti&#39;, &#39;Dominica&#39;, &#39;Denmark&#39;, &#39;Dominican Republic&#39;, &#39;Algeria&#39;,
       &#39;Ecuador&#39;, &#39;Egypt&#39;, &#39;Spain&#39;, &#39;Estonia&#39;, &#39;Ethiopia&#39;, &#39;Finland&#39;,
       &#39;Fiji&#39;, &#39;France&#39;, &#39;Gabon&#39;, &#39;United Kingdom&#39;, &#39;Georgia&#39;, &#39;Ghana&#39;,
       &#39;Guinea&#39;, &#39;Gambia&#39;, &#39;Guinea-Bissau&#39;, &#39;Equatorial Guinea&#39;, &#39;Greece&#39;,
       &#39;Grenada&#39;, &#39;Guatemala&#39;, &#39;Guyana&#39;, &#39;China, Hong Kong SAR&#39;,
       &#39;Honduras&#39;, &#39;Croatia&#39;, &#39;Haiti&#39;, &#39;Hungary&#39;, &#39;Indonesia&#39;, &#39;India&#39;,
       &#39;Ireland&#39;, &#39;Iran (Islamic Republic of)&#39;, &#39;Iraq&#39;, &#39;Iceland&#39;,
       &#39;Israel&#39;, &#39;Italy&#39;, &#39;Jamaica&#39;, &#39;Jordan&#39;, &#39;Japan&#39;, &#39;Kazakhstan&#39;,
       &#39;Kenya&#39;, &#39;Kyrgyzstan&#39;, &#39;Cambodia&#39;, &#39;Saint Kitts and Nevis&#39;,
       &#39;Republic of Korea&#39;, &#39;Kuwait&#39;, &quot;Lao People&#39;s DR&quot;, &#39;Lebanon&#39;,
       &#39;Liberia&#39;, &#39;Saint Lucia&#39;, &#39;Sri Lanka&#39;, &#39;Lesotho&#39;, &#39;Lithuania&#39;,
       &#39;Luxembourg&#39;, &#39;Latvia&#39;, &#39;China, Macao SAR&#39;, &#39;Morocco&#39;,
       &#39;Republic of Moldova&#39;, &#39;Madagascar&#39;, &#39;Maldives&#39;, &#39;Mexico&#39;,
       &#39;North Macedonia&#39;, &#39;Mali&#39;, &#39;Malta&#39;, &#39;Myanmar&#39;, &#39;Montenegro&#39;,
       &#39;Mongolia&#39;, &#39;Mozambique&#39;, &#39;Mauritania&#39;, &#39;Montserrat&#39;, &#39;Mauritius&#39;,
       &#39;Malawi&#39;, &#39;Malaysia&#39;, &#39;Namibia&#39;, &#39;Niger&#39;, &#39;Nigeria&#39;, &#39;Nicaragua&#39;,
       &#39;Netherlands&#39;, &#39;Norway&#39;, &#39;Nepal&#39;, &#39;New Zealand&#39;, &#39;Oman&#39;,
       &#39;Pakistan&#39;, &#39;Panama&#39;, &#39;Peru&#39;, &#39;Philippines&#39;, &#39;Poland&#39;, &#39;Portugal&#39;,
       &#39;Paraguay&#39;, &#39;State of Palestine&#39;, &#39;Qatar&#39;, &#39;Romania&#39;,
       &#39;Russian Federation&#39;, &#39;Rwanda&#39;, &#39;Saudi Arabia&#39;, &#39;Sudan&#39;, &#39;Senegal&#39;,
       &#39;Singapore&#39;, &#39;Sierra Leone&#39;, &#39;El Salvador&#39;, &#39;Serbia&#39;,
       &#39;Sao Tome and Principe&#39;, &#39;Suriname&#39;, &#39;Slovakia&#39;, &#39;Slovenia&#39;,
       &#39;Sweden&#39;, &#39;Eswatini&#39;, &#39;Sint Maarten (Dutch part)&#39;, &#39;Seychelles&#39;,
       &#39;Syrian Arab Republic&#39;, &#39;Turks and Caicos Islands&#39;, &#39;Chad&#39;, &#39;Togo&#39;,
       &#39;Thailand&#39;, &#39;Tajikistan&#39;, &#39;Turkmenistan&#39;, &#39;Trinidad and Tobago&#39;,
       &#39;Tunisia&#39;, &#39;Turkey&#39;, &#39;Taiwan&#39;, &#39;U.R. of Tanzania: Mainland&#39;,
       &#39;Uganda&#39;, &#39;Ukraine&#39;, &#39;Uruguay&#39;, &#39;United States&#39;, &#39;Uzbekistan&#39;,
       &#39;St. Vincent and the Grenadines&#39;,
       &#39;Venezuela (Bolivarian Republic of)&#39;, &#39;British Virgin Islands&#39;,
       &#39;Viet Nam&#39;, &#39;Yemen&#39;, &#39;South Africa&#39;, &#39;Zambia&#39;, &#39;Zimbabwe&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
<p>類似するメソッドに<code class="docutils literal notranslate"><span class="pre">.nunique()</span></code>がある。これを使うと，ユニークなデータの数を確認できる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>183
</pre></div>
</div>
</div>
</div>
<p>183の国・地域が含まれるということである。<code class="docutils literal notranslate"><span class="pre">unique()</span></code>でデータの年を確認することもできる。</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">year_list</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">year_list</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1950, 1951, 1952, 1953, 1954, 1955, 1956, 1957, 1958, 1959, 1960,
       1961, 1962, 1963, 1964, 1965, 1966, 1967, 1968, 1969, 1970, 1971,
       1972, 1973, 1974, 1975, 1976, 1977, 1978, 1979, 1980, 1981, 1982,
       1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993,
       1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004,
       2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015,
       2016, 2017, 2018, 2019])
</pre></div>
</div>
</div>
</div>
<p>データを扱う際，必ずしもデータ・セットは完璧な形で提供されているわけではないことを念頭に置く必要がある。<code class="docutils literal notranslate"><span class="pre">df</span></code>の場合，必ずしも全ての国で全ての年のデータが揃っているわけではない。それを確認する必要があるが，役に立つのが<code class="docutils literal notranslate"><span class="pre">df</span></code>のメソッド<code class="docutils literal notranslate"><span class="pre">info()</span></code>である。</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 12810 entries, 0 to 12809
Data columns (total 55 columns):
 #   Column        Non-Null Count  Dtype  
---  ------        --------------  -----  
 0   countrycode   12810 non-null  object 
 1   country       12810 non-null  object 
 2   oecd          12810 non-null  int64  
 3   income_group  12670 non-null  object 
 4   region        12810 non-null  object 
 5   continent     12810 non-null  object 
 6   year          12810 non-null  int64  
 7   rgdpe         10399 non-null  float64
 8   rgdpo         10399 non-null  float64
 9   pop           10399 non-null  float64
 10  emp           9529 non-null   float64
 11  avh           3492 non-null   float64
 12  hc            8637 non-null   float64
 13  ccon          10399 non-null  float64
 14  cda           10399 non-null  float64
 15  cgdpe         10399 non-null  float64
 16  cgdpo         10395 non-null  float64
 17  cn            10314 non-null  float64
 18  ck            7095 non-null   float64
 19  ctfp          6412 non-null   float64
 20  cwtfp         6412 non-null   float64
 21  rgdpna        10399 non-null  float64
 22  rconna        10399 non-null  float64
 23  rdana         10399 non-null  float64
 24  rnna          10314 non-null  float64
 25  rkna          7095 non-null   float64
 26  rtfpna        6412 non-null   float64
 27  rwtfpna       6412 non-null   float64
 28  labsh         7970 non-null   float64
 29  irr           7540 non-null   float64
 30  delta         10314 non-null  float64
 31  xr            10399 non-null  float64
 32  pl_con        10399 non-null  float64
 33  pl_da         10399 non-null  float64
 34  pl_gdpo       10399 non-null  float64
 35  i_cig         10399 non-null  object 
 36  i_xm          10399 non-null  object 
 37  i_xr          10399 non-null  object 
 38  i_outlier     10399 non-null  object 
 39  i_irr         7540 non-null   object 
 40  cor_exp       1653 non-null   float64
 41  statcap       2117 non-null   float64
 42  csh_c         10399 non-null  float64
 43  csh_i         10399 non-null  float64
 44  csh_g         10399 non-null  float64
 45  csh_x         10399 non-null  float64
 46  csh_m         10399 non-null  float64
 47  csh_r         10399 non-null  float64
 48  pl_c          10399 non-null  float64
 49  pl_i          10399 non-null  float64
 50  pl_g          10399 non-null  float64
 51  pl_x          10399 non-null  float64
 52  pl_m          10399 non-null  float64
 53  pl_n          10314 non-null  float64
 54  pl_k          7095 non-null   float64
dtypes: float64(43), int64(2), object(10)
memory usage: 5.4+ MB
</pre></div>
</div>
</div>
</div>
<p>この出力の読み方については<a class="reference internal" href="3_Pandas.html#pandas"><span class="std std-ref">Pandasの章</span></a>で解説したので，ここでリピートする必要はないと思うが，次の点が重要となる。</p>
<ul class="simple">
<li><p>行のインデックスは<code class="docutils literal notranslate"><span class="pre">0</span></code>から<code class="docutils literal notranslate"><span class="pre">12809</span></code>まであり，合計<code class="docutils literal notranslate"><span class="pre">12810</span></code>行ある。<code class="docutils literal notranslate"><span class="pre">countrycode</span></code>をみると<code class="docutils literal notranslate"><span class="pre">12810</span> <span class="pre">non-null</span></code>となっており，<code class="docutils literal notranslate"><span class="pre">non-null</span></code>は「非欠損値（欠損値ではない）」なので，その列には欠損値がないということを意味する。一方，<code class="docutils literal notranslate"><span class="pre">hc</span></code>は<code class="docutils literal notranslate"><span class="pre">8637</span> <span class="pre">non-null</span></code>となっており，<code class="docutils literal notranslate"><span class="pre">12810-8637=4173</span></code>の欠損値が存在する。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">float64</span></code>は浮動小数点型データであり，<code class="docutils literal notranslate"><span class="pre">object</span></code>は文字列のデータと考えて良いだろう。</p></li>
</ul>
<p>しかし<code class="docutils literal notranslate"><span class="pre">object</span></code>に関しては少し注意が必要となる。列に文字列が１つ混じっていて，他は<code class="docutils literal notranslate"><span class="pre">float</span></code>であっても<code class="docutils literal notranslate"><span class="pre">object</span></code>となるので注意が必要である。次の例がそれを示している。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">]})</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 6 entries, 0 to 5
Data columns (total 1 columns):
 #   Column  Non-Null Count  Dtype 
---  ------  --------------  ----- 
 0   a       6 non-null      object
dtypes: object(1)
memory usage: 176.0+ bytes
</pre></div>
</div>
</div>
</div>
<p>そしてもう一つ。<code class="docutils literal notranslate"><span class="pre">hc</span></code>には欠損値があると分かったが，その定義を個別で確認したい場合，<code class="docutils literal notranslate"><span class="pre">py4macro</span></code>の引数<code class="docutils literal notranslate"><span class="pre">description=2</span></code>を使うと<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>が返されるので，それを使うと良いだろう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">teigi</span> <span class="o">=</span> <span class="n">py4macro</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;pwt&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">teigi</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s1">&#39;hc&#39;</span><span class="p">],:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable definition</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>hc</th>
      <td>Human capital index, based on years of schooli...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>ただ，これだと定義の説明が全て表示できない。その場合は<code class="docutils literal notranslate"><span class="pre">py4macro.show()</span></code>関数を使うとフルに表示できる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">py4macro</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">teigi</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s1">&#39;hc&#39;</span><span class="p">],:])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable definition</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>hc</th>
      <td>Human capital index, based on years of schooling and returns to education; see Human capital in PWT9.</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>上のコードで<code class="docutils literal notranslate"><span class="pre">.loc['hc',:]</span></code>とすると<code class="docutils literal notranslate"><span class="pre">Series</span></code>が返されるので，表示が少し異なることになる。</p>
</div>
<p>実際にデータを使う前に，含まれているGDPの変数について簡単に説明する。世界中の経済のGDPを比較可能な形でデータを作成するのは非常に難しい。経済によって消費・生産・輸出・輸入する財の種類・量も違えば，価格も違う。それに購買力平価（PPPs; Purchasing Power Parities; <a class="reference external" href="https://www.worldbank.org/en/programs/icp">PWTで使うPPPs</a>）を使って経済間のGDPを実質化したとしても，時系列的に実質化するには更なる調整が必要となる。またそれぞれの政府データを使う事になるが，大きく数字が修正される場合もある。このような問題に対処するために，PWTには５つのGDPの変数が提供されている。</p>
<ul class="simple">
<li><p>データにある年のPPPsに基づき経済間の価格の違いを考慮している。</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">cgdpo</span></code>：産出データに基づいており，時系列的には名目。ある年で経済間の生産能力（<strong>水準</strong>）の比較に適している。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cgdpe</span></code>：支出データに基づいており，時系列的には名目。ある年で経済間の生活<strong>水準</strong>の比較に適している。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rgdpo</span></code>：産出データに基づいており，時系列的には実質。ある期間で経済間の生産能力（<strong>水準</strong>）の比較に適している。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rgdpe</span></code>：支出データに基づいており，時系列的には実質。ある期間で経済間の生活<strong>水準</strong>の比較に適している。</p></li>
</ul>
</li>
<li><p>ある基準年のPPPsだけに基づき経済間の価格の違いを考慮している。</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">rgdpna</span></code>：それぞれの経済の国民経済計算を使っており，時系列的には実質。GDPの<strong>成長率</strong>の比較に適している。</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="id4">
<h2>発展会計<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id5">
<h3>説明<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>経済間の所得格差の要因を探るために，次の生産関数を考えよう。</p>
<div class="math notranslate nohighlight" id="equation-eq-5-production">
<span class="eqno">(1)<a class="headerlink" href="#equation-eq-5-production" title="Permalink to this equation">¶</a></span>\[
Y_i=A_iK_i^\alpha\left(h_iH_iL_i\right)^{1-\alpha}
,\quad
0&lt;\alpha&lt;1
\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(i\)</span>：経済<code class="docutils literal notranslate"><span class="pre">i</span></code></p></li>
<li><p><span class="math notranslate nohighlight">\(Y_i\)</span>：GDP</p></li>
<li><p><span class="math notranslate nohighlight">\(K_i\)</span>：物的資本</p></li>
<li><p><span class="math notranslate nohighlight">\(A_i\)</span>：全要素生産性（TFP）</p></li>
<li><p><span class="math notranslate nohighlight">\(H_i\)</span>：労働者一人当たりの人的資本</p></li>
<li><p><span class="math notranslate nohighlight">\(h_i\)</span>：労働者一人当たりの平均労働時間</p></li>
<li><p><span class="math notranslate nohighlight">\(L_i\)</span>：労働者数</p></li>
</ul>
<p>GDPは労働，物的人的資本とTFPによって決定されると考える，ということである。このアプローチは「大雑把」な印象を否めないが，データを使う事により，重要な知見を得ることが可能となる。次に，生産関数を一人当たりに書き換えよう。</p>
<div class="math notranslate nohighlight" id="equation-eq-5-yi">
<span class="eqno">(2)<a class="headerlink" href="#equation-eq-5-yi" title="Permalink to this equation">¶</a></span>\[
\frac{Y_i}{L_i}=A_i
\left(
    \frac{K_i}{L_i}
\right)^{\alpha}
\left(
h_iH_i
\right)^{1-\alpha}
\quad\Rightarrow\quad
y_i=A_ik_i^{\alpha}\left(h_iH_i\right)^{1-\alpha}
\]</div>
<p>この式を使い経済間の一人当たりGDPの違いを考察する事になる。即ち，<span class="math notranslate nohighlight">\(A_i\)</span>，<span class="math notranslate nohighlight">\(k_i\)</span>，<span class="math notranslate nohighlight">\(h_i\)</span>，<span class="math notranslate nohighlight">\(H_i\)</span>の違いを使って<span class="math notranslate nohighlight">\(y_i\)</span>の違いを説明しようという事である。以下では，<span class="math notranslate nohighlight">\(h_iH_i\)</span>と<span class="math notranslate nohighlight">\(k_i\)</span>，<span class="math notranslate nohighlight">\(h_i\)</span>，<span class="math notranslate nohighlight">\(H_i\)</span>を合わせた項を次のように呼ぶ事にする。</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
&amp;\text{（労働者一人当たり）人的資本サービス： } h_iH_i\\
&amp;\text{（労働者一人当たり）蓄積生産要素： } k_i^{\alpha}\left(h_iH_i\right)^{1-\alpha}
\end{align*}
\end{split}\]</div>
<p>使うデータ・セットには，<span class="math notranslate nohighlight">\(y_i\)</span>，<span class="math notranslate nohighlight">\(k_i\)</span>，<span class="math notranslate nohighlight">\(h_i\)</span>に対応する変数があり，蓄積生産要素がどれだけ一人当たりGDPに寄与するかを数値で表すことができる。一方，全要素生産性は次の式で求めることができる。</p>
<div class="math notranslate nohighlight" id="equation-eq-5-ai">
<span class="eqno">(3)<a class="headerlink" href="#equation-eq-5-ai" title="Permalink to this equation">¶</a></span>\[
A_i=\dfrac{y_i}{k_i^{\alpha}\left(h_iH_i\right)^{1-\alpha}}
\]</div>
<p>これらの式とデータを使って，一人当たりGDPに対する蓄積生産要素と全要素生産性の寄与度を数量化する事になる。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>生産関数<a class="reference internal" href="#equation-eq-5-production">(1)</a>の仮定のもとで<span class="math notranslate nohighlight">\(A_i\)</span>が上昇したとしよう。物的人的資本の限界生産性が上昇するため，<span class="math notranslate nohighlight">\(k_i\)</span>と<span class="math notranslate nohighlight">\(H_i\)</span>は増加することになる。即ち，<span class="math notranslate nohighlight">\(A_i\)</span>の上昇により一人当たりGDPは上昇するが，間接的に<span class="math notranslate nohighlight">\(k_i\)</span>と<span class="math notranslate nohighlight">\(H_i\)</span>も増加させ<span class="math notranslate nohighlight">\(y_i\)</span>が増加する。これにより本来<span class="math notranslate nohighlight">\(A_i\)</span>による効果が<span class="math notranslate nohighlight">\(k_i\)</span>と<span class="math notranslate nohighlight">\(H_i\)</span>の寄与度に算入されることになり，全要素生産性の寄与度の過小評価につながる可能性がある。この問題は練習問題で取り上げることにする。</p>
</div>
<p>データ・セットに含まれるどの変数を使うかという問題があるが，ここでは次のデータを使うことにする。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">rgdpo</span></code>：生産面から計算したGDP（current PPPs; in mil. 2011US$）</p>
<ul>
<li><p>経済間では一定な価格を使い計算されているが、時系列的には「名目」</p></li>
<li><p>ある年に経済間の比較をするのに適している</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">emp</span></code>：雇用者数（in millions）</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">avh</span></code>：年間平均労働時間</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ck</span></code>：資本サービス水準（current PPPs (USA=1)）</p>
<ul>
<li><p>資本ストックを生産に使うことにより得るサービス</p></li>
<li><p>USA=1と基準化されているが，米国との比率を考えるため，基準化による問題はなくなる。</p></li>
<li><p>データ・セットには次に２つが含まれている。</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">cn</span></code>：資本ストック（current PPPs, in mil. 2011US$，タクシーを例にすると車体の価額)。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ck</span></code>：資本サービス（current PPPs, USA=1，タクシーを例にするとそのサービス（走行距離など）)。</p></li>
</ul>
</li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">hc</span></code>：一人当たり人的資本の指標</p>
<ul>
<li><p>教育年数と教育の収益から計算されている</p></li>
</ul>
</li>
</ul>
<p>式に当てはめると次のようになる。</p>
<ul class="simple">
<li><p>一人当たりGDP：<span class="math notranslate nohighlight">\(y_i\equiv\dfrac{Y_i}{L_i}=\)</span> <code class="docutils literal notranslate"><span class="pre">cgdpo</span></code>/<code class="docutils literal notranslate"><span class="pre">emp</span></code></p></li>
<li><p>一人当たり資本：<span class="math notranslate nohighlight">\(k_i\equiv\dfrac{K_i}{L_i}=\)</span> <code class="docutils literal notranslate"><span class="pre">ck</span></code>/<code class="docutils literal notranslate"><span class="pre">emp</span></code></p></li>
<li><p>労働者一人当たり人的資本サービス：<span class="math notranslate nohighlight">\(h_iH_i=\)</span> <code class="docutils literal notranslate"><span class="pre">avh</span></code>x<code class="docutils literal notranslate"><span class="pre">hc</span></code></p></li>
<li><p>資本の所得シャア：<span class="math notranslate nohighlight">\(\alpha=1/3\)</span>を仮定</p></li>
</ul>
<p>これに従ってコードを書いていこう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 資本の所得シャア</span>
<span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mf">3.0</span>

<span class="c1"># 労働者一人当たりGDP</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;gdp_pc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;cgdpo&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;emp&#39;</span><span class="p">]</span>

<span class="c1"># 一人当たり資本</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;k_pc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;ck&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;emp&#39;</span><span class="p">]</span>

<span class="c1"># 蓄積生産要素</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;factors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;k_pc&#39;</span><span class="p">]</span><span class="o">**</span><span class="n">a</span> <span class="o">*</span> <span class="p">(</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;hc&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;avh&#39;</span><span class="p">]</span> <span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">a</span><span class="p">)</span>

<span class="c1"># 全要素生産性</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;tfp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;gdp_pc&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;factors&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id6">
<h3>2019年<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>2019年だけを抽出する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2019</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;year == 2019&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<p><code class="docutils literal notranslate"><span class="pre">df</span></code>から2019年だけ抽出後，<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>のメソッド<code class="docutils literal notranslate"><span class="pre">copy()</span></code>を使いそのコピーを作成し，それを左辺の<code class="docutils literal notranslate"><span class="pre">df2019</span></code>に割り当てている。ある警告が出ないようにするために<code class="docutils literal notranslate"><span class="pre">copy()</span></code>を使っている。さらに<code class="docutils literal notranslate"><span class="pre">Python</span></code>について学習した後に説明する事にする。</p>
</div>
<p>わかりやすくするために，全ての国の一人当たりGDPを米国の一人当たりGDPで割り、米国を１（基準）として議論を進める事にする。先に，米国だけのデータを抽出する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">us2019</span> <span class="o">=</span> <span class="n">df2019</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;country == &quot;United States&quot;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>次に，米国を基準とした相対的な一人当たりGDP作成し，<code class="docutils literal notranslate"><span class="pre">df2019</span></code>に新たな列として代入によう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;gdp_pc_relative&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;gdp_pc&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">us2019</span><span class="p">[</span><span class="s1">&#39;gdp_pc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<p><code class="docutils literal notranslate"><span class="pre">.to_numpy()</span></code>は<code class="docutils literal notranslate"><span class="pre">NumPy</span></code>の<code class="docutils literal notranslate"><span class="pre">array</span></code>に変換するメソッドである。<code class="docutils literal notranslate"><span class="pre">.to_numpy()</span></code>を省くと<code class="docutils literal notranslate"><span class="pre">Series</span></code>を<code class="docutils literal notranslate"><span class="pre">Series</span></code>で割る事になりエラーとなる。</p>
</div>
<div class="section" id="id7">
<h4>物的資本<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h4>
<p>物的資本についても同様に，全ての国の<code class="docutils literal notranslate"><span class="pre">k_pc</span></code>を米国の<code class="docutils literal notranslate"><span class="pre">k_pc</span></code>で割り基準化する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;k_pc_relative&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;k_pc&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">us2019</span><span class="p">[</span><span class="s1">&#39;k_pc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>データを散布図で確認しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2019</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;k_pc_relative&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;gdp_pc_relative&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5_Income_Differences_59_0.png" src="_images/5_Income_Differences_59_0.png" />
</div>
</div>
<p>正の関係があることが確認できる。またデータの曲線トレンドは凹関数のようである。<code class="docutils literal notranslate"><span class="pre">gdp_pc_relative</span></code>に対する<code class="docutils literal notranslate"><span class="pre">k_pc_relative</span></code>増加の影響は，<code class="docutils literal notranslate"><span class="pre">k_pc_relative</span></code>が低いと大きく，<code class="docutils literal notranslate"><span class="pre">k_pc_relative</span></code>が高いと小さくなる。即ち，資本の限界生産性の逓減の反映と考えられる。ただ，この効果のみで上の図を解釈するには問題がある。第一に，異なる経済のクロスセクション・データ（横断面データ）であるため，経済間の様々な異質性が反映されている。即ち，全ての観測値は同じ生産関数から生成されている訳ではない。第二に，資本の限界生産性の逓減という概念は，労働や他の投入が一定のもとでの比較静学の結果である。しかし，他の投入は一定に固定されている訳ではない。これらを考慮しつつ図の解釈をするべきではあるが，データの裏には資本の限界生産性の逓減のメカニズムが働いていると考えるのは自然であろう。</p>
</div>
<div class="section" id="id8">
<h4>人的資本サービス<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h4>
<p>まず人的資本<code class="docutils literal notranslate"><span class="pre">hc</span></code>を考察する事にする。それにより労働時間<code class="docutils literal notranslate"><span class="pre">avh</span></code>の効果も理解できるだろう。
全ての国の<code class="docutils literal notranslate"><span class="pre">hc</span></code>を米国の<code class="docutils literal notranslate"><span class="pre">hc</span></code>で割り，米国を<code class="docutils literal notranslate"><span class="pre">1</span></code>とする人的資本インデックスを作成する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;hc_relative&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;hc&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">us2019</span><span class="p">[</span><span class="s1">&#39;hc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>散布図で確認してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2019</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;hc_relative&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;gdp_pc_relative&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5_Income_Differences_65_0.png" src="_images/5_Income_Differences_65_0.png" />
</div>
</div>
<p>正の関係があることがわかる。即ち，人的資本ストックが高ければ，一人当たり所得も増えるという事であり，非常に直感的でもある。一方，物的資本と比べると，曲線トレンドは凸関数になっている。裏にあるメカニズムとして様々なことが想定できる。</p>
<ul class="simple">
<li><p>労働者のスキルが高いため，同じ時間でより多くの財を生産できる。</p></li>
<li><p>学習能力が高いため，生産活動をとおして更にスキル向上，生産性向上につながる（学習効果）。</p></li>
<li><p>人的資本には，人に教える能力も含まれる（例えば，教師）。それにより，さらなる人的資本ストックの増加につながる。</p></li>
<li><p>人から学ぶ能力も高いため，技術・知識の伝播の速度を速め，経済全体の生産性を向上させる。</p></li>
<li><p>新しい技術・知識の創出，即ち，イノベーションを起こす必要不可欠な要素である。</p></li>
<li><p>海外からの技術移転にも貢献する。</p></li>
<li><p>リスクに対する理解が深まり，リスクは高いがより生産性が高い活動への投資につながる。</p></li>
<li><p>などなど</p></li>
</ul>
<p>ここで見えてくるのは人的資本の「外部性」の効果である。典型的な例が，学習効果である。人的資本が増えると，生産量が高くなり学習する機会が増え，更なる人的資本の増加につながる。それが更なる生産量の増加となり，相乗効果として凸関数トレンドとして現れていると解釈できる。また，能力が上がれば，それだけ新しい知識や技術をより簡単に吸収することが可能となるだろう。更には，周りに優れた人に囲まれて仕事や勉強をすれば，それに引っ張られて自分の能力も増してくる事になるのは多くの人が経験していることではないだろうか。労働者はこのような効果を意識して（例えば，他人への効果を考慮して）行動しているわけではない。即ち，外部性が一つの基本メカニズムとして働いているという解釈が成り立つ。</p>
<p>一方で，違う見方を可能である。閾値効果である。図を見ると，<code class="docutils literal notranslate"><span class="pre">h_relative</span></code>が低いところから増加しても<code class="docutils literal notranslate"><span class="pre">gdp_pc_relative</span></code>は大きく増加しないが，0.7あたりから増加率が増している。0.7付近で接続される２つの直線からなる折れ線グラフのようなトレンドが想定できるのではないだろうか。変数<code class="docutils literal notranslate"><span class="pre">hc</span></code>は，教育年数が一つの決定要因となっており，<code class="docutils literal notranslate"><span class="pre">hc</span></code>が低い経済では初等教育はある程度整っているが，高等教育が十分ではないと考えられる。従って，初等教育よりも高等教育の方が生産により大きな効果をもたらすとも考えられる。</p>
<p>人的資本の効果がある程度わかったので，次に人的資本サービスについて考えよう。全ての国の<code class="docutils literal notranslate"><span class="pre">hav</span></code>x<code class="docutils literal notranslate"><span class="pre">hc</span></code>を米国の<code class="docutils literal notranslate"><span class="pre">hav</span></code>x<code class="docutils literal notranslate"><span class="pre">hc</span></code>で割り基準化する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;human_relative&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span> <span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;avh&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;hc&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">/</span> \
                           <span class="p">(</span> <span class="n">us2019</span><span class="p">[</span><span class="s1">&#39;avh&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">us2019</span><span class="p">[</span><span class="s1">&#39;hc&#39;</span><span class="p">]</span> <span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>散布図で確認してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2019</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;human_relative&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;gdp_pc_relative&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5_Income_Differences_70_0.png" src="_images/5_Income_Differences_70_0.png" />
</div>
</div>
<p>正の関係であることは変わらないが，相関度は減少している。これは労働時間の影響であるり，一人当たりGDPとの散布図をプロットして確認してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;avh_relative&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;avh&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">us2019</span><span class="p">[</span><span class="s1">&#39;avh&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

<span class="n">df2019</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;avh_relative&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;gdp_pc_relative&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5_Income_Differences_72_0.png" src="_images/5_Income_Differences_72_0.png" />
</div>
</div>
<p>負の相関関係にあると言えるだろう。即ち，豊かな経済では労働時間が短くなる傾向にある。この傾向は，ミクロ経済学の授業で習った消費者の労働供給モデルを考えて解釈することができる。所得が上昇すると，所得効果により労働供給は減少するが，代替効果により労働時間は上昇する。上の図は，所得効果が代替効果を上回っている結果の反映と考えることが可能である。一方で，経済間では所得だけではなく他の要因も異なることも念頭においておこう。いずれにしろ，労働時間の負の関係により，人的資本サービスと一人当たりGDPの相関は弱くなっている。</p>
</div>
<div class="section" id="sec-5-tfp">
<span id="id9"></span><h4>全要素生産性<a class="headerlink" href="#sec-5-tfp" title="Permalink to this headline">¶</a></h4>
<p>米国を<code class="docutils literal notranslate"><span class="pre">1</span></code>に基準化して一人当たりGDPと全要素生産性との関係を図示する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;tfp_relative&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;tfp&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">us2019</span><span class="p">[</span><span class="s1">&#39;tfp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

<span class="n">df2019</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;tfp_relative&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;gdp_pc_relative&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5_Income_Differences_77_0.png" src="_images/5_Income_Differences_77_0.png" />
</div>
</div>
<p>正の相関関係にあることは明らかであり，直線のトレンドであることがわかる。物的資本の場合は凹関数トレンドで，限界生産性の逓減の反映とも解釈できた。人的資本の場合は凸関数トレンドで，外部性の効果が示唆された。全要素生産性の直線トレンドの解釈はどうなるのだろう。まず，物的資本のように，限界生産性の逓減があれば凹型トレンドになるはずだが，それを抑えるメカニズムが働いていると考えられる。それが正の外部性の存在である。</p>
<p>全要素生産性は，蓄積生産要素で説明できない一人当たりGDPとして定義されているが，広く使われる解釈が技術水準である。技術水準はイノベーションなどにより決定され，外部性の役割が大きいと理解されている。それを説明するために，アイザック・ニュートンが言ったとされる次の引用を考えてみよう。</p>
<blockquote>
<div><p>If I have seen further, it is by standing on the shoulders of Giants.</p>
</div></blockquote>
<p>ここでのhave seen furtherとはニュートンの天才的な能力・発見を指し，the shoulders of Giantsは先人が築き上げた知識・知見を意味する。ここで重要な点は，ニュートンは殆ど無料（書籍代や読書の機会費用はあるだろうが）で当時までに蓄積された知識を使うことができたということである。また多くの「先人」はニュートンがアイデアを参考にするとは想定していない，もしくはアイデアを使う対価を受け取っていないと思われれ，まさしく正の外部性が存在している（研究開発には負の外部性もある）。このようなことは，今でも発生している。新薬や新しいくゲーム・ソフトを作る場合，まず市場にある財を参考にする。知的財産権で守られているためコピー商品は違法だが，特許で開示されている技術やデザインなどを参考に新たな財を作り出すことは日常茶飯事である。この考えを使って上のデータを解釈してみよう。技術水準が低ければ，他から学ぶ土壌が乏しい。従って，TFPが低い場合は一人当たりGDPに対する影響は限定的になる。しかし技術水準が高ければ，他からより多くを学ぶ環境が存在するため，TFPの効果はより大きなものとなって現れていると考えられる。この効果により，技術水準の限界生産性の逓減が中和され直線トレンドとしてあらわれていると解釈できる。</p>
<p>関連する問題として，生産関数の仮定と全要素生産性の関係について次の点を付け加えておく。TFPを計算する上でコブ・ダグラス生産関数を使ったが，規模に対して収穫一定を仮定している。もしこの仮定が間違っていて，規模に関して収穫逓増が正しい場合どのようなバイアスが発生するのだろうか。この点を明らかにするために，真の生産関数が次式で与えられるとしよう。</p>
<div class="math notranslate nohighlight">
\[
Y_i=\tilde{A}_i\left(K_i^\alpha H_i^{1-\alpha}\right)^\mu,
\quad\mu&gt;1
\]</div>
<p><span class="math notranslate nohighlight">\(\mu=1\)</span>を仮定したわけだが，<span class="math notranslate nohighlight">\(\mu&gt;1\)</span>の場合は規模に関して収穫逓増となる。<span class="math notranslate nohighlight">\(\tilde{A}_i\)</span>は真のTFPを指しており，<span class="math notranslate nohighlight">\(\mu=1\)</span>と<span class="math notranslate nohighlight">\(\mu&gt;1\)</span>の場合のTFPの比率は次の式で表される。</p>
<div class="math notranslate nohighlight">
\[
\dfrac{A_i}{\tilde{A}_i}
=\dfrac{
        \dfrac{Y_i}{K_i^\alpha H_i^{1-\alpha}}
        }{
        \dfrac{Y_i}{\left(K_i^\alpha H_i^{1-\alpha}\right)^\mu}
        }
=\left(K_i^\alpha H_i^{1-\alpha}\right)^{\mu-1}
&gt;1
\]</div>
<p><span class="math notranslate nohighlight">\(K_i^\alpha H_i^{1-\alpha}&gt;1\)</span>と考えると，収穫一定のTFPは真のTFPを過大評価する事がわかる。何が起こっているのだろうか。<span class="math notranslate nohighlight">\(\mu&gt;1\)</span>の場合に収穫一定を仮定すると，</p>
<div class="math notranslate nohighlight">
\[
K_i^\alpha H_i^{1-\alpha}
&lt;
\left(K_i^\alpha H_i^{1-\alpha}\right)^\mu
\]</div>
<p>となり，蓄積生産要素の効果が過小評価されることになる。これにより物的人的資本の効果の一部をTFPの貢献だと間違って判断しTFPの過大評価になっている。では，なぜ規模に関して収穫逓増になり得るのだろうか。それが技術水準や蓄積生産要素の外部性である。技術水準と人的資本の外部性について簡単に説明したが，物的資本ストックも外部性を発生させると考えられる。物的資本ストックが増えると一人当たりGDPを増加させる。それにより，人的資本の学習効果を強める事になる。また研究開発のヒントを与えるようなきっかけにもなるかもしれない。そのような相乗効果により規模に関して収穫逓増になる生産関数を想定することも可能である。しかし多くの研究では規模に関して収穫一定の下で議論が進められており，以下ではそれを踏襲して<span class="math notranslate nohighlight">\(\mu=\)</span>とする。</p>
</div>
<div class="section" id="id10">
<h4>相関係数<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h4>
<p>一人当たりGDPと全要素生産性の散布図から，両変数の相関度は非常に高いと思われる。相関係数を計算してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2019</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,[</span><span class="s1">&#39;gdp_pc_relative&#39;</span><span class="p">,</span><span class="s1">&#39;tfp_relative&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gdp_pc_relative</th>
      <th>tfp_relative</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>gdp_pc_relative</th>
      <td>1.000000</td>
      <td>0.921097</td>
    </tr>
    <tr>
      <th>tfp_relative</th>
      <td>0.921097</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.dropna()</span></code>は<code class="docutils literal notranslate"><span class="pre">NaN</span></code>がある行を削除するメソッド</p></li>
</ul>
<p>*<code class="docutils literal notranslate"><span class="pre">.corr()</span></code>は相関係数を計算するメソッド</p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">GDPpc_relative</span></code>と<code class="docutils literal notranslate"><span class="pre">tfp_relative</span></code>の相関係数は約<span class="pasted-inline"><code class="output text_plain docutils literal notranslate"><span class="pre">0.921</span></code></span>であり、非常に高いことがわかる。</p>
<p>次に，蓄積生産要素と一人当たりGDPの散布図を作成し，相関係数を計算してみよう図示する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;factors_relative&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;factors&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">us2019</span><span class="p">[</span><span class="s1">&#39;factors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

<span class="n">df2019</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;factors_relative&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;gdp_pc_relative&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5_Income_Differences_85_0.png" src="_images/5_Income_Differences_85_0.png" />
</div>
</div>
<p>視覚的には，TFPと比べて相関度は低いようである。コードで確認しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2019</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,[</span><span class="s1">&#39;gdp_pc_relative&#39;</span><span class="p">,</span><span class="s1">&#39;factors_relative&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gdp_pc_relative</th>
      <th>factors_relative</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>gdp_pc_relative</th>
      <td>1.000000</td>
      <td>0.850706</td>
    </tr>
    <tr>
      <th>factors_relative</th>
      <td>0.850706</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>TFPより相関係数は低いことが確認できた。</p>
</div>
</div>
<div class="section" id="sec-5-tfp-factors">
<span id="id11"></span><h3>全要素生産性と蓄積生産要素の寄与度<a class="headerlink" href="#sec-5-tfp-factors" title="Permalink to this headline">¶</a></h3>
<p>全要素生産性と蓄積生産要素はそれぞれ一人当たりGDPにどれだけ寄与しているかを考えるために，次の方法を考える。まず生産関数を使い以下を定義する。</p>
<div class="math notranslate nohighlight">
\[
R_i^y=R_i^{\text{tfp}}R_i^{\text{factors}}
\]</div>
<p>ここで</p>
<div class="math notranslate nohighlight">
\[
R_i^y\equiv\dfrac{y_i}{y_{\text{US}}},\quad
R_i^{\text{tfp}}\equiv\dfrac{A_i}{A_{\text{US}}},\quad
R_i^{\text{factors}}\equiv
\dfrac{k_i^a\left(h_iH_i\right)^{1-a}}{k_{\text{US}}^a\left(h_{\text{US}}H_{\text{US}}\right)^{1-a}}
\]</div>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(R_i^y\)</span>：米国を基準とした相対所得</p></li>
<li><p><span class="math notranslate nohighlight">\(R_i^{\text{tfp}}\)</span>：米国を基準とした相対全要素生産性</p></li>
<li><p><span class="math notranslate nohighlight">\(R_i^{\text{factors}}\)</span>：米国を基準とした相対蓄積生産要素</p></li>
</ol>
<p>まず両辺に対数を取ると次式となる。</p>
<div class="math notranslate nohighlight" id="equation-eq-riy-decomposition">
<span class="eqno">(4)<a class="headerlink" href="#equation-eq-riy-decomposition" title="Permalink to this equation">¶</a></span>\[
r_i^y =
r_i^{\text{tfp}} +
r_i^{\text{factors}}
\]</div>
<p>ここで，</p>
<div class="math notranslate nohighlight">
\[
r_i^y\equiv \log\left(R_i^y\right),\quad
r_i^{\text{tfp}}\equiv\log\left(R_i^{\text{tfp}}\right),\quad
r_i^{\text{factors}}\equiv\log\left(R_i^{\text{factors}}\right)
\]</div>
<p>次に式<a class="reference internal" href="#equation-eq-riy-decomposition">(4)</a>の両辺の分散を計算するが，次の関係が成立することを思い出そう。</p>
<div class="math notranslate nohighlight" id="equation-eq-var-a-b">
<span class="eqno">(5)<a class="headerlink" href="#equation-eq-var-a-b" title="Permalink to this equation">¶</a></span>\[
\text{Var}(a+b)= \text{Var}(a)+ \text{Var}(b)+2\text{Cov}(a,b)
\]</div>
<p>式<a class="reference internal" href="#equation-eq-var-a-b">(5)</a>を使うと<a class="reference internal" href="#equation-eq-riy-decomposition">(4)</a>は次のように書き換えることができる。</p>
<div class="math notranslate nohighlight" id="equation-eq-varriy-decomposition">
<span class="eqno">(6)<a class="headerlink" href="#equation-eq-varriy-decomposition" title="Permalink to this equation">¶</a></span>\[
\text{Var}\left(r_i^y\right) =
\text{Var}\left(r_i^{\text{tfp}}\right) +
\text{Var}\left(r_i^{\text{factors}}\right) +
2\text{Cov}\left(r_i^{\text{tfp}},r_i^{\text{factors}}\right)
\]</div>
<p>式<a class="reference internal" href="#equation-eq-varriy-decomposition">(6)</a>は左辺の相対所得の変動は右辺の３つの項に分解することができることを示している。</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\text{Var}\left(r_i^{\text{tfp}}\right)\)</span>：全要素生産性（対数; 米国＝１）の変動</p></li>
<li><p><span class="math notranslate nohighlight">\(\text{Var}\left(r_i^{\text{factors}}\right)\)</span>：蓄積生産要素（対数; 米国＝１）の変動</p></li>
<li><p><span class="math notranslate nohighlight">\(\text{Cov}\left(r_i^{\text{tfp}},r_i^{\text{factors}}\right)\)</span>：全要素生産性と相対蓄積生産要素の共分散（それぞれ対数; 米国＝１）</p></li>
</ul>
<p>更に，<a class="reference internal" href="#equation-eq-varriy-decomposition">(6)</a>の両辺を<span class="math notranslate nohighlight">\(\text{Var}(r_i^y)\)</span>で割ると，次のように書くことができる。</p>
<div class="math notranslate nohighlight">
\[
1= \text{全要素生産性の寄与度}
+\text{蓄積生産要素の寄与度}
\]</div>
<p>ここで</p>
<div class="math notranslate nohighlight" id="equation-eq-tfp-contribution">
<span class="eqno">(7)<a class="headerlink" href="#equation-eq-tfp-contribution" title="Permalink to this equation">¶</a></span>\[
\text{全要素生産性の寄与度}=
\dfrac{
    \text{Var}\left(r_i^{\text{tfp}}\right)
    +\text{Cov}\left(r_i^{\text{tfp}},r_i^{\text{factors}}\right)
    }{
    \text{Var}(r_i^y)
    }
\]</div>
<div class="math notranslate nohighlight" id="equation-eq-factor-contribution">
<span class="eqno">(8)<a class="headerlink" href="#equation-eq-factor-contribution" title="Permalink to this equation">¶</a></span>\[
\text{蓄積生産要素の寄与度}=
\dfrac{
    \text{Var}\left(r_i^{\text{factors}}\right)
    +\text{Cov}\left(r_i^{\text{tfp}},r_i^{\text{factors}}\right)
    }{
    \text{Var}(r_i^y)
    }    
\]</div>
<p>と定義する。<span class="math notranslate nohighlight">\(2\text{Cov}\left(r_i^{\text{tfp}},r_i^{\text{factors}}\right)\)</span> は等分されている。</p>
<p>（考え方）</p>
<p>式<a class="reference internal" href="#equation-eq-tfp-contribution">(7)</a>と<a class="reference internal" href="#equation-eq-factor-contribution">(8)</a>の分母は<span class="math notranslate nohighlight">\(\log(R_i^y)\)</span>の分散であり，それに対して分子はどれだけ変動しているかで寄与度を計算しようということである。分母に対して分子の変動が大きければ大きい程，説明力が高いと判断するわけである。極端な例として、全ての経済の全要素生産性が同じで蓄積生産要素だけが異なる場合を考えてみよう。即ち，</p>
<div class="math notranslate nohighlight">
\[
\text{Var}\left(r_i^{\text{tfp}}\right)=0\quad\Rightarrow\quad
\text{Cov}\left(r_i^{\text{tfp}},r_i^{\text{factors}}\right)
=0
\]</div>
<p>この場合、蓄積生産要素だけで一人当たりGDPの違いを説明できることになるため、全要素生産性の寄与度は<code class="docutils literal notranslate"><span class="pre">0</span></code>であり蓄積生産要素は<code class="docutils literal notranslate"><span class="pre">1</span></code>である。即ち、全要素生産性は変化しないため一人当たりGDP（対数）の分散を説明できないが，一方，蓄積生産要素の変動のみで一人当たりGDPの変動を説明している事になる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 欠損値であるNaNがある行を削除</span>
<span class="n">df2019_nonan</span> <span class="o">=</span> <span class="n">df2019</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;gdp_pc_relative&#39;</span><span class="p">,</span><span class="s1">&#39;tfp_relative&#39;</span><span class="p">,</span> <span class="s1">&#39;factors_relative&#39;</span><span class="p">])</span>

<span class="c1"># それぞれの変数（対数）を設定</span>
<span class="n">tfp</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">df2019_nonan</span><span class="p">[</span><span class="s1">&#39;tfp_relative&#39;</span><span class="p">])</span>
<span class="n">factors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">df2019_nonan</span><span class="p">[</span><span class="s1">&#39;factors_relative&#39;</span><span class="p">])</span>
<span class="n">gdp_pc</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">df2019_nonan</span><span class="p">[</span><span class="s1">&#39;gdp_pc_relative&#39;</span><span class="p">])</span>

<span class="c1"># 分散・共分散の計算</span>
<span class="n">tfp_var</span>         <span class="o">=</span> <span class="n">tfp</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
<span class="n">factors_var</span>     <span class="o">=</span> <span class="n">factors</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
<span class="n">gdp_pc_var</span>      <span class="o">=</span> <span class="n">gdp_pc</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
<span class="n">tfp_factors_cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">tfp</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">factors</span><span class="o">.</span><span class="n">values</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<p>１行目で使った<code class="docutils literal notranslate"><span class="pre">.dropna()</span></code>は，引数なしでそのまま使うと１つでも<code class="docutils literal notranslate"><span class="pre">NaN</span></code>がある行は削除される。引数の<code class="docutils literal notranslate"><span class="pre">subset=[]</span></code>に列を指定すると，その列に<code class="docutils literal notranslate"><span class="pre">NaN</span></code>がある行だけが削除される。</p>
</div>
<p><strong>全要素生産性の寄与度</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">tfp_var</span> <span class="o">+</span> <span class="n">tfp_factors_cov</span><span class="p">)</span> <span class="o">/</span> <span class="n">gdp_pc_var</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5391873123319044
</pre></div>
</div>
</div>
</div>
<p><strong>蓄積生産要素の寄与度</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">factors_var</span> <span class="o">+</span> <span class="n">tfp_factors_cov</span><span class="p">)</span> <span class="o">/</span> <span class="n">gdp_pc_var</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.46081268766809563
</pre></div>
</div>
</div>
</div>
<p><strong>結果</strong></p>
<p>2019年の一人当たりGDPの変動の約<span class="pasted-inline"><code class="output text_plain docutils literal notranslate"><span class="pre">54</span></code></span>%は全要素生産性によって説明され，残りの<span class="pasted-inline"><code class="output text_plain docutils literal notranslate"><span class="pre">46</span></code></span>%は蓄積生産要素によって説明される。即ち，一人当たりGDPの決定要因としての全要素生産性は蓄積生産要素は重要性は同等もしくはそれ以上である。</p>
</div>
<div class="section" id="id12">
<h3>表の作成<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h3>
<p>最後に、主要な国のデータを表にまとめてみる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1</span>
<span class="n">country_table</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Japan&#39;</span><span class="p">,</span> <span class="s1">&#39;United Kingdom&#39;</span><span class="p">,</span><span class="s1">&#39;United States&#39;</span><span class="p">,</span> <span class="s1">&#39;Norway&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Mexico&#39;</span><span class="p">,</span><span class="s1">&#39;Peru&#39;</span><span class="p">,</span><span class="s1">&#39;India&#39;</span><span class="p">,</span><span class="s1">&#39;China&#39;</span><span class="p">,</span><span class="s1">&#39;Zimbabwe&#39;</span><span class="p">,</span><span class="s1">&#39;Niger&#39;</span><span class="p">]</span>

<span class="c1"># 2</span>
<span class="n">cond</span> <span class="o">=</span> <span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">country_table</span><span class="p">)</span>

<span class="c1"># 3</span>
<span class="n">col</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;country&#39;</span><span class="p">,</span><span class="s1">&#39;gdp_pc_relative&#39;</span><span class="p">,</span><span class="s1">&#39;tfp_relative&#39;</span><span class="p">,</span><span class="s1">&#39;factors_relative&#39;</span><span class="p">]</span>

<span class="c1"># 4</span>
<span class="n">table2019</span> <span class="o">=</span> <span class="n">df2019</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;country&#39;</span><span class="p">)</span> \
                  <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;gdp_pc_relative&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> \
                  <span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> \
                  <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;gdp_pc_relative&#39;</span><span class="p">:</span><span class="s1">&#39;一人当たりGDP&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;tfp_relative&#39;</span><span class="p">:</span><span class="s1">&#39;全要素生産性&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;factors_relative&#39;</span><span class="p">:</span><span class="s1">&#39;蓄積生産要素&#39;</span><span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;米国を１として&#39;</span><span class="p">)</span>
<span class="n">table2019</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>米国を１として
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>一人当たりGDP</th>
      <th>全要素生産性</th>
      <th>蓄積生産要素</th>
    </tr>
    <tr>
      <th>country</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Norway</th>
      <td>1.05</td>
      <td>1.15</td>
      <td>0.91</td>
    </tr>
    <tr>
      <th>United States</th>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>United Kingdom</th>
      <td>0.70</td>
      <td>0.76</td>
      <td>0.92</td>
    </tr>
    <tr>
      <th>Japan</th>
      <td>0.55</td>
      <td>0.63</td>
      <td>0.87</td>
    </tr>
    <tr>
      <th>Mexico</th>
      <td>0.33</td>
      <td>0.52</td>
      <td>0.65</td>
    </tr>
    <tr>
      <th>China</th>
      <td>0.19</td>
      <td>0.37</td>
      <td>0.53</td>
    </tr>
    <tr>
      <th>Peru</th>
      <td>0.18</td>
      <td>0.35</td>
      <td>0.52</td>
    </tr>
    <tr>
      <th>India</th>
      <td>0.14</td>
      <td>0.35</td>
      <td>0.40</td>
    </tr>
    <tr>
      <th>Zimbabwe</th>
      <td>0.05</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Niger</th>
      <td>0.02</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<ol class="simple">
<li><p>表示する国のリスト</p></li>
<li><p>列<code class="docutils literal notranslate"><span class="pre">country</span></code>に<code class="docutils literal notranslate"><span class="pre">country_list</span></code>にある国名と同じであれば<code class="docutils literal notranslate"><span class="pre">True</span></code>、異なる場合は<code class="docutils literal notranslate"><span class="pre">False</span></code>を返す条件を作成している。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.isin()</span></code>はそのためのメソッド</p></li>
</ul>
</li>
<li><p>表の列ラベルに使う変数リスト</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を作成する。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.loc[cond,col]</span></code>を使い、<code class="docutils literal notranslate"><span class="pre">cond</span></code>の条件に合った行、そして<code class="docutils literal notranslate"><span class="pre">col</span></code>の列を抽出する。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.set_index('country')</span></code>は<code class="docutils literal notranslate"><span class="pre">country</span></code>の列を行ラベルに設定するメソッド。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.sort_values()</span></code>は<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を列<code class="docutils literal notranslate"><span class="pre">gdp_pc_relative</span></code>に従って並び替えるメソッドであり、<code class="docutils literal notranslate"><span class="pre">ascending=False</span></code>は降順を指定している。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.round(2)</span></code>は表示する小数点を第二桁までで四捨五入することを指定するメソッド。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.rename()</span></code>は列ラベルを変更するメソッド。</p></li>
</ul>
</li>
</ol>
<p>＜コメント＞ <code class="docutils literal notranslate"><span class="pre">print()</span></code>関数を使うとテキストとして表示される。</p>
</div>
<p>この表から日本の全要素生産性は米国の<span class="pasted-inline"><code class="output text_plain docutils literal notranslate"><span class="pre">63</span></code></span>%であり，蓄積生産要素は米国の{glue:}``%であることが分かる。</p>
</div>
</div>
<div class="section" id="id13">
<h2>成長会計<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id14">
<h3>説明<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h3>
<p>発展会計では一人当たりGDPを分解し、全要素生産性と蓄積生産要素に分けてその寄与度を考えた。成長会計では、一人当たりGDPの<strong>変化率</strong>（即ち、経済成長率）を同じように２つの要素に分解しそれぞれの寄与度を考察する。<span class="math notranslate nohighlight">\(t\)</span>時点の生産関数は</p>
<div class="math notranslate nohighlight">
\[
y_t=A_tk_t^a\left(h_tH_t\right)^{1-a}
\]</div>
<p>とすると、<span class="math notranslate nohighlight">\(t\)</span>時点と<span class="math notranslate nohighlight">\(t+1\)</span>時点の生産関数を使うと</p>
<div class="math notranslate nohighlight">
\[
\frac{y_{t+1}}{y_t}=\frac{A_{t+1}}{A_t}
\left(\frac{k_{t+1}}{k_t}\right)^a
\left(\frac{h_{t+1}H_{t+1}}{h_tH_t}\right)^{1-a}
\]</div>
<p>となる。ここで</p>
<div class="math notranslate nohighlight">
\[
1+g_x\equiv\frac{x_{t+1}}{x_t}
\]</div>
<p>とすると，<span class="math notranslate nohighlight">\(g_x\)</span>は<span class="math notranslate nohighlight">\(x\)</span>の成長率（例えば、0.02）である。これにより、</p>
<div class="math notranslate nohighlight">
\[
    1+g_y=(1+g_A)(1+g_k)^a\left[(1+g_h)(1+g_H)\right]^{1-a}
\]</div>
<p>となり、対数化すると</p>
<div class="math notranslate nohighlight">
\[
    \log(1+g_y)=\log(1+g_A)+a\log(1+g_k)+(1-a)\left[\log(1+g_h)+\log(1+g_H)\right]
\]</div>
<p>となる。また成長率が十分に小さい場合（例えば、0.02）、次式で近似することが可能となる。</p>
<div class="math notranslate nohighlight" id="equation-eq-gx-approx">
<span class="eqno">(9)<a class="headerlink" href="#equation-eq-gx-approx" title="Permalink to this equation">¶</a></span>\[
\log(1+g_x)\approx g_x
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.02</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.01980262729617973
</pre></div>
</div>
</div>
</div>
<p>即ち、</p>
<div class="math notranslate nohighlight">
\[
    g_y=g_A+ag_k+(1-a)(g_h+g_H)
\]</div>
<p>となる。</p>
<p>この式に基づき，成長会計，即ち，どの要素がどれだけ一人当たりGDPの成長率に貢献しているかを計算する訳だが，そのためには変数の平均成長率を計算する必要があるので，その計算方法について説明する。ある変数<span class="math notranslate nohighlight">\(x\)</span>が<span class="math notranslate nohighlight">\(n\)</span>年間<span class="math notranslate nohighlight">\(g_x\)</span>の率で成長したとしよう。初期の<span class="math notranslate nohighlight">\(x=x_0\)</span>に対する<span class="math notranslate nohighlight">\(n\)</span>年後の比率を考えると，次式が成立する。</p>
<div class="math notranslate nohighlight" id="equation-eq-5-growth-average-expanded">
<span class="eqno">(10)<a class="headerlink" href="#equation-eq-5-growth-average-expanded" title="Permalink to this equation">¶</a></span>\[
\frac{x_{n}}{x_{0}}=
\frac{x_1}{x_{0}}\cdot
\frac{x_2}{x_{1}}\cdot
\frac{x_3}{x_{2}}\cdot
\cdots
\frac{x_{n-2}}{x_{n-3}}\cdot
\frac{x_{n-1}}{x_{n-2}}\cdot
\frac{x_n}{x_{n-1}}
=(1+g_x)^{n}
\]</div>
<p>この式の両辺を<span class="math notranslate nohighlight">\(1/n\)</span>乗すると次式となる。</p>
<div class="math notranslate nohighlight">
\[
\left(\frac{x_n}{x_0}\right)^{\frac{1}{n}}=1+g_x
\]</div>
<p>即ち，<span class="math notranslate nohighlight">\(1+g_x\)</span>は<span class="math notranslate nohighlight">\(\dfrac{x_n}{x_0}\)</span>の幾何平均であり，<span class="math notranslate nohighlight">\(g_x\)</span>が平均成長率である。</p>
<div class="math notranslate nohighlight" id="equation-eq-5-growth-average">
<span class="eqno">(11)<a class="headerlink" href="#equation-eq-5-growth-average" title="Permalink to this equation">¶</a></span>\[
g_x=
\left(
\dfrac{x_{n}}{x_{0}}
\right)^{\frac{1}{n}}-1
\]</div>
<p>この場合，算術平均ではなく幾何平均を使うことに注意しよう。また毎期毎期の成長率が違っても同じ結果<a class="reference internal" href="#equation-eq-5-growth-average">(11)</a>は成立することも覚えておこう。</p>
<p>年間平均成長率を計算する場合，<a class="reference internal" href="#equation-eq-5-growth-average-expanded">(10)</a>の両辺を対数化し式<a class="reference internal" href="#equation-eq-gx-approx">(9)</a>の近似を使う方法もある。</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\ln\left(\frac{x_n}{x_0}\right)
&amp;=\ln\left(1+g_x\right)^n \\
&amp;\Downarrow
\end{align*}
\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-5-growth-average-2">
<span class="eqno">(12)<a class="headerlink" href="#equation-eq-5-growth-average-2" title="Permalink to this equation">¶</a></span>\[
g_x\approx\frac{1}{n}\ln\left(\frac{x_n}{x_0}\right)
\]</div>
<p><span class="math notranslate nohighlight">\(g_x\)</span>が十分に小さい場合は，<a class="reference internal" href="#equation-eq-5-growth-average">(11)</a>と<a class="reference internal" href="#equation-eq-5-growth-average-2">(12)</a>のどちらを使っても大きな差は出ない。重要な点は，どちらかの一つの方法を計算の対象全てに一貫して使うことである。</p>
<p>例：<span class="math notranslate nohighlight">\(x_0=10\)</span>，<span class="math notranslate nohighlight">\(x_n=30\)</span>，<span class="math notranslate nohighlight">\(n=50\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x0</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">xn</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">n</span>  <span class="o">=</span> <span class="mi">50</span>

<span class="n">houhou1</span> <span class="o">=</span> <span class="p">(</span><span class="n">xn</span><span class="o">/</span><span class="n">x0</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">n</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
<span class="n">houhou2</span> <span class="o">=</span> <span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">xn</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span> <span class="p">)</span><span class="o">/</span><span class="n">n</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;方法１：</span><span class="si">{</span><span class="n">houhou1</span><span class="si">:}</span><span class="se">\n</span><span class="s1">方法２：</span><span class="si">{</span><span class="n">houhou2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>方法１：0.022215413278477092
方法２：0.02197224577336219
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code>は以前説明した<code class="docutils literal notranslate"><span class="pre">f-string</span></code>である。<code class="docutils literal notranslate"><span class="pre">houhou1</span></code>と<code class="docutils literal notranslate"><span class="pre">houhou2</span></code>にそれぞれの値を代入している。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">\n</span></code>は改行を意味する。</p></li>
</ul>
</div>
<p>Penn World Tableの次の変数を使う。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">rgdpna</span></code>：実質GDP</p>
<ul>
<li><p>経済成長を考える上で適している</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">emp</span></code>：雇用者数</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rkna</span></code>：物的資本サービス</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hc</span></code>：人的資本の指標</p>
<ul>
<li><p>教育年数と教育の収益から計算されている</p></li>
</ul>
</li>
</ul>
<p>以下で計算する変数とは次のように対応している。</p>
<ul class="simple">
<li><p>一人当たりGDP：<span class="math notranslate nohighlight">\(y_i\equiv\dfrac{Y_i}{L_i}=\)</span> <code class="docutils literal notranslate"><span class="pre">rgdpna</span></code>/<code class="docutils literal notranslate"><span class="pre">emp</span></code></p></li>
<li><p>一人当たり資本：<span class="math notranslate nohighlight">\(k_i\equiv\dfrac{K_i}{L_i}=\)</span> <code class="docutils literal notranslate"><span class="pre">rkna</span></code>/<code class="docutils literal notranslate"><span class="pre">emp</span></code></p></li>
<li><p>労働者一人当たり人的資本サービス：<span class="math notranslate nohighlight">\(h_iH_i=\)</span> <code class="docutils literal notranslate"><span class="pre">avh</span></code>x<code class="docutils literal notranslate"><span class="pre">hc</span></code></p></li>
<li><p>資本の所得シャア：<span class="math notranslate nohighlight">\(\alpha=1/3\)</span>（仮定）</p></li>
<li><p>蓄積生産要素の寄与：<span class="math notranslate nohighlight">\(k_i^{\alpha}\left(h_iH_i\right)^{1-\alpha}\)</span></p></li>
<li><p>全要素生産性：<span class="math notranslate nohighlight">\(A_i=\dfrac{y_i}{k_i^{\alpha}\left(h_iH_i\right)^{1-\alpha}}\)</span></p></li>
</ul>
<p>それぞれの変数を計算しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 資本の所得シャア</span>
<span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mf">3.0</span>

<span class="c1"># 一人当たりGDP</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;rgdp_pc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;rgdpna&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;emp&#39;</span><span class="p">]</span>

<span class="c1"># 資本割合</span>

<span class="n">df</span><span class="p">[</span><span class="s1">&#39;k_pc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;rkna&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;emp&#39;</span><span class="p">]</span>

<span class="c1"># 蓄積生産要素</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;factors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;k_pc&#39;</span><span class="p">]</span><span class="o">**</span><span class="n">a</span> <span class="o">*</span> <span class="p">(</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;avh&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;hc&#39;</span><span class="p">]</span> <span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">a</span><span class="p">)</span>

<span class="c1"># 全要素生産性</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;tfp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;rgdp_pc&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;factors&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id15">
<h3>平均成長率の計算<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h3>
<p>まず1999年から2019年の20年間の<code class="docutils literal notranslate"><span class="pre">rgdp_pc</span></code>、<code class="docutils literal notranslate"><span class="pre">k_pc</span></code>、<code class="docutils literal notranslate"><span class="pre">avh</span></code>，<code class="docutils literal notranslate"><span class="pre">hc</span></code>の平均成長率を計算する。次のコードを使うが<code class="docutils literal notranslate"><span class="pre">for</span></code>ループが二重（入れ子）になっている。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;rgdp_pc&#39;</span><span class="p">,</span><span class="s1">&#39;k_pc&#39;</span><span class="p">,</span><span class="s1">&#39;avh&#39;</span><span class="p">,</span><span class="s1">&#39;hc&#39;</span><span class="p">]</span>   <span class="c1"># 1</span>

<span class="n">growth_dict</span> <span class="o">=</span> <span class="p">{}</span>            <span class="c1"># 2</span>

<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">var_list</span><span class="p">:</span>          <span class="c1"># 3</span>
    
    <span class="n">growth_list</span> <span class="o">=</span> <span class="p">[]</span>        <span class="c1"># 4</span>
    
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">country_list</span><span class="p">:</span>  <span class="c1"># 5</span>
        <span class="n">start</span> <span class="o">=</span> <span class="mi">1999</span>        <span class="c1"># 6</span>
        <span class="n">end</span> <span class="o">=</span> <span class="mi">2019</span>          <span class="c1"># 7</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">end</span><span class="o">-</span><span class="n">start</span>       <span class="c1"># 8</span>
        
        <span class="n">df_start</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;country == @c &amp; year == @start&#39;</span><span class="p">)</span>  <span class="c1"># 9</span>
        <span class="n">df_end</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;country == @c &amp; year == @end&#39;</span><span class="p">)</span>      <span class="c1"># 10</span>


        <span class="n">g</span> <span class="o">=</span> <span class="p">(</span> <span class="n">df_end</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">df_start</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">n</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>  <span class="c1"># 11</span>
        <span class="n">growth_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">g</span><span class="p">)</span>                               <span class="c1"># 12</span>
            
    <span class="n">growth_dict</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">growth_list</span>                                <span class="c1"># 13</span>


<span class="n">df_growth</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;country&#39;</span><span class="p">:</span><span class="n">country_list</span><span class="p">,</span>               <span class="c1"># 14</span>
                          <span class="s1">&#39;rgdp_pc&#39;</span><span class="p">:</span><span class="n">growth_dict</span><span class="p">[</span><span class="s1">&#39;rgdp_pc&#39;</span><span class="p">],</span>     <span class="c1"># 15</span>
                          <span class="s1">&#39;k_pc&#39;</span><span class="p">:</span><span class="n">growth_dict</span><span class="p">[</span><span class="s1">&#39;k_pc&#39;</span><span class="p">],</span>
                          <span class="s1">&#39;avh&#39;</span><span class="p">:</span><span class="n">growth_dict</span><span class="p">[</span><span class="s1">&#39;avh&#39;</span><span class="p">],</span>
                          <span class="s1">&#39;hc&#39;</span><span class="p">:</span><span class="n">growth_dict</span><span class="p">[</span><span class="s1">&#39;hc&#39;</span><span class="p">]})</span>
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<ol class="simple">
<li><p>成長率を計算する対象となる変数リスト</p></li>
<li><p>空の辞書。次の形になるように(1)の平均成長率のリストを格納する。</p>
<ul class="simple">
<li><p>キー：変数名（<code class="docutils literal notranslate"><span class="pre">rgdp_pc</span></code>、<code class="docutils literal notranslate"><span class="pre">k_pc</span></code>、<code class="docutils literal notranslate"><span class="pre">hc</span></code>）</p></li>
<li><p>値：それぞれの国の成長率からなるリスト</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">var_list</span></code>に対しての<code class="docutils literal notranslate"><span class="pre">for</span></code>ループ。１回目のループでは<code class="docutils literal notranslate"><span class="pre">rdgp_pc</span></code>について計算する。</p></li>
<li><p>空リスト（役割は以下で説明）</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">country_list</span></code>に対しての<code class="docutils literal notranslate"><span class="pre">for</span></code>ループ。(3)の１回目の<code class="docutils literal notranslate"><span class="pre">for</span></code>ループで変数<code class="docutils literal notranslate"><span class="pre">rdgp_pc</span></code>に対して<code class="docutils literal notranslate"><span class="pre">country_list</span></code>にある国の成長率を下に続くコードを使って計算する。</p></li>
<li><p>最初の年を指定</p></li>
<li><p>最後の年を指定</p></li>
<li><p>何年間かを計算</p></li>
<li><p>最初の年の<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を抽出</p></li>
<li><p>最後の年の<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を抽出</p></li>
<li><p>平均成長率を計算する。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">df_end[v]</span></code>と<code class="docutils literal notranslate"><span class="pre">df_start[v]</span></code>は列ラベル<code class="docutils literal notranslate"><span class="pre">v</span></code>の列を抽出しており、<code class="docutils literal notranslate"><span class="pre">Series</span></code>として返される。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.iat[0]</span></code>は<code class="docutils literal notranslate"><span class="pre">Series</span></code>の<code class="docutils literal notranslate"><span class="pre">0</span></code>番目の数値を取り出すメソッド</p></li>
</ul>
</li>
<li><p>計算した成長率を(4)のリストに追加する。
* <code class="docutils literal notranslate"><span class="pre">100</span></code>をかけて％表示にする。</p></li>
<li><p>ループが終わると、(4)のリストを(2)の辞書に追加する。</p>
<ul class="simple">
<li><p>辞書に追加する際に変数名<code class="docutils literal notranslate"><span class="pre">v</span></code>を指定することにより、次のペアのデータが追加される</p>
<ul>
<li><p>キー：変数名（<code class="docutils literal notranslate"><span class="pre">rgdp_pc</span></code>、<code class="docutils literal notranslate"><span class="pre">k_pc</span></code>、<code class="docutils literal notranslate"><span class="pre">hc</span></code>）</p></li>
<li><p>値：それぞれの国の成長率のリスト</p></li>
</ul>
</li>
<li><p>3.の<code class="docutils literal notranslate"><span class="pre">for</span></code>ループの次の変数に移り、3.以下で説明した作業が繰り返される。</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">country_list</span></code>を<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>の列に設定</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rgdp_pc</span></code>の成長率を<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>の列に設定するが，その際，<code class="docutils literal notranslate"><span class="pre">growth_dict['キー']</span></code>で<code class="docutils literal notranslate"><span class="pre">growth_dic</span></code>の<code class="docutils literal notranslate"><span class="pre">キー</span></code>にあるリストを抽出している。</p>
<ul class="simple">
<li><p>下の３行は<code class="docutils literal notranslate"><span class="pre">k_pc</span></code>，<code class="docutils literal notranslate"><span class="pre">avh</span></code>，<code class="docutils literal notranslate"><span class="pre">hc</span></code>に対して同じ作業を行なっている。</p></li>
</ul>
</li>
</ol>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_growth</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>rgdp_pc</th>
      <th>k_pc</th>
      <th>avh</th>
      <th>hc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aruba</td>
      <td>-0.138189</td>
      <td>2.924345</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Angola</td>
      <td>1.948414</td>
      <td>-0.560107</td>
      <td>NaN</td>
      <td>0.734893</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Anguilla</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Albania</td>
      <td>3.588328</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.387198</td>
    </tr>
    <tr>
      <th>4</th>
      <td>United Arab Emirates</td>
      <td>-2.068514</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.335975</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>欠損値が含まれているので、<code class="docutils literal notranslate"><span class="pre">NaN</span></code>がある行は全て削除する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_growth</span> <span class="o">=</span> <span class="n">df_growth</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>残った国数を確認してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">df_growth</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>60
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">rgdp_pc</span></code>の成長率のヒストグラムをプロットするが，ここでは<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>のメソッド<code class="docutils literal notranslate"><span class="pre">plot()</span></code>を使う。まず使用する列を選んでメソッド<code class="docutils literal notranslate"><span class="pre">plot()</span></code>の引数に<code class="docutils literal notranslate"><span class="pre">kind='hist'</span></code>を指定するだけである。<code class="docutils literal notranslate"><span class="pre">bins=20</span></code>は階級（棒）の数を指定する引数（デフォルトは<code class="docutils literal notranslate"><span class="pre">10</span></code>）と理解すれば良いだろう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_growth</span><span class="p">[</span><span class="s1">&#39;rgdp_pc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5_Income_Differences_129_0.png" src="_images/5_Income_Differences_129_0.png" />
</div>
</div>
<p>多くの国はプラスの経済成長を遂げているが，マイナイス成長の経済も存在する。平均成長率がマイナスの国数を計算してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">df_growth</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;rgdp_pc &lt; 0&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5
</pre></div>
</div>
</div>
</div>
<p>最も平均成長率が低い経済の国名を探してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_growth_sorted</span> <span class="o">=</span> <span class="n">df_growth</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;rgdp_pc&#39;</span><span class="p">)</span>
<span class="n">df_growth_sorted</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>rgdp_pc</th>
      <th>k_pc</th>
      <th>avh</th>
      <th>hc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>Argentina</td>
      <td>-0.347174</td>
      <td>0.208928</td>
      <td>-0.794247</td>
      <td>0.782819</td>
    </tr>
    <tr>
      <th>84</th>
      <td>Italy</td>
      <td>-0.268447</td>
      <td>0.512725</td>
      <td>-0.423148</td>
      <td>0.696057</td>
    </tr>
    <tr>
      <th>102</th>
      <td>Luxembourg</td>
      <td>-0.031667</td>
      <td>-0.309171</td>
      <td>-0.277986</td>
      <td>1.191794</td>
    </tr>
    <tr>
      <th>52</th>
      <td>Ecuador</td>
      <td>-0.014519</td>
      <td>0.094647</td>
      <td>-0.708364</td>
      <td>0.645785</td>
    </tr>
    <tr>
      <th>109</th>
      <td>Mexico</td>
      <td>-0.000961</td>
      <td>0.496348</td>
      <td>-0.239539</td>
      <td>0.747133</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>ここで使ったメソッド<code class="docutils literal notranslate"><span class="pre">sort_values()</span></code>は，引数の列を基準に昇順に並べ替える。引数に<code class="docutils literal notranslate"><span class="pre">ascending=False</span></code>を使うと，降順に並び替えることができる。</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;上のヒストグラムで最も成長率が低い国は&#39;</span>
      <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">df_growth_sorted</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">である。&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>上のヒストグラムで最も成長率が低い国はArgentinaである。
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id16">
<h3>蓄積生産要素の成長率<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h3>
<p>次に，下の式を使って蓄積生産要素の成長率を計算しよう。</p>
<div class="math notranslate nohighlight">
\[
g_{\text{factors}}=ag_k+(1-a)(g_h+g_H)
\]</div>
<p>結果を<code class="docutils literal notranslate"><span class="pre">df_growth</span></code>に追加するが，その際、<span class="math notranslate nohighlight">\(a=\dfrac{1}{3}\)</span>と仮定する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_growth</span><span class="p">[</span><span class="s1">&#39;factors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">df_growth</span><span class="p">[</span><span class="s1">&#39;k_pc&#39;</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span> <span class="n">df_growth</span><span class="p">[</span><span class="s1">&#39;avh&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">df_growth</span><span class="p">[</span><span class="s1">&#39;hc&#39;</span><span class="p">]</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">factors</span></code>の成長率のヒストグラムを図示する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_growth</span><span class="p">[</span><span class="s1">&#39;factors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5_Income_Differences_140_0.png" src="_images/5_Income_Differences_140_0.png" />
</div>
</div>
<p>マイナスの成長率の国数を調べてみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">df_growth</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;factors &lt; 0&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id17">
<h3>全要素生産性<a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h3>
<p>全要素生産性は残差として計算される。</p>
<div class="math notranslate nohighlight">
\[
g_A=g_y-g_{\text{factors}}
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_growth</span><span class="p">[</span><span class="s1">&#39;tfp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_growth</span><span class="p">[</span><span class="s1">&#39;rgdp_pc&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df_growth</span><span class="p">[</span><span class="s1">&#39;factors&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">tfp</span></code>の成長率のヒストグラムを図示してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_growth</span><span class="p">[</span><span class="s1">&#39;tfp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5_Income_Differences_147_0.png" src="_images/5_Income_Differences_147_0.png" />
</div>
</div>
<p>蓄積生産要素と比べると全要素生産性の成長率はよりマイナスに広がっている。TFP成長率がマイナスの国の数を確認してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">df_growth</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;tfp &lt; 0&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10
</pre></div>
</div>
</div>
</div>
<p>蓄積要素生産性のマイナス成長率の国数と比べると10倍である。</p>
</div>
<div class="section" id="id18">
<h3>全要素生産性と蓄積生産要素の貢献度<a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h3>
<p>全要素生産性と蓄積生産要素のどちらが成長率に貢献しているのだろうか。まず図を使って比較してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_growth</span><span class="p">[[</span><span class="s1">&#39;tfp&#39;</span><span class="p">,</span><span class="s1">&#39;factors&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5_Income_Differences_153_0.png" src="_images/5_Income_Differences_153_0.png" />
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<ul class="simple">
<li><p>２つの列を選択することにより，同じ図に２つのヒストグラムが表示できるようになる。</p></li>
<li><p>引数<code class="docutils literal notranslate"><span class="pre">alpha</span></code>は図の透過度を指定する。0から1の間の値が指定可能で，デフォルトは1（透過なし）。</p></li>
</ul>
</div>
<p>図から次のことがわかる。蓄積生産要素の成長率は正の値になる傾向がある。即ち，殆どの経済で蓄積生産要素による経済成長が起こっているということである。一方，全要素生産性の成長率はマイナスへの広がりがあり，成長を妨げる要因になっているようである。</p>
<p>次に，一人当たりGDPの成長率に対する全要素生産性の貢献度を数量化するが，２つの方法を考えよう。</p>
<div class="section" id="id19">
<h4>方法１<a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h4>
<p>全要素生産性の貢献度を次の式で計算する。</p>
<div class="math notranslate nohighlight">
\[
100\times\frac{g_{A}}{g_y}
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_growth</span><span class="p">[</span><span class="s1">&#39;tfp_contribution&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">df_growth</span><span class="p">[</span><span class="s1">&#39;tfp&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">df_growth</span><span class="p">[</span><span class="s1">&#39;rgdp_pc&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>全要素生産性の貢献度が<code class="docutils literal notranslate"><span class="pre">50</span></code>％以上の国は何％かを計算する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">100</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_growth</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;50&lt;=tfp_contribution&#39;</span><span class="p">))</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_growth</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>56.666666666666664
</pre></div>
</div>
</div>
</div>
<p>約<span class="pasted-inline"><code class="output text_plain docutils literal notranslate"><span class="pre">56.7</span></code></span>％の国で全要素生産性がより大きな貢献をしている。</p>
</div>
<div class="section" id="id20">
<h4>方法２<a class="headerlink" href="#id20" title="Permalink to this headline">¶</a></h4>
<p>２つ目の方法として発展会計で使った方法を考える。</p>
<div class="math notranslate nohighlight">
\[
g_{yi} = g_{Ai} + g_{\text{factors},i}
\]</div>
<p>従って、分散を計算すると</p>
<div class="math notranslate nohighlight">
\[
\text{Var}\left(g_{yi}\right)=
\text{Var}\left(g_{Ai}\right)+
\text{Var}\left(g_{\text{factors},i}\right)
+2\text{Cov}\left(g_{Ai},g_{\text{factors},i}\right)
\]</div>
<p>となり、次式を定義することができる。</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\text{全要素生産性の寄与度}&amp;=
\dfrac{
    \text{Var}\left(g_{Ai}\right)+
    \text{Cov}\left(g_{Ai},g_{\text{factors},i}\right)
    }{
    \text{Var}\left(g_{yi}\right)
    } \\
\text{生産要素の寄与度}&amp;=
\dfrac{
    \text{Var}\left(g_{\text{factors},i}\right)+
    \text{Cov}\left(g_{Ai},g_{\text{factors},i}\right)
    }{
    \text{Var}\left(g_{yi}\right)
    }    
\end{align*}
\end{split}\]</div>
<p>これらの式に従って計算してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># それぞれの変数を設定</span>
<span class="n">tfp_growth</span>     <span class="o">=</span> <span class="n">df_growth</span><span class="p">[</span><span class="s1">&#39;tfp&#39;</span><span class="p">]</span>
<span class="n">factors_growth</span> <span class="o">=</span> <span class="n">df_growth</span><span class="p">[</span><span class="s1">&#39;factors&#39;</span><span class="p">]</span>
<span class="n">rgdp_pc_growth</span> <span class="o">=</span> <span class="n">df_growth</span><span class="p">[</span><span class="s1">&#39;rgdp_pc&#39;</span><span class="p">]</span>

<span class="c1"># 分散・共分散の計算</span>
<span class="n">tfp_growth_var</span>         <span class="o">=</span> <span class="n">tfp_growth</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
<span class="n">factors_growth_var</span>     <span class="o">=</span> <span class="n">factors_growth</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
<span class="n">rgdp_pc_growth_var</span>     <span class="o">=</span> <span class="n">rgdp_pc_growth</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
<span class="n">tfp_factors_growth_cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">tfp_growth</span><span class="p">,</span> <span class="n">factors_growth</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p><strong>全要素生産性の寄与度</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">tfp_growth_var</span> <span class="o">+</span> <span class="n">tfp_factors_growth_cov</span><span class="p">)</span> <span class="o">/</span> <span class="n">rgdp_pc_growth_var</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6120634566381635
</pre></div>
</div>
</div>
</div>
<p><strong>蓄積生産要素の寄与度</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">factors_growth_var</span><span class="o">+</span> <span class="n">tfp_factors_growth_cov</span><span class="p">)</span> <span class="o">/</span> <span class="n">rgdp_pc_growth_var</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.38793654336183664
</pre></div>
</div>
</div>
</div>
<p>蓄積生産要素と全要素生産性の寄与度は概ね6対4の割合でであることが確認できる。この結果は両変数の成長率のヒストグラムからも伺える。全要素生産性の方がより幅広く変化しているようである。いずれにしろ，蓄積生産要素と全要素生産性ともに一人当たりGDPの成長に大きく貢献していることが確認できる。</p>
</div>
</div>
<div class="section" id="id21">
<h3>表の作成<a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h3>
<p>結果を表としてまとめてみる。右端の列は方法１の結果を使っている。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">country_table</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Japan&#39;</span><span class="p">,</span> <span class="s1">&#39;United Kingdom&#39;</span><span class="p">,</span><span class="s1">&#39;United States&#39;</span><span class="p">,</span> <span class="s1">&#39;Norway&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Singapore&#39;</span><span class="p">,</span><span class="s1">&#39;Peru&#39;</span><span class="p">,</span><span class="s1">&#39;India&#39;</span><span class="p">,</span><span class="s1">&#39;China&#39;</span><span class="p">]</span>

<span class="n">cond</span> <span class="o">=</span> <span class="n">df_growth</span><span class="p">[</span><span class="s1">&#39;country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">country_table</span><span class="p">)</span>

<span class="n">col</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;country&#39;</span><span class="p">,</span><span class="s1">&#39;rgdp_pc&#39;</span><span class="p">,</span><span class="s1">&#39;factors&#39;</span><span class="p">,</span><span class="s1">&#39;tfp&#39;</span><span class="p">,</span><span class="s1">&#39;tfp_contribution&#39;</span><span class="p">]</span>

<span class="n">df_growth</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;country&#39;</span><span class="p">)</span> \
         <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;rgdp_pc&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> \
         <span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> \
         <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;rgdp_pc&#39;</span><span class="p">:</span><span class="s1">&#39;一人当たりGDPの成長率&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;factors&#39;</span><span class="p">:</span><span class="s1">&#39;蓄積生産要素の成長率&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;tfp&#39;</span><span class="p">:</span><span class="s1">&#39;全要素生産性の成長率&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;tfp_contribution&#39;</span><span class="p">:</span><span class="s1">&#39;全要素生産性の寄与度(％)&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>一人当たりGDPの成長率</th>
      <th>蓄積生産要素の成長率</th>
      <th>全要素生産性の成長率</th>
      <th>全要素生産性の寄与度(％)</th>
    </tr>
    <tr>
      <th>country</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>China</th>
      <td>6.26</td>
      <td>3.57</td>
      <td>2.69</td>
      <td>42.99</td>
    </tr>
    <tr>
      <th>India</th>
      <td>5.31</td>
      <td>2.98</td>
      <td>2.33</td>
      <td>43.83</td>
    </tr>
    <tr>
      <th>Peru</th>
      <td>2.45</td>
      <td>1.39</td>
      <td>1.05</td>
      <td>43.05</td>
    </tr>
    <tr>
      <th>Singapore</th>
      <td>1.73</td>
      <td>1.86</td>
      <td>-0.13</td>
      <td>-7.48</td>
    </tr>
    <tr>
      <th>United States</th>
      <td>1.35</td>
      <td>0.64</td>
      <td>0.71</td>
      <td>52.42</td>
    </tr>
    <tr>
      <th>United Kingdom</th>
      <td>0.78</td>
      <td>0.49</td>
      <td>0.29</td>
      <td>36.96</td>
    </tr>
    <tr>
      <th>Japan</th>
      <td>0.63</td>
      <td>0.12</td>
      <td>0.51</td>
      <td>80.75</td>
    </tr>
    <tr>
      <th>Norway</th>
      <td>0.61</td>
      <td>0.61</td>
      <td>0.00</td>
      <td>0.20</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>ここでの全要素生産性の寄与度は，一人当たりGDPの成長率のうち何％がTFPによるものかを示している。この表を見ると，日本の全要素生産性の寄与度は非常に大きい。このデータは1999~2019年のデータであり，それ以前ではどうだったのかを含めて，次節では年代を区切って日本の経済成長を考察してみることにする。</p>
</div>
<div class="section" id="id22">
<h3>日本<a class="headerlink" href="#id22" title="Permalink to this headline">¶</a></h3>
<p>年代別に成長率を考えるために，次の関数を定義しよう。<code class="docutils literal notranslate"><span class="pre">start</span></code>から<code class="docutils literal notranslate"><span class="pre">end</span></code>までの間の平均成長率と全要素生産性の寄与度をリストとして返す。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">jp_growth_decomposition</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;引数：</span>
<span class="sd">        start（int）: 開始年</span>
<span class="sd">        end（int）: 最終年</span>
<span class="sd">        </span>
<span class="sd">       返り値：次の変数の成長率とTFPの寄与度からなるリスト</span>
<span class="sd">                一人当たりGDP</span>
<span class="sd">                一人当たり物的資本</span>
<span class="sd">                平均労働時間</span>
<span class="sd">                人的資本</span>
<span class="sd">                全要素生産性（TFP）&quot;&quot;&quot;</span>

    <span class="n">var_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;rgdp_pc&#39;</span><span class="p">,</span><span class="s1">&#39;k_pc&#39;</span><span class="p">,</span><span class="s1">&#39;avh&#39;</span><span class="p">,</span><span class="s1">&#39;hc&#39;</span><span class="p">]</span>
    
    <span class="n">start</span> <span class="o">=</span> <span class="n">start</span>
    <span class="n">end</span> <span class="o">=</span> <span class="n">end</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">end</span><span class="o">-</span><span class="n">start</span>
    
    <span class="n">df_start</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;country == &quot;Japan&quot; &amp; year == @start&#39;</span><span class="p">)</span>
    <span class="n">df_end</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;country == &quot;Japan&quot; &amp; year == @end&#39;</span><span class="p">)</span>
    
    <span class="n">g_list</span> <span class="o">=</span> <span class="p">[]</span>
    
    
    <span class="c1"># ========== var_listの変数の平均成長率を計算しg_listに追加する ==========</span>
    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">var_list</span><span class="p">:</span>
        
        <span class="n">g</span> <span class="o">=</span> <span class="p">(</span> <span class="n">df_end</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">df_start</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">n</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
        <span class="n">g_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">g</span><span class="p">)</span>

        
    <span class="c1"># ========== 蓄積生産要素の平均成長率を計算しg_listに追加する ==========</span>
    <span class="n">factors</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">g_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span> <span class="n">g_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">g_list</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="p">)</span>
    <span class="n">g_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">factors</span><span class="p">)</span>

    
    <span class="c1"># ========== 全要素生産性の平均成長率を計算しg_listに追加する ==========</span>
    <span class="n">tfp</span> <span class="o">=</span> <span class="n">g_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">factors</span>
    <span class="n">g_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tfp</span><span class="p">)</span>

    <span class="c1"># ========== 全要素生産性の寄与度を計算しg_listに追加する ==========</span>
    <span class="n">tfp_contribution</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span><span class="n">tfp</span><span class="o">/</span><span class="n">g_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">g_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tfp_contribution</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">g_list</span>
</pre></div>
</div>
</div>
</div>
<p>この関数を使って<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を作成する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dic</span> <span class="o">=</span> <span class="p">{}</span>                                          <span class="c1"># 1</span>

<span class="n">yr_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;1950s&#39;</span><span class="p">,</span><span class="s1">&#39;1960s&#39;</span><span class="p">,</span><span class="s1">&#39;1970s&#39;</span><span class="p">,</span>               <span class="c1"># 2</span>
           <span class="s1">&#39;1980s&#39;</span><span class="p">,</span><span class="s1">&#39;1990s&#39;</span><span class="p">,</span><span class="s1">&#39;2000s&#39;</span><span class="p">,</span><span class="s1">&#39;2010s&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">yr</span> <span class="ow">in</span> <span class="n">yr_list</span><span class="p">:</span>                                <span class="c1"># 3</span>
    <span class="n">start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">yr</span><span class="p">[:</span><span class="mi">4</span><span class="p">])</span>                           <span class="c1"># 4</span>
    <span class="n">end</span> <span class="o">=</span> <span class="n">start</span><span class="o">+</span><span class="mi">9</span>                                 <span class="c1"># 5</span>
    <span class="n">dic</span><span class="p">[</span><span class="n">yr</span><span class="p">]</span> <span class="o">=</span> <span class="n">jp_growth_decomposition</span><span class="p">(</span><span class="n">start</span><span class="p">,</span><span class="n">end</span><span class="p">)</span>  <span class="c1"># 6</span>


<span class="n">idx</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;gdp_pc_growth&#39;</span><span class="p">,</span><span class="s1">&#39;k_pc_growth&#39;</span><span class="p">,</span>             <span class="c1"># 7</span>
       <span class="s1">&#39;avh_growth&#39;</span><span class="p">,</span><span class="s1">&#39;hc_growth&#39;</span><span class="p">,</span><span class="s1">&#39;factors_growth&#39;</span><span class="p">,</span>
       <span class="s1">&#39;tfp_growth&#39;</span><span class="p">,</span><span class="s1">&#39;tfp_contribution&#39;</span><span class="p">]</span>

<span class="n">df_jp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dic</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">idx</span><span class="p">)</span>              <span class="c1"># 8</span>
<span class="n">df_jp</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1950s</th>
      <th>1960s</th>
      <th>1970s</th>
      <th>1980s</th>
      <th>1990s</th>
      <th>2000s</th>
      <th>2010s</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>gdp_pc_growth</th>
      <td>5.818810</td>
      <td>8.574257</td>
      <td>3.828061</td>
      <td>3.638507</td>
      <td>0.905053</td>
      <td>0.220202</td>
      <td>0.308059</td>
    </tr>
    <tr>
      <th>k_pc_growth</th>
      <td>NaN</td>
      <td>11.263879</td>
      <td>8.484514</td>
      <td>4.983142</td>
      <td>3.480964</td>
      <td>1.046741</td>
      <td>-0.272145</td>
    </tr>
    <tr>
      <th>avh_growth</th>
      <td>0.670331</td>
      <td>-0.133080</td>
      <td>-0.339988</td>
      <td>-0.067591</td>
      <td>-1.012446</td>
      <td>-0.617680</td>
      <td>-0.563402</td>
    </tr>
    <tr>
      <th>hc_growth</th>
      <td>1.265048</td>
      <td>0.807691</td>
      <td>0.711507</td>
      <td>0.560457</td>
      <td>0.516702</td>
      <td>0.443183</td>
      <td>0.303400</td>
    </tr>
    <tr>
      <th>factors_growth</th>
      <td>NaN</td>
      <td>4.204367</td>
      <td>3.075851</td>
      <td>1.989625</td>
      <td>0.829825</td>
      <td>0.232582</td>
      <td>-0.264049</td>
    </tr>
    <tr>
      <th>tfp_growth</th>
      <td>NaN</td>
      <td>4.369890</td>
      <td>0.752210</td>
      <td>1.648882</td>
      <td>0.075227</td>
      <td>-0.012380</td>
      <td>0.572108</td>
    </tr>
    <tr>
      <th>tfp_contribution</th>
      <td>NaN</td>
      <td>50.965232</td>
      <td>19.649905</td>
      <td>45.317542</td>
      <td>8.311944</td>
      <td>-5.622092</td>
      <td>185.713890</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<p>1~6のコードは次のコードを<code class="docutils literal notranslate"><span class="pre">for</span></code>ループとして書いている。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dic</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;1950s&#39;</span><span class="p">:</span><span class="n">jp_growth_decomposition</span><span class="p">(</span><span class="mi">1950</span><span class="p">,</span><span class="mi">1959</span><span class="p">),</span>
       <span class="s1">&#39;1960s&#39;</span><span class="p">:</span><span class="n">jp_growth_decomposition</span><span class="p">(</span><span class="mi">1960</span><span class="p">,</span><span class="mi">1969</span><span class="p">),</span>
       <span class="s1">&#39;1970s&#39;</span><span class="p">:</span><span class="n">jp_growth_decomposition</span><span class="p">(</span><span class="mi">1970</span><span class="p">,</span><span class="mi">1979</span><span class="p">),</span>
       <span class="s1">&#39;1980s&#39;</span><span class="p">:</span><span class="n">jp_growth_decomposition</span><span class="p">(</span><span class="mi">1980</span><span class="p">,</span><span class="mi">1989</span><span class="p">),</span>
       <span class="s1">&#39;1990s&#39;</span><span class="p">:</span><span class="n">jp_growth_decomposition</span><span class="p">(</span><span class="mi">1990</span><span class="p">,</span><span class="mi">1999</span><span class="p">),</span>
       <span class="s1">&#39;2000s&#39;</span><span class="p">:</span><span class="n">jp_growth_decomposition</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span><span class="mi">2010</span><span class="p">),</span>
       <span class="s1">&#39;2010s&#39;</span><span class="p">:</span><span class="n">jp_growth_decomposition</span><span class="p">(</span><span class="mi">2010</span><span class="p">,</span><span class="mi">2019</span><span class="p">)}</span>

</pre></div>
</div>
<ol class="simple">
<li><p>空の辞書<code class="docutils literal notranslate"><span class="pre">dic</span></code>を作成する。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dic</span></code>のキーになる値のリストを作成する。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">yr_list</span></code>に対しての<code class="docutils literal notranslate"><span class="pre">for</span></code>ループ。</p></li>
<li><p>関数<code class="docutils literal notranslate"><span class="pre">jp_growth_decomposition()</span></code>の引数として使用する開始年を作成する。</p>
<ul class="simple">
<li><p>右辺の<code class="docutils literal notranslate"><span class="pre">yr</span></code>は5つの文字からなる文字列であり，<code class="docutils literal notranslate"><span class="pre">yr[:4]</span></code>は最初の4文字を抽出する。それを整数に変換するために<code class="docutils literal notranslate"><span class="pre">int()</span></code>を使っている。</p></li>
<li><p>右辺の開始年を変数<code class="docutils literal notranslate"><span class="pre">start</span></code>に割り当てる。</p></li>
</ul>
</li>
<li><p>関数<code class="docutils literal notranslate"><span class="pre">jp_growth_decomposition()</span></code>の引数として使用する最終年を作成する。</p>
<ul class="simple">
<li><p>右辺では<code class="docutils literal notranslate"><span class="pre">start</span></code>の9年後を最終年としている。</p></li>
<li><p>右辺の最終年を変数<code class="docutils literal notranslate"><span class="pre">end</span></code>に割り当てる。</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">dic</span></code>のキー<code class="docutils literal notranslate"><span class="pre">yr</span></code>に対応する値として<code class="docutils literal notranslate"><span class="pre">jp_growth_decomposition(start,end)</span></code>の返り値を`設定する。</p></li>
<li><p>(8)で<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を作成するが，その行ラベルに使うリストを作成する。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dic</span></code>を使い<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を作成する。</p></li>
</ol>
</div>
<p>値を確認するだけであればこのままでも良いが，棒グラフを作成するために列と行を入れ替えることにする。<code class="docutils literal notranslate"><span class="pre">df_jp</span></code>のメソッド<code class="docutils literal notranslate"><span class="pre">.transpose()</span></code>を使う。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_jp</span> <span class="o">=</span> <span class="n">df_jp</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">df_jp</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gdp_pc_growth</th>
      <th>k_pc_growth</th>
      <th>avh_growth</th>
      <th>hc_growth</th>
      <th>factors_growth</th>
      <th>tfp_growth</th>
      <th>tfp_contribution</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1950s</th>
      <td>5.818810</td>
      <td>NaN</td>
      <td>0.670331</td>
      <td>1.265048</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1960s</th>
      <td>8.574257</td>
      <td>11.263879</td>
      <td>-0.133080</td>
      <td>0.807691</td>
      <td>4.204367</td>
      <td>4.369890</td>
      <td>50.965232</td>
    </tr>
    <tr>
      <th>1970s</th>
      <td>3.828061</td>
      <td>8.484514</td>
      <td>-0.339988</td>
      <td>0.711507</td>
      <td>3.075851</td>
      <td>0.752210</td>
      <td>19.649905</td>
    </tr>
    <tr>
      <th>1980s</th>
      <td>3.638507</td>
      <td>4.983142</td>
      <td>-0.067591</td>
      <td>0.560457</td>
      <td>1.989625</td>
      <td>1.648882</td>
      <td>45.317542</td>
    </tr>
    <tr>
      <th>1990s</th>
      <td>0.905053</td>
      <td>3.480964</td>
      <td>-1.012446</td>
      <td>0.516702</td>
      <td>0.829825</td>
      <td>0.075227</td>
      <td>8.311944</td>
    </tr>
    <tr>
      <th>2000s</th>
      <td>0.220202</td>
      <td>1.046741</td>
      <td>-0.617680</td>
      <td>0.443183</td>
      <td>0.232582</td>
      <td>-0.012380</td>
      <td>-5.622092</td>
    </tr>
    <tr>
      <th>2010s</th>
      <td>0.308059</td>
      <td>-0.272145</td>
      <td>-0.563402</td>
      <td>0.303400</td>
      <td>-0.264049</td>
      <td>0.572108</td>
      <td>185.713890</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>1950年代に欠損値があるが，そのまま議論を進めよう。まず一人当たりGDP成長率<code class="docutils literal notranslate"><span class="pre">gdp_pc_growth</span></code>を棒グラフとして表示してみよう。表示したい列を選択し，引数に<code class="docutils literal notranslate"><span class="pre">kind='bar'</span></code>を選択するだけである。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_jp</span><span class="p">[</span><span class="s1">&#39;gdp_pc_growth&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5_Income_Differences_184_0.png" src="_images/5_Income_Differences_184_0.png" />
</div>
</div>
<p>1960年代をピークに成長率は下降線をたどっている。</p>
<p>次にヒストグラムに異なる変数を並べて表示してみる。この場合も、表示したい変数を先に選び<code class="docutils literal notranslate"><span class="pre">kind='bar'</span></code>を指定するだけである。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_jp</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5_Income_Differences_186_0.png" src="_images/5_Income_Differences_186_0.png" />
</div>
</div>
<p>以下では，全要素生産性と蓄積生産要素の成長率に焦点を当てるので，<code class="docutils literal notranslate"><span class="pre">dropna()</span></code>を使って1950年代のデータは削除する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_jp</span> <span class="o">=</span> <span class="n">df_jp</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>上の棒グラフで，引数<code class="docutils literal notranslate"><span class="pre">stacked=True</span></code>を設定すると棒を積み重ねて表示することができる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_jp</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5_Income_Differences_190_0.png" src="_images/5_Income_Differences_190_0.png" />
</div>
</div>
<p>次のグラフでは，一人当たりGDPの線グラフと一緒に表示している。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax_</span> <span class="o">=</span> <span class="n">df_jp</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_jp</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax_</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5_Income_Differences_192_0.png" src="_images/5_Income_Differences_192_0.png" />
</div>
</div>
<p>1990年代に入ると，それ以前と比べて全要素生産性の成長率の下落が著しく，一人当たりGDPの成長率に大きく影響している。「失われた10年」の原因と主張する研究者もいる。</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="4_matplotlib.html" title="previous page">Matplotlib</a>
    <a class='right-next' id="next-link" href="6_Regression.html" title="next page">回帰分析</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By 春山 鉄源  Tetsugen HARUYAMA<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
                        window.ga = window.ga || function () {
                            (ga.q = ga.q || []).push(arguments) };
                        ga.l = +new Date;
                        ga('create', 'UA-165998213-2', 'auto');
                        ga('set', 'anonymizeIp', true);
                        ga('send', 'pageview');
                    </script>

  </body>
</html>