
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>回帰分析 &#8212; Pythonで学ぶマクロ経済学 (中級＋レベル)</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=87e54e7c" />
    <link rel="stylesheet" type="text/css" href="_static/myadmonitions.css?v=372cf325" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-3FB0WMD39P"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-3FB0WMD39P');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-3FB0WMD39P');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '6_Regression';</script>
    <link rel="canonical" href="https://py4macro.github.io/6_Regression.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="差分方程式と経済分析" href="7_DifferenceEq.html" />
    <link rel="prev" title="成長会計" href="5b_Growth_Accounting.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">Pythonで学ぶマクロ経済学 (中級＋レベル)</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Pythonの学習</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://py4basics.github.io">経済学のためのPython入門</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">長期分析</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="5a_Development_Accounting.html">発展会計</a></li>
<li class="toctree-l1"><a class="reference internal" href="5b_Growth_Accounting.html">成長会計</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">回帰分析</a></li>
<li class="toctree-l1"><a class="reference internal" href="7_DifferenceEq.html">差分方程式と経済分析</a></li>
<li class="toctree-l1"><a class="reference internal" href="8_Solow.html">ソロー・モデル</a></li>
<li class="toctree-l1"><a class="reference internal" href="9_Convergence.html">所得分布と所得収斂</a></li>
<li class="toctree-l1"><a class="reference internal" href="19_PPP.html">一物一価と購買力平価</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">短期分析I</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="10_Data_Fluctuation.html">GDPと構成要素</a></li>
<li class="toctree-l1"><a class="reference internal" href="11_Macro_Variables.html">法則・曲線・増加率</a></li>
<li class="toctree-l1"><a class="reference internal" href="18_ADAS-1.html">定量的マクロ経済分析：Part 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="18_ADAS-2.html">定量的マクロ経済分析：Part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="12_IS-MP-PC.html">IS-MP-PCモデル</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">短期分析II</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="13_random_TFP.html">ランダム変数と全要素生産性</a></li>
<li class="toctree-l1"><a class="reference internal" href="14_linearsolve.html"><code class="docutils literal notranslate"><span class="pre">linearsolve</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="15_RBC.html">実物的景気循環(RBC)モデル</a></li>
<li class="toctree-l1"><a class="reference internal" href="16_data_on_money.html">古典派の二分法と金融政策</a></li>
<li class="toctree-l1"><a class="reference internal" href="Plan.html">今後の計画</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">参考</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://py4basics.github.io/Gapminder.html">Gapminder</a></li>
<li class="toctree-l1"><a class="reference external" href="https://py4etrics.github.io">Pythonで学ぶ入門計量経済学</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/Py4Macro/py4macro.github.io/source?urlpath=tree/6_Regression.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/Py4Macro/py4macro.github.io/blob/source/6_Regression.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>



<a href="https://github.com/Py4Macro/py4macro.github.io" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/6_Regression.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>回帰分析</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">はじめに</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#python"><code class="docutils literal notranslate"><span class="pre">Python</span></code>を使った回帰分析</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">データ</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">回帰分析</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sec-6-regression-da">回帰分析による発展会計</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">説明</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">最小二乗法による計算</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="chap-6-regression">
<span id="id1"></span><h1>回帰分析<a class="headerlink" href="#chap-6-regression" title="Link to this heading">#</a></h1>
<div name="html-admonition" style="font-size: 0.8em">
<input type="button" onclick="location.href='https://translate.google.com/translate?hl=&sl=ja&tl=en&u='+window.location;" value="Google translation" style="color:#ffffff;background-color:#008080; height:25px" onmouseover="this.style.background='#99ccff'" onmouseout="this.style.background='#008080'"/> in English or the language of your choice.
</div><br><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">japanize_matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">py4macro</span>
<span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>

<span class="c1"># numpy v1の表示を使用</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">legacy</span><span class="o">=</span><span class="s1">&#39;1.25&#39;</span><span class="p">)</span>
<span class="c1"># 警告メッセージを非表示</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="id2">
<h2>はじめに<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<p>この章の目的は２つある。第一に，<code class="docutils literal notranslate"><span class="pre">Python</span></code>を使って回帰分析の方法を紹介する事である。読者には統計学や計量経済学を学び，実際にソフトを使い回帰分析をした経験を持つ人も多く含まれると思う。例えば，無料のRやGretl，そして有料ではあるがStataやEViewsあたりが人気ではないだろうか。<code class="docutils literal notranslate"><span class="pre">Python</span></code>でも回帰分析を簡単におこなうことが可能であり，有名な<code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>と<code class="docutils literal notranslate"><span class="pre">linearmodels</span></code>パッケージを使うと学部の授業で習うことは殆ど全て可能だろう。この章では基本的な回帰分析を考えるので<code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>だけを取り上げ，その基本的なコードを紹介するが，より多くを知りたい場合は<a class="reference external" href="https://py4etrics.github.io">「Pythonで学ぶ入門計量経済学」</a>を参照して欲しい。</p>
<p>この章の第二の目的は，<a class="reference internal" href="5a_Development_Accounting.html#chap-5a-accounting"><span class="std std-ref">発展会計</span></a>と<a class="reference internal" href="5b_Growth_Accounting.html#chap-5b-accounting"><span class="std std-ref">成長会計</span></a>の章で考察した問題を再考することである。その章では，全要素生産性と蓄積生産要素の２つにフォーカスし，それぞれが一人当たりGDPの水準と成長率にどれだけ貢献しているかを考えた。その際，寄与度として分散と共分散を使い計算したが，回帰分析を使うと簡単に計算できる事を示す。</p>
</section>
<section id="python">
<h2><code class="docutils literal notranslate"><span class="pre">Python</span></code>を使った回帰分析<a class="headerlink" href="#python" title="Link to this heading">#</a></h2>
<p><a class="reference internal" href="5a_Development_Accounting.html#chap-5a-accounting"><span class="std std-ref">発展会計</span></a>の章で経済間の所得格差の要因を考え，<a class="reference internal" href="5a_Development_Accounting.html#sec-5a-tfp"><span class="std std-ref">全要素生産性</span></a>のセクションで全要素生産性と一人当たりGDPの散布図を作成した。そのデータを使い回帰分析のためのコードの書き方を説明する。</p>
<section id="id3">
<h3>データ<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<p>まずデータを作成する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2019</span> <span class="o">=</span> <span class="n">py4macro</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;pwt&#39;</span><span class="p">)</span> \
                 <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;year == 2019&#39;</span><span class="p">)</span> \
                 <span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">py4macro.data()</span></code>は<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を返すため，そのメソッド<code class="docutils literal notranslate"><span class="pre">query()</span></code>を続けて使っている。また<code class="docutils literal notranslate"><span class="pre">query()</span></code>も<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を返すため，そのメソッド<code class="docutils literal notranslate"><span class="pre">reset_index()</span></code>を続けて使っている。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">\</span></code>を使うと改行が可能となる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">query('year</span> <span class="pre">==</span> <span class="pre">2019')</span></code>を使って2019年のデータだけを抽出したが，その際に行インデックスが飛び飛びになるので，それを<code class="docutils literal notranslate"><span class="pre">0</span></code>，<code class="docutils literal notranslate"><span class="pre">1</span></code>，<code class="docutils literal notranslate"><span class="pre">2</span></code>….と番号を振り直すために<code class="docutils literal notranslate"><span class="pre">reset_index()</span></code>を使っている。引数<code class="docutils literal notranslate"><span class="pre">drop=True</span></code>がないと，元の飛び飛びの行インデックスが新たな列として残るため，それを残さないようにしている。</p></li>
</ul>
</div>
<p>発展会計の分析で使った同じ変数を作成しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 資本の所得シャア</span>
<span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mf">3.0</span>

<span class="c1"># 労働者一人当たりGDP</span>
<span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;gdp_pc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;cgdpo&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;emp&#39;</span><span class="p">]</span>

<span class="c1"># 労働者一人当たり資本</span>
<span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;k_pc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;ck&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;emp&#39;</span><span class="p">]</span>

<span class="c1"># 蓄積生産要素</span>
<span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;factors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;k_pc&#39;</span><span class="p">]</span><span class="o">**</span><span class="n">a</span> <span class="o">*</span> <span class="p">(</span> <span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;avh&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;hc&#39;</span><span class="p">]</span> <span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">a</span><span class="p">)</span>

<span class="c1"># 全要素生産性</span>
<span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;tfp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;gdp_pc&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;factors&#39;</span><span class="p">]</span>

<span class="c1"># 米国のデータ</span>
<span class="n">us2019</span> <span class="o">=</span> <span class="n">df2019</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;country == &quot;United States&quot;&#39;</span><span class="p">)</span>

<span class="c1"># 労働者一人当たりGDPを標準化（USA=1）</span>
<span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;gdp_pc_relative&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;gdp_pc&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">us2019</span><span class="p">[</span><span class="s1">&#39;gdp_pc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

<span class="c1"># 全要素生産性の標準化（USA=1）</span>
<span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;tfp_relative&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;tfp&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">us2019</span><span class="p">[</span><span class="s1">&#39;tfp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

<span class="c1"># 蓄積生産要素の標準化（USA=1）</span>
<span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;factors_relative&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;factors&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">us2019</span><span class="p">[</span><span class="s1">&#39;factors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>全要素生産性と一人当たりGDPの散布図を作成しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2019</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;tfp_relative&#39;</span><span class="p">,</span> <span class="s1">&#39;gdp_pc_relative&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7d7f8d92b11fb86f139135820f13fa21b467df43bdc2be51e56a5753c8a0373b.png" src="_images/7d7f8d92b11fb86f139135820f13fa21b467df43bdc2be51e56a5753c8a0373b.png" />
</div>
</div>
</section>
<section id="id4">
<h3>回帰分析<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<p>上の散布図に直線のトレンドの描く場合</p>
<div class="math notranslate nohighlight" id="equation-eq-6-regression">
<span class="eqno">(15)<a class="headerlink" href="#equation-eq-6-regression" title="Link to this equation">#</a></span>\[
y_i = a+bA_i
\]</div>
<p>となり，<code class="docutils literal notranslate"><span class="pre">i</span></code>は個々の観測値（即ち，経済）を表す。ここでの目的は，散布図のデータを使い定数項<code class="docutils literal notranslate"><span class="pre">a</span></code>とスロープ係数<code class="docutils literal notranslate"><span class="pre">b</span></code>を計算し直線トレンドを描く事である。</p>
<p>式<a class="reference internal" href="#equation-eq-6-regression">(15)</a>のパラメータ<code class="docutils literal notranslate"><span class="pre">b</span></code>を推計するために<code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>パッケージを使うが，そのサブパッケージ<code class="docutils literal notranslate"><span class="pre">formula.api</span></code>の中に含まれる<code class="docutils literal notranslate"><span class="pre">ols</span></code>を使うことにより、最小二乗法の多くの計算（例えば、検定値など）を自動で行うことが可能である。また推定式を文字列で書くことができるので直感的にコードを書くことが可能となる。より具体的な説明は<a class="reference external" href="https://py4etrics.github.io">このサイト</a>を参照してほしい。</p>
<p>次のステップでコードを書く。</p>
<ol class="arabic simple">
<li><p>文字列で推定式を書く。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">smf</span></code>に含まれる<code class="docutils literal notranslate"><span class="pre">ols()</span></code>関数を使って推定の準備を行う。</p></li>
<li><p>メソッド<code class="docutils literal notranslate"><span class="pre">.fit()</span></code>を使って自動計算を行う。</p></li>
<li><p>結果の属性やメソッドを使い推定値を表示する。</p></li>
</ol>
<p><strong>＜ステップ１＞</strong> 推定式の設定</p>
<p>回帰式は次のような形で文字列を使って指定する。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;被説明変数 ~ 定数項以外の説明変数&#39;</span>
</pre></div>
</div>
<p>定数項は自動的に挿入される。また定数項以外の説明変数が複数がる場合は、<code class="docutils literal notranslate"><span class="pre">+</span></code>でつなげるが，今回は単回帰分析となるので説明変数は１つとなる。また回帰式の中で使う変数名は，データが含まれる<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>の列ラベルを使う。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;gdp_pc_relative ~ tfp_relative&#39;</span>
</pre></div>
</div>
<p>以下ではこの回帰式を変数<code class="docutils literal notranslate"><span class="pre">formula</span></code>に割り当てているが，変数は分かりやすいものであれば好きなものを使えば良い。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">formula</span> <span class="o">=</span> <span class="s1">&#39;gdp_pc_relative ~ tfp_relative&#39;</span>
</pre></div>
</div>
</div>
</div>
<p><strong>＜ステップ２＞</strong> 自動計算の準備</p>
<p><code class="docutils literal notranslate"><span class="pre">smf</span></code>の<code class="docutils literal notranslate"><span class="pre">ols()</span></code>関数を使って自動計算の準備として計算の対象となるもの（インスタンスと呼ばれるオブジェクト）を生成する。次のコードでは変数<code class="docutils literal notranslate"><span class="pre">model</span></code>に割り当てる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df2019</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">ols()</span></code>の第１引数は上で定義した文字列の回帰式であり、第２引数<code class="docutils literal notranslate"><span class="pre">data</span></code>は使用するデータを指定する。</p>
<p><strong>＜ステップ３＞</strong> 自動計算</p>
<p><code class="docutils literal notranslate"><span class="pre">model</span></code>のメソッド<code class="docutils literal notranslate"><span class="pre">.fit()</span></code>を使って自動計算し，計算した結果を変数<code class="docutils literal notranslate"><span class="pre">result</span></code>に割り当てる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>ここでステップ２と３を連続で次のように書いても構わない。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>＜ステップ４＞</strong> 結果の表示</p>
<p><code class="docutils literal notranslate"><span class="pre">result</span></code>には様々な属性が用意されているが、メソッド<code class="docutils literal notranslate"><span class="pre">.summary()</span></code>を使うと基本的な推定結果を表示することができる。（関数<code class="docutils literal notranslate"><span class="pre">print()</span></code>を使っているが使わなくても同じ情報が表示される。）</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:        gdp_pc_relative   R-squared:                       0.851
Model:                            OLS   Adj. R-squared:                  0.848
Method:                 Least Squares   F-statistic:                     336.7
Date:                Sun, 07 Jul 2024   Prob (F-statistic):           4.64e-26
Time:                        07:02:21   Log-Likelihood:                 49.767
No. Observations:                  61   AIC:                            -95.53
Df Residuals:                      59   BIC:                            -91.31
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
================================================================================
                   coef    std err          t      P&gt;|t|      [0.025      0.975]
--------------------------------------------------------------------------------
Intercept       -0.2821      0.049     -5.812      0.000      -0.379      -0.185
tfp_relative     1.2005      0.065     18.349      0.000       1.070       1.331
==============================================================================
Omnibus:                       12.607   Durbin-Watson:                   1.985
Prob(Omnibus):                  0.002   Jarque-Bera (JB):               18.207
Skew:                           0.730   Prob(JB):                     0.000111
Kurtosis:                       5.243   Cond. No.                         7.14
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
</div>
</div>
<p>表は3つのセクションから構成されている。</p>
<ul class="simple">
<li><p>上段にはOLS推定の基本的な情報が表示されている。</p>
<ul>
<li><p>左側</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Dep.</span> <span class="pre">Variable</span></code>：被説明変数</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Model</span></code>：モデル</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Method</span></code>：手法</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Data</span></code>：日にち</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Time</span></code>：時間</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">No.</span> <span class="pre">Observation</span></code>：標本の大きさ</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Df</span> <span class="pre">Residuals</span></code>：残差の自由度</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Df</span> <span class="pre">Model</span></code>：モデルの自由度（定数項以外の説明変数の数）</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Covariance</span> <span class="pre">Type</span></code>：共分散のタイプ</p></li>
</ul>
</li>
<li><p>右側</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">R-squared</span></code>：決定係数</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">adj.</span> <span class="pre">R-squared</span></code>：自由度調整済み決定係数</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">F-statistic</span></code>：<span class="math notranslate nohighlight">\(F\)</span>統計量</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Prob</span> <span class="pre">(F-statistic)</span></code>：<span class="math notranslate nohighlight">\(F\)</span>値</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Log-Likelihood</span></code>：対数尤度</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">AIC</span></code>：赤池情報量規準</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BIC</span></code>：ベイズ情報量規準</p></li>
</ul>
</li>
</ul>
</li>
<li><p>中段には主な推定結果が表示される。</p>
<ul>
<li><p>列ラベル</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">coef</span></code>：係数</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">std</span> <span class="pre">err</span></code>：標準誤差</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">t</span></code>：<span class="math notranslate nohighlight">\(t\)</span>値</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">P&gt;|t|</span></code>：<span class="math notranslate nohighlight">\(p\)</span>値</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[0.025,0.975]</span></code>：信頼区間（5%)</p></li>
</ul>
</li>
<li><p>行ラベル</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Intercept</span></code>：定数項</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tfp_relative</span></code>：説明変数（選択する変数によって変わる）</p></li>
</ul>
</li>
</ul>
</li>
<li><p>下段には様々な検定などに関する数値が並んでいる。</p>
<ul>
<li><p>左側</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Omnibus</span></code>：オムニバス検定統計量（帰無仮説：残差は正規分布に従う）</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Prob(Omnibus)</span></code>：オムニバス検定<span class="math notranslate nohighlight">\(p\)</span>値</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Skew</span></code>：残差の歪度（正規分布であれば<code class="docutils literal notranslate"><span class="pre">0</span></code>）</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Kurtosis</span></code>：残差の尖度（正規分布であれば<code class="docutils literal notranslate"><span class="pre">3</span></code>）</p></li>
</ul>
</li>
<li><p>右側</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Durbin-Watson</span></code>：ダービン・ワトソン統計量（残差の自己相関の検定）</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Jarque-Bera</span> <span class="pre">(JB)</span></code>：ジャーク・ベラ検定統計量（帰無仮説：残差は正規分布に従う）</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Prob(JB)</span></code>：ジャーク・ベラ検定<span class="math notranslate nohighlight">\(p\)</span>値</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Cond.</span> <span class="pre">No.</span></code>：条件指数（Condition Index）の最大値（多重共線性を確認するための指標だが，変数が標準化されて計算していないため変数の値の大きさに依存することになるり，使い難い指標となっている。重回帰分析においての多重共線性の確認については<a class="reference external" href="https://py4etrics.github.io/9_Multiple_Regression.html#sec-9-vif">ここで説明</a>する手法を使うことを勧める。）</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>必要な部分だけを表示する場合は，次のコードを使うと良いだろう。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">result</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">result</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<p>係数の推定値に関する中段の表を表示してみる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>================================================================================
                   coef    std err          t      P&gt;|t|      [0.025      0.975]
--------------------------------------------------------------------------------
Intercept       -0.2821      0.049     -5.812      0.000      -0.379      -0.185
tfp_relative     1.2005      0.065     18.349      0.000       1.070       1.331
================================================================================
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">statsmodels</span> <span class="pre">13.0</span></code>では<code class="docutils literal notranslate"><span class="pre">.summary()</span></code>に引数<code class="docutils literal notranslate"><span class="pre">slim</span></code>（デフォルトは<code class="docutils literal notranslate"><span class="pre">False</span></code>）が追加されており，<code class="docutils literal notranslate"><span class="pre">.tables</span></code>を使わずに次のコードで簡略化された表を表示できる。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">slim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>結果の解釈を試みてみよう。</p>
<ul class="simple">
<li><p>定数項の推定値のp値は小さく、通常の有意水準では「定数項の値はゼロ」の帰無仮説を棄却できる。一方で，一人当たりGDPは正の値を取るが，定数項はマイナスの値となっている。ここでは非線形の関係が示唆されるので，練習問題で再考する。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tfp_relative</span></code>のパラメータの推定値は正の値であり，統計的優位性も高い。推定値を解釈するために，相対的全要素生産性である<code class="docutils literal notranslate"><span class="pre">tfp_relative</span></code>が0.01上昇したとしよう（例えば，0.5から0.51）。相対的一人当たりGDP<code class="docutils literal notranslate"><span class="pre">gdp_pc_relative</span></code>は平均で1.2225x0.01=0.012225増加する事になる。即ち，全要素生産性の１単位の上昇は一人当たりGDPの１単位以上の増加につながっている。</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">result</span></code>は推定結果に関する情報が詰まったオブジェクトである。何が備わっているか<code class="docutils literal notranslate"><span class="pre">py4macro</span></code>モジュールに含まれる<code class="docutils literal notranslate"><span class="pre">see()</span></code>関数を使って調べてみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">py4macro</span><span class="o">.</span><span class="n">see</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.HC0_se             .HC1_se             .HC2_se             .HC3_se
.aic                .bic                .bse                .centered_tss
.compare_f_test     .compare_lm_test    .compare_lr_test    .condition_number
.conf_int           .conf_int_el        .cov_HC0            .cov_HC1
.cov_HC2            .cov_HC3            .cov_kwds           .cov_params
.cov_type           .df_model           .df_resid           .diagn
.eigenvals          .el_test            .ess                .f_pvalue
.f_test             .fittedvalues       .fvalue             .get_influence
.get_prediction     .get_robustcov_results  .info_criteria      .initialize
.k_constant         .llf                .load               .model
.mse_model          .mse_resid          .mse_total          .nobs
.normalized_cov_params  .outlier_test       .params             .predict
.pvalues            .remove_data        .resid              .resid_pearson
.rsquared           .rsquared_adj       .save               .scale
.ssr                .summary            .summary2           .t_test
.t_test_pairwise    .tvalues            .uncentered_tss     .use_t
.wald_test          .wald_test_terms    .wresid
</pre></div>
</div>
</div>
</div>
<p>推定結果の表を表示するメソッド<code class="docutils literal notranslate"><span class="pre">.summary()</span></code>が含まれていることが分かる。その他様々なものが含まれているが，詳細は<a class="reference external" href="https://www.statsmodels.org/stable/generated/statsmodels.regression.linear_model.RegressionResults.html">このサイト</a>（英語）を参考にして欲しい。ここでは代表的なものだけを紹介する。</p>
<p>まず係数の推定値は<code class="docutils literal notranslate"><span class="pre">result</span></code>の属性<code class="docutils literal notranslate"><span class="pre">params</span></code>でアクセスできる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">params</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Intercept      -0.282074
tfp_relative    1.200503
dtype: float64
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">result.params</span></code>のタイプを調べてみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pandas.core.series.Series
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Pandas</span></code>の<code class="docutils literal notranslate"><span class="pre">Series</span></code>として返されていることが分かる。従って，定数項は<code class="docutils literal notranslate"><span class="pre">.iloc[]</span></code>とインデックス番号を使って<code class="docutils literal notranslate"><span class="pre">result.params[0]</span></code>，スロープ係数は<code class="docutils literal notranslate"><span class="pre">result.params[1]</span></code>で抽出できる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ahat</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">bhat</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ahat</span><span class="p">,</span> <span class="n">bhat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-0.282074443950234, 1.2005026319194922)
</pre></div>
</div>
</div>
</div>
<p>もしくは，ラベルを使うこともできる。その場合は，<code class="docutils literal notranslate"><span class="pre">[]</span></code>もしくは<code class="docutils literal notranslate"><span class="pre">.loc[]</span></code>を使うと良い。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ahat</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;Intercept&#39;</span><span class="p">]</span>
<span class="n">bhat</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;tfp_relative&#39;</span><span class="p">]</span>

<span class="c1"># これでも同じ結果となる</span>
<span class="c1"># ahat = result.params.loc[&#39;Intercept&#39;]</span>
<span class="c1"># bhat = result.params.loc[&#39;tfp_relative&#39;]</span>

<span class="n">ahat</span><span class="p">,</span> <span class="n">bhat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-0.282074443950234, 1.2005026319194922)
</pre></div>
</div>
</div>
</div>
<p>この方法を使い，<code class="docutils literal notranslate"><span class="pre">tfp_relative</span></code>が<code class="docutils literal notranslate"><span class="pre">x</span></code>の場合の<code class="docutils literal notranslate"><span class="pre">gdp_pc_relative</span></code>を計算する関数は作ってみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">calculate_gdp_pc_relative</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    
    <span class="n">gdp</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">result</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;相対全要素生産性が</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">の場合の相対的一人当たりGDPは約</span><span class="si">{</span><span class="n">gdp</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">です。&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">x</span></code>が<code class="docutils literal notranslate"><span class="pre">0.8</span></code>の場合を考えよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">calculate_gdp_pc_relative</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>相対全要素生産性が0.8の場合の相対的一人当たりGDPは約0.678です。
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>予測値だけであれば，次のコードでも同じ結果を表示できる。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">predict</span><span class="p">({</span><span class="s1">&#39;tfp_relative&#39;</span><span class="p">:</span><span class="mf">0.8</span><span class="p">})</span>
</pre></div>
</div>
<p>ここで<code class="docutils literal notranslate"><span class="pre">.predict()</span></code>は予測値を得るメソッド。引数を入れずに使うと，次に説明する属性<code class="docutils literal notranslate"><span class="pre">.fittedvalues</span></code>と同じ値を返す。</p>
</div>
<p>次に、標本の散布図に回帰直線を重ねて表示してみる。まず<code class="docutils literal notranslate"><span class="pre">result</span></code>の属性<code class="docutils literal notranslate"><span class="pre">.fittedvalues</span></code>を使い非説明変数の予測値を抽出することができるので、<code class="docutils literal notranslate"><span class="pre">df2019</span></code>に<code class="docutils literal notranslate"><span class="pre">fitted</span></code>のラベルを使って新たな列として追加する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;OLS fitted&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">fittedvalues</span>
</pre></div>
</div>
</div>
</div>
<p>図を重ねて表示する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax_</span> <span class="o">=</span> <span class="n">df2019</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;tfp_relative&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;gdp_pc_relative&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">)</span>
<span class="n">df2019</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;OLS fitted&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;tfp_relative&#39;</span><span class="p">,</span>
                                      <span class="n">y</span><span class="o">=</span><span class="s1">&#39;OLS fitted&#39;</span><span class="p">,</span>
                                      <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax_</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8c5cab9556ce6e7245c847ee75527d759f20350dd86f6965ff347149b8dcde51.png" src="_images/8c5cab9556ce6e7245c847ee75527d759f20350dd86f6965ff347149b8dcde51.png" />
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<p>２行目の<code class="docutils literal notranslate"><span class="pre">sort_values()</span></code>は引数の<code class="docutils literal notranslate"><span class="pre">'OLS</span> <span class="pre">fitted'</span></code>を基準に昇順に並べ替える。これを指定しないと直線が綺麗に表示されない。</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">gdp_pc_relative</span></code>の予測値は，属性<code class="docutils literal notranslate"><span class="pre">.fittedvalues</span></code>もしくはメソッド<code class="docutils literal notranslate"><span class="pre">.predict()</span></code>で取得できるが，次のコードでも同じ結果となる。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;fitted&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ahat</span> <span class="o">+</span> <span class="n">bhat</span> <span class="o">*</span> <span class="n">df2019</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;tfp_relative&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="sec-6-regression-da">
<span id="id5"></span><h2>回帰分析による発展会計<a class="headerlink" href="#sec-6-regression-da" title="Link to this heading">#</a></h2>
<section id="id6">
<h3>説明<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<p><a class="reference internal" href="5a_Development_Accounting.html#chap-5a-accounting"><span class="std std-ref">発展会計</span></a>の式<a class="reference internal" href="5a_Development_Accounting.html#equation-eq-riy-decomposition">(5)</a>では，米国の一人当たりGDPを基準として経済<span class="math notranslate nohighlight">\(i\)</span>の一人当たりGDPを次式で表した。</p>
<div class="math notranslate nohighlight" id="equation-eq-6-riy">
<span class="eqno">(16)<a class="headerlink" href="#equation-eq-6-riy" title="Link to this equation">#</a></span>\[
r_i^y =
r_i^{\text{tfp}} +
r_i^{\text{factors}}
\]</div>
<p>ここで，</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(r_i^y\)</span>：一人当たりGDP（対数; 米国＝１）</p></li>
<li><p><span class="math notranslate nohighlight">\(r_i^{\text{tfp}}\)</span>：全要素生産性（対数; 米国＝１）</p></li>
<li><p><span class="math notranslate nohighlight">\(r_i^{\text{factors}}\)</span>：蓄積生産要素（対数; 米国＝１）</p></li>
</ul>
<p>また，それぞれの貢献度を次式で数量化した。</p>
<div class="math notranslate nohighlight" id="equation-eq-6-tfp-contribution">
<span class="eqno">(17)<a class="headerlink" href="#equation-eq-6-tfp-contribution" title="Link to this equation">#</a></span>\[
\text{全要素生産性の寄与度}
\equiv\beta_{\text{tfp}}=
\dfrac{
    \text{Var}\left(r_i^{\text{tfp}}\right)
    +\text{Cov}\left(r_i^{\text{tfp}},r_i^{\text{factors}}\right)
    }{
    \text{Var}(r_i^y)
    }
\]</div>
<div class="math notranslate nohighlight" id="equation-eq-6-factors-contribution">
<span class="eqno">(18)<a class="headerlink" href="#equation-eq-6-factors-contribution" title="Link to this equation">#</a></span>\[
\text{蓄積生産要素の寄与度}
\equiv
\beta_{\text{factors}}=
\dfrac{
    \text{Var}\left(r_i^{\text{factors}}\right)
    +\text{Cov}\left(r_i^{\text{tfp}},r_i^{\text{factors}}\right)
    }{
    \text{Var}(r_i^y)
    }    
\]</div>
<p>この章では回帰分析を使って<span class="math notranslate nohighlight">\(\beta_{\text{tfp}}\)</span>と<span class="math notranslate nohighlight">\(\beta_{\text{factors}}\)</span>計算することができることを示す。そのために，まず次の関係が成立することを思い出そう。</p>
<div class="math notranslate nohighlight">
\[
\text{Cov}(x,x)=\text{Var}(x)
\]</div>
<div class="math notranslate nohighlight">
\[
\text{Cov}(x,y\pm z)=\text{Cov}(x,y)\pm\text{Cov}(x,z)
\]</div>
<p>これらを使うと<a class="reference internal" href="#equation-eq-6-tfp-contribution">(17)</a>は次のように書き換えることができる。</p>
<div class="math notranslate nohighlight" id="equation-eq-6-tfp-contribution-2">
<span class="eqno">(19)<a class="headerlink" href="#equation-eq-6-tfp-contribution-2" title="Link to this equation">#</a></span>\[
\beta_{\text{tfp}}
=\dfrac{
    \text{Var}\left(r_i^{\text{tfp}}\right)
    +\text{Cov}\left(r_i^{\text{tfp}},r_i^y-r_i^{\text{tfp}}\right)
    }{
    \text{Var}(r_i^y)
    }
=\dfrac{
    \text{Cov}\left(r_i^{\text{tfp}},r_i^{y}\right)
    }{
    \text{Var}(r_i^y)
    } 
\]</div>
<p>蓄積生産要素の寄与度についても同様に次式で与えられる。</p>
<div class="math notranslate nohighlight" id="equation-eq-6-factors-contribution-2">
<span class="eqno">(20)<a class="headerlink" href="#equation-eq-6-factors-contribution-2" title="Link to this equation">#</a></span>\[
\beta_{\text{factors}}
=\dfrac{
    \text{Cov}\left(r_i^{\text{factors}},r_i^{y}\right)
    }{
    \text{Var}(r_i^y)
    } 
\]</div>
<p>この結果が回帰分析とどのような関係にあるかを確認するために，次の単回帰式を考えよう。</p>
<div class="math notranslate nohighlight">
\[
y_i = a + bx_i+e_i
\]</div>
<p>最小二乗法を使い推定すると，スロープ係数の推定値は次式で与えられることになる。</p>
<div class="math notranslate nohighlight" id="equation-eq-6-bhat">
<span class="eqno">(21)<a class="headerlink" href="#equation-eq-6-bhat" title="Link to this equation">#</a></span>\[
\hat{b}=\dfrac{
            \text{Cov}\left(y,x\right)
            }{
            \text{Var}(x)
            } 
\]</div>
<p>式<a class="reference internal" href="#equation-eq-6-bhat">(21)</a>と２つの式<a class="reference internal" href="#equation-eq-6-tfp-contribution-2">(19)</a>と<a class="reference internal" href="#equation-eq-6-factors-contribution-2">(20)</a>から，次の回帰式を最小二乗法で推定すると<span class="math notranslate nohighlight">\(\beta_{\text{tfp}}\)</span>と<span class="math notranslate nohighlight">\(\beta_{\text{factors}}\)</span>を計算できることが分かる。</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
&amp;r_i^{\text{tfp}}=a+\beta_{\text{tfp}}r_i^{y}+e_i \\
&amp;r_i^{\text{factors}}=c+\beta_{\text{factors}}r_i^{y}+u_i
\end{align*}
\end{split}\]</div>
<p>以下では<code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>を使って実際に計算してみよう。</p>
</section>
<section id="id7">
<h3>最小二乗法による計算<a class="headerlink" href="#id7" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">df2019</span></code>にある変数を使って，計算に使う変数を作成しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 労働者一人当たりGDP（USA=1）の対数化</span>
<span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;gdp_pc_relative_log&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span> <span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;gdp_pc_relative&#39;</span><span class="p">]</span> <span class="p">)</span>

<span class="c1"># 全要素生産性（USA=1）の対数化</span>
<span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;tfp_relative_log&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span> <span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;tfp_relative&#39;</span><span class="p">]</span> <span class="p">)</span>

<span class="c1"># 蓄積生産要素（USA=1）の対数化</span>
<span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;factors_relative_log&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span> <span class="n">df2019</span><span class="p">[</span><span class="s1">&#39;factors_relative&#39;</span><span class="p">]</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>次に推定式を定義する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">formula_tfp</span> <span class="o">=</span> <span class="s1">&#39;tfp_relative_log ~ gdp_pc_relative_log&#39;</span>
<span class="n">formula_factors</span> <span class="o">=</span> <span class="s1">&#39;factors_relative_log ~ gdp_pc_relative_log&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>自動計算のための準備をし，実際に計算した結果を変数に割り当てる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_tfp</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula_tfp</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df2019</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">result_factors</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula_factors</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df2019</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>パラメータの値を表示してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;全要素生産性の寄与度：</span><span class="si">{</span><span class="n">result_tfp</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
      <span class="sa">f</span><span class="s1">&#39;蓄積生産要素の寄与度：</span><span class="si">{</span><span class="n">result_factors</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>全要素生産性の寄与度：0.5467723234514837
蓄積生産要素の寄与度：0.45322767654851603
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code>は以前説明した<code class="docutils literal notranslate"><span class="pre">f-string</span></code>を使って<code class="docutils literal notranslate"><span class="pre">{}</span></code>に値を代入している。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">()</span></code>は複数行にしても構わない。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">''</span></code>で囲んだ文字列を複数行にする場合は，それぞれの行で閉じる必要がある。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">\n</span></code>は改行という意味。</p></li>
</ul>
</div>
<p><a class="reference internal" href="5a_Development_Accounting.html#sec-5-tfp-factors"><span class="std std-ref">全要素生産性と蓄積生産要素の寄与度</span></a>で計算した値と同じになることが確認できる。</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="5b_Growth_Accounting.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">成長会計</p>
      </div>
    </a>
    <a class="right-next"
       href="7_DifferenceEq.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">差分方程式と経済分析</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">はじめに</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#python"><code class="docutils literal notranslate"><span class="pre">Python</span></code>を使った回帰分析</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">データ</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">回帰分析</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sec-6-regression-da">回帰分析による発展会計</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">説明</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">最小二乗法による計算</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By 春山 鉄源  Tetsugen HARUYAMA
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <!-- Default Statcounter code for Py4Macro https://py4macro.github.io --> <script type="text/javascript"> var sc_project=12478906; var sc_invisible=1; var sc_security="e767d225"; </script> <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script> <noscript><div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img class="statcounter" src="https://c.statcounter.com/12478906/0/e767d225/1/" alt="Web Analytics"></a></div></noscript> <!-- End of Statcounter Code -->
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>