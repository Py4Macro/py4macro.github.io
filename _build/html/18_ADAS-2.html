

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>定量的マクロ経済分析：Part 2 &#8212; Pythonで学ぶマクロ経済学 (中級＋レベル)</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/my_style.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-3FB0WMD39P"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-3FB0WMD39P');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '18_ADAS-2';</script>
    <link rel="canonical" href="https://py4macro.github.io/18_ADAS-2.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="IS-MP-PCモデル" href="12_IS-MP-PC.html" />
    <link rel="prev" title="定量的マクロ経済分析：Part 1" href="18_ADAS-1.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    <p class="title logo__title">Pythonで学ぶマクロ経済学 (中級＋レベル)</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Pythonの学習</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://py4basics.github.io">経済学のためのPython入門</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">長期分析</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="5a_Development_Accounting.html">発展会計</a></li>
<li class="toctree-l1"><a class="reference internal" href="5b_Growth_Accounting.html">成長会計</a></li>
<li class="toctree-l1"><a class="reference internal" href="6_Regression.html">回帰分析</a></li>
<li class="toctree-l1"><a class="reference internal" href="7_DifferenceEq.html">差分方程式と経済分析</a></li>
<li class="toctree-l1"><a class="reference internal" href="8_Solow.html">ソロー・モデル</a></li>
<li class="toctree-l1"><a class="reference internal" href="9_Convergence.html">所得分布と所得収斂</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">短期分析I</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="10_Data_Fluctuation.html">GDPと構成要素</a></li>
<li class="toctree-l1"><a class="reference internal" href="11_Macro_Variables.html">法則・曲線・増加率</a></li>
<li class="toctree-l1"><a class="reference internal" href="18_ADAS-1.html">定量的マクロ経済分析：Part 1</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">定量的マクロ経済分析：Part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="12_IS-MP-PC.html">IS-MP-PCモデル</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">短期分析II</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="13_random_TFP.html">ランダム変数と全要素生産性</a></li>
<li class="toctree-l1"><a class="reference internal" href="14_linearsolve.html"><code class="docutils literal notranslate"><span class="pre">linearsolve</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="15_RBC.html">実物的景気循環(RBC)モデル</a></li>
<li class="toctree-l1"><a class="reference internal" href="16_data_on_money.html">古典派の二分法と金融政策</a></li>
<li class="toctree-l1"><a class="reference internal" href="Plan.html">今後の計画</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">参考</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://py4basics.github.io/Gapminder.html">Gapminder</a></li>
<li class="toctree-l1"><a class="reference external" href="https://py4etrics.github.io">Pythonで学ぶ入門計量経済学</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/Py4Macro/py4macro.github.io/source?urlpath=tree/18_ADAS-2.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/Py4Macro/py4macro.github.io/blob/source/18_ADAS-2.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="このページをダウンロード">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/18_ADAS-2.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="ソースファイルをダウンロード"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="PDFに印刷"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="全画面モード"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>定量的マクロ経済分析：Part 2</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> 目次 </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">はじめに</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">コードの基本形</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adas">ADASモデルの安定性</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">インパルス反応関数</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">コード</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">プロット</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">総供給ショック</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">総需要ショック</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">総供給・総需要ショックの同時発生</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">確率的シミュレーション</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">コード</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">プロット</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gdp">GDPと価格水準の％乖離の標準偏差</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">自己相関係数</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#py"><code class="docutils literal notranslate"><span class="pre">p</span></code>と<code class="docutils literal notranslate"><span class="pre">y</span></code>の％乖離の相関係数：同時期</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">結果のまとめと拡張</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">ADASモデルの評価</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">定量的な問い</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">予測誤差</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">GDPの％乖離</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">計算方法</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">結果</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">解釈</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">価格水準の％乖離</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">計算方法</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id23">結果</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">解釈</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id25">まとめ</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id26">付録：分散と共分散の性質</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="part-2">
<span id="chap-18-adas-2"></span><h1>定量的マクロ経済分析：Part 2<a class="headerlink" href="#part-2" title="Permalink to this headline">#</a></h1>
<div name="html-admonition" style="font-size: 0.8em">
<input type="button" onclick="location.href='https://translate.google.com/translate?hl=&sl=ja&tl=en&u='+window.location;" value="Google translation" style="color:#ffffff;background-color:#008080; height:25px" onmouseover="this.style.background='#99ccff'" onmouseout="this.style.background='#008080'"/> in English or the language of your choice.
</div><br><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">japanize_matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">py4macro</span>
<span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;frozen importlib._bootstrap&gt;:228: RuntimeWarning: scipy._lib.messagestream.MessageStream size changed, may indicate binary incompatibility. Expected 56 from C header, got 64 from PyObject
</pre></div>
</div>
</div>
</div>
<section id="id1">
<h2>はじめに<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h2>
<p>前章で展開したADASモデルは次の２つの均衡式で与えられる。</p>
<div class="math notranslate nohighlight" id="equation-eq-18-eq-p-2">
<span class="eqno">(84)<a class="headerlink" href="#equation-eq-18-eq-p-2" title="Permalink to this equation">#</a></span>\[
p_{t}=hp_{t-1}+h\left(a u_{t}+v_{t}\right)
\]</div>
<div class="math notranslate nohighlight" id="equation-eq-18-eq-y-2">
<span class="eqno">(85)<a class="headerlink" href="#equation-eq-18-eq-y-2" title="Permalink to this equation">#</a></span>\[
y_t=-cp_t + u_t
\]</div>
<p>ここで</p>
<div class="math notranslate nohighlight" id="equation-eq-18-h-2">
<span class="eqno">(86)<a class="headerlink" href="#equation-eq-18-h-2" title="Permalink to this equation">#</a></span>\[
h\equiv\frac{1}{1+a c}&lt;1
\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(p_t\)</span>：価格水準のトレンドからの％乖離</p></li>
<li><p><span class="math notranslate nohighlight">\(y_t\)</span>：産出量のトレンドからの％乖離</p></li>
<li><p><span class="math notranslate nohighlight">\(v_t\sim N\left(0,\sigma_v^2\right)\)</span>：総供給ショック</p></li>
<li><p><span class="math notranslate nohighlight">\(u_t\sim N\left(0,\sigma_u^2\right)\)</span>：総需要ショック</p></li>
</ul>
<p>またカリブレーションの手法を使い，次の値を設定した。</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ahat</span> <span class="o">=</span> <span class="mf">0.3674839411519716</span>
<span class="n">chat</span> <span class="o">=</span> <span class="mf">0.679419826388461</span>
<span class="n">v_std</span> <span class="o">=</span> <span class="mf">0.006610407413428777</span>
<span class="n">u_std</span> <span class="o">=</span> <span class="mf">0.014412515882360838</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;aの値：</span><span class="si">{</span><span class="n">ahat</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;cの値：</span><span class="si">{</span><span class="n">chat</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;uの標準偏差：</span><span class="si">{</span><span class="n">u_std</span><span class="si">:</span><span class="s1">.6f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;vの標準偏差：</span><span class="si">{</span><span class="n">v_std</span><span class="si">:</span><span class="s1">.6f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>aの値：0.367
cの値：0.679
uの標準偏差：0.014413
vの標準偏差：0.006610
</pre></div>
</div>
</div>
</div>
<p>これらの値を使い，次の定量的マクロ分析をおこなう。第一に，ADASモデルの安定性を検討する。ADASモデルの定性的分析をとおして長期的な均衡は安定的だと直感的に理解できるが，以下では，差分方程式を使い結果をプロットし均衡の安定性を確認する。これにより，均衡への収束の速さを視覚的に確認することも可能となる。第二に，インパルス反応関数を使い，需要ショックもしくは供給ショックが発生した際，産出量と物価水準（トレンドからの％乖離）がどのように変化するかを示す時系列的なプロットに基づき検討する。このような定量分析は，ADASモデルの定性的な理解を補完することになる。第三に，確率的シミュレーションをおこない，ADASモデルが景気循環データをどの程度再現できるかが焦点となる。確率的シミュレーションでは，毎期毎期，総需要・総供給ショックが絶え間なく発生する状況を考え，生成されるデータと実際の景気循環データの特徴を比較することにより，ADASモデルのデータ再現力を評価することができる。第四に，確率的シミュレーションの結果を踏まえて，次の定量的な問いを検討する。</p>
<blockquote>
<div><p>GDPと価格水準の長期トレンドからの乖離（％）の変動は，何パーセントが需要ショックにより引き起こされ，何パーセントが供給ショックに起因するのか？</p>
</div></blockquote>
</section>
<section id="id2">
<h2>コードの基本形<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h2>
<p>以下ではシミュレーションをおこなうが，コードは関数にまとめて書くことにする。
コードは次のようなパターンになっている。</p>
<p>関数の中身</p>
<ol class="arabic simple">
<li><p>アップデート用の変数を用意</p></li>
<li><p>空のリストを作成</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">for</span></code>ループに<code class="docutils literal notranslate"><span class="pre">.append()</span></code>を使う</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を返す</p></li>
</ol>
<p>簡単な例として次の差分方程式を考えてみよう。</p>
<div class="math notranslate nohighlight">
\[
x_t = x_{t-1} + a
\]</div>
<p><code class="docutils literal notranslate"><span class="pre">my_func()</span></code>は，この差分方程式を使った計算結果を<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>として返す。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_func</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    引数：</span>
<span class="sd">        x0: 初期値</span>
<span class="sd">        a: 差分方程式のパラメーター</span>
<span class="sd">        n: ループ計算の回数</span>
<span class="sd">    戻り値：</span>
<span class="sd">        DataFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">x0</span>      <span class="c1"># アップデート用の変数</span>

    <span class="n">lst</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span>   <span class="c1"># 空のリスト</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">a</span>      <span class="c1"># 差分方程式</span>

        <span class="n">lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># リストに結果を追加</span>
        
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;col&#39;</span><span class="p">:</span> <span class="n">lst</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_func</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>col</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10</td>
    </tr>
    <tr>
      <th>2</th>
      <td>20</td>
    </tr>
    <tr>
      <th>3</th>
      <td>30</td>
    </tr>
    <tr>
      <th>4</th>
      <td>40</td>
    </tr>
    <tr>
      <th>5</th>
      <td>50</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>本章のコードは少し長くなるが，コードのパターンとしては上の例と同じになるので，コードの理解に不安な場合は上のコードで復習してはどうだろうか。</p>
</section>
<section id="adas">
<h2>ADASモデルの安定性<a class="headerlink" href="#adas" title="Permalink to this headline">#</a></h2>
<p>まずADASモデルの安定性を考える。すなわち，任意の初期値（<span class="math notranslate nohighlight">\(p_0\)</span>と<span class="math notranslate nohighlight">\(y_0\)</span>）にある経済が長期均衡に戻るかどうかを確認する。
そのために，ここでは総需要・総供給ショックがない経済を考える。即ち，<span class="math notranslate nohighlight">\(u_t=v_t=0\)</span>，<span class="math notranslate nohighlight">\(t=0,1,2,\cdots\)</span>とする。
従って，均衡式<a class="reference internal" href="18_ADAS-1.html#equation-eq-18-eq-p">(77)</a>と<a class="reference internal" href="18_ADAS-1.html#equation-eq-18-eq-y">(78)</a>は</p>
<div class="math notranslate nohighlight" id="equation-eq-18-eq-p-v0">
<span class="eqno">(87)<a class="headerlink" href="#equation-eq-18-eq-p-v0" title="Permalink to this equation">#</a></span>\[
p_{t}=hp_{t-1}
\]</div>
<div class="math notranslate nohighlight" id="equation-eq-18-eq-y-u0">
<span class="eqno">(88)<a class="headerlink" href="#equation-eq-18-eq-y-u0" title="Permalink to this equation">#</a></span>\[
y_t=-cp_t 
\]</div>
<p>となる。</p>
<p>上でも説明したが，次の特徴がある。<span class="math notranslate nohighlight">\(p_t\)</span>の値は式<a class="reference internal" href="#equation-eq-18-eq-p-v0">(87)</a>のみで決定され，その<span class="math notranslate nohighlight">\(p_t\)</span>に基づいて<span class="math notranslate nohighlight">\(y_t\)</span>が式<a class="reference internal" href="#equation-eq-18-eq-y-u0">(88)</a>で決まる。この点を説明するために次の表を見てみよう。</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>t=0</p></th>
<th class="head"><p>t=1</p></th>
<th class="head"><p>t=2</p></th>
<th class="head"><p>t=3</p></th>
<th class="head"><p>…</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>デフレーター</p></td>
<td><p><span class="math notranslate nohighlight">\(p_0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(p_1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(p_2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(p_3\)</span></p></td>
<td><p>…</p></td>
</tr>
<tr class="row-odd"><td><p>GDP</p></td>
<td><p><span class="math notranslate nohighlight">\(y_0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(y_1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(y_2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(y_3\)</span></p></td>
<td><p>…</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(t=0\)</span>期：初期値<span class="math notranslate nohighlight">\(p_0\)</span>が与えられると，式<a class="reference internal" href="#equation-eq-18-eq-y-u0">(88)</a>によって初期値<span class="math notranslate nohighlight">\(y_0\)</span>が<strong>決定される</strong>。</p></li>
<li><p><span class="math notranslate nohighlight">\(t=1\)</span>期：<span class="math notranslate nohighlight">\(p_0\)</span>に基づいて式<a class="reference internal" href="#equation-eq-18-eq-p-v0">(87)</a>に従って<span class="math notranslate nohighlight">\(p_1\)</span>が決まる。また<span class="math notranslate nohighlight">\(p_1\)</span>が決まると，式<a class="reference internal" href="#equation-eq-18-eq-y-u0">(88)</a>によって<span class="math notranslate nohighlight">\(y_1\)</span>が定まる。</p></li>
<li><p><span class="math notranslate nohighlight">\(t=2\)</span>期以降：同様のプロセスで<span class="math notranslate nohighlight">\(p_t\)</span>と<span class="math notranslate nohighlight">\(y_t\)</span>が決定される。</p></li>
</ul>
<p>ここから次の２つの特徴が浮かび上がる。</p>
<ol class="arabic simple">
<li><p>初期値には<span class="math notranslate nohighlight">\(p_0\)</span>のみが必要であり，<span class="math notranslate nohighlight">\(y_0\)</span>を別に設定する必要はない。</p></li>
<li><p>安定性は式<a class="reference internal" href="#equation-eq-18-eq-p-v0">(87)</a>のみに依存する。</p></li>
</ol>
<p>また，特徴2から次のことも導き出せる。
式<a class="reference internal" href="#equation-eq-18-eq-p-v0">(87)</a>の<span class="math notranslate nohighlight">\(h\)</span>の値は正であり絶対値は1よりも小さい。従って，差分方程式である式<a class="reference internal" href="#equation-eq-18-eq-p-v0">(87)</a>は安定的であり，ADASモデル自体が安定的だということが確認できる。以下では，シミュレーションを使いこの結果を確認しよう。そのための関数を作成する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">adas_model</span><span class="p">(</span><span class="n">p0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">ahat</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">chat</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;引数</span>
<span class="sd">        p0: pの初期値（デフォルト：0）</span>
<span class="sd">        n: ループの回数（デフォルト：20）</span>
<span class="sd">        a: aの値（デフォルト：ahat）</span>
<span class="sd">        c: cの値（デフォルト：chat）</span>
<span class="sd">    戻り値：</span>
<span class="sd">        yとpのDataFrame&quot;&quot;&quot;</span>

    <span class="c1"># === pの差分方程式の右辺 ==========</span>
    <span class="k">def</span> <span class="nf">price_func</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
        <span class="n">h</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="o">*</span><span class="n">c</span><span class="p">)</span>  <span class="c1"># hの値</span>
        <span class="k">return</span> <span class="n">h</span><span class="o">*</span><span class="n">p</span>
        
    <span class="c1"># === 初期値，forループのアップデート用変数 ==========</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">p0</span>
    <span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">p0</span>    
    
    <span class="c1"># === yとpの値を格納するリスト ==========</span>
    <span class="n">y_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span><span class="p">]</span>   <span class="c1"># 初期値を格納</span>
    <span class="n">p_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">]</span>   <span class="c1"># 初期値を格納</span>

    <span class="c1"># === ショック後のループ計算 ==========</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        
        <span class="n">p</span> <span class="o">=</span> <span class="n">price_func</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">p</span>

        <span class="n">y_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="n">p_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    
    <span class="c1"># === 辞書の作成 ==========</span>
    <span class="n">dic</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;y&#39;</span><span class="p">:</span><span class="n">y_list</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">:</span><span class="n">p_list</span><span class="p">}</span>
    
    <span class="c1"># === 戻り値としてのDataFrame ==========</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dic</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>デフレーターの％乖離の初期値を1（即ち，１％乖離）として結果をプロットしてみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adas_model</span><span class="p">(</span><span class="n">p0</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e6dea6fab82387f5405291550bf43517e18df4b85fd42a80a3143283bb0178ae.png" src="_images/e6dea6fab82387f5405291550bf43517e18df4b85fd42a80a3143283bb0178ae.png" />
</div>
</div>
<p>このプロットの横軸には返された<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>の行インデックスが使われているが，時系列的なプロットと考えれば良いだろう。<span class="math notranslate nohighlight">\(p_t\)</span>は初期値である１から始まっており，<span class="math notranslate nohighlight">\(y_t\)</span>の初期値は式<a class="reference internal" href="#equation-eq-18-eq-y-u0">(88)</a>で計算した値である。このプロットから次のことが確認できる。</p>
<ul class="simple">
<li><p>定常状態である0に両変数は近づいている。即ち，長期均衡が安定的だということである。</p></li>
<li><p>長期均衡に近づく速度は，最初は速いが，そのスピードが時間と共に落ちているのが伺える。</p></li>
</ul>
<p>下のプロットは，横軸に<span class="math notranslate nohighlight">\(y_t\)</span>，縦軸に<span class="math notranslate nohighlight">\(p_t\)</span>を置いた図となる。点はAD曲線とAS曲線の交点を表している。右下がりの直線はAD曲線と等しく，AD曲線に沿ってAS曲線が下方シフトしていることになる。そういう意味では，<a class="reference internal" href="18_ADAS-1.html#fig-18-adas1"><span class="std std-numref">Fig. 10</span></a>で描かれている状況と同じである。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adas_model</span><span class="p">(</span><span class="n">p0</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1d19b48b7727d2838f416a0adf694cd2a2f15d311044489b812c2829564a26cc.png" src="_images/1d19b48b7727d2838f416a0adf694cd2a2f15d311044489b812c2829564a26cc.png" />
</div>
</div>
<p>また，このプロットから長期均衡<span class="math notranslate nohighlight">\((0,0)\)</span>に近づくにつれて，経済の動きが小刻みになっているのも確認できる。<span class="math notranslate nohighlight">\(p_t\)</span>と<span class="math notranslate nohighlight">\(y_t\)</span>の変化が小さくなり，動くスピードが遅くなっている。実は，式<a class="reference internal" href="#equation-eq-18-eq-p-v0">(87)</a>を使うと，<span class="math notranslate nohighlight">\(p_t\)</span>が０に近づく変化率を簡単に計算することができる。式<a class="reference internal" href="#equation-eq-18-eq-p-v0">(87)</a>を次のように書き直そう。</p>
<div class="math notranslate nohighlight">
\[
p_t\text{の変化率}=
\frac{p_t}{p_{t-1}}-1=h-1=-\frac{a}{1/c+a}&lt;0
\]</div>
<p>負の符号は，時間と共に<span class="math notranslate nohighlight">\(p_t\)</span>の絶対値が小さくなることを意味している（<span class="math notranslate nohighlight">\(p_t\)</span>が負の値でも同じ）。また<span class="math notranslate nohighlight">\(p_t\)</span>の変化率の絶対値は，<span class="math notranslate nohighlight">\(a\)</span>の増加関数であり，<span class="math notranslate nohighlight">\(1/c\)</span>の現象関数となっている。この結果の含意を理解するために，<span class="math notranslate nohighlight">\(a\)</span>はAS曲線の傾きであり，<span class="math notranslate nohighlight">\(1/c\)</span>はAD曲線の傾きであることを思い出そう。このことから次のことが言える。</p>
<ul class="simple">
<li><p>AS曲線の傾きが急になると，長期均衡への収束速度が速くなる。</p></li>
<li><p>AD曲線の傾きが急になると，長期均衡への収束速度が遅くなる。</p></li>
</ul>
<p>同様に，式<a class="reference internal" href="#equation-eq-18-eq-p-v0">(87)</a>と<a class="reference internal" href="#equation-eq-18-eq-y-u0">(88)</a>を使うと次の結果を導出できる。</p>
<div class="math notranslate nohighlight">
\[
y_t\text{の変化率}=
\frac{y_t}{y_{t-1}}-1=
\frac{-cp_t}{-cp_{t-1}}-1=
\frac{p_t}{p_{t-1}}-1=
p_t\text{の変化率}
\]</div>
<p><span class="math notranslate nohighlight">\(p_t\)</span>と<span class="math notranslate nohighlight">\(y_t\)</span>の変化率は同じである。</p>
<p>下のプロットでは，<span class="math notranslate nohighlight">\(p_t\)</span>の初期値が負の場合を図示している。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adas_model</span><span class="p">(</span><span class="n">p0</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5d113c2ecf84efb89228ccbd8da8323c0f481dab7fdb4d5efade53b6cc09adb5.png" src="_images/5d113c2ecf84efb89228ccbd8da8323c0f481dab7fdb4d5efade53b6cc09adb5.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adas_model</span><span class="p">(</span><span class="n">p0</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7dd6fa27da6ec257c9461249c337617e92ce3e892e728bf0fe7c3a9ca1341d38.png" src="_images/7dd6fa27da6ec257c9461249c337617e92ce3e892e728bf0fe7c3a9ca1341d38.png" />
</div>
</div>
</section>
<section id="id3">
<h2>インパルス反応関数<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h2>
<p>インパルス反応関数とは，ある特定のショック（<span class="math notranslate nohighlight">\(u_t\)</span>もしくは<span class="math notranslate nohighlight">\(v_t\)</span>）が発生した場合，<code class="docutils literal notranslate"><span class="pre">y_t</span></code>と<code class="docutils literal notranslate"><span class="pre">p_t</span></code>がどのように変化するかを示す時系列のグラフをである。インパルス反応関数により，ショックの波及効果を可視化できる。また，後で考察する確率的シミュレーションの結果を理解する上でも有用な情報となる。</p>
<section id="id4">
<h3>コード<a class="headerlink" href="#id4" title="Permalink to this headline">#</a></h3>
<p>均衡式<a class="reference internal" href="18_ADAS-1.html#equation-eq-18-as-small">(71)</a>と式<a class="reference internal" href="18_ADAS-1.html#equation-eq-18-ad-small">(73)</a>を再掲する。</p>
<div class="math notranslate nohighlight">
\[
p_{t}=hp_{t-1}+h\left(a u_{t}+v_{t}\right)
\]</div>
<div class="math notranslate nohighlight">
\[
y_t=-cp_t + u_t
\]</div>
<p>次のコードでは，ショック項である<span class="math notranslate nohighlight">\(u_t\)</span>と<span class="math notranslate nohighlight">\(v_t\)</span>は１期間だけ変化すると仮定する。
従って，<code class="docutils literal notranslate"><span class="pre">u_std</span></code>と<code class="docutils literal notranslate"><span class="pre">v_std</span></code>は無関係となるため，コードには使っていない。
一方，<code class="docutils literal notranslate"><span class="pre">a</span></code>，<code class="docutils literal notranslate"><span class="pre">c</span></code>は上で決めた値を使うこととする。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">one_period_impulse</span><span class="p">(</span><span class="n">u</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_after</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">ahat</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">chat</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;引数</span>
<span class="sd">        u: AD曲線へのショックの大きさ（デフォルト：0）</span>
<span class="sd">        v: AS曲線へのショックの大きさ（デフォルト：0）</span>
<span class="sd">        n_after: ショック発生後0に戻った後の計算回数（デフォルト：20）</span>
<span class="sd">        a: aの値（デフォルト：ahat）</span>
<span class="sd">        c: cの値（デフォルト：chat）</span>
<span class="sd">    戻り値：</span>
<span class="sd">        y, p, u, vのDataFrame</span>

<span class="sd">    * 最初の３期間はショックゼロ&quot;&quot;&quot;</span>

    <span class="c1"># === pの差分方程式の右辺 ==========</span>
    <span class="k">def</span> <span class="nf">price_func</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="n">h</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="o">*</span><span class="n">c</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">h</span><span class="o">*</span><span class="n">p</span> <span class="o">+</span> <span class="n">h</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">u</span> <span class="o">+</span> <span class="n">v</span><span class="p">)</span>
    
    <span class="c1"># === 初期値，forループのアップデート用変数 ==========</span>
    <span class="n">p</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># 最初は定常状態に設定</span>
                <span class="c1"># yの初期値は必要ない</span>
    
    <span class="c1"># === 結果を格納するリストの作成 ==========</span>
    <span class="c1"># 最初の３つの要素は定常状態に設定</span>
    <span class="n">y_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span>
    <span class="n">p_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span>
    <span class="n">u_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span>
    <span class="n">v_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span>

    <span class="c1"># === ショック発生時 ==========</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">price_func</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>   <span class="c1"># 引数のu,vが使われる</span>
    <span class="n">y</span> <span class="o">=</span> <span class="o">-</span> <span class="n">c</span><span class="o">*</span><span class="n">p</span> <span class="o">+</span> <span class="n">u</span>             <span class="c1"># 引数のuが使われる</span>
        
    <span class="n">y_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">p_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="n">u_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>          <span class="c1"># 引数のuが使われる</span>
    <span class="n">v_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>          <span class="c1"># 引数のvが使われる</span>
        
    <span class="c1"># === ショック後 ==========</span>
    <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>     <span class="c1"># ショックを0に戻す</span>

    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_after</span><span class="p">):</span>
        
        <span class="n">p</span> <span class="o">=</span> <span class="n">price_func</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="o">-</span> <span class="n">c</span><span class="o">*</span><span class="n">p</span> <span class="o">+</span> <span class="n">u</span>

        <span class="n">y_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="n">p_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">u_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
        <span class="n">v_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    
    <span class="c1"># === 変数の辞書 ==========</span>
    <span class="n">dic</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;y&#39;</span><span class="p">:</span><span class="n">y_list</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">:</span><span class="n">p_list</span><span class="p">,</span> <span class="s1">&#39;u&#39;</span><span class="p">:</span><span class="n">u_list</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">:</span><span class="n">v_list</span><span class="p">}</span>
    
    <span class="c1"># === DataFrameを返す ==========</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dic</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id5">
<h3>プロット<a class="headerlink" href="#id5" title="Permalink to this headline">#</a></h3>
<section id="id6">
<h4>総供給ショック<a class="headerlink" href="#id6" title="Permalink to this headline">#</a></h4>
<p>0から数えて3期目に<span class="math notranslate nohighlight">\(p_t\)</span>の１％乖離を引き起こす供給ショック（<span class="math notranslate nohighlight">\(v_t=1\)</span>）を考えよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">one_period_impulse</span><span class="p">(</span><span class="n">v</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9fa70958f1190b4277171394bd3d9ac4a99c7ce5bca66bbf04b54a704f2a77d1.png" src="_images/9fa70958f1190b4277171394bd3d9ac4a99c7ce5bca66bbf04b54a704f2a77d1.png" />
</div>
</div>
<p><a class="reference internal" href="#fig-18-adas-as-shock"><span class="std std-numref">Fig. 11</span></a>を使って説明しよう。</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(t=2\)</span>期以前は定常状態である0に経済は位置する。</p></li>
<li><p><span class="math notranslate nohighlight">\(t=3\)</span>期にAS曲線へのショックが発生し，AS曲線が上方シフトする（①）。経済は点Aにジャンプする。</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(p_t\)</span>は上昇し<span class="math notranslate nohighlight">\(y_t\)</span>は減少する。</p></li>
</ul>
</li>
<li><p><span class="math notranslate nohighlight">\(t=4\)</span>期では，ショックはゼロになる。しかしAS曲線は元の位置にすぐには戻らない。適応的期待により<span class="math notranslate nohighlight">\(p_3\)</span>が高かったため<span class="math notranslate nohighlight">\(p_4\)</span>も高い傾向にあるためである。従って，<span class="math notranslate nohighlight">\(p_t\)</span>は少ししか減少しない。その結果<span class="math notranslate nohighlight">\(y_t\)</span>も少ししか縮小しない。</p></li>
<li><p><span class="math notranslate nohighlight">\(t=5\)</span>期以降，AS曲線が徐々に下方シフトし，経済はAD曲線に沿って0に向かって動いていく（②）。</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(p_t\)</span>は減少し<span class="math notranslate nohighlight">\(y_t\)</span>は増加する。</p></li>
</ul>
</li>
</ul>
<figure class="align-default" id="fig-18-adas-as-shock">
<a class="reference internal image-reference" href="_images/asas_as_shock.jpeg"><img alt="_images/asas_as_shock.jpeg" src="_images/asas_as_shock.jpeg" style="width: 414.04999999999995px; height: 350.0px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 11 </span><span class="caption-text">総供給ショックによるインパルス反応</span><a class="headerlink" href="#fig-18-adas-as-shock" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="id7">
<h4>総需要ショック<a class="headerlink" href="#id7" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">one_period_impulse</span><span class="p">(</span><span class="n">u</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/97359940c8cdf064aff5a94bd6e0df1135552027e89c98ea77642701c81b43e1.png" src="_images/97359940c8cdf064aff5a94bd6e0df1135552027e89c98ea77642701c81b43e1.png" />
</div>
</div>
<p><a class="reference internal" href="#fig-18-adas-ad-shock"><span class="std std-numref">Fig. 12</span></a>を使って説明しよう。</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(t=2\)</span>期以前は定常状態である0に経済は位置する。</p></li>
<li><p><span class="math notranslate nohighlight">\(t=3\)</span>期にAD曲線へのショックが発生し，AD曲線が右シフトする（①）。経済は点Aにジャンプする。</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(p_t\)</span>と<span class="math notranslate nohighlight">\(y_t\)</span>はともに上昇する。</p></li>
</ul>
</li>
<li><p><span class="math notranslate nohighlight">\(t=4\)</span>期ではショックはゼロになり，AD曲線は元の位置に戻る（②）。一方，<span class="math notranslate nohighlight">\(p_3\)</span>が高かったため，その影響によりAS曲線は上方シフト（③），経済は点Bにジャンプする。<span class="math notranslate nohighlight">\(p_t\)</span>は減少するが高止まりする一方，<span class="math notranslate nohighlight">\(y_t\)</span>は0を下回る。</p></li>
<li><p><span class="math notranslate nohighlight">\(t=5\)</span>期以降，AS曲線が徐々に下方シフトし，経済はAD曲線に沿って0に向かって動いていく（④）。</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(p_t\)</span>は減少し<span class="math notranslate nohighlight">\(y_t\)</span>は増加する。</p></li>
</ul>
</li>
</ul>
<figure class="align-default" id="fig-18-adas-ad-shock">
<a class="reference internal image-reference" href="_images/asas_ad_shock.jpeg"><img alt="_images/asas_ad_shock.jpeg" src="_images/asas_ad_shock.jpeg" style="width: 406.34999999999997px; height: 350.0px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 12 </span><span class="caption-text">総需要ショックによるインパルス反応</span><a class="headerlink" href="#fig-18-adas-ad-shock" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="id8">
<h4>総供給・総需要ショックの同時発生<a class="headerlink" href="#id8" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">one_period_impulse</span><span class="p">(</span><span class="n">u</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b21a232ca524bfdaabfab579ca7598d1334597d9861e6d225506f1f5b2c9e52d.png" src="_images/b21a232ca524bfdaabfab579ca7598d1334597d9861e6d225506f1f5b2c9e52d.png" />
</div>
</div>
<p><a class="reference internal" href="#fig-18-adas-adas-shock"><span class="std std-numref">Fig. 13</span></a>を使って説明しよう。</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(t=2\)</span>期以前は定常状態である0に経済は位置する。</p></li>
<li><p><span class="math notranslate nohighlight">\(t=3\)</span>期にAD曲線とAS曲線へのショックが発生し，AD曲線は右シフトし，AS曲線は上方シフトする（①）。経済は点Aにジャンプする。</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(p_t\)</span>と<span class="math notranslate nohighlight">\(y_t\)</span>はともに上昇する。</p></li>
</ul>
</li>
<li><p><span class="math notranslate nohighlight">\(t=4\)</span>期ではショックはゼロになり，AD曲線は元の位置に戻る（②）。一方，<span class="math notranslate nohighlight">\(p_3\)</span>が高かったため，適応的期待によりAS曲線は大きくは下落せずオレンジ色の線に下方シフトし，経済は点Bに移る。</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(p_t\)</span>は減少するが高止まりする一方，<span class="math notranslate nohighlight">\(y_t\)</span>は0を下回る。</p></li>
</ul>
</li>
<li><p><span class="math notranslate nohighlight">\(t=5\)</span>期以降，AS曲線が徐々に下方シフトし，経済はAD曲線に沿って0に向かって動いていく（③）。</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(p_t\)</span>は減少し<span class="math notranslate nohighlight">\(y_t\)</span>は増加する。</p></li>
</ul>
</li>
</ul>
<figure class="align-default" id="fig-18-adas-adas-shock">
<a class="reference internal image-reference" href="_images/asas_adas_shock.jpeg"><img alt="_images/asas_adas_shock.jpeg" src="_images/asas_adas_shock.jpeg" style="width: 416.5px; height: 349.65px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 13 </span><span class="caption-text">総需要ショックと総供給ショックの同時発生によるインパルス反応</span><a class="headerlink" href="#fig-18-adas-adas-shock" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
</section>
<section id="id9">
<h2>確率的シミュレーション<a class="headerlink" href="#id9" title="Permalink to this headline">#</a></h2>
<p>インパルス反応関数の分析では，ショックが１期間のみ発生した場合を考え<span class="math notranslate nohighlight">\(p_t\)</span>と<span class="math notranslate nohighlight">\(y_t\)</span>の動きを考察した。
ADASモデルの特徴を理解する上では非常に有用な分析方法である。
一方で，現実経済では大小の総需要・総供給ショックが毎期毎期連続的に発生していると考えることができるとともに，その結果としてデータに景気循環という形で現れていると解釈できる。
この節では，そのような状況を再現する確率的シミュレーションをおこなうことが一つの目的である。
もう一つの目的は，確率的シミュレーションによって生成された<span class="math notranslate nohighlight">\(p_t\)</span>と<span class="math notranslate nohighlight">\(y_t\)</span>のデータが実際の景気循環のデータをどの程度再現できるかを考察することである。データの再現性の程度によって，理論モデルとしてのADASモデルの「精度」を考えてみようということである。</p>
<p>ここでは総需要・総供給ショックに関して次の仮定を置く。毎期<span class="math notranslate nohighlight">\(u_t\)</span>と<span class="math notranslate nohighlight">\(v_t\)</span>は正規分布に従って発生する。</p>
<div class="math notranslate nohighlight">
\[
u_t\sim N(0,\sigma_u^2)
\qquad\quad
v_t\sim N(0,\sigma_v^2)
\]</div>
<p>この仮定は次のことを意味する。</p>
<ul class="simple">
<li><p>正規分布により，大小の様々なショックを捉えることができる。また，小さなショックと比べて大きなショックは発生し難い。</p></li>
<li><p>ショックの幅は標準偏差である<span class="math notranslate nohighlight">\(\sigma_u\)</span>と<span class="math notranslate nohighlight">\(\sigma_v\)</span>で捉えることができる。</p></li>
<li><p>平均を0とすることにより，<span class="math notranslate nohighlight">\(p_t\)</span>と<span class="math notranslate nohighlight">\(y_t\)</span>の長期的な値も0に設定することができる。</p></li>
</ul>
<section id="id10">
<h3>コード<a class="headerlink" href="#id10" title="Permalink to this headline">#</a></h3>
<p><span class="math notranslate nohighlight">\(a\)</span>，<span class="math notranslate nohighlight">\(c\)</span>，<span class="math notranslate nohighlight">\(\sigma_u\)</span>，<span class="math notranslate nohighlight">\(\sigma_v\)</span>には，カリブレーションで得た値を使うこととする。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">stochastic_sim</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">ahat</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">chat</span><span class="p">,</span> <span class="n">ustd</span><span class="o">=</span><span class="n">u_std</span><span class="p">,</span> <span class="n">vstd</span><span class="o">=</span><span class="n">v_std</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    引数：</span>
<span class="sd">        n: シミュレーションの回数（デフォルト：100）</span>
<span class="sd">        a: aの値（デフォルト：ahat）</span>
<span class="sd">        c: cの値（デフォルト：chat）</span>
<span class="sd">        ustd: 需要ショックの標準偏差（デフォルト：u_std）</span>
<span class="sd">        vstd: 供給ショックの標準偏差（デフォルト：v_std）</span>
<span class="sd">    戻り値：</span>
<span class="sd">        y, p, u, vのDataFrame&quot;&quot;&quot;</span>
    
    <span class="c1"># === pの差分方程式の右辺 ==========</span>
    <span class="k">def</span> <span class="nf">price_func</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="n">h</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="o">*</span><span class="n">c</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">h</span><span class="o">*</span><span class="n">p</span> <span class="o">+</span> <span class="n">h</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">u</span> <span class="o">+</span> <span class="n">v</span><span class="p">)</span>
    
    <span class="c1"># === 初期値，forループのアップデート用変数 ==========</span>
    <span class="n">p</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c1"># 最初は定常状態に設定</span>
            <span class="c1"># yの初期値は必要ない</span>

    <span class="c1"># === 結果を格納するリストの作成 ==========</span>
    <span class="n">y_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">p_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">u_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">v_list</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="c1"># === ランダム変数の「種」==========</span>
    <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>

    <span class="c1"># === ループ計算 ==========</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="c1"># ADのショック項</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ustd</span><span class="p">)</span>

        <span class="c1"># ASのショック項</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">vstd</span><span class="p">)</span>
        
        <span class="n">p</span> <span class="o">=</span> <span class="n">price_func</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">p</span> <span class="o">+</span> <span class="n">u</span>
            
        <span class="n">y_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="n">p_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">u_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
        <span class="n">v_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            
    <span class="c1"># === 変数の辞書 ==========</span>
    <span class="n">dic</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;y&#39;</span><span class="p">:</span><span class="n">y_list</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">:</span><span class="n">p_list</span><span class="p">,</span> <span class="s1">&#39;u&#39;</span><span class="p">:</span><span class="n">u_list</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">:</span><span class="n">v_list</span><span class="p">}</span>

    <span class="c1"># === DataFrameを返す ==========</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dic</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>統計学では変数<span class="math notranslate nohighlight">\(x\)</span>が正規分布に従う場合，<span class="math notranslate nohighlight">\(x\sim N(\mu,\sigma^2)\)</span>と表す。<span class="math notranslate nohighlight">\(\mu\)</span>は平均であり，<span class="math notranslate nohighlight">\(\sigma^2\)</span>は分散を指す。一方で，上のコードの中の正規分布のランダム変数を生成するコードでは，例えば，<code class="docutils literal notranslate"><span class="pre">v=rng.normal(0,</span> <span class="pre">vstd)</span></code>となっており，<code class="docutils literal notranslate"><span class="pre">0</span></code>は平均であり，<code class="docutils literal notranslate"><span class="pre">vstd</span></code>は標準偏差が引数となっている。分散と標準偏差は似て異なる概念なので注意して使い分けするように。</p>
</div>
</section>
<section id="id11">
<h3>プロット<a class="headerlink" href="#id11" title="Permalink to this headline">#</a></h3>
<p>まずループ計算を100回おこなうシミュレーションの結果をプロットしてみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span> <span class="o">=</span> <span class="n">stochastic_sim</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/65898c95beed47d3306593198de002b013438c037cb529aabe171fdaee377bb0.png" src="_images/65898c95beed47d3306593198de002b013438c037cb529aabe171fdaee377bb0.png" />
</div>
</div>
<p><span class="math notranslate nohighlight">\(u_t\)</span>と<span class="math notranslate nohighlight">\(v_t\)</span>が毎期毎期変動しており，その結果として<span class="math notranslate nohighlight">\(p_t\)</span>と<span class="math notranslate nohighlight">\(y_t\)</span>が変動していることになる。
視覚的に<span class="math notranslate nohighlight">\(p_t\)</span>は持続性が強いように見えるが，適応的期待の役割が大きいと考えられる。</p>
<p>このようなシミュレーションをおこなう上で注意する点がある。
ランダム変数を生成させた結果となるため，実行する度に<span class="math notranslate nohighlight">\(p_t\)</span>，<span class="math notranslate nohighlight">\(y_t\)</span>，<span class="math notranslate nohighlight">\(u_t\)</span>，<span class="math notranslate nohighlight">\(v_t\)</span>の値は異なり，プロットは異なるものとなる。従って，シミュレーションの度に平均や標準偏差は異なる値になり，特に計算回数が少ない場合に問題となる。
解決方法は簡単で，単純にループ計算の回数を大きな値にすることである。
（例えば，サイコロを<span class="math notranslate nohighlight">\(n\)</span>回投げて平均を計算するとしよう。<span class="math notranslate nohighlight">\(n=10\)</span>だと理論上の平均である3.5にはならない場合が多い。しかし，<span class="math notranslate nohighlight">\(n=100,000\)</span>の場合の平均は何回試行ても3.5に非常に近い値になる。）</p>
<p>では，10万回のシミュレーションをプロットしてみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span> <span class="o">=</span> <span class="n">stochastic_sim</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">100_000</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e96ed572f504e0430f22416fc63013d0878b09c2d8e2f3847cd386206b806f69.png" src="_images/e96ed572f504e0430f22416fc63013d0878b09c2d8e2f3847cd386206b806f69.png" />
</div>
</div>
<p>このプロットから次の点を確認できる。</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(u_t\)</span>は概ね<span class="math notranslate nohighlight">\((-0.05,0.05)\)</span>の間に収まっているが，<span class="math notranslate nohighlight">\(v_t\)</span>の変動幅はその1/2程である。これは<code class="docutils literal notranslate"><span class="pre">u_std</span></code>と<code class="docutils literal notranslate"><span class="pre">v_std</span></code>の値の反映と言える。</p></li>
<li><p><span class="math notranslate nohighlight">\(y_t\)</span>も概ね<span class="math notranslate nohighlight">\((-0.05,0.05)\)</span>の間に収まっているが，<span class="math notranslate nohighlight">\(p_t\)</span>の変動幅は<span class="math notranslate nohighlight">\(y_t\)</span>よりも小さいように見える。</p></li>
<li><p>４つの変数全てにおいて0を中心に左右対称に分布している。</p></li>
</ul>
<p>このシミュレーション結果を用いて統計的な特徴を計算し，実際のデータの特徴１〜３をどの程度再現できるかを考察しよう。</p>
</section>
<section id="gdp">
<h3>GDPと価格水準の％乖離の標準偏差<a class="headerlink" href="#gdp" title="Permalink to this headline">#</a></h3>
<p><strong>データの値（再掲）</strong></p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">py4macro</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;jpn-q&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;gdp&#39;</span><span class="p">,</span><span class="s1">&#39;deflator&#39;</span><span class="p">]:</span>
    <span class="n">df</span><span class="p">[</span><span class="n">c</span><span class="o">+</span><span class="s1">&#39;_cycle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">c</span><span class="p">])</span> <span class="o">-</span> <span class="n">py4macro</span><span class="o">.</span><span class="n">trend</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">c</span><span class="p">])</span> <span class="p">)</span>
<span class="n">y_std</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;gdp_cycle&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">p_std</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;deflator_cycle&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;GDPのトレンドからの％乖離の標準偏差：</span><span class="si">{</span><span class="n">y_std</span><span class="si">:</span><span class="s1">.5f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;デフレータのトレンドからの％乖離の標準偏差：</span><span class="si">{</span><span class="n">p_std</span><span class="si">:</span><span class="s1">.5f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GDPのトレンドからの％乖離の標準偏差：0.01477
デフレータのトレンドからの％乖離の標準偏差：0.00696
</pre></div>
</div>
</div>
</div>
<p><strong>シミュレーションの結果</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;p&#39;</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s1">の標準偏差:</span><span class="si">{</span><span class="n">sim</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">:</span><span class="s1">.5f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>yの標準偏差:0.01348
pの標準偏差:0.01127
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>GDPの標準偏差はデータと近い値になっている。</p></li>
<li><p>価格水準の標準偏差は大きすぎる結果となている。</p></li>
</ul>
</section>
<section id="id12">
<h3>自己相関係数<a class="headerlink" href="#id12" title="Permalink to this headline">#</a></h3>
<p><strong>データの値（再掲）</strong></p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_autocorr</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;gdp_cycle&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">autocorr</span><span class="p">()</span>
<span class="n">p_autocorr</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;deflator_cycle&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">autocorr</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;GDPのトレンドからの％乖離の自己相関係数：</span><span class="si">{</span><span class="n">y_autocorr</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;デフレータのトレンドからの％乖離の自己相関係数：</span><span class="si">{</span><span class="n">p_autocorr</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GDPのトレンドからの％乖離の自己相関係数：0.681
デフレータのトレンドからの％乖離の自己相関係数：0.829
</pre></div>
</div>
</div>
</div>
<p><strong>シミュレーションの結果</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;p&#39;</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">sim</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">autocorr</span><span class="p">()</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>y:0.079
p:0.800
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">y</span></code>の自己相関係数は低すぎる。持続性が捉えられていない。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code>の自己相関係数はデータと近い値になっており，<code class="docutils literal notranslate"><span class="pre">p</span></code>の持続性が再現されている。</p></li>
</ul>
</section>
<section id="py">
<h3><code class="docutils literal notranslate"><span class="pre">p</span></code>と<code class="docutils literal notranslate"><span class="pre">y</span></code>の％乖離の相関係数：同時期<a class="headerlink" href="#py" title="Permalink to this headline">#</a></h3>
<p><strong>データの値（再掲）</strong></p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">yp_corr</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,[</span><span class="s1">&#39;gdp_cycle&#39;</span><span class="p">,</span> <span class="s1">&#39;deflator_cycle&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;GDPとデフレータの％乖離の相関係数：</span><span class="si">{</span><span class="n">yp_corr</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GDPとデフレータの％乖離の相関係数：-0.234
</pre></div>
</div>
</div>
</div>
<p><strong>シミュレーションの結果</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="p">[[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.1675279235593699
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>符号は合っており，数値も的外れな値ではない。</p></li>
</ul>
</section>
<section id="id13">
<h3>結果のまとめと拡張<a class="headerlink" href="#id13" title="Permalink to this headline">#</a></h3>
<p>データと<code class="docutils literal notranslate"><span class="pre">100,000</span></code>回のシミュレーション結果</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>GDP標準偏差</p></th>
<th class="head"><p>デフレータの標準偏差</p></th>
<th class="head"><p>GDP自己相関係数</p></th>
<th class="head"><p>デフレータの自己相関係数</p></th>
<th class="head"><p>GDPとデフレータの相関係数</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>データ</p></td>
<td><p>0.01477</p></td>
<td><p>0.00696</p></td>
<td><p>0.681</p></td>
<td><p>0.829</p></td>
<td><p>-0.234</p></td>
</tr>
<tr class="row-odd"><td><p>WNショック</p></td>
<td><p>0.01356</p></td>
<td><p>0.01128</p></td>
<td><p>0.075</p></td>
<td><p>0.800</p></td>
<td><p>-0.166</p></td>
</tr>
<tr class="row-even"><td><p>AR(1)ショック</p></td>
<td><p>0.01252</p></td>
<td><p>0.01707</p></td>
<td><p>0.649</p></td>
<td><p>0.931</p></td>
<td><p>-0.292</p></td>
</tr>
</tbody>
</table>
<p>WNショックのWNはホワイト・ノイズを表しており，上のシミュレーションの結果を示している。データの数値と比べてみよう。</p>
<ul class="simple">
<li><p>GDP標準偏差の自己相関係数は概ね近い値（◯）</p></li>
<li><p>デフレータの標準偏差の値は高すぎる（X）</p></li>
<li><p>GDPの自己相関係数は低すぎる（X）</p></li>
<li><p>デフレータの自己相関係数は近い値（◯）</p></li>
<li><p>同期のGDPと価格の相関係数は的外れではない（△）</p></li>
</ul>
<p>捉えることができていないデータの特徴もある一方，全く的外れな結果ではない。
単純なAD-ASモデルにしてはまずまずの結果と言えるのではないだろうか。</p>
<p>次に，モデルの簡単な拡張に触れる。ホワイト・ノイズは前期のショックと今期のショックは何の関係もない独立を意味する。総需要ショックと総供給ショックは，そうなのだろうか。例えば，政府支出を考えてみよう。政府は，増税を実施すると，１四半期後に減税するような行動は取らない。少なくともある期間，政策を一貫して実施することになる。投資はどうだろうか。１四半期毎に企業は投資をコロコロと変えるような行動はしない。消費者の嗜好の変化も需要ショックとして現れるが，ファッションで今季は赤が流行り，１四半期後には青が流行るということではない。すなわち，ショックはホワイト・ノイズではなく，ある程度の<strong>持続性</strong>が存在すると想定できる。総供給ショックも同じように考えることができる。</p>
<p>この特徴を捉えるために，総需要ショックと総供給ショックに次の自己回帰モデルを想定することができる。</p>
<div class="math notranslate nohighlight" id="equation-eq-18-v-ar1">
<span class="eqno">(89)<a class="headerlink" href="#equation-eq-18-v-ar1" title="Permalink to this equation">#</a></span>\[
v_t=\rho_v v_{t-1}+e^v_t,\qquad e^v_t\sim\text{WN}(0,\sigma_{ev}^2)
\]</div>
<div class="math notranslate nohighlight" id="equation-eq-18-u-ar1">
<span class="eqno">(90)<a class="headerlink" href="#equation-eq-18-u-ar1" title="Permalink to this equation">#</a></span>\[
u_t=\rho_u u_{t-1}+e^u_t,\qquad e^u_t\sim\text{WN}(0,\sigma_{eu}^2)
\]</div>
<p>新たなパラメーターとして<span class="math notranslate nohighlight">\(\rho_u\)</span>，<span class="math notranslate nohighlight">\(\rho_v\)</span>，<span class="math notranslate nohighlight">\(\sigma_{eu}^2\)</span>，<span class="math notranslate nohighlight">\(\sigma_{ev}^2\)</span>の４つがあるが，これらもデータを使って次のように推定することが可能である。</p>
<ol class="arabic simple">
<li><p>式<a class="reference internal" href="18_ADAS-1.html#equation-eq-18-vt">(82)</a>の<span class="math notranslate nohighlight">\(\hat{v}\)</span>を使い，式<a class="reference internal" href="#equation-eq-18-v-ar1">(89)</a>を推定式として<span class="math notranslate nohighlight">\(\hat{\rho}_v\)</span>を推定する。またその残差の標準偏差を<span class="math notranslate nohighlight">\(\sigma_{ev}\)</span>とする。</p></li>
<li><p>式<a class="reference internal" href="18_ADAS-1.html#equation-eq-18-ut">(83)</a>の<span class="math notranslate nohighlight">\(\hat{u}\)</span>を使い，式<a class="reference internal" href="#equation-eq-18-u-ar1">(90)</a>を推定式として<span class="math notranslate nohighlight">\(\hat{\rho}_u\)</span>を推定する。またその残差の標準偏差を<span class="math notranslate nohighlight">\(\sigma_{eu}\)</span>とする。</p></li>
</ol>
<p>このように計算すると次の値となる。</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\hat{\rho}_u=0.6884968624035948\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\hat{\rho}_v=0.31284420357447135\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\hat{\sigma}_{eu}=0.010415370807183315\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\hat{\sigma}_{ev}=0.006036417181315\)</span></p></li>
</ul>
<p>これらの値を使い<code class="docutils literal notranslate"><span class="pre">100,000</span></code>回シミュレーションした結果が上の表の「AR(1)ショック」に示されている。次のように結果をまとめることができる。</p>
<ul class="simple">
<li><p>GDP標準偏差の自己相関係数は少し低い（△）</p></li>
<li><p>デフレータの標準偏差の値は高すぎる（X）</p></li>
<li><p>GDPの自己相関係数は概ね近い値（◯）</p></li>
<li><p>デフレータの自己相関係数は若干高い値（△）</p></li>
<li><p>同期のGDPと価格の相関係数は概ね近い値（◯）</p></li>
</ul>
<p>ホワイト・ノイズの場合と比べると，AR(1)のケースが若干ではあるが再現性が向上したようにも見える。例えば，GDPの自己相関係数は格段にデータの値に近づいた。一方で，デフレーターの標準偏差の再現性はホワイト・ノイズの場合よりも悪くなっている。AR(1)のショックを導入しても再現性の著しい向上とは言えないだろう。</p>
</section>
<section id="id14">
<h3>ADASモデルの評価<a class="headerlink" href="#id14" title="Permalink to this headline">#</a></h3>
<p>ADASモデルは，経済を理解する上では非常に有用だが，データの一部の特徴の説明力に欠ける。
どう評価すれば良いだろうか。</p>
<p>経済学研究で用いる推論方法を考えてみよう。
帰納的推論（inductive inference）とは，真のモデルが存在するという前提の下でデータを使い推定するモデルの蓋然性を検討する手法である。
典型的な例として，計量経済分析が当てはまる。
推定されたモデルは，帰納的推論の<strong>アウトプット</strong>ということになる。</p>
<figure class="align-default" id="fig-18-inductive">
<a class="reference internal image-reference" href="_images/inductive.png"><img alt="_images/inductive.png" src="_images/inductive.png" style="width: 567.6999999999999px; height: 396.2px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 14 </span><span class="caption-text">帰納的推論</span><a class="headerlink" href="#fig-18-inductive" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>一方，演繹的推論（deductive inference）では，モデルは<strong>インプット</strong>になる。
モデルを「装置」として使い，理論の含意に関して推論しようということである。
例えば，ADASモデルで比較静学をおこない，外生変数の定性的な効果を検討する場合が当てはまる。
政府支出が増加すると実質利子率は上昇するとい結果は，ADASモデルを使った演繹的推論の結果である。
しかし，経済モデルは複雑な経済を抽象化した考え方に過ぎず，ADASモデルを含めてどのような経済モデルであっても複雑な経済の全ての側面を捉えることはできない「間違った」モデルである。
また，この章の目的はADASモデルが真のモデルかどうかを判断しようということではない。
従って，データの特徴の一部を説明できないのは，単にADASモデルの限界を表していると解釈できる。</p>
<figure class="align-default" id="fig-18-deductive">
<a class="reference internal image-reference" href="_images/deductive.png"><img alt="_images/deductive.png" src="_images/deductive.png" style="width: 563.5px; height: 351.4px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 15 </span><span class="caption-text">演繹的推論</span><a class="headerlink" href="#fig-18-deductive" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>では，ADASモデルのどこに有用性があるのだろうか。
カリブレーションを説明する際，手作りの体重計の例を使ったがもう一度考えみよう。
カリブレーション後，60kg以上の体重は誤差が大きく使いものにならないが，60kg未満であれば誤差は許容範囲だとしてみよう。
この場合，「普通の小学生やそれより幼い子どもの体重を測る」ことが目的であれば，手作り体重計の成功と考えることができる。
要するに，完璧な「装置」でなくとも，目的に沿ったものであれば十分だということだ。
「完璧でなくても良い」という考え方は，地図の有用性を考えれば直ぐに理解できるのではないだろうか。
地図は，実際の距離を縮尺にしており，多くの詳細が省かれている。
三宮のレストランを探す場合，世界地図は使いものにならない。
しかし，石油を運ぶタンカーの運航や宇宙衛星を落下させる際には重要な役割を果たす（政治的な目的にも有用だという主張もある）。
経済モデルは地図のようなものであり，AD-ASモデルは不完全だが，ある目的のためであれば有用になり得るということだ。</p>
<p>このような演繹的推論に基づき，再現性の精度には多少欠けることも念頭に，次のセクションではADASモデルを「装置」として使い<strong>定量的</strong>な問を検討する。</p>
</section>
</section>
<section id="id15">
<h2>定量的な問い<a class="headerlink" href="#id15" title="Permalink to this headline">#</a></h2>
<blockquote>
<div><p>GDPと価格水準の長期トレンドからの乖離（％）の変動は，何パーセントが需要ショックにより引き起こされ，何パーセントが供給ショックに起因するのか？</p>
</div></blockquote>
<p>この問を検討するには，定性的な比較静学では不可能であり，定量的なアプローチが要求される。では，この問にどのように答えれば良いかどうか。ここでは，ベクトル自己回帰モデルで使われる次のような手法を採用する。</p>
<section id="id16">
<h3>予測誤差<a class="headerlink" href="#id16" title="Permalink to this headline">#</a></h3>
<p>カリブレーションをおこなった際の推定式<a class="reference internal" href="18_ADAS-1.html#equation-eq-18-regression-h">(79)</a>と<a class="reference internal" href="18_ADAS-1.html#equation-eq-18-regression-d">(80)</a>を再掲する。</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
y_{t} &amp;= -chp_{t-1} + e_{yt}\\
p_{t}&amp;=hp_{t-1} + e_{pt}
\end{align*}
\end{split}\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(e_{yt}\equiv h(u_{t}-cv_{t})\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(e_{pt}\equiv h\left(a u_{t}+v_{t}\right)\)</span></p></li>
</ul>
<p>今期が<span class="math notranslate nohighlight">\(t-1\)</span>期とし，<span class="math notranslate nohighlight">\(x_{t-1}\)</span>は既に実現したと考えてみよう。一方，<span class="math notranslate nohighlight">\(t\)</span>期の変数は実現前の将来の変数としよう。ここで，実現値<span class="math notranslate nohighlight">\(x_{t-1}\)</span>を所与として<code class="docutils literal notranslate"><span class="pre">t</span></code>期の変数を予測するとしよう。予測値は次式で表現できる。</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\text{E}_{t-1}(y_{t}) &amp;= -chp_{t-1}\\
\text{E}_{t-1}(p_{t})&amp;=hp_{t-1}
\end{align*}
\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(\text{E}_{t-1}\)</span>は<span class="math notranslate nohighlight">\(t-1\)</span>時点での情報に基づき期待値を計算していることを表す。また，<span class="math notranslate nohighlight">\(u_t\)</span>と<span class="math notranslate nohighlight">\(v_t\)</span>の期待値（平均）はゼロと仮定しているため，<span class="math notranslate nohighlight">\(\text{E}_{t-1}(u_t)=\text{E}_{t-1}(v_t)=0\)</span>となり，<span class="math notranslate nohighlight">\(\text{E}_{t-1}(e_{yt})=\text{E}_{t-1}(e_{pt})=0\)</span>も成立することになり，上の予測値の結果となる。</p>
<p>更に，上の２つの式を使うと，予測誤差を次のように表すことができる。</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
y_{t} - \text{E}_{t-1}(y_{t})&amp;= e_{yt}\\
p_{t}- \text{E}_{t-1}(p_{t})&amp;= e_{pt}
\end{align*}
\end{split}\]</div>
<p>この結果は，次のことを意味する。</p>
<ul class="simple">
<li><p>予測誤差は<span class="math notranslate nohighlight">\(e_{yt}\)</span>と<span class="math notranslate nohighlight">\(e_{pt}\)</span>に集約される。</p></li>
<li><p>予測誤差は総需要ショックと総供給ショックによって発生した<span class="math notranslate nohighlight">\(y_t\)</span>と<span class="math notranslate nohighlight">\(p_t\)</span>の変動を捉えており，両方の影響が混在する。</p></li>
</ul>
<p>次に，予測誤差に基づいて総需要・総供給ショックの影響を抽出する計算方法ついて下で説明するが，その前に，その考え方について簡単に説明する。確率的シミュレーションが示すように，ショックが連続して発生することにより，<span class="math notranslate nohighlight">\(y_t\)</span>と<span class="math notranslate nohighlight">\(p_t\)</span>はトレンド（<span class="math notranslate nohighlight">\(y_*=p_*=0\)</span>）には戻らず，％乖離は正や負の値を取ることになる。そのような変動の大きさは分散で捉えることができる。同様に，予測誤差の変動もその分散で捉えることができ，更には，総需要ショックと総供給ショックの分散に依存することになる。即ち，次のように分散分解することができる。</p>
<div class="math notranslate nohighlight">
\[
\text{Var}(e_{xt})=\text{Var}(e_{xt}|u_t)+\text{Var}(e_{xt}|v_t)
\qquad
x_t=y_t,p_t
\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\text{Var}(e_{xt})\)</span>：<span class="math notranslate nohighlight">\(x_t\)</span>の分散</p></li>
<li><p><span class="math notranslate nohighlight">\(\text{Var}(e_{xt}|u_t)\)</span>：総需要ショック（<span class="math notranslate nohighlight">\(u_t\)</span>）に起因する<span class="math notranslate nohighlight">\(x_t\)</span>の分散</p></li>
<li><p><span class="math notranslate nohighlight">\(\text{Var}(e_{xt}|v_t)\)</span>：総供給ショック（<span class="math notranslate nohighlight">\(v_t\)</span>）に起因する<span class="math notranslate nohighlight">\(x_t\)</span>の分散</p></li>
</ul>
<p>この関係を使うと，何％が需要ショックに起因し，残りの何％が供給ショックにより発生しているかは次式で与えられることになる。</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\left(
\begin{split}
&amp;\text{総需要ショックによる}\\
&amp;x_t\text{の変動の割合}
\end{split}
\right)
&amp;=
\frac{\text{Var}(e_{xt}|u_t)}{\text{Var}(e_{xt})},
\qquad
x_t=y_t,p_t
\\
\left(
\begin{split}
&amp;\text{総供給ショックによる}\\
&amp;x_t\text{の変動の割合}
\end{split}
\right)
&amp;=
\frac{\text{Var}(e_{xt}|v_t)}{\text{Var}(e_{xt})},
\qquad
x_t=y_t,p_t
\end{align*}
\end{split}\]</div>
<p>以下では，それぞれの項を計算し量的な問いを考察する。</p>
</section>
<section id="id17">
<h3>GDPの％乖離<a class="headerlink" href="#id17" title="Permalink to this headline">#</a></h3>
<section id="id18">
<h4>計算方法<a class="headerlink" href="#id18" title="Permalink to this headline">#</a></h4>
<p>予測誤差<span class="math notranslate nohighlight">\(e_{yt}\)</span>は次式で与えられる。</p>
<div class="math notranslate nohighlight">
\[
e_{yt}=h(u_t-cv_t)
\]</div>
<p>両辺の分散を計算すると次のようになる。</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\text{Var}(e_{yt})
&amp;=\text{Var}(hu_{t}-chv_{t})\\
&amp;=\text{Var}(hu_{t})+
    \text{Var}(-chv_{t})+
    2\text{Cov}(hu_{t},-chv_{t})\\
&amp;=h^2\text{Var}(u_{t})+
    (ch)^2\text{Var}(v_{t})-
    2ch^2\text{Cov}(u_{t},v_{t})\\
&amp;=h^2\sigma_u^2+
    (ch)^2\sigma_v^2-
    2ch^2\sigma_{uv}\\
&amp;\quad\Downarrow\\
&amp;=\text{Var}(e_{pt}|u_t)+\text{Var}(e_{pt}|v_t)
\end{align*}
\end{split}\]</div>
<p>ここで</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\sigma_u^2=\text{Var}(u_{t})\)</span> は<span class="math notranslate nohighlight">\(u_t\)</span>の分散</p></li>
<li><p><span class="math notranslate nohighlight">\(\sigma_v^2=\text{Var}(v_{t})\)</span> は<span class="math notranslate nohighlight">\(v_t\)</span>の分散</p></li>
<li><p><span class="math notranslate nohighlight">\(\sigma_{uv}=\text{Cov}(u_t,v_t)\)</span> は<span class="math notranslate nohighlight">\(u_t\)</span>と<span class="math notranslate nohighlight">\(v_t\)</span>の共分散</p></li>
</ul>
<p>であり，</p>
<div class="math notranslate nohighlight" id="equation-eq-18-var-eyu">
<span class="eqno">(91)<a class="headerlink" href="#equation-eq-18-var-eyu" title="Permalink to this equation">#</a></span>\[
\text{Var}(e_{yt}|u_t)
=h^2\left(\sigma_u^2-c\sigma_{uv}\right)
\]</div>
<p>は需要ショックによる<span class="math notranslate nohighlight">\(e_{yt}\)</span>の分散であり，</p>
<div class="math notranslate nohighlight" id="equation-eq-18-var-eyv">
<span class="eqno">(92)<a class="headerlink" href="#equation-eq-18-var-eyv" title="Permalink to this equation">#</a></span>\[
\text{Var}(e_{yt}|v_t)
=h^2\left(c^2\sigma_v^2-c\sigma_{uv}\right)
\]</div>
<p>は供給ショックによる<span class="math notranslate nohighlight">\(e_{yt}\)</span>の分散である。上の式の４行目にある<span class="math notranslate nohighlight">\(-2ch^2\sigma_{uv}\)</span>は，需要ショックと供給ショックが連動する効果を捉えているため，<span class="math notranslate nohighlight">\(\text{Var}(e_{yt}|u_t)\)</span>と<span class="math notranslate nohighlight">\(\text{Var}(e_{yt}|v_t)\)</span>に等分している。</p>
<p>この結果を使うと，</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\left(
\begin{split}
&amp;\text{需要ショックによる}\\
&amp;y_t\text{の変動の割合}
\end{split}
\right)
&amp;=\frac{\text{Var}(e_{yt}|u_t)}{\text{Var}(e_{yt})}
=\frac{\sigma_u^2-c\sigma_{uv}}
    {\sigma_u^2+
    c^2\sigma_v^2-
    2c\sigma_{uv}}
\tag{*y}
\end{align*}
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\left(
\begin{split}
&amp;\text{供給ショックによる}\\
&amp;y_t\text{の変動の割合}
\end{split}
\right)
&amp;=\frac{\text{Var}(e_{yt}|u_t)}{\text{Var}(e_{yt})}
=\frac{c^2\sigma_v^2-c\sigma_{uv}}
    {\sigma_u^2+
    c^2\sigma_v^2-
    2c\sigma_{uv}}
\tag{**y}
\end{align*}
\end{split}\]</div>
<p>計算結果を見て気付くのは，総需要曲線の傾きである <span class="math notranslate nohighlight">\(c\)</span> が重要な役割を果たしている。一方，総供給曲線の傾きである <span class="math notranslate nohighlight">\(a\)</span> は，変動の大きさ（即ち，分散の大きさ）に影響を及ぼすが（<span class="math notranslate nohighlight">\(h=1/(1+ac)\)</span>を思い出そう），変動の割合は <span class="math notranslate nohighlight">\(a\)</span> から独立であることがわかる。</p>
</section>
<section id="id19">
<h4>結果<a class="headerlink" href="#id19" title="Permalink to this headline">#</a></h4>
<p>それぞれの変数の推定値を使い実際に計算してみよう。</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;deflator_cycle_lag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;deflator_cycle&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">()</span>

<span class="n">res_d</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;gdp_cycle ~ deflator_cycle_lag&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">ey</span> <span class="o">=</span> <span class="n">res_d</span><span class="o">.</span><span class="n">resid</span>

<span class="n">res_h</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;deflator_cycle ~ deflator_cycle_lag&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">ep</span> <span class="o">=</span> <span class="n">res_h</span><span class="o">.</span><span class="n">resid</span>

<span class="n">vt</span> <span class="o">=</span> <span class="n">ep</span> <span class="o">-</span> <span class="n">ahat</span><span class="o">*</span><span class="n">ey</span>
<span class="n">ut</span> <span class="o">=</span> <span class="n">ey</span> <span class="o">+</span> <span class="n">chat</span><span class="o">*</span><span class="n">ep</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 式(*y)の分子</span>
<span class="n">numerator_y</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">var</span><span class="p">()</span> <span class="o">-</span> <span class="n">chat</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">ut</span><span class="p">,</span><span class="n">vt</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># 式(*y)の分母</span>
<span class="n">denominator_y</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">var</span><span class="p">()</span> <span class="o">+</span> <span class="n">chat</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">vt</span><span class="o">.</span><span class="n">var</span><span class="p">()</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">chat</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">ut</span><span class="p">,</span><span class="n">vt</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>

<span class="n">ad_shock_on_y</span> <span class="o">=</span> <span class="n">numerator_y</span> <span class="o">/</span> <span class="n">denominator_y</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;GDPの％乖離の</span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="n">ad_shock_on_y</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">％は総需要ショックに起因する。&#39;</span>  <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GDPの％乖離の79.3％は総需要ショックに起因する。
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;GDPの％乖離の</span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">ad_shock_on_y</span><span class="p">)</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">％は総供給ショックに起因する。&#39;</span>  <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GDPの％乖離の20.7％は総供給ショックに起因する。
</pre></div>
</div>
</div>
</div>
<p>GDPの％乖離に対しては総需要ショックが相対的に大きな影響を及ぼしていることがわかる。</p>
</section>
<section id="id20">
<h4>解釈<a class="headerlink" href="#id20" title="Permalink to this headline">#</a></h4>
<p>まず，式<a class="reference internal" href="#equation-eq-18-var-eyu">(91)</a>の需要ショックによる<span class="math notranslate nohighlight">\(y_t\)</span>の変動の大きさ（割合ではない）を考えてみよう。式を展開すると</p>
<div class="math notranslate nohighlight">
\[
\text{Var}(e_{yt}|u_t)
=h^2\sigma_u^2-ch^2\sigma_{uv}
\]</div>
<p>となる。右辺の第１項は，総供給曲線を所与として需要ショックによる<span class="math notranslate nohighlight">\(y_t\)</span>の変動を捉えている。
第２項 <span class="math notranslate nohighlight">\(-ch^2\sigma_{uv}&gt;0\)</span> は，需要ショックと供給ショックが同時に変動する影響を捉えている。計算すると正の値になることは簡単に確認できる。即ち，正の需要ショック（<span class="math notranslate nohighlight">\(u_t&gt;0\)</span>）は負の供給ショック（<span class="math notranslate nohighlight">\(v_t&lt;0\)</span>）を伴う傾向にあり，<span class="math notranslate nohighlight">\(y_t\)</span>に対する需要ショックの効果は，伴う供給ショックによって増幅されることを意味する。</p>
<p>同様に，式<a class="reference internal" href="#equation-eq-18-var-eyv">(92)</a>の供給ショックによる<span class="math notranslate nohighlight">\(y_t\)</span>の変動を考えてみよう。</p>
<div class="math notranslate nohighlight">
\[
\text{Var}(e_{yt}|v_t)
=(ch)^2\sigma_v^2-ch^2\sigma_{uv}
\]</div>
<p>右辺の第１項は，需要曲線を所与として供給ショックが変動する場合の <span class="math notranslate nohighlight">\(y_t\)</span> の変動を捉えている。
第２項 <span class="math notranslate nohighlight">\(-ch^2\sigma_{uv}&gt;0\)</span> は，正の供給ショック（<span class="math notranslate nohighlight">\(v_t&gt;0\)</span>）は負の需要ショック（<span class="math notranslate nohighlight">\(u_t&lt;0\)</span>）を伴う傾向にあり，<span class="math notranslate nohighlight">\(y_t\)</span>に対する供給ショックの効果は，需要ショックによって増幅されている。</p>
<p>変動の大きさを決定する上で，<span class="math notranslate nohighlight">\(h\)</span> が重要な役割を果たしている。<span class="math notranslate nohighlight">\(h\)</span>はは約<code class="docutils literal notranslate"><span class="pre">0.8</span></code>であり<span class="math notranslate nohighlight">\(p_t\)</span>の高い持続性を意味する。持続性が高い場合，一旦総供給曲線が定常状態の位置から離れると元の位置に戻るには時間が掛かることになる。即ち，定常状態から離れた状態が長くなる。そのような状況下で，更にショックが発生すると，定常状態から更に乖離する結果につながることになる。このメカニズムにより，<span class="math notranslate nohighlight">\(h\)</span>が高くなると，両方のショックの影響は増幅されることになる。その効果が <span class="math notranslate nohighlight">\(h^2\)</span> で捉えられている。</p>
<p>次に，割合を考えてみよう。価格水準の％乖離に対しては総供給ショックが相対的に大きな影響を及ぼしていることがわかるが，式(*y)と(**y)にはあるパラメータは <span class="math notranslate nohighlight">\(c\)</span>のみであり，その役割を考えてみよう。総需要曲線の傾きは <span class="math notranslate nohighlight">\(1/c\)</span>で与えられる。
<a class="reference internal" href="#fig-18-y-uv"><span class="std std-numref">Fig. 16</span></a>では，AD曲線の傾きが急な場合と緩やかな場合の２つのケースを示している。</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(1/c\)</span> が小さいケース：</p>
<ul>
<li><p>総需要曲線の傾きは緩やかになる。</p></li>
<li><p>総供給曲線が動くと<span class="math notranslate nohighlight">\(y_t\)</span>は大きく動くが，<span class="math notranslate nohighlight">\(p_t\)</span>は大きく動かない。</p></li>
</ul>
</li>
<li><p><span class="math notranslate nohighlight">\(1/c\)</span> が大きいケース：</p>
<ul>
<li><p>総需要曲線の傾きは急になる。</p></li>
<li><p>総供給曲線が動くと<span class="math notranslate nohighlight">\(y_t\)</span>の動きは小さくなる一方，<span class="math notranslate nohighlight">\(p_t\)</span>は大きく動くことになる。</p></li>
</ul>
</li>
</ul>
<p><span class="math notranslate nohighlight">\(1/c\)</span> の値は<code class="docutils literal notranslate"><span class="pre">1</span></code>よりも大きく，<span class="math notranslate nohighlight">\(1/c\)</span> が大きいケースが当てはまる。この場合，<span class="math notranslate nohighlight">\(y_t\)</span>に対する総供給ショックのインパクトは小さな値となり，相対的に総需要ショックの寄与度が高くなっていると考えられる。</p>
<figure class="align-default" id="fig-18-y-uv">
<a class="reference internal image-reference" href="_images/adas-y-uv.jpeg"><img alt="_images/adas-y-uv.jpeg" src="_images/adas-y-uv.jpeg" style="width: 433.65px; height: 350.0px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 16 </span><span class="caption-text">GDPの％乖離の変動において総需要ショックの影響が大きい理由</span><a class="headerlink" href="#fig-18-y-uv" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="id21">
<h3>価格水準の％乖離<a class="headerlink" href="#id21" title="Permalink to this headline">#</a></h3>
<section id="id22">
<h4>計算方法<a class="headerlink" href="#id22" title="Permalink to this headline">#</a></h4>
<p><span class="math notranslate nohighlight">\(e_{pt}\)</span>は次式で与えられる。</p>
<div class="math notranslate nohighlight">
\[
e_{pt}=ahu_t+hcv_t
\]</div>
<p>両辺の分散を計算すると次のようになる。</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\text{Var}(e_{pt})
&amp;=\text{Var}(ahu_{t}+hv_{t})\\
&amp;=\text{Var}(ahu_{t})+
    \text{Var}(hv_{t})+
    2\text{Cov}(ahu_{t},hv_{t})\\
&amp;=(ah)^2\text{Var}(u_{t})+
    h^2\text{Var}(v_{t})+
    2ah^2\text{Cov}(u_{t},v_{t})\\
&amp;=(ah)^2\sigma_u^2+
    h^2\sigma_v^2+
    2ah^2\sigma_{uv}\\
&amp;\quad\Downarrow\\
&amp;=\text{Var}(e_{pt}|u_t)+\text{Var}(e_{pt}|v_t)
\end{align*}
\end{split}\]</div>
<p>ここで</p>
<div class="math notranslate nohighlight" id="equation-eq-18-var-epu">
<span class="eqno">(93)<a class="headerlink" href="#equation-eq-18-var-epu" title="Permalink to this equation">#</a></span>\[
\text{Var}(e_{pt}|u_t)
=h^2\left(a^2\sigma_u^2+a\sigma_{uv}\right)
\]</div>
<p>は需要ショックによる<span class="math notranslate nohighlight">\(e_{pt}\)</span>の分散であり，</p>
<div class="math notranslate nohighlight" id="equation-eq-18-var-epv">
<span class="eqno">(94)<a class="headerlink" href="#equation-eq-18-var-epv" title="Permalink to this equation">#</a></span>\[
\text{Var}(e_{pt}|v_t)
=h^2\left(\sigma_v^2+a\sigma_{uv}\right)
\]</div>
<p>は供給ショックによる<span class="math notranslate nohighlight">\(e_{pt}\)</span>の分散である。上の式の４行目にある<span class="math notranslate nohighlight">\(2ah^2\sigma_{uv}\)</span>は，需要ショックと供給ショックが連動する効果を捉えているため，<span class="math notranslate nohighlight">\(\text{Var}(e_{pt}|u_t)\)</span>と<span class="math notranslate nohighlight">\(\text{Var}(e_{pt}|v_t)\)</span>に等分している。</p>
<p>この結果を使うと，</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\left(
\begin{split}
&amp;\text{需要ショックによる}\\
&amp;p_t\text{の変動の割合}
\end{split}
\right)
&amp;=\frac{\text{Var}(e_{pt}|u_t)}{\text{Var}(e_{pt})}
=\frac{a^2\sigma_u^2+a\sigma_{uv}}
    {a^2\sigma_u^2+
    \sigma_v^2+
    2a\sigma_{uv}}
\tag{*p}
\end{align*}
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\left(
\begin{split}
&amp;\text{供給ショックによる}\\
&amp;p_t\text{の変動の割合}
\end{split}
\right)
&amp;=\frac{\text{Var}(e_{pt}|u_t)}{\text{Var}(e_{pt})}
=\frac{\sigma_v^2+a\sigma_{uv}}
    {a^2\sigma_u^2+
    \sigma_v^2+
    2a\sigma_{uv}}
\tag{**p}
\end{align*}
\end{split}\]</div>
<p>計算結果を見て気付くのは，総供給曲線の傾きである <span class="math notranslate nohighlight">\(a\)</span> が重要な役割を果たしている。一方，総需要曲線の傾きである <span class="math notranslate nohighlight">\(c\)</span> は，変動の大きさ（即ち，分散の大きさ）に影響を及ぼすが（<span class="math notranslate nohighlight">\(h=1/(1+ac)\)</span>を思い出そう），変動の割合は<code class="docutils literal notranslate"><span class="pre">c</span></code>から独立であることがわかる。</p>
</section>
<section id="id23">
<h4>結果<a class="headerlink" href="#id23" title="Permalink to this headline">#</a></h4>
<p>それぞれの変数の推定値を使い実際に計算してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 式(*p)の分子</span>
<span class="n">numerator_p</span> <span class="o">=</span> <span class="n">ahat</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">ut</span><span class="o">.</span><span class="n">var</span><span class="p">()</span> <span class="o">+</span> <span class="n">ahat</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">ut</span><span class="p">,</span><span class="n">vt</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># 式(*p)の分母</span>
<span class="n">denominator_p</span> <span class="o">=</span> <span class="n">ahat</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">ut</span><span class="o">.</span><span class="n">var</span><span class="p">()</span> <span class="o">+</span> <span class="n">vt</span><span class="o">.</span><span class="n">var</span><span class="p">()</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">ahat</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">ut</span><span class="p">,</span><span class="n">vt</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>

<span class="n">ad_shock_on_p</span> <span class="o">=</span> <span class="n">numerator_p</span> <span class="o">/</span> <span class="n">denominator_p</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;価格水準の％乖離の</span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="n">ad_shock_on_p</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">％は需要ショックに起因する。&#39;</span>  <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>価格水準の％乖離の14.1％は需要ショックに起因する。
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;価格水準の％乖離の</span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">ad_shock_on_p</span><span class="p">)</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">％は供給ショックに起因する。&#39;</span>  <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>価格水準の％乖離の85.9％は供給ショックに起因する。
</pre></div>
</div>
</div>
</div>
<p>価格水準の％乖離に対しては総供給ショックが相対的に大きな影響を及ぼしていることがわかる。</p>
</section>
<section id="id24">
<h4>解釈<a class="headerlink" href="#id24" title="Permalink to this headline">#</a></h4>
<p>まず，式<a class="reference internal" href="#equation-eq-18-var-epu">(93)</a>の需要ショックによる<span class="math notranslate nohighlight">\(p_t\)</span>の変動（割合ではない）を考えてみよう。
式を展開すると</p>
<div class="math notranslate nohighlight">
\[
\text{Var}(e_{pt}|u_t)
=(ah)^2\sigma_u^2+ah^2\sigma_{uv}
\]</div>
<p>となる。右辺の第１項は，供給曲線を所与として需要ショックによる<span class="math notranslate nohighlight">\(p_t\)</span>の変動を捉えている。
第２項 <span class="math notranslate nohighlight">\(ah^2\sigma_{uv}&lt;0\)</span> は，需要ショックと供給ショックが同時に変動する影響を捉えている。計算すると負の値になることは簡単に確認できる。即ち，正の需要ショック（<span class="math notranslate nohighlight">\(u_t&gt;0\)</span>）は負の供給ショック（<span class="math notranslate nohighlight">\(v_t&lt;0\)</span>）を伴う傾向にあり，<span class="math notranslate nohighlight">\(p_t\)</span>に対する需要ショックの効果は，伴う供給ショックによって減衰されることを意味する。</p>
<p>同様に，式<a class="reference internal" href="#equation-eq-18-var-epv">(94)</a>の供給ショックによる<span class="math notranslate nohighlight">\(p_t\)</span>の変動を考えてみよう。</p>
<div class="math notranslate nohighlight">
\[
\text{Var}(e_{pt}|v_t)
=h^2\sigma_v^2+ah^2\sigma_{uv}
\]</div>
<p>右辺の第１項は，需要曲線を所与として供給ショックが変動する場合の <span class="math notranslate nohighlight">\(p_t\)</span> の変動を捉えている。
第２項 <span class="math notranslate nohighlight">\(ah^2\sigma_{uv}&lt;0\)</span> は，正の供給ショック（<span class="math notranslate nohighlight">\(v_t&gt;0\)</span>）は負の需要ショック（<span class="math notranslate nohighlight">\(u_t&lt;0\)</span>）を伴う傾向にあり，<span class="math notranslate nohighlight">\(p_t\)</span>に対する供給ショックの効果は，需要ショックによって減衰されている。</p>
<p>変動の大きさを決定する上で，<span class="math notranslate nohighlight">\(h\)</span> が重要な役割を果たしているが，上で説明した通りである。</p>
<p>次に，割合を考えてみよう。価格水準の％乖離に対しては総供給ショックが相対的に大きな影響を及ぼしていることがわかるが，式(*p)と(**p)にはあるパラメータは<code class="docutils literal notranslate"><span class="pre">a</span></code>（総供給曲線の傾き）のみであり，その役割を考えてみよう。
<a class="reference internal" href="#fig-18-p-uv"><span class="std std-numref">Fig. 17</span></a>では，AS曲線の傾きが急な場合と緩やかな場合の２つのケースを示している。</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(a\)</span> が小さい場合，総供給曲線の傾きは緩やかになる。その場合，需要曲線が動くと<span class="math notranslate nohighlight">\(y_t\)</span>は大きく動くが，<span class="math notranslate nohighlight">\(p_t\)</span>は大きく動かない。</p></li>
<li><p><span class="math notranslate nohighlight">\(a\)</span> が大きい場合，総供給曲線の傾きは急になる。その場合，需要曲線が動くと<span class="math notranslate nohighlight">\(y_t\)</span>の動きは小さくなる一方，<span class="math notranslate nohighlight">\(p_t\)</span>は大きく動くことになる。</p></li>
</ul>
<p><span class="math notranslate nohighlight">\(a\)</span> の値は<code class="docutils literal notranslate"><span class="pre">1</span></code>よりも小さく，<span class="math notranslate nohighlight">\(a\)</span> が小さいケースが当てはまる。この場合，<span class="math notranslate nohighlight">\(p_t\)</span>に対する総需要ショックのインパクトは小さな値となり，相対的に総供給ショックの寄与度が高くなっていると考えられる。</p>
<figure class="align-default" id="fig-18-p-uv">
<a class="reference internal image-reference" href="_images/adas-p-uv.jpeg"><img alt="_images/adas-p-uv.jpeg" src="_images/adas-p-uv.jpeg" style="width: 453.59999999999997px; height: 349.65px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 17 </span><span class="caption-text">物価水準の％乖離の変動において総供給ショックの影響が大きい理由</span><a class="headerlink" href="#fig-18-p-uv" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
</section>
<section id="id25">
<h2>まとめ<a class="headerlink" href="#id25" title="Permalink to this headline">#</a></h2>
<p>GDPと価格水準のトレンドからの％乖離のプロットを再掲する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax_</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,[</span><span class="s1">&#39;gdp_cycle&#39;</span><span class="p">,</span><span class="s1">&#39;deflator_cycle&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">ax_</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9a04c4982eedf7bb392f424918af996f355732144481c0d27c196d872e79bb95.png" src="_images/9a04c4982eedf7bb392f424918af996f355732144481c0d27c196d872e79bb95.png" />
</div>
</div>
<p>このプロットを眺めることにより，総需要ショックと総供給ショックがどれだけ景気循環に影響を及ぼしているかが分かるだろうか。もちろん否である。ADASモデルを「装置」として用いて，「スイッチ」を調整することにより，結果が数字として現れてくることになる。
「調整済み装置」があってこその分析結果であり，体重計がないと体重を測れないことと同じである。</p>
<p>体重計の例をもう一度考えてみよう。
今度は，AさんとBさんが作る体重計である。
Aさんの体重計は単純な装置だが，一方，Bさんの技術は高く，設計図は洗練され使う材料もより質が高いとしてみよう。
その差は精度の違いとして現れることになるだろう。
マクロ経済モデルも同じである。
AD-ASモデルは，研究や政策議論で使われるモデルと比べると単純なモデルであり，それが故に定量的な問に対しての答えも精度が低いものとならざるを得ない。
大学院で学ぶDSGEモデルや構造VARモデルなどはより洗練された「装置」であり，AD-ASモデルよりも精度が高い結果を返すことになるだろう。</p>
</section>
<section id="id26">
<h2>付録：分散と共分散の性質<a class="headerlink" href="#id26" title="Permalink to this headline">#</a></h2>
<p><span class="math notranslate nohighlight">\(X\)</span>，<span class="math notranslate nohighlight">\(Y\)</span>，<span class="math notranslate nohighlight">\(Z\)</span>，<span class="math notranslate nohighlight">\(W\)</span>をランダム変数，<span class="math notranslate nohighlight">\(a\)</span>，<span class="math notranslate nohighlight">\(b\)</span>，<span class="math notranslate nohighlight">\(c\)</span>，<span class="math notranslate nohighlight">\(d\)</span>を定数とする。
分散に関して次の結果が成立する。</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\text{Var}(k)&amp;=0\\
\text{Var}(X+k)&amp;=\text{Var}(X)\\
\text{Var}(aX)&amp;=a^2\text{Var}(X)\\
\text{Var}(aX\pm bY)&amp;=a^2\text{Var}(X)+b^2\text{Var}(Y)\pm 2ab\text{Cov}(X,Y) \\
\end{align*}
\end{split}\]</div>
<p>共分散に関して次の結果が成立する。</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\text{Cov}(X,a)&amp;=0\\
\text{Cov}(X,X)&amp;=\text{Var}(X)\\
\text{Cov}(aX,bY)&amp;=ab\text{Var}(Y,X)\\
\text{Cov}(X+a,Y+b)&amp;=\text{Var}(Y,X)\\
\text{Cov}(aX+bY,cZ+dW)&amp;=ac\text{Cov}(X,Z)+ad\text{Cov}(X,W)+bc\text{Cov}(Y,Z)+bd\text{Cov}(Y,W)
\end{align*}
\end{split}\]</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="18_ADAS-1.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">定量的マクロ経済分析：Part 1</p>
      </div>
    </a>
    <a class="right-next"
       href="12_IS-MP-PC.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">IS-MP-PCモデル</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> 目次
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">はじめに</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">コードの基本形</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adas">ADASモデルの安定性</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">インパルス反応関数</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">コード</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">プロット</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">総供給ショック</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">総需要ショック</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">総供給・総需要ショックの同時発生</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">確率的シミュレーション</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">コード</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">プロット</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gdp">GDPと価格水準の％乖離の標準偏差</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">自己相関係数</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#py"><code class="docutils literal notranslate"><span class="pre">p</span></code>と<code class="docutils literal notranslate"><span class="pre">y</span></code>の％乖離の相関係数：同時期</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">結果のまとめと拡張</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">ADASモデルの評価</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">定量的な問い</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">予測誤差</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">GDPの％乖離</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">計算方法</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">結果</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">解釈</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">価格水準の％乖離</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">計算方法</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id23">結果</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">解釈</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id25">まとめ</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id26">付録：分散と共分散の性質</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner">
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
著者 春山 鉄源  Tetsugen HARUYAMA
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div></div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>