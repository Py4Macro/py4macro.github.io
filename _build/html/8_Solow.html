
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ソロー・モデル &#8212; Pythonで学ぶ中級マクロ経済学</title>
    
  <link rel="stylesheet" href="_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/my_style.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://py4macro.github.io/8_Solow.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Pandas：プロット" href="Pandas_plot.html" />
    <link rel="prev" title="差分方程式と経済分析" href="7_DifferenceEq.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />


<!-- Opengraph tags -->
<meta property="og:url"         content="https://py4macro.github.io/8_Solow.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="ソロー・モデル" />
<meta property="og:description" content="ソロー・モデル  If you come here without expecting Japanese, please click Google translated version in English or the language of your choice.  import numpy as np impo" />


<meta name="twitter:card" content="summary" />


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  
  <h1 class="site-logo" id="site-title">Pythonで学ぶ中級マクロ経済学</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <p class="caption collapsible-parent">
 <span class="caption-text">
  １. Pythonの学習
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="1_Python_Basics.html">
   Pythonの基礎
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2_NumPy.html">
   NumPy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="3_Pandas.html">
   Pandas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="4_Matplotlib.html">
   Matplotlib
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  ２. マクロ経済学
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="5_Income_Differences.html">
   発展会計と成長会計
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="6_Regression.html">
   回帰分析
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="7_DifferenceEq.html">
   差分方程式と経済分析
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   ソロー・モデル
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  ３. 参考
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="Pandas_plot.html">
   Pandas：プロット
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  <a  href="https://github.com/Py4Macro/py4macro.github.io">&#128200;&#127891;&#128202;<!-- Default Statcounter code for Py4Macro https://py4macro.github.io --> <script type="text/javascript"> var sc_project=12478906; var sc_invisible=1; var sc_security="e767d225"; </script> <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script> <noscript><div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img class="statcounter" src="https://c.statcounter.com/12478906/0/e767d225/1/" alt="Web Analytics"></a></div></noscript> <!-- End of Statcounter Code --></a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/8_Solow.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/Py4Macro//source?urlpath=tree/8_Solow.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/Py4Macro//blob/source/8_Solow.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   はじめに
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   モデルの説明
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id4">
   動学
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id5">
   定常状態での変数の値
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id6">
   線形近似
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id7">
   長期均衡の予測
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id8">
     説明
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id9">
     データ
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id10">
       貯蓄率
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id11">
       資本減耗率
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id12">
       労働人口成長率
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#gdp">
       資本ストック対GDP比
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id13">
       データの結合
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id14">
     トレンド線と散布図
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="id1">
<h1>ソロー・モデル<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>If you come here without expecting Japanese, please click <a class="reference external" href="https://translate.google.com/translate?sl=auto&amp;tl=en&amp;u=https://py4macro.github.io/8_Solow.html">Google translated version</a> in English or the language of your choice.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">japanize_matplotlib</span>
<span class="kn">import</span> <span class="nn">py4macro</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id2">
<h2>はじめに<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>前章では差分方程式について説明し，簡単な経済モデルを使いコードの書き方を説明した。本章では，差分方程式の応用となるソロー・モデルを考える。ソロー・モデルは1987年にノーベル経済学賞を受賞した<a class="reference external" href="https://www.nobelprize.org/prizes/economic-sciences/1987/press-release/">Robert M. Solow</a>によって考案された経済成長モデルであり，マクロ経済学の代表的な理論モデルの一つである。今でも盛んに研究が続く経済成長のバックボーン的な存在である。モデルの説明の後，<code class="docutils literal notranslate"><span class="pre">Python</span></code>を使い動学的な特徴を明らかにし，線形近似を使った安定性の確認もおこなう。また理論的な予測がデータと整合性があるかについてもPenn World Tableを使って検討する。本章の内容は次章で議論する所得収斂の分析の基礎となる。</p>
</div>
<div class="section" id="id3">
<h2>モデルの説明<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>ここではモデルの具体的な説明については教科書に譲るとして，簡単にモデルを紹介し，重要な式をまとめることにする。</p>
<p>＜記号＞</p>
<ul class="simple">
<li><p>産出量：<span class="math notranslate nohighlight">\(Y_t\)</span></p></li>
<li><p>消費量：<span class="math notranslate nohighlight">\(C_t\)</span></p></li>
<li><p>投資量：<span class="math notranslate nohighlight">\(I_t\)</span></p></li>
<li><p>資本ストック：<span class="math notranslate nohighlight">\(K_t\)</span></p></li>
<li><p>労働：<span class="math notranslate nohighlight">\(L_t\)</span></p></li>
<li><p>貯蓄率（一定な外生変数）：<span class="math notranslate nohighlight">\(0&lt;s&lt;1\)</span></p></li>
<li><p>労働人口増加率（一定な外生変数）：<span class="math notranslate nohighlight">\(n\equiv\dfrac{L_{t+1}}{L_t}-1\geq 0\)</span></p></li>
<li><p>資本減耗率（一定な外生変数）：<span class="math notranslate nohighlight">\(0&lt;d&lt;1\)</span></p></li>
<li><p>生産性（一定な外生変数）：<span class="math notranslate nohighlight">\(A&gt;0\)</span></p></li>
</ul>
<p>＜一人当たりの変数＞</p>
<ul class="simple">
<li><p>一人当たり産出量：<span class="math notranslate nohighlight">\(y_t\equiv\dfrac{Y_t}{L_t}\)</span></p></li>
<li><p>一人当たり消費量：<span class="math notranslate nohighlight">\(c_t\equiv\dfrac{C_t}{L_t}\)</span></p></li>
<li><p>一人当たり投資量：<span class="math notranslate nohighlight">\(i_t\equiv\dfrac{I_t}{L_t}\)</span></p></li>
<li><p>一人当たり資本ストック：<span class="math notranslate nohighlight">\(k_t\equiv\dfrac{K_t}{L_t}\)</span></p></li>
</ul>
<p>全ての市場は完全競争である閉鎖経済を考えよう。この経済には一種類の財（ニューメレール財）しかなく，消費・貯蓄・投資に使われる。財は次の生産関数に従って生産される。</p>
<div class="math notranslate nohighlight" id="equation-eq-8-production-level">
<span class="eqno">(25)<a class="headerlink" href="#equation-eq-8-production-level" title="Permalink to this equation">¶</a></span>\[
Y_t=AK_t^aL_t^{1-a},\quad 0&lt;a&lt;1
\]</div>
<p>両辺を<span class="math notranslate nohighlight">\(L_t\)</span>で割ると一人当たりの変数で表した生産関数となる。</p>
<div class="math notranslate nohighlight" id="equation-eq-8-production">
<span class="eqno">(26)<a class="headerlink" href="#equation-eq-8-production" title="Permalink to this equation">¶</a></span>\[
y_t=Ak_t^a
\]</div>
<p>消費者は所得の割合<span class="math notranslate nohighlight">\(s\)</span>を貯蓄するが，このモデルの中で消費者の役割はこれだけであり，残り全ては生産側で決定される。貯蓄は<span class="math notranslate nohighlight">\(sY_t\)</span>であり投資<span class="math notranslate nohighlight">\(I_t\)</span>と等しくなる。</p>
<div class="math notranslate nohighlight" id="equation-eq-8-syi">
<span class="eqno">(27)<a class="headerlink" href="#equation-eq-8-syi" title="Permalink to this equation">¶</a></span>\[
sY_t=I_t
\]</div>
<p><span class="math notranslate nohighlight">\(t\)</span>期の投資により<span class="math notranslate nohighlight">\(t+1\)</span>期の資本ストックは増加するが，毎期ごと資本は<span class="math notranslate nohighlight">\(d\)</span>の率で減耗する。即ち，投資と資本ストックには次の関係が成立する。</p>
<div class="math notranslate nohighlight" id="equation-eq-8-kk">
<span class="eqno">(28)<a class="headerlink" href="#equation-eq-8-kk" title="Permalink to this equation">¶</a></span>\[
K_{t+1}-K_{t}=I_t-dK_t
\]</div>
<p>ここで左辺は資本ストックの変化であり，右辺は純投資である。<span class="math notranslate nohighlight">\(I_t\)</span>は粗投資，<span class="math notranslate nohighlight">\(dK_t\)</span>は減耗した資本である。式<a class="reference internal" href="#equation-eq-8-syi">(27)</a>，<a class="reference internal" href="#equation-eq-8-kk">(28)</a>，<a class="reference internal" href="#equation-eq-8-production">(26)</a>を使うと資本の蓄積方程式が導出できる。</p>
<div class="math notranslate nohighlight" id="equation-eq-8-kkdot">
<span class="eqno">(29)<a class="headerlink" href="#equation-eq-8-kkdot" title="Permalink to this equation">¶</a></span>\[
K_{t+1} = sAK_t^a + (1-d)K_t
\]</div>
<p>両辺を<span class="math notranslate nohighlight">\(L_t\)</span>で割ることで一人当たりの変数で表すことができる。右辺は単純に一人当たりの変数に直し，左辺は次のように書き換えることに注意しよう。</p>
<div class="math notranslate nohighlight">
\[
\frac{K_{t+1}}{L_t}=\frac{K_{t+1}}{L_{t+1}}\frac{L_{t+1}}{L_t}
=k_{t+1}(1+n)
\]</div>
<p>従って，<span class="math notranslate nohighlight">\(t+1\)</span>期の一人当たりの資本ストックを決定する式は次式で与えられる。</p>
<div class="math notranslate nohighlight" id="equation-eq-8-kdot">
<span class="eqno">(30)<a class="headerlink" href="#equation-eq-8-kdot" title="Permalink to this equation">¶</a></span>\[
k_{t+1} = \frac{sAk_t^a + (1-d)k_t}{1+n}
\]</div>
<p>この式は非線形の差分方程式だが，前章でも述べたように，考え方は線形差分方程式と同じであり，数値計算のための<code class="docutils literal notranslate"><span class="pre">Python</span></code>コードに関しては大きな違いはない。また式<a class="reference internal" href="#equation-eq-8-kdot">(30)</a>を資本ストックの成長率を示す式に書き換えることもできる。</p>
<div class="math notranslate nohighlight" id="equation-eq-8-kgrowth">
<span class="eqno">(31)<a class="headerlink" href="#equation-eq-8-kgrowth" title="Permalink to this equation">¶</a></span>\[
\frac{k_{t+1}}{k_t}-1 = \frac{sAk_t^{-(1-a)}-(n+d)}{1+n}
\]</div>
<p>この式から資本が蓄積され<span class="math notranslate nohighlight">\(k_t\)</span>が増加すると，その成長率は減少していくことが分かる。</p>
<p>産出量の動学は生産関数<a class="reference internal" href="#equation-eq-8-production">(26)</a>を使うことによって<span class="math notranslate nohighlight">\(y_t\)</span>の動きを確認できる。例えば，産出量の成長率を考えてみよう。式<a class="reference internal" href="#equation-eq-8-production">(26)</a>を使うと</p>
<div class="math notranslate nohighlight" id="equation-eq-8-ygrowth">
<span class="eqno">(32)<a class="headerlink" href="#equation-eq-8-ygrowth" title="Permalink to this equation">¶</a></span>\[
\frac{y_{t+1}}{y_t}-1
=\left(\frac{k_{t+1}}{k_t}\right)^{\alpha}-1
\]</div>
<p>となり，一人当たり資本ストックの成長率と同じような動きをすることが分かると思う。</p>
<p>次に定常状態を考えよう。定常状態では資本ストックは一定なり，資本の成長率である式<a class="reference internal" href="#equation-eq-8-kgrowth">(31)</a>の右辺はゼロになる。
定常値は次のように確認することができる。</p>
<div class="math notranslate nohighlight" id="equation-eq-8-kss">
<span class="eqno">(33)<a class="headerlink" href="#equation-eq-8-kss" title="Permalink to this equation">¶</a></span>\[\begin{split}
\begin{align*}
\frac{k_*}{k_*}-1 
&amp;=\frac{sAk_*^{-(1-a)} - (n+d)}{1+n} \\
&amp;\Downarrow \\
k_*
&amp;=\left(
        \frac{As}{n+d}
    \right)^{\frac{1}{1-a}}
\end{align*}
\end{split}\]</div>
<p>この値を生産関数<a class="reference internal" href="#equation-eq-8-production">(26)</a>に代入することにより一人当たりGDPの定常値を求めることができる。</p>
<div class="math notranslate nohighlight" id="equation-eq-8-yss">
<span class="eqno">(34)<a class="headerlink" href="#equation-eq-8-yss" title="Permalink to this equation">¶</a></span>\[
y_*=Ak_*^{a}
\]</div>
<p><a class="reference internal" href="#fig-8-solow"><span class="std std-numref">Fig. 6</span></a>は資本ストックの動学的均衡を示している。</p>
<div class="figure align-default" id="fig-8-solow">
<a class="reference internal image-reference" href="_images/solow.jpeg"><img alt="_images/solow.jpeg" src="_images/solow.jpeg" style="width: 400.5px; height: 300.0px;" /></a>
<p class="caption"><span class="caption-number">Fig. 6 </span><span class="caption-text">一人当たり資本ストックの動学</span><a class="headerlink" href="#fig-8-solow" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="id4">
<h2>動学<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>差分方程式<a class="reference internal" href="#equation-eq-8-kdot">(30)</a>を使って資本ストックの変化をプロットするが，以前と同じように<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を生成する関数を定義しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">solow_model</span><span class="p">(</span><span class="n">k0</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">T</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;引数</span>
<span class="sd">            k0: 資本の初期値</span>
<span class="sd">            A: 生産性</span>
<span class="sd">            a: 資本の所得比率 (a&lt;1)</span>
<span class="sd">            s: 貯蓄率 (s&lt;1)</span>
<span class="sd">            n: 労働人口成長率（％）</span>
<span class="sd">            d: 資本減耗率 (d&lt;1)</span>
<span class="sd">            T: ループによる計算回数</span>
<span class="sd">       戻り値</span>
<span class="sd">            資本と産出量からなるDataFrame&quot;&quot;&quot;</span>
    
    <span class="n">k</span> <span class="o">=</span> <span class="n">k0</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">A</span><span class="o">*</span><span class="n">k0</span><span class="o">**</span><span class="n">a</span>
    
    <span class="n">k_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span><span class="p">]</span>
    <span class="n">y_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
        
        <span class="n">k</span> <span class="o">=</span> <span class="p">(</span> <span class="n">s</span><span class="o">*</span><span class="n">A</span><span class="o">*</span><span class="n">k</span><span class="o">**</span><span class="n">a</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">d</span><span class="p">)</span><span class="o">*</span><span class="n">k</span> <span class="p">)</span><span class="o">/</span><span class="p">(</span> <span class="mi">1</span><span class="o">+</span><span class="n">n</span> <span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">A</span><span class="o">*</span><span class="n">k</span><span class="o">**</span><span class="n">a</span>

        <span class="n">k_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="n">y_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

    <span class="c1"># DataFrameの作成</span>
    <span class="n">dic</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;capital&#39;</span><span class="p">:</span><span class="n">k_list</span><span class="p">,</span> <span class="s1">&#39;output&#39;</span><span class="p">:</span><span class="n">y_list</span><span class="p">}</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dic</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">df</span> 
</pre></div>
</div>
</div>
</div>
<p>引数に使うパラーメータには次の値を使ってプロットしてみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">solow_model</span><span class="p">(</span><span class="n">k0</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">A</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8_Solow_16_0.png" src="_images/8_Solow_16_0.png" />
</div>
</div>
<p>異なる初期値を使って資本の変化をプロットしてみる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">initial_list</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>      <span class="c1"># 1</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>              <span class="c1"># 2</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">initial_list</span><span class="p">:</span>                <span class="c1"># 3</span>
    <span class="n">df_temp</span> <span class="o">=</span> <span class="n">solow_model</span><span class="p">(</span><span class="n">k0</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">A</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;capital&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_temp</span><span class="p">)</span>
    
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;ソロー・モデルの移行過程&#39;</span><span class="p">,</span>  <span class="c1"># 4</span>
       <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;ループの回数&#39;</span><span class="p">,</span>
       <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;一人当たり資本ストック&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8_Solow_18_0.png" src="_images/8_Solow_18_0.png" />
</div>
</div>
<div class="admonition- admonition">
<p class="admonition-title">コードの説明</p>
<ol>
<li><p><code class="docutils literal notranslate"><span class="pre">range(100,300,10)</span></code>は100から300-1=299までの間の数を10間隔で生成する。100，110，120，<span class="math notranslate nohighlight">\(cdots\)</span>，290となる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.subplots()</span></code>を使ってキャンバスを<code class="docutils literal notranslate"><span class="pre">fig</span></code>に，「軸」を<code class="docutils literal notranslate"><span class="pre">ax</span></code>に割り当てる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">initial_list</span></code>に対して<code class="docutils literal notranslate"><span class="pre">for</span></code>ループを設定する。一回のループごとに以下をおこなう。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">i</span></code>は<code class="docutils literal notranslate"><span class="pre">k0</span></code>の引数に使う値になる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">solow_model()</span></code>で資本ストックの数値を計算し，その<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を<code class="docutils literal notranslate"><span class="pre">df_temp</span></code>に割り当てる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.plot()</span></code>を使い<code class="docutils literal notranslate"><span class="pre">ax</span></code>に図をプロットする。これにより図が重ねて描かれる。</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">ax</span></code>のメソッド<code class="docutils literal notranslate"><span class="pre">set()</span></code>を使い，引数を使い以下を追加する。</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">title</span></code>：図のタイトル</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">xlabel</span></code>：横軸のラベル</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ylabel</span></code>：縦軸のラベル</p></li>
<li><p>この３行を次のように書いても同じ結果となる。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ソロー・モデルの移行過程&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;ループの回数&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;一人当たり資本ストック&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>この３つを<code class="docutils literal notranslate"><span class="pre">.set()</span></code>でまとめて書いたのが上のコードである。３つに分けて書く利点はフォントの大きさを指定できることだろう。</p>
</li>
</ul>
</li>
</ol>
</div>
<p>図から初期値に関わらず定常値に収束していることが分かる。即ち，定常状態である長期均衡は安定的である。</p>
</div>
<div class="section" id="id5">
<h2>定常状態での変数の値<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<p>次に定常状態での変数の値を計算してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">calculate_steady_state</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">d</span><span class="p">):</span>
    
    <span class="n">k_ss</span> <span class="o">=</span> <span class="p">(</span> <span class="n">s</span><span class="o">*</span><span class="n">A</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="n">d</span><span class="p">)</span> <span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">a</span><span class="p">))</span>    
    <span class="n">y_ss</span> <span class="o">=</span> <span class="n">A</span><span class="o">*</span><span class="n">k_ss</span><span class="o">**</span><span class="p">(</span><span class="n">a</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">a</span><span class="p">))</span>    
    
    <span class="k">return</span> <span class="n">k_ss</span><span class="p">,</span> <span class="n">y_ss</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ss</span> <span class="o">=</span> <span class="n">calculate_steady_state</span><span class="p">(</span><span class="n">A</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;定常状態での資本ストック:</span><span class="si">{</span><span class="n">ss</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span>
      <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">定常状態での産出量: </span><span class="si">{</span><span class="n">ss</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>定常状態での資本ストック:214.5
定常状態での産出量: 99.8
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id6">
<h2>線形近似<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="#fig-8-solow"><span class="std std-numref">Fig. 6</span></a>は，定常状態は安定的であることを示している。またシミュレーションの結果からも定常状態の安定性が確認できる。次に，線形近似を使って解析的に安定性を確認してみることにする。また線形近似は真の値からの乖離が発生するが，その乖離がどの程度のものかをコードを使って計算することにする。</p>
<p>＜テイラー展開による１次線形近似＞</p>
<ul>
<li><p>関数<span class="math notranslate nohighlight">\(z=f(x)\)</span>を<span class="math notranslate nohighlight">\(x_*\)</span>でテイラー展開すると次式となる。</p>
<div class="math notranslate nohighlight">
\[
    z=f(x^*)+\left.\frac{df}{dx}\right|_{x=x_*}(x-x_*)
    \]</div>
</li>
</ul>
<p>ソロー・モデルの式に当てはめると次のような対応関係にある。</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(z\;\Rightarrow\;k_{t+1}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(f(x)\;\Rightarrow\;\dfrac{Ask_{t}^{\alpha}+(1-d)k_t}{1+n}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(x^*\;\Rightarrow\;k^*\)</span></p></li>
</ul>
<p>公式に従って計算してみよう。</p>
<div class="math notranslate nohighlight" id="equation-eq-8-kapprox">
<span class="eqno">(35)<a class="headerlink" href="#equation-eq-8-kapprox" title="Permalink to this equation">¶</a></span>\[\begin{split}
\begin{align*}
k_{t+1}
&amp;=\frac{Ask_{*}^{\alpha}+(1-d)k_*}{1+n}
+\frac{1}{1+n}\left[\frac{Asa}{k_t^{1-\alpha}}+(1-d)\right]_{k_t=k_*}(k_t-k_*) \\
&amp;=k_{*}
+\frac{1}{1+n}\left[\frac{Asa}{k_*^{1-\alpha}}+(1-d)\right](k_t-k_*) \\
&amp;=k_*+\frac{1}{1+n}\left[\frac{Asa}{As/(n+d)}+(1-d)\right](k_t-k_*) \\
&amp;=k_*+\frac{a(n+d)+1-d-n+n}{1+n}(k_t-k_*) \\
&amp;=k_*+\frac{1+n-(1-a)(n+d)}{1+n}(k_t-k_*) \\
&amp;=(1-\lambda) k_t + \lambda k_*
\end{align*}
\end{split}\]</div>
<p>ここで</p>
<div class="math notranslate nohighlight" id="equation-eq-8-lambda">
<span class="eqno">(36)<a class="headerlink" href="#equation-eq-8-lambda" title="Permalink to this equation">¶</a></span>\[
\lambda\equiv \frac{(1-a)(n+d)}{1+n}
\]</div>
<p>３行目は定常状態の式<a class="reference internal" href="#equation-eq-8-kdot">(30)</a>と式<a class="reference internal" href="#equation-eq-8-kss">(33)</a>を使っている。式<a class="reference internal" href="#equation-eq-8-kapprox">(35)</a>は<span class="math notranslate nohighlight">\(k_{t+1}\)</span>と<span class="math notranslate nohighlight">\(k_t\)</span>の線形差分方程式になっており，<span class="math notranslate nohighlight">\(k_t\)</span>の係数は</p>
<div class="math notranslate nohighlight" id="equation-eq-8-coef-of-kt">
<span class="eqno">(37)<a class="headerlink" href="#equation-eq-8-coef-of-kt" title="Permalink to this equation">¶</a></span>\[
0&lt;1-\lambda&lt;1
\quad\because
0&lt;a,d&lt;1
\]</div>
<p>が成立する。<a class="reference internal" href="#fig-8-solow"><span class="std std-numref">Fig. 6</span></a>の赤い直線が式<a class="reference internal" href="#equation-eq-8-kapprox">(35)</a>である。従って，初期値<span class="math notranslate nohighlight">\(k_0&gt;0\)</span>からスタートする経済は必ず長期的均衡に収束することがわかる。</p>
<p>式<a class="reference internal" href="#equation-eq-8-lambda">(36)</a>は<span class="math notranslate nohighlight">\(k_t\)</span>の係数だが，その裏にあるメカニズムを考えてみよう。特に，<span class="math notranslate nohighlight">\(a\)</span>の役割を考える。<span class="math notranslate nohighlight">\(a\)</span>は資本の所得比率であり，目安の値は1/3である。そしてソロー・モデルにおける重要な役割が<strong>資本の限界生産性の逓減</strong>を決定することである。この効果により資本ストックが増加する毎に産出量も増加するがその増加自体が減少する。この効果により，<a class="reference internal" href="#fig-8-solow"><span class="std std-numref">Fig. 6</span></a>の曲線は凹関数になっており，生産関数<a class="reference internal" href="#equation-eq-8-production">(26)</a>の場合は必ず45度線と交差することになる。即ち，資本の限界生産性の逓減こそが<span class="math notranslate nohighlight">\(k_t\)</span>が一定になる定常状態に経済が収束す理由なのである。この点がソロー・モデルの一番重要なメカニズムとなる。</p>
<p>ここで<span class="math notranslate nohighlight">\(a\)</span>が上昇したとしよう。そうなると資本の限界生産性の逓減の効果は弱くなり，資本ストックが増加しても産出量の増加自体の減少は小さくなる。また式<a class="reference internal" href="#equation-eq-8-kss">(33)</a>が示すように定常状態での資本ストックはより大きくなる。これは<a class="reference internal" href="#fig-8-solow"><span class="std std-numref">Fig. 6</span></a>で曲線が上方シフトしている考えると良いだろう。次章で収束速度について考察する際，<span class="math notranslate nohighlight">\(a\)</span>の大きさが重要になってくるので，この点を覚えておこう。</p>
<div class="note admonition">
<p class="admonition-title">内生的成長</p>
<p>更に<span class="math notranslate nohighlight">\(a\)</span>を上昇させて<span class="math notranslate nohighlight">\(a=1\)</span>になるとどうなるのだろう。この場合，資本の限界生産性は逓減せず一定となる。そして<span class="math notranslate nohighlight">\(k_t\)</span>の係数である式<a class="reference internal" href="#equation-eq-8-coef-of-kt">(37)</a>は1になってしまい，<span class="math notranslate nohighlight">\(k_t\)</span>が一定になる定常状態が存在しなくなる。<span class="math notranslate nohighlight">\(a=1\)</span>となる極限の状態を内生的成長と呼ぶ。ここでは立ち入った議論はしないが，内生的成長の典型的な生産関数は次式となり，</p>
<div class="math notranslate nohighlight">
\[y_t=Ak_t\]</div>
<p>この生産関数に基づくモデルは<span class="math notranslate nohighlight">\(AK\)</span>モデルと呼ばれる。資本の限界生産性は<span class="math notranslate nohighlight">\(A\)</span>で一定になることが分かると思う。</p>
</div>
<p>次に関数<code class="docutils literal notranslate"><span class="pre">solow_model()</span></code>を修正して線形近似の誤差を確かめてみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">solow_model_approx</span><span class="p">(</span><span class="n">k0</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">T</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;引数</span>
<span class="sd">            k0: 資本の初期値</span>
<span class="sd">            A: 生産性</span>
<span class="sd">            a: 資本の所得比率 (a&lt;1)</span>
<span class="sd">            s: 貯蓄率 (s&lt;1)</span>
<span class="sd">            n: 労働人口成長率（n&gt;=0）</span>
<span class="sd">            d: 資本減耗率 (d&lt;1)</span>
<span class="sd">            T: ループによる計算回数</span>
<span class="sd">       戻り値</span>
<span class="sd">            線形近似モデルを使い計算した資本と産出量からなるDataFrame&quot;&quot;&quot;</span>
    
    <span class="n">k</span> <span class="o">=</span> <span class="n">k0</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">A</span><span class="o">*</span><span class="n">k0</span><span class="o">**</span><span class="n">a</span>
    
    <span class="n">k_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span><span class="p">]</span>
    <span class="n">y_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span><span class="p">]</span>

    <span class="c1"># 定常状態</span>
    <span class="n">k_ss</span> <span class="o">=</span> <span class="p">(</span> <span class="n">s</span><span class="o">*</span><span class="n">A</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="n">d</span><span class="p">)</span> <span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">a</span><span class="p">))</span>    
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
        
        <span class="n">lamb</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="p">)</span>  <span class="c1"># lambda</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">lamb</span><span class="o">*</span><span class="n">k</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">lamb</span><span class="p">)</span><span class="o">*</span><span class="n">k_ss</span>  <span class="c1"># 線形近似</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">A</span><span class="o">*</span><span class="n">k</span><span class="o">**</span><span class="n">a</span>

        <span class="n">k_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="n">y_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

    <span class="c1"># DataFrameの作成</span>
    <span class="n">dic</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;capital&#39;</span><span class="p">:</span><span class="n">k_list</span><span class="p">,</span> <span class="s1">&#39;output&#39;</span><span class="p">:</span><span class="n">y_list</span><span class="p">}</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dic</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">df</span> 
</pre></div>
</div>
</div>
</div>
<p>近似誤差を計算するために，上と同じ数値でシミュレーションをおこなう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_approx</span> <span class="o">=</span> <span class="n">solow_model_approx</span><span class="p">(</span><span class="n">k0</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">A</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>非線形のモデル<a class="reference internal" href="#equation-eq-8-kdot">(30)</a>と線形近似のモデル<a class="reference internal" href="#equation-eq-8-kapprox">(35)</a>で計算された資本ストックを重ねて図示してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_approx</span><span class="p">[</span><span class="s1">&#39;capital&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;線形近似モデル&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;capital&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;ソロー・モデル&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8_Solow_35_0.png" src="_images/8_Solow_35_0.png" />
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">df_approx</span></code>が図示され、その上に<code class="docutils literal notranslate"><span class="pre">df</span></code>が重ねて表示されるが、殆ど同じのように見える。誤差を％で計算し図示してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span> <span class="mi">100</span><span class="o">*</span><span class="p">(</span> <span class="mi">1</span><span class="o">-</span><span class="n">df_approx</span><span class="p">[</span><span class="s1">&#39;capital&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;capital&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8_Solow_37_0.png" src="_images/8_Solow_37_0.png" />
</div>
</div>
<p>初期の資本ストック<span class="math notranslate nohighlight">\(k_0\)</span>は同じなので誤差はゼロであり，<span class="math notranslate nohighlight">\(t=1\)</span>から線形近似の誤差が現れることになる。誤差は単調ではない。<a class="reference internal" href="#fig-8-solow"><span class="std std-numref">Fig. 6</span></a>の図が示しているように，階段のような形で増加していくためであり，その階段お大きさや進み具合が異なるためである。線形近似の値は大き過ぎるため負の値になっているが、誤差は大きくても約0.02％であり、定常状態に近づくにつれて誤差はゼロに近づいている。もちろん，誤差の値は初期値が定常値から離れればそれだけ大きくなっていく。</p>
</div>
<div class="section" id="id7">
<h2>長期均衡の予測<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id8">
<h3>説明<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<p>この節では長期均衡（定常状態）に焦点を当て，理論的な予測のデータとの整合性をチェックする。まず定常状態の特徴をまとめよう。式<a class="reference internal" href="#equation-eq-8-kss">(33)</a>と<a class="reference internal" href="#equation-eq-8-yss">(34)</a>を使いうと定常状態での一人当たり資本ストックとGDPは次式で与えれる。</p>
<div class="math notranslate nohighlight">
\[
k_*=
\left(
     \frac{sA}{n+d}
\right)^{\frac{1}{1-a}},
\quad
y_*=Ak_*^a
\]</div>
<p>この２つをそれぞれ試すこともできるが，同時に捉えるために２つの式の比率を考える。</p>
<div class="math notranslate nohighlight" id="equation-eq-8-kyratio">
<span class="eqno">(38)<a class="headerlink" href="#equation-eq-8-kyratio" title="Permalink to this equation">¶</a></span>\[
\frac{k_*}{y_*}=\frac{s}{n+d}
=\left.\frac{K_t/L_t}{Y_t/L_t}\right|_{\text{定常状態}}
=\left.\frac{K_t}{Y_t}\right|_{\text{定常状態}}
\]</div>
<p>この値は資本ストック対GDP比と等しいく，次のことが分かる。</p>
<ul class="simple">
<li><p>貯蓄率<span class="math notranslate nohighlight">\(s\)</span>の上昇は資本ストック対GDP比を増加させる。。</p></li>
<li><p>労働人口成長率<span class="math notranslate nohighlight">\(n\)</span>の上昇は資本ストック対GDP比を減少させる。</p></li>
<li><p>資本減耗率<span class="math notranslate nohighlight">\(d\)</span>の上昇は資本ストック対GDP比を減少させる。</p></li>
</ul>
<p>この３つの予測が成立するか確かめるために<code class="docutils literal notranslate"><span class="pre">py4macro</span></code>モジュールに含まれるPenn World Dataの次の変数を使う。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cgdpo</span></code>：GDP（2019年）</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cn</span></code>：物的資本ストック（2019年）</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">csh_i</span></code>：GDPに対しての資本形成の比率</p>
<ul>
<li><p>投資の対GDP比であり<span class="math notranslate nohighlight">\(s\)</span>の代わりに使う。</p></li>
<li><p>1960年〜2019年の平均を使う。</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">emp</span></code>：雇用者数</p>
<ul>
<li><p>1960年〜2019年の平均成長率を使う。</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">delta</span></code>：資本ストックの年平均減耗率</p>
<ul>
<li><p>1960年〜2019年の平均を使う。</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="id9">
<h3>データ<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<p>1960年以降のデータを<code class="docutils literal notranslate"><span class="pre">pwt</span></code>に割り当てる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pwt</span> <span class="o">=</span> <span class="n">py4macro</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;pwt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;year &gt;= 1960&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id10">
<h4>貯蓄率<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h4>
<p>1960年から2019年までの国別の貯蓄率の平均を計算するが必要があるが，ここでは<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>のメソッド<code class="docutils literal notranslate"><span class="pre">.pivot()</span></code>を使いデータを整形する。<code class="docutils literal notranslate"><span class="pre">.pivot()</span></code>は，元の<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>から列を選び，その列から新たな<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を作成する便利なメソッドである。実際にコードを実行して説明しよう。</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">saving</span> <span class="o">=</span> <span class="n">pwt</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;country&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;csh_i&#39;</span><span class="p">)</span>
<span class="n">saving</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>country</th>
      <th>Albania</th>
      <th>Algeria</th>
      <th>Angola</th>
      <th>Anguilla</th>
      <th>Antigua and Barbuda</th>
      <th>Argentina</th>
      <th>Armenia</th>
      <th>Aruba</th>
      <th>Australia</th>
      <th>Austria</th>
      <th>...</th>
      <th>United Arab Emirates</th>
      <th>United Kingdom</th>
      <th>United States</th>
      <th>Uruguay</th>
      <th>Uzbekistan</th>
      <th>Venezuela (Bolivarian Republic of)</th>
      <th>Viet Nam</th>
      <th>Yemen</th>
      <th>Zambia</th>
      <th>Zimbabwe</th>
    </tr>
    <tr>
      <th>year</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1960</th>
      <td>NaN</td>
      <td>0.303861</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.148988</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.356183</td>
      <td>0.215909</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.250929</td>
      <td>0.243929</td>
      <td>0.154078</td>
      <td>NaN</td>
      <td>0.377831</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.053204</td>
      <td>0.201060</td>
    </tr>
    <tr>
      <th>1961</th>
      <td>NaN</td>
      <td>0.337310</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.151162</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.302833</td>
      <td>0.205103</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.242859</td>
      <td>0.235292</td>
      <td>0.157036</td>
      <td>NaN</td>
      <td>0.344871</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.047308</td>
      <td>0.184336</td>
    </tr>
    <tr>
      <th>1962</th>
      <td>NaN</td>
      <td>0.372718</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.131594</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.320442</td>
      <td>0.184987</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.224224</td>
      <td>0.237818</td>
      <td>0.133648</td>
      <td>NaN</td>
      <td>0.351696</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.042713</td>
      <td>0.129202</td>
    </tr>
    <tr>
      <th>1963</th>
      <td>NaN</td>
      <td>0.359685</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.113241</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.315644</td>
      <td>0.184251</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.226413</td>
      <td>0.243220</td>
      <td>0.123745</td>
      <td>NaN</td>
      <td>0.324748</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.031628</td>
      <td>0.113312</td>
    </tr>
    <tr>
      <th>1964</th>
      <td>NaN</td>
      <td>0.272713</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.139779</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.341544</td>
      <td>0.208624</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.270936</td>
      <td>0.246120</td>
      <td>0.102930</td>
      <td>NaN</td>
      <td>0.397737</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.020669</td>
      <td>0.117670</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 183 columns</p>
</div></div></div>
</div>
<div class="admonition- admonition">
<p class="admonition-title">コードの説明</p>
<p><code class="docutils literal notranslate"><span class="pre">pwt</span></code>の３つの列<code class="docutils literal notranslate"><span class="pre">year</span></code>，<code class="docutils literal notranslate"><span class="pre">country</span></code>，<code class="docutils literal notranslate"><span class="pre">csh_i</span></code>を使って新たな<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を作成し<code class="docutils literal notranslate"><span class="pre">saving</span></code>に割り当てている。引数は次の役割をする。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">index</span></code>：新たな<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>の<strong>行ラベル</strong>を指定する。</p>
<ul>
<li><p>コードでは<code class="docutils literal notranslate"><span class="pre">year</span></code>が指定され行ラベルになっている。</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">columns</span></code>：新たな<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>の<strong>列ラベル</strong>を指定する。</p>
<ul>
<li><p>コードでは<code class="docutils literal notranslate"><span class="pre">country</span></code>が指定され列ラベルになっている。</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">values</span></code>：新たな<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>の<strong>値</strong>を指定する。</p>
<ul>
<li><p>コードでは<code class="docutils literal notranslate"><span class="pre">csh_i</span></code>が指定され，その値で<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>が埋め尽くされている。</p></li>
</ul>
</li>
</ul>
</div>
<p>1960年以降欠損値がない国だけを使うので，<code class="docutils literal notranslate"><span class="pre">NaN</span></code>がある列を削除する必要があるが，<code class="docutils literal notranslate"><span class="pre">.dropna()</span></code>を使う。</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">saving</span> <span class="o">=</span> <span class="n">saving</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="n">saving</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>country</th>
      <th>Algeria</th>
      <th>Argentina</th>
      <th>Australia</th>
      <th>Austria</th>
      <th>Bangladesh</th>
      <th>Barbados</th>
      <th>Belgium</th>
      <th>Benin</th>
      <th>Bolivia (Plurinational State of)</th>
      <th>Botswana</th>
      <th>...</th>
      <th>Tunisia</th>
      <th>Turkey</th>
      <th>U.R. of Tanzania: Mainland</th>
      <th>Uganda</th>
      <th>United Kingdom</th>
      <th>United States</th>
      <th>Uruguay</th>
      <th>Venezuela (Bolivarian Republic of)</th>
      <th>Zambia</th>
      <th>Zimbabwe</th>
    </tr>
    <tr>
      <th>year</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1960</th>
      <td>0.303861</td>
      <td>0.148988</td>
      <td>0.356183</td>
      <td>0.215909</td>
      <td>0.015934</td>
      <td>0.097599</td>
      <td>0.290086</td>
      <td>0.041995</td>
      <td>0.155338</td>
      <td>0.109739</td>
      <td>...</td>
      <td>0.119855</td>
      <td>0.206398</td>
      <td>0.110611</td>
      <td>0.105968</td>
      <td>0.250929</td>
      <td>0.243929</td>
      <td>0.154078</td>
      <td>0.377831</td>
      <td>0.053204</td>
      <td>0.201060</td>
    </tr>
    <tr>
      <th>1961</th>
      <td>0.337310</td>
      <td>0.151162</td>
      <td>0.302833</td>
      <td>0.205103</td>
      <td>0.017991</td>
      <td>0.080713</td>
      <td>0.299679</td>
      <td>0.038844</td>
      <td>0.116987</td>
      <td>0.126386</td>
      <td>...</td>
      <td>0.148971</td>
      <td>0.200566</td>
      <td>0.119069</td>
      <td>0.116082</td>
      <td>0.242859</td>
      <td>0.235292</td>
      <td>0.157036</td>
      <td>0.344871</td>
      <td>0.047308</td>
      <td>0.184336</td>
    </tr>
    <tr>
      <th>1962</th>
      <td>0.372718</td>
      <td>0.131594</td>
      <td>0.320442</td>
      <td>0.184987</td>
      <td>0.026607</td>
      <td>0.073272</td>
      <td>0.281366</td>
      <td>0.038015</td>
      <td>0.194461</td>
      <td>0.143890</td>
      <td>...</td>
      <td>0.187644</td>
      <td>0.196202</td>
      <td>0.099676</td>
      <td>0.116963</td>
      <td>0.224224</td>
      <td>0.237818</td>
      <td>0.133648</td>
      <td>0.351696</td>
      <td>0.042713</td>
      <td>0.129202</td>
    </tr>
    <tr>
      <th>1963</th>
      <td>0.359685</td>
      <td>0.113241</td>
      <td>0.315644</td>
      <td>0.184251</td>
      <td>0.019315</td>
      <td>0.079214</td>
      <td>0.272968</td>
      <td>0.039580</td>
      <td>0.165575</td>
      <td>0.160907</td>
      <td>...</td>
      <td>0.194986</td>
      <td>0.201216</td>
      <td>0.089344</td>
      <td>0.146264</td>
      <td>0.226413</td>
      <td>0.243220</td>
      <td>0.123745</td>
      <td>0.324748</td>
      <td>0.031628</td>
      <td>0.113312</td>
    </tr>
    <tr>
      <th>1964</th>
      <td>0.272713</td>
      <td>0.139779</td>
      <td>0.341544</td>
      <td>0.208624</td>
      <td>0.024646</td>
      <td>0.078267</td>
      <td>0.309144</td>
      <td>0.033927</td>
      <td>0.171541</td>
      <td>0.200124</td>
      <td>...</td>
      <td>0.210442</td>
      <td>0.199917</td>
      <td>0.119029</td>
      <td>0.187897</td>
      <td>0.270936</td>
      <td>0.246120</td>
      <td>0.102930</td>
      <td>0.397737</td>
      <td>0.020669</td>
      <td>0.117670</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 111 columns</p>
</div></div></div>
</div>
<div class="admonition- admonition">
<p class="admonition-title">コードの説明</p>
<p><code class="docutils literal notranslate"><span class="pre">.dropna()</span></code>は<code class="docutils literal notranslate"><span class="pre">NaN</span></code>がある行か列を削除する。行と列のどちらを削除するかは引数<code class="docutils literal notranslate"><span class="pre">axis</span></code>で指定するが，デフォルトは<code class="docutils literal notranslate"><span class="pre">'rows'</span></code>である。即ち，引数なしで<code class="docutils literal notranslate"><span class="pre">.dropna()</span></code>を実行すると<code class="docutils literal notranslate"><span class="pre">NaN</span></code>がある行が削除される。ここでは列を削除したいので，引数に<code class="docutils literal notranslate"><span class="pre">'columns'</span></code>を指定している。</p>
</div>
<p>AlbaniaやAngolaなどが削除されていることが確認できる。何ヵ国残っているか確認してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">saving</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(60, 111)
</pre></div>
</div>
</div>
</div>
<div class="admonition- admonition">
<p class="admonition-title">コードの説明</p>
<p>属性<code class="docutils literal notranslate"><span class="pre">.shape</span></code>は<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>の行の数（左の数字）と列（右の数字）の数を返す。</p>
</div>
<p>111ヵ国含まれていることが確認できた。次に，それぞれの列の平均を計算する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">saving</span> <span class="o">=</span> <span class="n">saving</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="s1">&#39;saving_rate&#39;</span><span class="p">)</span>   <span class="c1"># 1</span>
<span class="n">saving</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>saving_rate</th>
    </tr>
    <tr>
      <th>country</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Algeria</th>
      <td>0.349476</td>
    </tr>
    <tr>
      <th>Argentina</th>
      <td>0.147927</td>
    </tr>
    <tr>
      <th>Australia</th>
      <td>0.285702</td>
    </tr>
    <tr>
      <th>Austria</th>
      <td>0.271485</td>
    </tr>
    <tr>
      <th>Bangladesh</th>
      <td>0.135590</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="admonition- admonition">
<p class="admonition-title">コードの説明</p>
<ol class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.mean()</span></code>はそれぞれの列の平均を計算し，<code class="docutils literal notranslate"><span class="pre">Series</span></code>を返す。後で<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を結合するメソッド<code class="docutils literal notranslate"><span class="pre">.merge()</span></code>を使うために<code class="docutils literal notranslate"><span class="pre">.to_frame()</span></code>を使って<code class="docutils literal notranslate"><span class="pre">Series</span></code>を<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>に変換しており，引数<code class="docutils literal notranslate"><span class="pre">saving_rate</span></code>は列ラベルを指定している。もちろん引数を使わずに２行に分けることも可能である。</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">saving</span> <span class="o">=</span> <span class="n">saving</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>
<span class="n">saving</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;saving_rate&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id11">
<h4>資本減耗率<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">saving</span></code>と同じ方法で資本減耗率の平均からなる<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を作成する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">depreciation</span> <span class="o">=</span> <span class="n">pwt</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;country&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;delta&#39;</span><span class="p">)</span>
<span class="n">depreciation</span> <span class="o">=</span> <span class="n">depreciation</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">depreciation</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(60, 110)
</pre></div>
</div>
</div>
</div>
<p>110ヵ国含まれている。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">depreciation</span> <span class="o">=</span> <span class="n">depreciation</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="s1">&#39;depreciation&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id12">
<h4>労働人口成長率<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h4>
<p>平均成長率を計算するには1960年と2019年の労働人口だけで計算できるが，上と同じ方法で計算してみる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">emp</span> <span class="o">=</span> <span class="n">pwt</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;country&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;emp&#39;</span><span class="p">)</span>
<span class="n">emp</span> <span class="o">=</span> <span class="n">emp</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">emp</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(60, 91)
</pre></div>
</div>
</div>
</div>
<p>91ヵ国しか含まれていない。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">emp_growth</span> <span class="o">=</span> <span class="p">(</span> <span class="p">(</span> <span class="n">emp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">2019</span><span class="p">,:]</span><span class="o">/</span><span class="n">emp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1960</span><span class="p">,:]</span> <span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2019</span><span class="o">-</span><span class="mi">1960</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">-</span><span class="mi">1</span> 
             <span class="p">)</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="s1">&#39;employment_growth&#39;</span><span class="p">)</span>
<span class="n">emp_growth</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>employment_growth</th>
    </tr>
    <tr>
      <th>country</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Algeria</th>
      <td>0.029604</td>
    </tr>
    <tr>
      <th>Argentina</th>
      <td>0.016698</td>
    </tr>
    <tr>
      <th>Australia</th>
      <td>0.019011</td>
    </tr>
    <tr>
      <th>Austria</th>
      <td>0.004671</td>
    </tr>
    <tr>
      <th>Bangladesh</th>
      <td>0.021903</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="gdp">
<h4>資本ストック対GDP比<a class="headerlink" href="#gdp" title="Permalink to this headline">¶</a></h4>
<p>2019年の<code class="docutils literal notranslate"><span class="pre">cgdpo</span></code>と<code class="docutils literal notranslate"><span class="pre">cn</span></code>を使って資本ストック対GDP比を含む<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を作成する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ky_ratio</span> <span class="o">=</span> <span class="n">pwt</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;year == 2019&#39;</span><span class="p">)</span> \
              <span class="o">.</span><span class="n">loc</span><span class="p">[:,[</span><span class="s1">&#39;country&#39;</span><span class="p">,</span><span class="s1">&#39;cgdpo&#39;</span><span class="p">,</span><span class="s1">&#39;cn&#39;</span><span class="p">]]</span> \
              <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;country&#39;</span><span class="p">)</span> \
              <span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">ky_ratio</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cgdpo</th>
      <th>cn</th>
    </tr>
    <tr>
      <th>country</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Aruba</th>
      <td>3466.241943</td>
      <td>1.845814e+04</td>
    </tr>
    <tr>
      <th>Angola</th>
      <td>223289.312500</td>
      <td>1.371321e+06</td>
    </tr>
    <tr>
      <th>Anguilla</th>
      <td>241.384537</td>
      <td>2.385742e+03</td>
    </tr>
    <tr>
      <th>Albania</th>
      <td>36288.328125</td>
      <td>2.298183e+05</td>
    </tr>
    <tr>
      <th>United Arab Emirates</th>
      <td>635332.812500</td>
      <td>4.510360e+06</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="admonition- admonition">
<p class="admonition-title">コードの説明</p>
<p><code class="docutils literal notranslate"><span class="pre">.set_index(''country')</span></code>を使って<code class="docutils literal notranslate"><span class="pre">country</span></code>を行ラベルに指定し，<code class="docutils literal notranslate"><span class="pre">.dropna()</span></code>によって欠損値がある行は削除する。</p>
</div>
<p>資本ストック対GDP比の列の作成しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ky_ratio</span><span class="p">[</span><span class="s1">&#39;ky_ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span> <span class="n">ky_ratio</span><span class="p">[</span><span class="s1">&#39;cn&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">ky_ratio</span><span class="p">[</span><span class="s1">&#39;cgdpo&#39;</span><span class="p">]</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>含まれる国数を確認する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ky_ratio</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(180, 3)
</pre></div>
</div>
</div>
</div>
<p>180ヵ国含まれており，<code class="docutils literal notranslate"><span class="pre">saving</span></code>や<code class="docutils literal notranslate"><span class="pre">depreciation</span></code>の国数よりも多くの国が含まれている。</p>
</div>
<div class="section" id="id13">
<h4>データの結合<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h4>
<p>上で作成した<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を結合する必要があり，そのための<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>のメソッド<code class="docutils literal notranslate"><span class="pre">.merge()</span></code>の使い方を説明する。<code class="docutils literal notranslate"><span class="pre">df_left</span></code>と<code class="docutils literal notranslate"><span class="pre">df_right</span></code>の２つの<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>があるとしよう。<code class="docutils literal notranslate"><span class="pre">df_left</span></code>を左の<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>，<code class="docutils literal notranslate"><span class="pre">df_right</span></code>を右の<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>と呼ぶことにする。<code class="docutils literal notranslate"><span class="pre">df_left</span></code>のメソッド<code class="docutils literal notranslate"><span class="pre">.merge()</span></code>を使い<code class="docutils literal notranslate"><span class="pre">df_right</span></code>と結合する場合，次のコードとなる。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_left</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_right</span><span class="p">)</span> 
</pre></div>
</div>
<p>しかし注意が必要な点が２つある。</p>
<ol class="simple">
<li><p>行数が同じでも<code class="docutils literal notranslate"><span class="pre">df_left</span></code>と<code class="docutils literal notranslate"><span class="pre">df_right</span></code>では行の並びが異なる可能性がある。</p></li>
<li><p>行数が異なる可能性がある。</p></li>
</ol>
<p>これらの問題に対応するためのる引数が用意されている。</p>
<p>まず１つ目の問題は，ある列を基準列もしくは行ラベルに合わせて行を並び替えることにより対応できる。例えば，上で作成した<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>であれば，行ラベルが<code class="docutils literal notranslate"><span class="pre">country</span></code>になっているので，それに合わせて結合すれば良い。その場合の引数を含めたコードは次の様になる。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_left</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_right</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
</pre></div>
</div>
<p>ここでの<code class="docutils literal notranslate"><span class="pre">left_index=True</span></code>と<code class="docutils literal notranslate"><span class="pre">right_index=True</span></code>は行ラベルを基準に結合することを指定しており，デフォルトは両方とも<code class="docutils literal notranslate"><span class="pre">False</span></code>である。行ラベルではなく，ある列を基準に結合した場合もあるだろう。その場合は次の引数を使う。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>df_left.merge(df_right,
              left_on=＜`df_left`の基準列のラベル（文字列）＞,
              right_on=＜`df_right`の基準列のラベル（文字列）＞) 
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">left_on</span></code>は基準列に使う左の<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>にある列ラベルを文字列で指定する。同様に<code class="docutils literal notranslate"><span class="pre">right_on</span></code>は基準列に使う右の<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>にある列ラベルを文字列で指定する。デフォルトは両方とも<code class="docutils literal notranslate"><span class="pre">None</span></code>となっている。</p>
<p>２つ目の問題は<code class="docutils literal notranslate"><span class="pre">how</span></code>という引数を使うことにより対処できる。使える値は次の４つであり，いずれも文字列で指定する。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'inner'</span></code>：<code class="docutils literal notranslate"><span class="pre">df_left</span></code>と<code class="docutils literal notranslate"><span class="pre">df_right</span></code>の両方の基準列にある共通の行だけを残す（デフォルト）。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'left'</span></code>：<code class="docutils literal notranslate"><span class="pre">df_left</span></code>の行は全て残し，<code class="docutils literal notranslate"><span class="pre">df_right</span></code>からはマッチする行だけが残り，対応する行がない場合は<code class="docutils literal notranslate"><span class="pre">NaN</span></code>が入る。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'right'</span></code>：<code class="docutils literal notranslate"><span class="pre">df_right</span></code>の行は全て残し，<code class="docutils literal notranslate"><span class="pre">df_left</span></code>からはマッチする行だけが残り，対応する行がない場合は<code class="docutils literal notranslate"><span class="pre">NaN</span></code>が入る。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'outer'</span></code>：<code class="docutils literal notranslate"><span class="pre">df_left</span></code>と<code class="docutils literal notranslate"><span class="pre">df_right</span></code>の両方の行を全て残し，マッチする行がない場合は<code class="docutils literal notranslate"><span class="pre">NaN</span></code>を入れる。</p></li>
</ul>
<p>では実際に上で作成した<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を結合しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">df_right</span> <span class="ow">in</span> <span class="p">[</span><span class="n">saving</span><span class="p">,</span> <span class="n">depreciation</span><span class="p">,</span> <span class="n">emp_growth</span><span class="p">]:</span>    <span class="c1"># 1</span>
    <span class="n">ky_ratio</span> <span class="o">=</span> <span class="n">ky_ratio</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_right</span><span class="p">,</span>         <span class="c1"># 2</span>
                              <span class="n">left_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># 3</span>
                              <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1"># 4</span>
                              <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>      <span class="c1"># 5</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition- admonition">
<p class="admonition-title">コードの説明</p>
<ol class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">df_right</span></code>が上の説明の<code class="docutils literal notranslate"><span class="pre">df_right</span></code>に対応している。<code class="docutils literal notranslate"><span class="pre">[saving,</span> <span class="pre">depreciation,</span> <span class="pre">emp_growth]</span></code>は上で作成した<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>のリスト。</p></li>
<li><p>右辺の<code class="docutils literal notranslate"><span class="pre">ky_ratio</span></code>が上の説明の<code class="docutils literal notranslate"><span class="pre">df_left</span></code>に対応している。右辺で結合した<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を左辺にある<code class="docutils literal notranslate"><span class="pre">ky_ratio</span></code>に割り当てている（上書き）。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ky_ratio</span></code>の行ラベルを基準とすることを指定する。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">df_right</span></code>の行ラベルを基準とすることを指定する。</p></li>
<li><p>ここでの<code class="docutils literal notranslate"><span class="pre">'outer'</span></code>は左右の<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>のそれぞれの行ラベルを残し，値がない箇所には<code class="docutils literal notranslate"><span class="pre">NaN</span></code>を入れることを指定する。</p></li>
</ol>
</div>
<p>結合の結果を表示してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ky_ratio</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cgdpo</th>
      <th>cn</th>
      <th>ky_ratio</th>
      <th>saving_rate</th>
      <th>depreciation</th>
      <th>employment_growth</th>
    </tr>
    <tr>
      <th>country</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Albania</th>
      <td>36288.328125</td>
      <td>2.298183e+05</td>
      <td>1.845793</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Algeria</th>
      <td>503848.312500</td>
      <td>2.487456e+06</td>
      <td>1.596740</td>
      <td>0.349476</td>
      <td>0.041103</td>
      <td>0.029604</td>
    </tr>
    <tr>
      <th>Angola</th>
      <td>223289.312500</td>
      <td>1.371321e+06</td>
      <td>1.815062</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Anguilla</th>
      <td>241.384537</td>
      <td>2.385742e+03</td>
      <td>2.290874</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Antigua and Barbuda</th>
      <td>1631.650513</td>
      <td>1.097573e+04</td>
      <td>1.906095</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>列AlbaniaやAngolaは<code class="docutils literal notranslate"><span class="pre">saving</span></code>，<code class="docutils literal notranslate"><span class="pre">depreciation</span></code>，<code class="docutils literal notranslate"><span class="pre">emp_growth</span></code>の<code class="docutils literal notranslate"><span class="pre">DataFram</span></code>には無いため<code class="docutils literal notranslate"><span class="pre">NaN</span></code>が入っている。</p>
<p>結合後の<code class="docutils literal notranslate"><span class="pre">ky_ratio</span></code>の情報を表示してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ky_ratio</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Index: 180 entries, Albania to Zimbabwe
Data columns (total 6 columns):
 #   Column             Non-Null Count  Dtype  
---  ------             --------------  -----  
 0   cgdpo              180 non-null    float64
 1   cn                 180 non-null    float64
 2   ky_ratio           180 non-null    float64
 3   saving_rate        111 non-null    float64
 4   depreciation       110 non-null    float64
 5   employment_growth  91 non-null     float64
dtypes: float64(6)
memory usage: 9.8+ KB
</pre></div>
</div>
</div>
</div>
<p>180ヵ国が含まれるが<code class="docutils literal notranslate"><span class="pre">NaN</span></code>がある国も多いことが分かる。</p>
</div>
</div>
<div class="section" id="id14">
<h3>トレンド線と散布図<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h3>
<p>ここでは次の３つをおこなう。</p>
<ul class="simple">
<li><p>資本ストック対GDP比と次の３つの変数の散布図の表示</p>
<ul>
<li><p>貯蓄率</p></li>
<li><p>資本減耗率</p></li>
<li><p>労働人口増加率</p></li>
</ul>
</li>
<li><p>回帰分析に基づいて計算したトレンド線の表示</p></li>
<li><p>トレンド線の傾きの統計的優位性の表示</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">for</span></code>ループを使ってこれらを同時に計算・表示する。まず<code class="docutils literal notranslate"><span class="pre">ky_ratio</span></code>の列ラベルをみると，回帰分析の説明変数に使う変数が最後の３つに並んでいる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ky_ratio</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;saving_rate&#39;, &#39;depreciation&#39;, &#39;employment_growth&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>これを使い<code class="docutils literal notranslate"><span class="pre">for</span></code>ループを組んでみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">ky_ratio</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]:</span>              <span class="c1"># 1</span>
    
    <span class="n">df_temp</span> <span class="o">=</span> <span class="n">ky_ratio</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>                  <span class="c1"># 2</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ky_ratio ~ </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>          <span class="c1"># 3</span>
                 <span class="n">data</span><span class="o">=</span><span class="n">df_temp</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>           <span class="c1"># 4</span>
    <span class="n">bhat</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>                       <span class="c1"># 5</span>
    <span class="n">pval</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">pvalues</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>                      <span class="c1"># 6</span>
    
    <span class="n">df_temp</span><span class="p">[</span><span class="s1">&#39;Trend&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">fittedvalues</span>        <span class="c1"># 7</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># 8</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="s1">&#39;ky_ratio&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_temp</span><span class="p">)</span>  <span class="c1"># 9</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="s1">&#39;Trend&#39;</span><span class="p">,</span>                      <span class="c1"># 10</span>
            <span class="n">data</span><span class="o">=</span><span class="n">df_temp</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Trend&#39;</span><span class="p">),</span> <span class="c1"># 11</span>
            <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>                             <span class="c1"># 12</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;トレンドの傾き：</span><span class="si">{</span><span class="n">bhat</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>  <span class="c1"># 13</span>
                 <span class="sa">f</span><span class="s1">&#39;p値：</span><span class="si">{</span><span class="n">pval</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>   <span class="c1"># 14</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;資本ストック対GDP比（対数）&#39;</span><span class="p">,</span>   <span class="c1"># 15</span>
                  <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>                     <span class="c1"># 16</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>           <span class="c1"># 17</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8_Solow_90_0.png" src="_images/8_Solow_90_0.png" />
<img alt="_images/8_Solow_90_1.png" src="_images/8_Solow_90_1.png" />
<img alt="_images/8_Solow_90_2.png" src="_images/8_Solow_90_2.png" />
</div>
</div>
<div class="admonition- admonition">
<p class="admonition-title">コードの説明</p>
<ol class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ky_ratio</span></code>の最後の３列のラベルに対して<code class="docutils literal notranslate"><span class="pre">for</span></code>ループを組んで，<code class="docutils literal notranslate"><span class="pre">var</span></code>はその列ラベルを指す。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ky_ratio</span></code>のコピーを作り<code class="docutils literal notranslate"><span class="pre">df_temp</span></code>に割り当てる。<code class="docutils literal notranslate"><span class="pre">.copy()</span></code>は実態としては別物のコピーを作成する。詳細は割愛するが<code class="docutils literal notranslate"><span class="pre">.copy()</span></code>がないと実態は同じで参照記号のみが異なることになり，予期しない結果につながることを防ぐために<code class="docutils literal notranslate"><span class="pre">.copy()</span></code>を使っている。</p></li>
<li><p>回帰分析をおこなっているが，<code class="docutils literal notranslate"><span class="pre">f-string</span></code>を使い回帰式の説明変数を指定している。また回帰分析の結果を<code class="docutils literal notranslate"><span class="pre">res</span></code>に割り当てている。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">data</span></code>で回帰分析のデータの指定をおこない，<code class="docutils literal notranslate"><span class="pre">.fit()</span></code>で自動計算！</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">res</span></code>の属性<code class="docutils literal notranslate"><span class="pre">.params</span></code>は推定値を２つ返すが，1番目に傾きの推定値が格納されているため<code class="docutils literal notranslate"><span class="pre">[1]</span></code>で抽出し，<code class="docutils literal notranslate"><span class="pre">bhat</span></code>に割り当てている。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">res</span></code>の属性<code class="docutils literal notranslate"><span class="pre">.pvalues</span></code>は<span class="math notranslate nohighlight">\(p\)</span>値を２つ返すが，1番目に傾きの<span class="math notranslate nohighlight">\(p\)</span>値が格納されているため<code class="docutils literal notranslate"><span class="pre">[1]</span></code>で抽出し，<code class="docutils literal notranslate"><span class="pre">pval</span></code>に割り当てている。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">res</span></code>の属性<code class="docutils literal notranslate"><span class="pre">fittedvalues</span></code>は予測値を返すが，それを新たな列（ラベルは<code class="docutils literal notranslate"><span class="pre">Trend</span></code>）として<code class="docutils literal notranslate"><span class="pre">df_temp</span></code>に追加している。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.subplots()</span></code>によるキャンバスを<code class="docutils literal notranslate"><span class="pre">fig</span></code>に，「軸」を<code class="docutils literal notranslate"><span class="pre">ax</span></code>に割り当てている。引数の<code class="docutils literal notranslate"><span class="pre">tight_layout=True</span></code>はスペースに余裕がある様に表示にするためであり，なくても構わない。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.scatter()</span></code>は散布図を描くメソッド。横軸は<code class="docutils literal notranslate"><span class="pre">var</span></code>，縦軸は<code class="docutils literal notranslate"><span class="pre">ky_ratio</span></code>とし，<code class="docutils literal notranslate"><span class="pre">df_temp</span></code>をデータとして使う。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.plot()</span></code>を使いトレンド線を描く。横軸は<code class="docutils literal notranslate"><span class="pre">var</span></code>，縦軸は<code class="docutils literal notranslate"><span class="pre">Trend</span></code>。</p></li>
<li><p>データには<code class="docutils literal notranslate"><span class="pre">df_temp</span></code>を使うが，メソッド<code class="docutils literal notranslate"><span class="pre">.sort_values('Trend')</span></code>で列<code class="docutils literal notranslate"><span class="pre">Trend</span></code>に従って昇順に並び替える。これはトレンド線が正確に表示されるために必要。</p></li>
<li><p>トレンド線の色を赤に指定する。</p></li>
<li><p>図のタイトルを設定する。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">f-string</span></code>を使い<code class="docutils literal notranslate"><span class="pre">bhat</span></code>の値を代入する。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">:.2f</span></code>は小数点第２位までの表示を指定。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">\n</span></code>は改行の意味。</p></li>
<li><p>行を変えるので<code class="docutils literal notranslate"><span class="pre">\n</span></code>の後に<code class="docutils literal notranslate"><span class="pre">'</span></code>が必要となる。</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">f-string</span></code>を使い<code class="docutils literal notranslate"><span class="pre">pval</span></code>の値を代入する。<code class="docutils literal notranslate"><span class="pre">:.3f</span></code>は小数点第３位までの表示を指定し，<code class="docutils literal notranslate"><span class="pre">size=20</span></code>はフォントの大きさの指定。</p></li>
<li><p>縦軸のラベルの設定。</p></li>
<li><p>フォントの大きさの指定。</p></li>
<li><p>横軸のラベルの設定であり，<code class="docutils literal notranslate"><span class="pre">f-string</span></code>を使い<code class="docutils literal notranslate"><span class="pre">var</span></code>の値を代入している。<code class="docutils literal notranslate"><span class="pre">size=20</span></code>はフォントの大きさの指定。</p></li>
</ol>
</div>
<p>３つの図からソロー・モデルの理論的予測はデータと整合性があることが確認できる。ここで注意する点が一つある。式<a class="reference internal" href="#equation-eq-8-kyratio">(38)</a>は因果関係を予測している。例えば，貯蓄率が高くなることにより長期的な一人
当たりGDPは増加する。一方，トレンド線は因果関係を示しているのではなく単なる相関関係を表している。ソロー・モデルの因果関係を計量経済学的に検討するにはさまざまな要因の検討が必要になり，本章の域を超える事になる。</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="7_DifferenceEq.html" title="previous page">差分方程式と経済分析</a>
    <a class='right-next' id="next-link" href="Pandas_plot.html" title="next page">Pandas：プロット</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By 春山 鉄源  Tetsugen HARUYAMA<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>