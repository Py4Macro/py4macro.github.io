

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>法則・曲線・増加率 &#8212; Pythonで学ぶマクロ経済学 (中級＋レベル)</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/myadmonitions.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-3FB0WMD39P"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-3FB0WMD39P');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '11_Macro_Variables';</script>
    <link rel="canonical" href="https://py4macro.github.io/11_Macro_Variables.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="定量的マクロ経済分析：Part 1" href="18_ADAS-1.html" />
    <link rel="prev" title="GDPと構成要素" href="10_Data_Fluctuation.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    <p class="title logo__title">Pythonで学ぶマクロ経済学 (中級＋レベル)</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Pythonの学習</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://py4basics.github.io">経済学のためのPython入門</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">長期分析</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="5a_Development_Accounting.html">発展会計</a></li>
<li class="toctree-l1"><a class="reference internal" href="5b_Growth_Accounting.html">成長会計</a></li>
<li class="toctree-l1"><a class="reference internal" href="6_Regression.html">回帰分析</a></li>
<li class="toctree-l1"><a class="reference internal" href="7_DifferenceEq.html">差分方程式と経済分析</a></li>
<li class="toctree-l1"><a class="reference internal" href="8_Solow.html">ソロー・モデル</a></li>
<li class="toctree-l1"><a class="reference internal" href="9_Convergence.html">所得分布と所得収斂</a></li>
<li class="toctree-l1"><a class="reference internal" href="19_PPP.html">一物一価と購買力平価</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">短期分析I</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="10_Data_Fluctuation.html">GDPと構成要素</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">法則・曲線・増加率</a></li>
<li class="toctree-l1"><a class="reference internal" href="18_ADAS-1.html">定量的マクロ経済分析：Part 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="18_ADAS-2.html">定量的マクロ経済分析：Part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="12_IS-MP-PC.html">IS-MP-PCモデル</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">短期分析II</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="13_random_TFP.html">ランダム変数と全要素生産性</a></li>
<li class="toctree-l1"><a class="reference internal" href="14_linearsolve.html"><code class="docutils literal notranslate"><span class="pre">linearsolve</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="15_RBC.html">実物的景気循環(RBC)モデル</a></li>
<li class="toctree-l1"><a class="reference internal" href="16_data_on_money.html">古典派の二分法と金融政策</a></li>
<li class="toctree-l1"><a class="reference internal" href="Plan.html">今後の計画</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">参考</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://py4basics.github.io/Gapminder.html">Gapminder</a></li>
<li class="toctree-l1"><a class="reference external" href="https://py4etrics.github.io">Pythonで学ぶ入門計量経済学</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/Py4Macro/py4macro.github.io/source?urlpath=tree/11_Macro_Variables.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/Py4Macro/py4macro.github.io/blob/source/11_Macro_Variables.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>



<a href="https://github.com/Py4Macro/py4macro.github.io" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/11_Macro_Variables.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>法則・曲線・増加率</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">はじめに</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">オークンの法則</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">説明</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sec-11-unemployment">失業率の特徴</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">回帰分析</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">フィリップス曲線</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">説明</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">インフレ率の特徴</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">フラット化するフィリップス曲線</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">インフレ率とマネーストックの増加率</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">説明</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">日本の時系列データ</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">説明</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#resample"><code class="docutils literal notranslate"><span class="pre">resample()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">データの作成</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">散布図とトレンド線</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">世界経済のパネルデータ</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">説明</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">変化率の計算</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">ハイパーインフレ</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">プロット</a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1>法則・曲線・増加率<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h1>
<div name="html-admonition" style="font-size: 0.8em">
<input type="button" onclick="location.href='https://translate.google.com/translate?hl=&sl=ja&tl=en&u='+window.location;" value="Google translation" style="color:#ffffff;background-color:#008080; height:25px" onmouseover="this.style.background='#99ccff'" onmouseout="this.style.background='#008080'"/> in English or the language of your choice.
</div><br><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">japanize_matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">py4macro</span>
<span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">see</span> <span class="kn">import</span> <span class="n">see</span>
</pre></div>
</div>
</div>
</div>
<section id="id2">
<h2>はじめに<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h2>
<p>前章では経済のデータを人の「言動」に例えて説明したが，その比喩をもう少し考えてみよう。「言動」にはパターンがあり，その人の心を映し出しているとも考えられる。例えば，心の優しい人は電車やバスで重い荷物を持つ老人や小さな子を持つ女性に席を譲る回数が多いかも知れない。「あの子が好きだ！」とは決して口に出さない男の子でも，その思いを示唆するような発言や行動があるかも知れない。同じように，経済の「真のメカニズム」の反映としてデータには何らかのパターンが現れる。そのパターンを見つけることに経済学者は時間を割いてきたし，見出したパターンの中には経済を理解する上で非常に重要なヒント隠されている場合がある。ここでは代表的な次のデータのパターンを考える。</p>
<ul class="simple">
<li><p>オークンの法則</p></li>
<li><p>フィリップス曲線</p></li>
<li><p>マネー・ストックの増加率とインフレーションの関係</p></li>
</ul>
<p>マクロ経済学を勉強した人にとっては必ずと言っていいほど，知名度が高いデータのパターンではないだろうか。これらから「真のメカニズム」の動きが垣間見える事になる。</p>
<p>一方で「真のメカニズム」は不変ではないかも知れない。経済は人が営む活動であり，人が変われば「真のメカニズム」も影響を受けると考えられる。技術進歩（例えば，ビットコイン）や価値観の変化（例えば，「昭和の価値観」から「平成・令和の価値観」への移り変わり），政府・日銀の政策やコロナ禍などの大きなショックは人の行動の変化に影響すると考えるのが自然である。例えば，2020年代の「真のメカニズム」は1970年代のそれとは異なる可能性を拭えない。データを見る際は，そのような変化がないかを注意深く見ることも重要になるだろう。</p>
</section>
<section id="id3">
<h2>オークンの法則<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h2>
<section id="id4">
<h3>説明<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h3>
<p>この節で使用する記号：</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(Y_t\)</span>：GDP</p></li>
<li><p><span class="math notranslate nohighlight">\(\bar{Y}_t\)</span>：産出量の自然率水準（もしくは長期的GDP、潜在的GDP）</p></li>
<li><p><span class="math notranslate nohighlight">\(u_t\)</span>：失業率</p></li>
<li><p><span class="math notranslate nohighlight">\(\bar{u}_t\)</span>：自然失業率（もしくは長期的失業率）</p></li>
</ul>
<p>オークンの法則は経験則として次の関係を表す。</p>
<div class="math notranslate nohighlight" id="equation-eq-11-okun">
<span class="eqno">(107)<a class="headerlink" href="#equation-eq-11-okun" title="Permalink to this equation">#</a></span>\[
\frac{Y_t-\bar{Y}_t}{\bar{Y}_t}=-b\left( u_t-\bar{u}_t\right),\quad b&gt;0
\]</div>
<p>左辺はGDPの自然率水準からの乖離率（自然率水準を何％上回るかを示す）であり，右辺は失業率の自然率からの乖離（自然失業率を何％ポイント上回るかを示す）である。即ち，GDPと失業率の長期的な値からの乖離には負の関係が存在することを意味している。労働者が生産投入といこと考えると，直感的にも受け入れ易い関係ではないだろうか。では失業率の乖離が1%ポイント上昇するとGDPの乖離率は何%減少するのだろうか。この問いについては，データを使いパラメータ<code class="docutils literal notranslate"><span class="pre">b</span></code>を推定する必要がる。難しい点は、<span class="math notranslate nohighlight">\(\bar{Y}_t\)</span>と<span class="math notranslate nohighlight">\(\bar{u}_t\)</span>が観測されないため推定する必要があることである。この点を回避するために、オークンの法則を変数の変化で表す場合もあるが、ここでは上の式を考える。<span class="math notranslate nohighlight">\(\bar{Y}_t\)</span>と<span class="math notranslate nohighlight">\(\bar{u}_t\)</span>の推定には様々な洗練された手法があるが、ここでは簡便的にHodrick–Prescottフィルターを使って計算したトレンドを<span class="math notranslate nohighlight">\(\bar{Y}\)</span>と<span class="math notranslate nohighlight">\(\bar{u}\)</span>とし，トレンドからの乖離を上の式の左辺と右辺に使う。</p>
<p>以前使ったデータを使うが，次の節でインフレ率について扱うので３つの変数<code class="docutils literal notranslate"><span class="pre">gdp</span></code>，<code class="docutils literal notranslate"><span class="pre">unemployment_rate</span></code>，<code class="docutils literal notranslate"><span class="pre">inflation</span></code>を読み込むことにする。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">py4macro</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;jpn-q&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,[</span><span class="s1">&#39;gdp&#39;</span><span class="p">,</span><span class="s1">&#39;unemployment_rate&#39;</span><span class="p">,</span><span class="s1">&#39;inflation&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
DatetimeIndex: 168 entries, 1980-03-31 to 2021-12-31
Data columns (total 3 columns):
 #   Column             Non-Null Count  Dtype  
---  ------             --------------  -----  
 0   gdp                168 non-null    float64
 1   unemployment_rate  168 non-null    float64
 2   inflation          168 non-null    float64
dtypes: float64(3)
memory usage: 5.2 KB
</pre></div>
</div>
</div>
</div>
</section>
<section id="sec-11-unemployment">
<span id="id5"></span><h3>失業率の特徴<a class="headerlink" href="#sec-11-unemployment" title="Permalink to this heading">#</a></h3>
<p>ここでは失業率の特徴を考える。まず図示してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;unemployment_rate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/36cd57077c72e80dd3a5525b8a16c6ac63124ddde35a9a598c1a1722f6652822.png" src="_images/36cd57077c72e80dd3a5525b8a16c6ac63124ddde35a9a598c1a1722f6652822.png" />
</div>
</div>
<p>最初に気づく点は，<a class="reference internal" href="10_Data_Fluctuation.html#chap-10-gdp"><span class="std std-ref">前章</span></a>で説明した持続性（変化が正（もしくは負）であれば正（もしくは負）の期間が続く傾向にある特徴）が高いとことである。実際，メソッド<code class="docutils literal notranslate"><span class="pre">.autocorr()</span></code>を使い自己相関係数を計算すると非常に高い値が返される。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;unemployment_rate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">autocorr</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9919258402544141
</pre></div>
</div>
</div>
</div>
<p>次に，GDPのトレンドからの乖離（％）と失業率のトレンドからの乖離（％ポイント）を比べてみる。まず失業に関する変数を作成するが，対数を取らずに差分をトレンドからの乖離とする。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;u_rate_trend&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">py4macro</span><span class="o">.</span><span class="n">trend</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;unemployment_rate&#39;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;u_rate_cycle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;unemployment_rate&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;u_rate_trend&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>ここで作成した変数は次の変数を表している。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">unemployment_rate_cycle</span></code>：<span class="math notranslate nohighlight">\(u_t-\bar{u}_t\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\bar{u}_t\)</span>：トレンド失業率</p></li>
</ul>
<p>次にGDPのトレンドからの乖離率を計算しよう。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">gdp_cycle</span></code>：<span class="math notranslate nohighlight">\(\dfrac{Y_t}{\bar{Y}_t}-1
              \approx
              \log\left(\dfrac{Y_t}{\bar{Y}_t}\right)
              =\log(Y_t) - \log(\bar{Y}_t)
              \)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\bar{Y}_t\)</span>：トレンドGDP</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;gdp_cycle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span><span class="p">(</span> 
                       <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;gdp&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="n">py4macro</span><span class="o">.</span><span class="n">trend</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;gdp&#39;</span><span class="p">])</span> <span class="p">)</span>
                      <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>GDPの乖離と重ねて動きを確認してみる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,[</span><span class="s1">&#39;u_rate_cycle&#39;</span><span class="p">,</span><span class="s1">&#39;gdp_cycle&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">secondary_y</span><span class="o">=</span><span class="s1">&#39;u_rate_cycle&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ff0936d828f21caca0fceb879f992797a95a2e34339a6460a02da3980c004b86.png" src="_images/ff0936d828f21caca0fceb879f992797a95a2e34339a6460a02da3980c004b86.png" />
</div>
</div>
<p>概ね逆方向に上下していることがわかる。またバブル景気の崩壊後やリーマン・ショック後に，２変数は逆方向に大きく動いていることも確認できる。相関度を確かめるために，<code class="docutils literal notranslate"><span class="pre">df</span></code>のメソッド<code class="docutils literal notranslate"><span class="pre">corr()</span></code>を使い相関係数を計算しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,[</span><span class="s1">&#39;u_rate_cycle&#39;</span><span class="p">,</span><span class="s1">&#39;gdp_cycle&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>u_rate_cycle</th>
      <th>gdp_cycle</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>u_rate_cycle</th>
      <td>1.000000</td>
      <td>-0.627466</td>
    </tr>
    <tr>
      <th>gdp_cycle</th>
      <td>-0.627466</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>右上と左下の値が２変数の相関係数であり，値は約<code class="docutils literal notranslate"><span class="pre">-0.63</span></code>は強い逆相関を意味する。</p>
<p>また上の図から持続性が高いことが伺える。自己相関係数を計算してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;gdp_cycle&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">autocorr</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.680888809545929
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;u_rate_cycle&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">autocorr</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.876025030648204
</pre></div>
</div>
</div>
</div>
<p>両変数ともトレンドからの乖離は持続性が非常に高いと言える。</p>
</section>
<section id="id6">
<h3>回帰分析<a class="headerlink" href="#id6" title="Permalink to this heading">#</a></h3>
<p>では実際に式<a class="reference internal" href="#equation-eq-11-okun">(107)</a>のスロープ変数<span class="math notranslate nohighlight">\(b\)</span>を推定してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">formula</span> <span class="o">=</span> <span class="s1">&#39;gdp_cycle ~ u_rate_cycle&#39;</span>   <span class="c1"># 1</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>       <span class="c1"># 2</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>                   <span class="c1"># 3</span>
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<ol class="arabic simple">
<li><p>回帰式を文字列で作成し変数<code class="docutils literal notranslate"><span class="pre">formula</span></code>に割り当てる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sm</span></code>の関数<code class="docutils literal notranslate"><span class="pre">.ols</span></code>を使い最小二乗法の準備をし，変数<code class="docutils literal notranslate"><span class="pre">model</span></code>に割り当てる。</p>
<ul class="simple">
<li><p>引数は(1)の<code class="docutils literal notranslate"><span class="pre">formula</span></code>と<code class="docutils literal notranslate"><span class="pre">data</span></code>に使用する<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>（ここでは<code class="docutils literal notranslate"><span class="pre">df_okun</span></code>）を指定する。</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">model</span></code>のメソッド<code class="docutils literal notranslate"><span class="pre">.fit()</span></code>を使い自動計算し，その結果を<code class="docutils literal notranslate"><span class="pre">result</span></code>に割り当てる。</p></li>
</ol>
</div>
<p><code class="docutils literal notranslate"><span class="pre">result</span></code>のメソッド<code class="docutils literal notranslate"><span class="pre">.summary()</span></code>を使い結果を表として表示しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:              gdp_cycle   R-squared:                       0.394
Model:                            OLS   Adj. R-squared:                  0.390
Method:                 Least Squares   F-statistic:                     107.8
Date:                Tue, 11 Jul 2023   Prob (F-statistic):           8.95e-20
Time:                        09:28:59   Log-Likelihood:                -261.32
No. Observations:                 168   AIC:                             526.6
Df Residuals:                     166   BIC:                             532.9
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
================================================================================
                   coef    std err          t      P&gt;|t|      [0.025      0.975]
--------------------------------------------------------------------------------
Intercept     3.854e-11      0.089   4.33e-10      1.000      -0.176       0.176
u_rate_cycle    -4.0106      0.386    -10.383      0.000      -4.773      -3.248
==============================================================================
Omnibus:                      104.252   Durbin-Watson:                   1.095
Prob(Omnibus):                  0.000   Jarque-Bera (JB):              989.767
Skew:                          -2.099   Prob(JB):                    1.19e-215
Kurtosis:                      14.125   Cond. No.                         4.34
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
</div>
</div>
<p>表の中段から次のことがわかる。</p>
<ul class="simple">
<li><p>定数項の推定値は非常に小さい。即ち、失業率の乖離がゼロある場合、GDPの乖離率もぜろになることを示しており、定数項がない式<a class="reference internal" href="#equation-eq-11-okun">(107)</a>と整合的であることわかる。</p></li>
<li><p>パラメータ<code class="docutils literal notranslate"><span class="pre">b</span></code>の推定値は負の値となっていおり、失業率が自然失業率を上回るとGDP乖離率は減少することが確認できる。</p></li>
</ul>
<p>＜コメント＞</p>
<ul class="simple">
<li><p>Durbin-Watson比は誤差項に正の自己相関が疑われことを示しており，<span class="math notranslate nohighlight">\(t\)</span>検定の解釈には注意が必要となるが，この点ついての議論は割愛する。</p></li>
</ul>
<p>回帰分析の結果を踏まえると，失業率の乖離が<code class="docutils literal notranslate"><span class="pre">x</span></code>％ポイントの場合にGDPのトレンドからの乖離率（％）を計算する関数は次のようになる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">growth_deviation</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">result</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;失業率の乖離が</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">％ポイントの場合のGDPのトレンドからの乖離率は約</span><span class="si">{</span><span class="n">g</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">です。&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">x</span></code>が１％ポイントの場合を考えよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">growth_deviation</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>失業率の乖離が1.0％ポイントの場合のGDPのトレンドからの乖離率は約-4.01です。
</pre></div>
</div>
</div>
</div>
<p>この値を解釈してみよう。失業率が1％ポイント乖離するとしよう。GDPの乖離率は約<code class="docutils literal notranslate"><span class="pre">-4.1</span></code>％になることを示しているが、この値は非常に大きい。例えば、上のプロットで示したGDPのトレンドからの乖離率を考えてみよう。バブル崩壊時の乖離率は約<code class="docutils literal notranslate"><span class="pre">2.6</span></code>％，リーマン・ショック時では約<code class="docutils literal notranslate"><span class="pre">6</span></code>％，コロナ禍では<code class="docutils literal notranslate"><span class="pre">7.7</span></code>％である。これは日本の雇用制度を反映していると考えられる。またトレンドを計算する際に使ったHodrick–Prescottフィルターの影響もあるだろう。</p>
<p>次に、標本の散布図に回帰直線を重ねて表示してみる。まず<code class="docutils literal notranslate"><span class="pre">result</span></code>の属性<code class="docutils literal notranslate"><span class="pre">.fittedvalues</span></code>を使い非説明変数の予測値を抽出することができるので、<code class="docutils literal notranslate"><span class="pre">df</span></code>に<code class="docutils literal notranslate"><span class="pre">fitted</span></code>のラベルを使って新たな列として追加する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;fitted_okun&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">fittedvalues</span>
</pre></div>
</div>
</div>
</div>
<p>図を重ねて表示する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax_</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;u_rate_cycle&#39;</span><span class="p">,</span>
              <span class="n">y</span><span class="o">=</span><span class="s1">&#39;gdp_cycle&#39;</span><span class="p">,</span>
              <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;u_rate_cycle&#39;</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="s1">&#39;fitted_okun&#39;</span><span class="p">,</span>
        <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;line&#39;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax_</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/842142f0f540920df48bc9274db9d559105f86f6ceed904b521f427f084c532d.png" src="_images/842142f0f540920df48bc9274db9d559105f86f6ceed904b521f427f084c532d.png" />
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>係数の推定値は、<code class="docutils literal notranslate"><span class="pre">result</span></code>の属性<code class="docutils literal notranslate"><span class="pre">params</span></code>でアクセスできることを説明したが、この値を使い次のコードで<code class="docutils literal notranslate"><span class="pre">gdp_cycle</span></code>の予測値を計算することも可能である。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ahat</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">bhat</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;fitted&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ahat</span> <span class="o">+</span> <span class="n">bhat</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;u_rate_cycle&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>プロットの下中央にある２点がリーマン・ショックとコロナ禍によるGDPの乖離率である。この２点に関連して次のことが言える。GDPの乖離率の観点から考えると，２つのショックは「外れ値」的な存在であり，大きなショックだったことがうかがえる。一方，2つのショックに伴う失業率の乖離は大きくなく，<code class="docutils literal notranslate"><span class="pre">0</span></code>に近い値となっている。これはGDPに対するショックが，失業率に影響を及ぼすには時間的なラグが発生することの反映であろう。その結果，回帰直線の傾きに対する影響は限定的だと言える（例えば，失業率の乖離が<code class="docutils literal notranslate"><span class="pre">0.8</span></code>近傍であれば，傾きは絶対値でより大きな値となっていただろう）。従って，傾きが約<code class="docutils literal notranslate"><span class="pre">-4.1</span></code>という結果は，数少ない大きなショックによって大きく影響を受けたものではないとして理解して良いだろう。</p>
</section>
</section>
<section id="id7">
<h2>フィリップス曲線<a class="headerlink" href="#id7" title="Permalink to this heading">#</a></h2>
<section id="id8">
<h3>説明<a class="headerlink" href="#id8" title="Permalink to this heading">#</a></h3>
<p>マクロ経済学を学んだ人にとって最も馴染み深い関係の一つがフィリップス曲線（PC曲線）ではないだろうか。失業率とインフレ率の関係を示すが，典型的なPC曲線は次式で与えられる。</p>
<div class="math notranslate nohighlight" id="equation-eq-11-phillips">
<span class="eqno">(108)<a class="headerlink" href="#equation-eq-11-phillips" title="Permalink to this equation">#</a></span>\[
\pi_t=\text{E}\pi_t-b(u_t-\bar{u})+v,\quad b&gt;0
\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\pi_t\)</span>：インフレ率</p></li>
<li><p><span class="math notranslate nohighlight">\(\text{E}\pi_t\)</span>：期待インフレ率</p></li>
<li><p><span class="math notranslate nohighlight">\(u_t\)</span>：失業率</p></li>
<li><p><span class="math notranslate nohighlight">\(\bar{u}\)</span>：自然失業率（長期的な失業率）</p></li>
<li><p><span class="math notranslate nohighlight">\(v\)</span>：供給サイドのショック</p></li>
</ul>
<p>通常，式<a class="reference internal" href="#equation-eq-11-phillips">(108)</a>では分析の簡単化のために自然失業率<span class="math notranslate nohighlight">\(\bar{u}\)</span>はトレンドであり一定と仮定され，その周辺を経済が変動すると考える。</p>
<p>失業率の特徴については<a class="reference internal" href="#sec-11-unemployment"><span class="std std-ref">「失業率の特徴」</span></a>の節で議論したので，以下では式<a class="reference internal" href="#equation-eq-11-phillips">(108)</a>の左辺にあるインフレ率について考えることにする。</p>
</section>
<section id="id9">
<h3>インフレ率の特徴<a class="headerlink" href="#id9" title="Permalink to this heading">#</a></h3>
<p>上で使用した<code class="docutils literal notranslate"><span class="pre">df</span></code>に<code class="docutils literal notranslate"><span class="pre">inflation</span></code>が含まれているので図示してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,[</span><span class="s1">&#39;inflation&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/996315d3236f9e89bd93e75a4f55e0ff984a91a8ae7292cd62a019c41e374408.png" src="_images/996315d3236f9e89bd93e75a4f55e0ff984a91a8ae7292cd62a019c41e374408.png" />
</div>
</div>
<p>上下しているのが，過去約35年間は非常に安定している。図から持続性が強いことがわかるが，実際に計算してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;inflation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">autocorr</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9486542725385126
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">0.949</span></code>は非常に高い持続性を意味しており，インフレが増加すると持続傾向にあることがわかる。次にトレンドからの乖離（％ポイント）を計算し，GDPのトレンドからの乖離と重ねて図示してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;inflation_trend&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">py4macro</span><span class="o">.</span><span class="n">trend</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;inflation&#39;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;inflation_cycle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;inflation&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;inflation_trend&#39;</span><span class="p">]</span>

<span class="n">df</span><span class="p">[[</span><span class="s1">&#39;gdp_cycle&#39;</span><span class="p">,</span><span class="s1">&#39;inflation_cycle&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7a3a87ae1cb47c86a3d383d6cb691981bf376ae35ba9bf449f2aa0e5969fbf3a.png" src="_images/7a3a87ae1cb47c86a3d383d6cb691981bf376ae35ba9bf449f2aa0e5969fbf3a.png" />
</div>
</div>
<p>同じ方向に動く傾向が確認できる。相関係数を計算してみる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;inflation_cycle&#39;</span><span class="p">,</span><span class="s1">&#39;gdp_cycle&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>inflation_cycle</th>
      <th>gdp_cycle</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>inflation_cycle</th>
      <td>1.000000</td>
      <td>0.308714</td>
    </tr>
    <tr>
      <th>gdp_cycle</th>
      <td>0.308714</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>絶対値でみると失業程ではないが，正の相関性があることが確認できる。この結果から，インフレ率と失業率の負の相関が予測される。次に、自己相関係数を確認する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;inflation_cycle&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">autocorr</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7771024330909484
</pre></div>
</div>
</div>
</div>
<p>トレンドからの乖離も強い持続性があることを示している。</p>
</section>
<section id="id10">
<h3>フラット化するフィリップス曲線<a class="headerlink" href="#id10" title="Permalink to this heading">#</a></h3>
<p>まずインフレ率と失業率の散布図をプロットしよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;unemployment_rate&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;inflation&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b3fec1bc1766c8cd014326e76dbe440121c36eb8e2e8cdaa832633285d99fa1d.png" src="_images/b3fec1bc1766c8cd014326e76dbe440121c36eb8e2e8cdaa832633285d99fa1d.png" />
</div>
</div>
<p>右下がりであり式<a class="reference internal" href="#equation-eq-11-phillips">(108)</a>と整合的にみえる。上の散布図に１つの曲線を描いてそれをPC曲線と呼ぶこともできるだろう。一方で，次の問題を考えてみよう。</p>
<ol class="arabic simple">
<li><p>過去40年間，フィリプス曲線は変化した可能性はないのか。即ち，真のメカニズムが変わりながら生成されたデータが表示されているのではないか，という問題である。</p></li>
<li><p>式<a class="reference internal" href="#equation-eq-11-phillips">(108)</a>には期待インフレ率がり，また供給サイドのショックもあり得る（例えば，コロナ禍）。それらをどう考えるかという問題がある。</p></li>
</ol>
<p>第二の問題を扱うことはこのサイトの範囲を超えるので，ここでは扱わず議論を進めることにする。以下では第一の問題を考察してみよう。</p>
<p>景気循環のマクロ経済学での短期は何ヶ月または何年以下で，長期は何年以上なのだろうか。実は，曖昧で学者・学派によって見解が別れる事になる。ここでは10年間は長期に入ると考えることにする（多くの経済学者は同意するだろう）。この考えに基づき，10年毎のデータを検討しPC曲線に変化があるかどうかを確かめることにする。</p>
<p>まず10年毎のデータを使うために，次のコードを使い新たな列<code class="docutils literal notranslate"><span class="pre">decade</span></code>を<code class="docutils literal notranslate"><span class="pre">df</span></code>に追加しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;decade&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span> <span class="o">//</span> <span class="mi">10</span> <span class="o">*</span> <span class="mi">10</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;decade&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1980-03-31    1980
1980-06-30    1980
1980-09-30    1980
1980-12-31    1980
1981-03-31    1980
              ... 
2020-12-31    2020
2021-03-31    2020
2021-06-30    2020
2021-09-30    2020
2021-12-31    2020
Name: decade, Length: 168, dtype: int32
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<p><code class="docutils literal notranslate"><span class="pre">df.index</span></code>は行ラベルを抽出するが，その属性<code class="docutils literal notranslate"><span class="pre">.year</span></code>は行ラベルから年だけを抽出する。年を切り捨て除算演算子<code class="docutils literal notranslate"><span class="pre">//</span></code>を使い次の様に変換する</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1980 →　198
1981 →　198
1982 →　198
...
</pre></div>
</div>
<p>更に，それぞれの数字を<code class="docutils literal notranslate"><span class="pre">*10</span></code>により<code class="docutils literal notranslate"><span class="pre">10</span></code>倍することにより，次のような変換となる。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1980 →　1980
1981 →　1980
1982 →　1980
...
</pre></div>
</div>
<p>それを新たな列<code class="docutils literal notranslate"><span class="pre">decade</span></code>に割り当てている。</p>
</div>
<p>新たな列と<code class="docutils literal notranslate"><span class="pre">for</span></code>ループを使い，式<a class="reference internal" href="#equation-eq-11-phillips">(108)</a>の係数<span class="math notranslate nohighlight">\(a\)</span>と<span class="math notranslate nohighlight">\(b\)</span>を推定してみよう。大きな差が無ければ，フィリップス曲線は概ね一定だと考えることができる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">decade_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1980</span><span class="p">,</span> <span class="mi">2011</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="p">)</span>       <span class="c1">#1</span>

<span class="n">a_list</span> <span class="o">=</span> <span class="p">[]</span>   <span class="c1">#2</span>
<span class="n">b_list</span> <span class="o">=</span> <span class="p">[]</span>   <span class="c1">#3</span>

<span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">decade_list</span><span class="p">:</span>                             <span class="c1">#4</span>
    <span class="n">cond</span> <span class="o">=</span> <span class="p">(</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;decade&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">d</span> <span class="p">)</span>                  <span class="c1">#5</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;inflation ~ unemployment_rate&#39;</span><span class="p">,</span> <span class="c1">#6</span>
                 <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,:])</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>       <span class="c1">#7</span>
    
    <span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s1">年代データ&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">fittedvalues</span>          <span class="c1">#8</span>
    <span class="n">a_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>                  <span class="c1">#9</span>
    <span class="n">b_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>                  <span class="c1">#10</span>
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">#1</span></code>：<code class="docutils literal notranslate"><span class="pre">1980</span></code>，<code class="docutils literal notranslate"><span class="pre">1990</span></code>，<code class="docutils literal notranslate"><span class="pre">2000</span></code>，<code class="docutils literal notranslate"><span class="pre">2010</span></code>の4つの要素からなるリストを<code class="docutils literal notranslate"><span class="pre">decade_list</span></code>に割り当てる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#2</span></code>：定数項の推定値を格納する空のリスト。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#3</span></code>：スロープ係数の推定値を格納する空のリスト。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#4</span></code>：<code class="docutils literal notranslate"><span class="pre">decade_list</span></code>を使い<code class="docutils literal notranslate"><span class="pre">for</span></code>ループを開始。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#5</span></code>：列<code class="docutils literal notranslate"><span class="pre">decade</span></code>が<code class="docutils literal notranslate"><span class="pre">d</span></code>と等しい行のみが<code class="docutils literal notranslate"><span class="pre">True</span></code>になる条件を<code class="docutils literal notranslate"><span class="pre">cond</span></code>に割り当てる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#6</span></code>：OLS推定の結果を<code class="docutils literal notranslate"><span class="pre">res</span></code>に割り当てる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#7</span></code>：OLS推定に使用する<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を指定するが，<code class="docutils literal notranslate"><span class="pre">.loc[cond,:]</span></code>を使い10年間だけのデータを抽出する。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#8</span></code>：<code class="docutils literal notranslate"><span class="pre">res.fittedvalues</span></code>はOLSの予測値だが，新たな列として<code class="docutils literal notranslate"><span class="pre">df</span></code>に追加している。</p>
<ul>
<li><p>列ラベルとして<code class="docutils literal notranslate"><span class="pre">1980年代データ</span></code>のように設定しており，下でプロットする際の凡例に使うためである。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">f-string</span></code>を使うために<code class="docutils literal notranslate"><span class="pre">f</span></code>を置き<code class="docutils literal notranslate"><span class="pre">{}</span></code>の中に文字列を代入している。</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">#9</span></code>：<code class="docutils literal notranslate"><span class="pre">res.params</span></code>はOLS推定値の<code class="docutils literal notranslate"><span class="pre">Series</span></code>を返すので，その0番目の要素（定数項）を<code class="docutils literal notranslate"><span class="pre">a_list</span></code>に追加している。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#10</span></code>：<code class="docutils literal notranslate"><span class="pre">res.params</span></code>はOLS推定値の<code class="docutils literal notranslate"><span class="pre">Series</span></code>を返すので，その1番目の要素（スロープ係数）を<code class="docutils literal notranslate"><span class="pre">b_list</span></code>に追加している。</p></li>
</ul>
</div>
<p>結果を<code class="docutils literal notranslate"><span class="pre">print</span></code>関数を使い表示する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--- 定数項の推定値 -------------</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">decade_list</span><span class="p">,</span> <span class="n">a_list</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s1">年代：</span><span class="si">{</span><span class="n">a</span><span class="si">:</span><span class="s1">&gt;5.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    
    
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">--- スロープ係数の推定値 --------</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">decade_list</span><span class="p">,</span> <span class="n">b_list</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s1">年代：</span><span class="si">{</span><span class="n">b</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- 定数項の推定値 -------------

1980年代：18.58
1990年代： 4.37
2000年代： 4.58
2010年代： 2.11

--- スロープ係数の推定値 --------

1980年代：-6.43
1990年代：-1.04
2000年代：-1.03
2010年代：-0.48
</pre></div>
</div>
</div>
</div>
<p>定数項の推定値もスロープ係数の推定値も変化が大きく，特に1980年代の値とそれ以降の値の差が顕著である。傾きが緩やかになっているので，PC曲線のフラット化（需給ギャップに対してのインフレ率の弾性値の低下）と呼ばれている。研究では，日本だけではなく欧米でもPC曲線のフラット化が指摘されている。プロットして確認してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">color_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">]</span> <span class="c1"># 1</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">decade_list</span><span class="p">,</span> <span class="n">color_list</span><span class="p">):</span>
    
    <span class="n">cond</span> <span class="o">=</span> <span class="p">(</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;decade&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">d</span> <span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="s1">&#39;unemployment_rate&#39;</span><span class="p">,</span>
               <span class="s1">&#39;inflation&#39;</span><span class="p">,</span>
               <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,:],</span>
               <span class="n">edgecolor</span><span class="o">=</span><span class="n">c</span><span class="p">,</span>                    <span class="c1"># 2</span>
               <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span>              <span class="c1"># 3</span>
               <span class="n">label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;unemployment_rate&#39;</span><span class="p">,</span>
           <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s1">年代データ&#39;</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,:]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s1">年代データ&#39;</span><span class="p">),</span>
            <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span>                           <span class="c1"># 4</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span>                        <span class="c1"># 5</span>
            <span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;フラット化するフィリップス曲線&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;失業率&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;インフレ率&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6a84b3d660ebe840d63a327b288a2dccca167d3b90d5c032c50586363f94b0ef.png" src="_images/6a84b3d660ebe840d63a327b288a2dccca167d3b90d5c032c50586363f94b0ef.png" />
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<ol class="arabic simple">
<li><p>色のリスト</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">['orange','k',</span> <span class="pre">'b',</span> <span class="pre">'r']</span></code>としてもOK。</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">edgecolor</span></code>は散布図の円形マーカーの縁の色を指定する引数。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">facecolor</span></code>は散布図の円形マーカーの内側の色を指定する引数。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">color</span></code>は直線の色を指定する引数。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">linewidth</span></code>は直線幅を指定する引数。</p></li>
</ol>
</div>
<div class="dropdown admonition">
<p class="admonition-title">上の図をDataFrameのメソッド.plot()を使い図示する方法</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">,:]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="s1">&#39;unemployment_rate&#39;</span><span class="p">,</span> <span class="s1">&#39;inflation&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">decade_list</span><span class="p">,</span> <span class="n">color_list</span><span class="p">):</span>
    
    <span class="n">cond</span> <span class="o">=</span> <span class="p">(</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;decade&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">d</span> <span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="s1">&#39;unemployment_rate&#39;</span><span class="p">,</span>
               <span class="s1">&#39;inflation&#39;</span><span class="p">,</span>
               <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,:],</span>
               <span class="n">edgecolor</span><span class="o">=</span><span class="n">c</span><span class="p">,</span>
               <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span>
               <span class="n">label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;unemployment_rate&#39;</span><span class="p">,</span>
           <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s1">年代データ&#39;</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,:]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s1">年代データ&#39;</span><span class="p">),</span>
            <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span>
            <span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;フラット化するフィリップス曲線&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;失業率&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;インフレ率&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>時間が経つにつれてPC曲線は右に横滑りしていることが確認できる。失業率に対してのインフレ率の反応が鈍くなっていることを示しているが，フラット化の原因は定かではなく，活発な研究がおこなわれている。原因として次の点が指摘されている。</p>
<ol class="arabic simple">
<li><p>中央銀行の政策決定の透明化や政策のアナウンスメント，フォーワード・ガイダンス（将来の政策についてのガイダンス）などにより，中央銀行の物価安定（インフレ安定）重視のスタンスが民間に十分に浸透したと考えられる。失業が変化しても，インフレ率のの安定化を図る中央銀行の政策スタンスが民間の期待に織り込まれ，インフレ率の変化は小さくなったと思われる。この解釈が正しければ，日銀は素晴らしい仕事をしたということである。</p></li>
<li><p>グローバル化や規制改革により競争環境が変化し（例えば，需要曲線の変化や寡占化），その結果，企業の価格設定行動がも変化したためである。</p></li>
<li><p>1980年代のPC曲線の傾きは，データ上では大きく見えるが，真のPC曲線はフラットだったという解釈である。上の散布図は観測されたデータを単純にプロットしただけであり，データだけを見てもその裏にあるデータ生成メカニズムは分からない。更には，1980年代にインフレ率が急に減少しているが，インフレ率の下落はPC曲線の下方シフトとして発生したと考えられ，それがデータ上ではPC曲線の急な傾きとして観測されているに過ぎない。</p></li>
<li><p>PC曲線は直線ではなく非線形であり，失業率が高くなると傾きが緩やかになる。直感的には次のように理解できる。企業にとって価格改定にはコストがかかる。従って，インフレ率が高い場合は企業は価格改定をしないと損をするのでより頻繁に価格を上昇させる。一方，インフレ率が低いと，価格改定しない場合の損失は大きくないので，価格の変化は頻繁に起こらなくなる。</p></li>
</ol>
<p>解釈１〜３によると，「真のメカニズム」が変化したと考えることができる。一方，解釈４では「真のメカニズム」は変わらないという事になる。どの解釈がより妥当なのだろうか。非常に難しい問題であり，その解明が経済学の進歩につながる事は言うまでもない。（データと整合的な解釈が複数存在することは経済学でよくあることである。）</p>
<p>経済学に関するジョークに，真っ暗な部屋で黒猫を探す経済学者が登場するものがある。それを模して黒猫がPC曲線だとしよう。最初に黒猫の小さな可愛い鳴き声が聞こえ，５分後にまた同じ方向から鳴き声が聞こえたとする。それだけで，黒猫がいた場所が少しでも変わったかどうかを判断するとした場合，様々な解釈が成立する。「右に10cm動いているようだ。」「いや左に5cm。」「1m程右に動いて元の位置に戻っている。」「そもそも猫は2匹いて，最初の黒猫は他の場所に移り，もう一匹の三毛猫が鳴いたのではないか。」「2回目の鳴き声は幻聴だ。」非常に難しそうである。</p>
<div class="note dropdown admonition">
<p class="admonition-title">黒猫のジョーク</p>
<p>A mathematician, a theoretical economist and an econometrician are asked to find a black cat (who doesn’t really exist) in a closed room with the lights off:</p>
<ul class="simple">
<li><p>The mathematician (数学者) gets crazy trying to find a black cat that doesn’t exist inside the darkened room and ends up in a psychiatric hospital.</p></li>
<li><p>The theoretical economist (理論経済学者) is unable to catch the black cat that doesn’t exist inside the darkened room, but exits the room proudly proclaiming that he can construct a model to describe all his movements with extreme accuracy.</p></li>
<li><p>The econometrician (計量経済学者，特に経済データを用いて実証研究をする学者) walks securely into the darkened room, spend one hour looking for the black cat that doesn’t exits and shouts from inside the room that he has it catched by the neck.”</p></li>
</ul>
<p><a class="reference external" href="https://www.google.co.jp/search?q=economics+jokes">経済学のジョークのGoogle検索結果</a></p>
</div>
</section>
</section>
<section id="id11">
<h2>インフレ率とマネーストックの増加率<a class="headerlink" href="#id11" title="Permalink to this heading">#</a></h2>
<section id="id12">
<h3>説明<a class="headerlink" href="#id12" title="Permalink to this heading">#</a></h3>
<p>貨幣数量説は次式で表される。</p>
<div class="math notranslate nohighlight" id="equation-eq-11-qtm">
<span class="eqno">(109)<a class="headerlink" href="#equation-eq-11-qtm" title="Permalink to this equation">#</a></span>\[
P_tY_t=M_tV_t
\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(P_t\)</span>：一般物価水準</p>
<ul>
<li><p>ある期間（1年間）で取引された財の集計物価水準</p></li>
</ul>
</li>
<li><p><span class="math notranslate nohighlight">\(Y_t\)</span>：実質支出（GDP）</p>
<ul>
<li><p>ある期間（1年間）で取引された財に対する実質支出額</p></li>
</ul>
</li>
<li><p><span class="math notranslate nohighlight">\(M_t\)</span>：マネーストック</p>
<ul>
<li><p>ある期間（1年間）平均で流通した貨幣量</p></li>
</ul>
</li>
<li><p><span class="math notranslate nohighlight">\(V_t\)</span>：貨幣の流通速度</p>
<ul>
<li><p>ある期間（1年間）平均で貨幣１単位が何回使用されたかを示す</p></li>
</ul>
</li>
</ul>
<p>式<a class="reference internal" href="#equation-eq-11-qtm">(109)</a>に対数を取り時間微分すると次式となる。</p>
<div class="math notranslate nohighlight" id="equation-eq-11-qtm-growth">
<span class="eqno">(110)<a class="headerlink" href="#equation-eq-11-qtm-growth" title="Permalink to this equation">#</a></span>\[
\pi_t+g_t=m_t+v_t
\]</div>
<p>ここで</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\pi_t=\dfrac{\dot{P}_t}{P_t}\)</span>：インフレ率</p></li>
<li><p><span class="math notranslate nohighlight">\(g_t=\dfrac{\dot{Y_t}}{Y_t}\)</span>：実質GDPの成長率</p></li>
<li><p><span class="math notranslate nohighlight">\(m_t\equiv\dfrac{\dot{M}_t}{M_t}\)</span>：マネーストックの増加率</p></li>
<li><p><span class="math notranslate nohighlight">\(v_t=\dfrac{\dot{V}_t}{V_t}\)</span>：貨幣の流通速度の変化率</p></li>
</ul>
<p>式<a class="reference internal" href="#equation-eq-11-qtm">(109)</a>は恒等式であり，式<a class="reference internal" href="#equation-eq-11-qtm-growth">(110)</a>も常に成り立つ関係である。ここで長期均衡を考えてみよう。GDPは供給サイドで決定され，成長率は一定（<span class="math notranslate nohighlight">\(g_t=\overline{g}\)</span>）としよう（ソロー・モデルを考えてみよう）。更に貨幣の流通速度は一定とする。この仮定のもと式<a class="reference internal" href="#equation-eq-11-qtm-growth">(110)</a>は次式としてまとめることができる。</p>
<div class="math notranslate nohighlight" id="equation-eq-11-qtm-growth-long">
<span class="eqno">(111)<a class="headerlink" href="#equation-eq-11-qtm-growth-long" title="Permalink to this equation">#</a></span>\[
\pi_t = m_t-\overline{g}
\]</div>
<p>この式によると，<strong>長期的</strong>なインフレ率はマネーストックの増加率によって決定される。この節では，式<a class="reference internal" href="#equation-eq-11-qtm-growth-long">(111)</a>の予測がデータと整合的かどうかを議論する。次の２つのデータ・セットを使いこの問題を考察する。</p>
<ul class="simple">
<li><p>日本の時系列データ</p></li>
<li><p>世界経済のパネル・データ</p></li>
</ul>
<p>手法としては散布図と回帰直線の傾きに基づいて正の相関があるかを考える。</p>
</section>
<section id="id13">
<h3>日本の時系列データ<a class="headerlink" href="#id13" title="Permalink to this heading">#</a></h3>
<section id="id14">
<h4>説明<a class="headerlink" href="#id14" title="Permalink to this heading">#</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">py4macro</span></code>には<code class="docutils literal notranslate"><span class="pre">jpn-money</span></code>というデータ・セットが含まれており，その内容は次のコードで確認できる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">py4macro</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;jpn-money&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    | `cpi`: 消費者物価指数
    |   * 2015年の値を`100`
    |   * 季節調整済み
    | `money`: マネーストック（M1）
    |   * 2015年の値を`100`
    |   * 季節調整済み
    |
    | * 月次データ
    | * 1955年1月〜2021年12月
    | * 行ラベル：毎月の最終日
    |
    | ＜出典＞
    | OECD Main Economic Indicators
</pre></div>
</div>
</div>
</div>
<p>1955年1月から2021年4月までの月次データであり，消費者物価指数とマネーストックの２つの変数が含まれている。マネーストックにはM1が使われており，現金通貨と要求払預金(預入期間の設定がなく自由に出し入れができる預金のことであり，普通預金が典型的な例)で構成される。詳しくは<a class="reference external" href="https://www.boj.or.jp/statistics/outline/exp/data/exms01.pdf">マネーストック統計の解説</a>を参考にしてほしい。M1を使う大きな理由は長い時系列データが存在することであり，長期的な関係である式<a class="reference internal" href="#equation-eq-11-qtm-growth-long">(111)</a>を考えるには適しているためである。</p>
<p>一方で長い時系列データであれば長期的な関係を捉えることができるという訳ではない。ここでの長期的な関係とは，ある作用が発生した後，その効果が現れるのに時間が掛かるという意味である。例えば，今日マネーストックの増加率が上昇したとしても，明日すぐにインフレ率の上昇につながるという訳ではなく，その効果が浸透しデータの数字に現れるまで数ヶ月掛かる事になる。この点を示すために次のステップで進めることにする。</p>
<ol class="arabic simple">
<li><p>月次データを変換して次のデータを作成する。</p>
<ul class="simple">
<li><p>四半期データ</p></li>
<li><p>年次データ</p></li>
<li><p>1期を3年とするデータ（ここでは「3年次データ」と呼ぶ）</p></li>
</ul>
</li>
<li><p>月次データを含む４つのデータ・セットを使い，２変数の散布図と回帰分析をおこなう。</p></li>
</ol>
</section>
<section id="resample">
<h4><code class="docutils literal notranslate"><span class="pre">resample()</span></code><a class="headerlink" href="#resample" title="Permalink to this heading">#</a></h4>
<p>まず四半期データへの変換を考えよう。１四半期には３ヶ月の値があり，その平均を１四半期の値とする。同様に，年次データおよび3年次データに変換する場合は，12ヶ月間もしくは36ヶ月間の値を使い平均を計算することになる。このような計算は「連続的な時系列のグループ計算」として捉えることができる。グループ計算のメソッドに<code class="docutils literal notranslate"><span class="pre">groupby</span></code>があるが，カテゴリー変数に基づいてグループ分けするので，この問題に使うことはできない。その代わりに，時系列用グループ計算メソッドとして<code class="docutils literal notranslate"><span class="pre">resample</span></code>が用意されている。ここでは<code class="docutils literal notranslate"><span class="pre">resample</span></code>の使い方を紹介するが，異なる方法として移動平均を使うことも可能であり，興味がある人は<a class="reference external" href="https://py4basics.github.io/Moving_Average.html">こちらを参照してみよう</a>。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">resample</span></code>はグループ計算だけではなく，その「逆の計算」もすることができるがここでは触れない。以下では，「時系列グループ計算用」としてのみ考える。</p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">resample</span></code>の使い方を説明するために，次の<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>（変数名は<code class="docutils literal notranslate"><span class="pre">df_ex</span></code>）を考えよう。</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">date_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2020-01-31&#39;</span><span class="p">,</span><span class="s1">&#39;2021-12-31&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="n">df_ex</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;X&#39;</span><span class="p">:</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">120</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span>
                      <span class="s1">&#39;Y&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="o">*</span><span class="mi">2</span><span class="p">)},</span><span class="n">index</span><span class="o">=</span><span class="n">date_index</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_ex</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>X</th>
      <th>Y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-01-31</th>
      <td>10</td>
      <td>4.980440</td>
    </tr>
    <tr>
      <th>2020-02-29</th>
      <td>20</td>
      <td>3.436559</td>
    </tr>
    <tr>
      <th>2020-03-31</th>
      <td>30</td>
      <td>5.502668</td>
    </tr>
    <tr>
      <th>2020-04-30</th>
      <td>40</td>
      <td>5.212144</td>
    </tr>
    <tr>
      <th>2020-05-31</th>
      <td>50</td>
      <td>5.443595</td>
    </tr>
    <tr>
      <th>2020-06-30</th>
      <td>60</td>
      <td>4.905171</td>
    </tr>
    <tr>
      <th>2020-07-31</th>
      <td>70</td>
      <td>5.806354</td>
    </tr>
    <tr>
      <th>2020-08-31</th>
      <td>80</td>
      <td>4.870844</td>
    </tr>
    <tr>
      <th>2020-09-30</th>
      <td>90</td>
      <td>3.997860</td>
    </tr>
    <tr>
      <th>2020-10-31</th>
      <td>100</td>
      <td>5.641995</td>
    </tr>
    <tr>
      <th>2020-11-30</th>
      <td>110</td>
      <td>4.808050</td>
    </tr>
    <tr>
      <th>2020-12-31</th>
      <td>120</td>
      <td>3.022835</td>
    </tr>
    <tr>
      <th>2021-01-31</th>
      <td>10</td>
      <td>5.010290</td>
    </tr>
    <tr>
      <th>2021-02-28</th>
      <td>20</td>
      <td>4.053237</td>
    </tr>
    <tr>
      <th>2021-03-31</th>
      <td>30</td>
      <td>6.187049</td>
    </tr>
    <tr>
      <th>2021-04-30</th>
      <td>40</td>
      <td>6.085472</td>
    </tr>
    <tr>
      <th>2021-05-31</th>
      <td>50</td>
      <td>4.743537</td>
    </tr>
    <tr>
      <th>2021-06-30</th>
      <td>60</td>
      <td>3.221858</td>
    </tr>
    <tr>
      <th>2021-07-31</th>
      <td>70</td>
      <td>6.164076</td>
    </tr>
    <tr>
      <th>2021-08-31</th>
      <td>80</td>
      <td>5.221148</td>
    </tr>
    <tr>
      <th>2021-09-30</th>
      <td>90</td>
      <td>4.131788</td>
    </tr>
    <tr>
      <th>2021-10-31</th>
      <td>100</td>
      <td>6.388069</td>
    </tr>
    <tr>
      <th>2021-11-30</th>
      <td>110</td>
      <td>4.285004</td>
    </tr>
    <tr>
      <th>2021-12-31</th>
      <td>120</td>
      <td>5.200578</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">df_ex</span></code>には時系列用の行ラベルがが使われており，毎月の最後の日がラベルとなっている。列<code class="docutils literal notranslate"><span class="pre">X</span></code>には<code class="docutils literal notranslate"><span class="pre">10</span></code>から<code class="docutils literal notranslate"><span class="pre">120</span></code>までの整数が昇順に並んでおり，<code class="docutils literal notranslate"><span class="pre">Y</span></code>にはランダムは値が並んでいる。</p>
<p>２つのステップに分けて説明する。</p>
<p><strong>ステップ１</strong>：グループ化の期間を指定する<br>
最初のステップでは，グループ化する期間を引数として<code class="docutils literal notranslate"><span class="pre">.resample()</span></code>を実行する。指定する期間は次のように文字列として指定する。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">A</span></code>もしくは<code class="docutils literal notranslate"><span class="pre">Y</span></code>：１年を基準としてグループ化</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Q</span></code>：四半期を基準としてグループ化</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">M</span></code>：１ヶ月を基準としてグループ化</p>
<ul>
<li><p>3ヶ月であれば<code class="docutils literal notranslate"><span class="pre">3M</span></code>，１年であれば<code class="docutils literal notranslate"><span class="pre">12M</span></code>とできるが，<code class="docutils literal notranslate"><span class="pre">Q</span></code>と<code class="docutils literal notranslate"><span class="pre">A</span></code>（<code class="docutils literal notranslate"><span class="pre">Y</span></code>）と挙動が少し異なるので注意が必要である。</p></li>
</ul>
</li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">df_ex</span></code>を四半期でグループ化するには次のようになる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_ex</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pandas.core.resample.DatetimeIndexResampler object at 0x12777f9a0&gt;
</pre></div>
</div>
</div>
</div>
<p>このコードは<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を返すわけではない。返すのは時系列グループ計算用のオブジェクトであり，それを使ってグループ計算をおこなう事になる。</p>
<p><strong>ステップ２</strong>：計算内容を指定する。<br>
どのような計算をしたいかを指定する。ここではメソッド.mean()を使って指定した期間内の平均を計算してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_ex</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>X</th>
      <th>Y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-03-31</th>
      <td>20.0</td>
      <td>4.639889</td>
    </tr>
    <tr>
      <th>2020-06-30</th>
      <td>50.0</td>
      <td>5.186970</td>
    </tr>
    <tr>
      <th>2020-09-30</th>
      <td>80.0</td>
      <td>4.891686</td>
    </tr>
    <tr>
      <th>2020-12-31</th>
      <td>110.0</td>
      <td>4.490960</td>
    </tr>
    <tr>
      <th>2021-03-31</th>
      <td>20.0</td>
      <td>5.083525</td>
    </tr>
    <tr>
      <th>2021-06-30</th>
      <td>50.0</td>
      <td>4.683622</td>
    </tr>
    <tr>
      <th>2021-09-30</th>
      <td>80.0</td>
      <td>5.172338</td>
    </tr>
    <tr>
      <th>2021-12-31</th>
      <td>110.0</td>
      <td>5.291217</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>行ラベルには四半期の最後の日が使われている。列<code class="docutils literal notranslate"><span class="pre">X</span></code>に並んでいる数字から，毎四半期の期間内平均であることが確認できる。</p>
<p>次のコードは年平均を計算している。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_ex</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>X</th>
      <th>Y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-12-31</th>
      <td>65.0</td>
      <td>4.802376</td>
    </tr>
    <tr>
      <th>2021-12-31</th>
      <td>65.0</td>
      <td>5.057675</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>平均以外にも様々な計算ができるようになっている。<code class="docutils literal notranslate"><span class="pre">see()</span></code>関数を使って属性を調べてみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">see</span><span class="p">(</span><span class="n">df_ex</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    .*                []                &lt;                 &lt;=                ==
    !=                &gt;                 &gt;=                dir()
    hash()            iter()            len()             repr()
    str()             .X                .Y                .agg()
    .aggregate()      .apply()          .asfreq()         .ax
    .bfill()          .binner           .count()          .ffill()
    .fillna()         .first()          .get_group()      .groups
    .indices          .interpolate()    .kind             .last()
    .max()            .mean()           .median()         .min()
    .ndim             .nearest()        .ngroups          .nunique()
    .ohlc()           .pipe()           .prod()           .quantile()
    .sem()            .size()           .std()            .sum()
    .transform()      .var()
</pre></div>
</div>
</div>
</div>
<p>主なメソッドとして次を挙げることができる（これらの計算で欠損値は無視される）。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mean()</span></code>：平均</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">median()</span></code>：中央値</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max()</span></code>：最大値</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">min()</span></code>：最小値</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">std()</span></code>：標準偏差</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">var()</span></code>：分散</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sum()</span></code>：合計</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">first()</span></code>：最初の値</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">last()</span></code>：最後の値</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">count()</span></code>：要素数</p></li>
</ul>
<p>このリストにない計算をしたい場合は，上のリストにある.agg()（aggregate()も同じ）を使い<code class="docutils literal notranslate"><span class="pre">NumPy</span></code>や自作の関数を指定することができる。例えば，変動係数（coefficient of variation）を計算したいとしよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">cv</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>この関数の<code class="docutils literal notranslate"><span class="pre">x</span></code>は，時系列グループ計算で取り出された<code class="docutils literal notranslate"><span class="pre">Series</span></code>もしくは<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>と考えれば良いだろう。使い方は簡単で，<code class="docutils literal notranslate"><span class="pre">.agg()</span></code>の引数として<code class="docutils literal notranslate"><span class="pre">cv</span></code>を指定するだけである。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_ex</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">cv</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>X</th>
      <th>Y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-12-31</th>
      <td>0.5547</td>
      <td>0.183140</td>
    </tr>
    <tr>
      <th>2021-12-31</th>
      <td>0.5547</td>
      <td>0.200463</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><code class="docutils literal notranslate"><span class="pre">.agg()</span></code>の引数は<code class="docutils literal notranslate"><span class="pre">cv</span></code>であり<code class="docutils literal notranslate"><span class="pre">cv(x)</span></code>ではない。関数名だけを<code class="docutils literal notranslate"><span class="pre">.agg()</span></code>に渡し，<code class="docutils literal notranslate"><span class="pre">.agg()</span></code>が渡された関数を実行するというイメージである。<code class="docutils literal notranslate"><span class="pre">cv(x)</span></code>を引数に使うと，<code class="docutils literal notranslate"><span class="pre">cv(x)</span></code>を実行した<strong>結果</strong>を<code class="docutils literal notranslate"><span class="pre">.agg()</span></code>に渡すことになりエラーとなってしまう。</p>
</div>
</section>
<section id="id15">
<h4>データの作成<a class="headerlink" href="#id15" title="Permalink to this heading">#</a></h4>
<p>では実際に<code class="docutils literal notranslate"><span class="pre">jpn-money</span></code>のデータを使いデータを整形しよう。まず月次データを読み込み<code class="docutils literal notranslate"><span class="pre">month</span></code>に割り当てる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">month</span> <span class="o">=</span> <span class="n">py4macro</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;jpn-money&#39;</span><span class="p">)</span>
<span class="n">month</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cpi</th>
      <th>money</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2021-08-31</th>
      <td>101.618532</td>
      <td>158.215194</td>
    </tr>
    <tr>
      <th>2021-09-30</th>
      <td>101.729035</td>
      <td>158.977241</td>
    </tr>
    <tr>
      <th>2021-10-31</th>
      <td>101.401104</td>
      <td>160.060574</td>
    </tr>
    <tr>
      <th>2021-11-30</th>
      <td>101.956670</td>
      <td>161.054055</td>
    </tr>
    <tr>
      <th>2021-12-31</th>
      <td>102.045185</td>
      <td>161.869633</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>いつもの通り<code class="docutils literal notranslate"><span class="pre">.info()</span></code>を使ってデータの内容を確認しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">month</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
DatetimeIndex: 804 entries, 1955-01-31 to 2021-12-31
Data columns (total 2 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   cpi     804 non-null    float64
 1   money   804 non-null    float64
dtypes: float64(2)
memory usage: 18.8 KB
</pre></div>
</div>
</div>
</div>
<p>行ラベルが<code class="docutils literal notranslate"><span class="pre">DatetimeIndex</span></code>となっており，時系列データ用に設定されていることが分かる。</p>
<p>四半期データに変換して変数<code class="docutils literal notranslate"><span class="pre">quarter</span></code>に割り当てることにする。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">quarter</span> <span class="o">=</span> <span class="n">month</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>これで３ヶ月の値の平均からなる四半期データを作成した事になる。確かめてみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">quarter</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cpi</th>
      <th>money</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1955-03-31</th>
      <td>17.236707</td>
      <td>0.347656</td>
    </tr>
    <tr>
      <th>1955-06-30</th>
      <td>16.874004</td>
      <td>0.357257</td>
    </tr>
    <tr>
      <th>1955-09-30</th>
      <td>17.035517</td>
      <td>0.384201</td>
    </tr>
    <tr>
      <th>1955-12-31</th>
      <td>16.875107</td>
      <td>0.400080</td>
    </tr>
    <tr>
      <th>1956-03-31</th>
      <td>17.108284</td>
      <td>0.394544</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>四半期の最後の日が行ラベルになっていることが分かる。同様に，年次データ作成しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">annual</span> <span class="o">=</span> <span class="n">month</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">annual</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cpi</th>
      <th>money</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1955-12-31</th>
      <td>17.005334</td>
      <td>0.372299</td>
    </tr>
    <tr>
      <th>1956-12-31</th>
      <td>17.072603</td>
      <td>0.424722</td>
    </tr>
    <tr>
      <th>1957-12-31</th>
      <td>17.601583</td>
      <td>0.478435</td>
    </tr>
    <tr>
      <th>1958-12-31</th>
      <td>17.517496</td>
      <td>0.505580</td>
    </tr>
    <tr>
      <th>1959-12-31</th>
      <td>17.707073</td>
      <td>0.588486</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>１年の最後の日が行ラベルになっている。次に３年次データを作成しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">annual3</span> <span class="o">=</span> <span class="n">month</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;36M&#39;</span><span class="p">,</span><span class="n">closed</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>     <span class="c1"># 1</span>
<span class="n">annual3</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">annual3</span><span class="o">.</span><span class="n">index</span> <span class="o">-</span> <span class="n">pd</span><span class="o">.</span><span class="n">tseries</span><span class="o">.</span><span class="n">frequencies</span><span class="o">.</span><span class="n">to_offset</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">)</span>  <span class="c1"># 2</span>
<span class="n">annual3</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cpi</th>
      <th>money</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1957-12-31</th>
      <td>17.226506</td>
      <td>0.425152</td>
    </tr>
    <tr>
      <th>1960-12-31</th>
      <td>17.854861</td>
      <td>0.599932</td>
    </tr>
    <tr>
      <th>1963-12-31</th>
      <td>20.666763</td>
      <td>1.039100</td>
    </tr>
    <tr>
      <th>1966-12-31</th>
      <td>24.291933</td>
      <td>1.641735</td>
    </tr>
    <tr>
      <th>1969-12-31</th>
      <td>28.080477</td>
      <td>2.570458</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>このコードは<code class="docutils literal notranslate"><span class="pre">quarter</span></code>と<code class="docutils literal notranslate"><span class="pre">annual</span></code>のコード少し異なる。コードの具体的な説明は割愛するが，何をしているかを簡単に説明する。１行目の引数<code class="docutils literal notranslate"><span class="pre">36M</span></code>は36ヶ月を意味している。<code class="docutils literal notranslate"><span class="pre">3A</span></code>とすることもできるが，変わった挙動をするので月数（つきすう）を使っている。また引数<code class="docutils literal notranslate"><span class="pre">closed='left'</span></code>と<code class="docutils literal notranslate"><span class="pre">label='right'</span></code>が追加されているが，<code class="docutils literal notranslate"><span class="pre">quarter</span></code>と<code class="docutils literal notranslate"><span class="pre">annual</span></code>と同様の計算・表示になるようにするためである。２行目は行ラベルが３年次の最後の日になるように設定している。</p>
<p>次にインフレ率とマネーストックの増加率の変化を計算し，新たな列としてそれぞれの<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>に追加しよう。増加率の公式に従ってコードを書いても良いが，<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>のメソッド<code class="docutils literal notranslate"><span class="pre">.pct_change()</span></code>を紹介する。これは名前が示すように（percent changeの略）列の変化率を計算するメソッドである。ここで注意が必要な点は，<code class="docutils literal notranslate"><span class="pre">.pct_change()</span></code>はデフォルトで前期比の増加率を返す。例えば，次のコードは<code class="docutils literal notranslate"><span class="pre">cpi</span></code>の前月と比べた増加率を計算している。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">month</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;cpi&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span>
</pre></div>
</div>
<p>同年同期比の増加率を計算したい場合は，12ヶ月前の値と比べたいので引数に<code class="docutils literal notranslate"><span class="pre">12</span></code>を指定すれば良い。例として，<code class="docutils literal notranslate"><span class="pre">quarter</span></code>で<code class="docutils literal notranslate"><span class="pre">cpi</span></code>の同年同期比のインフレ率を計算する場合は次のようになる。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">month</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;cpi&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">pct_change</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p>以下では，デフォルトで<code class="docutils literal notranslate"><span class="pre">.pct_change()</span></code>を使い計算する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">month</span><span class="p">,</span> <span class="n">quarter</span><span class="p">,</span> <span class="n">annual</span><span class="p">,</span> <span class="n">annual3</span><span class="p">]</span>

<span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">df_list</span><span class="p">:</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;inflation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;cpi&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;money_growth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;money&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">month</span></code>を確認してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">month</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cpi</th>
      <th>money</th>
      <th>inflation</th>
      <th>money_growth</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1955-01-31</th>
      <td>17.219573</td>
      <td>0.347029</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1955-02-28</th>
      <td>17.351247</td>
      <td>0.350938</td>
      <td>0.007647</td>
      <td>0.011264</td>
    </tr>
    <tr>
      <th>1955-03-31</th>
      <td>17.139301</td>
      <td>0.345003</td>
      <td>-0.012215</td>
      <td>-0.016910</td>
    </tr>
    <tr>
      <th>1955-04-30</th>
      <td>16.964259</td>
      <td>0.353125</td>
      <td>-0.010213</td>
      <td>0.023541</td>
    </tr>
    <tr>
      <th>1955-05-31</th>
      <td>16.720857</td>
      <td>0.354401</td>
      <td>-0.014348</td>
      <td>0.003613</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>行<code class="docutils literal notranslate"><span class="pre">1955-01-01</span></code>の<code class="docutils literal notranslate"><span class="pre">inflation</span></code>と<code class="docutils literal notranslate"><span class="pre">money_growth</span></code>の値は<code class="docutils literal notranslate"><span class="pre">NaN</span></code>となっている。これは前期の値がないためである。</p>
</section>
<section id="id16">
<h4>散布図とトレンド線<a class="headerlink" href="#id16" title="Permalink to this heading">#</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">for</span></code>ループを使ってOLSの計算とプロットを同時におこなおう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">title_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;月次データ&#39;</span><span class="p">,</span><span class="s1">&#39;四半期データ&#39;</span><span class="p">,</span><span class="s1">&#39;年次データ&#39;</span><span class="p">,</span><span class="s1">&#39;3年次データ&#39;</span><span class="p">]</span>    <span class="c1"># 1</span>

<span class="k">for</span> <span class="n">df</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">df_list</span><span class="p">,</span><span class="n">title_list</span><span class="p">):</span>
    
    <span class="n">res</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;inflation ~ money_growth&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>    <span class="c1"># 2</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;トレンド&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">fittedvalues</span>                            <span class="c1"># 3</span>
    
    <span class="n">ax_</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;money_growth&#39;</span><span class="p">,</span> <span class="s1">&#39;inflation&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">)</span> <span class="c1"># 4</span>
    <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;トレンド&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;money_growth&#39;</span><span class="p">,</span><span class="s1">&#39;トレンド&#39;</span><span class="p">,</span>     <span class="c1"># 5</span>
                                   <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax_</span><span class="p">)</span>          <span class="c1"># 6</span>
    <span class="n">ax_</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">t</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>                                     <span class="c1"># 7</span>
                  <span class="sa">f</span><span class="s1">&#39;スロープ係数：</span><span class="si">{</span><span class="n">res</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>           <span class="c1"># 8</span>
                  <span class="sa">f</span><span class="s1">&#39;p値：</span><span class="si">{</span><span class="n">res</span><span class="o">.</span><span class="n">pvalues</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>                <span class="c1"># 9</span>
                  <span class="sa">f</span><span class="s1">&#39;調整済み決定係数：</span><span class="si">{</span><span class="n">res</span><span class="o">.</span><span class="n">rsquared_adj</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>      <span class="c1"># 10</span>
                  <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>                         <span class="c1"># 11</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9085155f26fe2478617db3eb03a4a2cd4d5f9ad16d19da257acfcbe4e531fee9.png" src="_images/9085155f26fe2478617db3eb03a4a2cd4d5f9ad16d19da257acfcbe4e531fee9.png" />
<img alt="_images/ccef8e6b52423de33a84957066073207a2270800d9fd274602f46d261249c428.png" src="_images/ccef8e6b52423de33a84957066073207a2270800d9fd274602f46d261249c428.png" />
<img alt="_images/aef95979f979fbd80d34da3c785595ad4887f0006d19d5182989e5d587a2188a.png" src="_images/aef95979f979fbd80d34da3c785595ad4887f0006d19d5182989e5d587a2188a.png" />
<img alt="_images/c8cba4506cbd79101e0138525c5a08e91c4c8c8bec2b10faf18682cba146ce5b.png" src="_images/c8cba4506cbd79101e0138525c5a08e91c4c8c8bec2b10faf18682cba146ce5b.png" />
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コード説明</p>
<ol class="arabic simple">
<li><p>それぞれのプロットのタイトルのリスト。</p></li>
<li><p>最小二乗法の結果を変数<code class="docutils literal notranslate"><span class="pre">res</span></code>に割り当てる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">res.fittedvalues</span></code>はOLSの予測値であり，新たな列としてそれぞれの<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>に追加する。その際の列名を<code class="docutils literal notranslate"><span class="pre">トレンド</span></code>とする。</p></li>
<li><p>散布図を描き，生成される「軸」を<code class="docutils literal notranslate"><span class="pre">ax_</span></code>に割り当てる。</p></li>
<li><p>トレンド線を描く。<code class="docutils literal notranslate"><span class="pre">.sort_values('トレンド')</span></code>を使って列<code class="docutils literal notranslate"><span class="pre">トレンド</span></code>を昇順に並び替える。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">color='r'</span></code>は色を赤に指定する。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ax=ax_</span></code>はトレンド線を描く際，「軸」<code class="docutils literal notranslate"><span class="pre">ax_</span></code>を使うことをしてしている。<code class="docutils literal notranslate"><span class="pre">f-string</span></code>を使ってタイトルを<code class="docutils literal notranslate"><span class="pre">{t}</span></code>に代入している。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">f-string</span></code>を使ってスロープ係数の推定値を代入している。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.pvalues</span></code>は推定値を抽出する<code class="docutils literal notranslate"><span class="pre">res</span></code>のメソッドであり，１番目の要素であるスロープ係数を<code class="docutils literal notranslate"><span class="pre">[1]</span></code>で指定している。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">:.3f</span></code>は小数点第三位まで表示することを指定している。</p></li>
</ul>
</li>
<li><p>p値に関して(8)と同じことを行なっている。</p></li>
<li><p>調整済み決定係数に対して(8)と同じことを行なっている。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">loc</span></code>はタイトルの位置を設定する引数。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'left'</span></code>は左寄せ</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'right'</span></code>は右寄せ</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'center'</span></code>は中央（デフォルト）</p></li>
</ul>
</li>
</ol>
</div>
<p>上の図とOLSの推定結果から次のことが分かる。</p>
<ul class="simple">
<li><p>全てのケースで統計的優位性は高い。</p></li>
<li><p>データの期間が長くなるとともに，スロープ係数の値が増加し，調整済み決定係数も高くなっている。</p></li>
</ul>
<p>これらのことからマネーストックの変化の影響は，より長い期間をかけてインフレへの影響が発生していることが伺える。この結果は，式<a class="reference internal" href="#equation-eq-11-qtm-growth-long">(111)</a>は長期的に成立することと整合的であると言えそうだ。</p>
<p>一方で，式<a class="reference internal" href="#equation-eq-11-qtm-growth-long">(111)</a>は係数が<code class="docutils literal notranslate"><span class="pre">1</span></code>になることを予測しているが，上の4つのケースの係数は全て<code class="docutils literal notranslate"><span class="pre">1</span></code>よりも低い値となっている。この点を念頭に，次の節では日本だけではなく<code class="docutils literal notranslate"><span class="pre">170</span></code>国以上のデータを使い，問題を再検討することにする。また，OLS結果は因果関係を示しておらず単なる相関関係を表していることは念頭に置いておこう。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>４つの図の縦軸・横軸の値を比べると，データが長くなるにつれて値が大きくなることがわかる。期間が長くなると増加率も上昇するということである。注意してほしいのは，増加率が上昇したために正の相関が強くなったという訳ではなく，増加率がより高くなっても正の相関は弱いまま，もしくは相関が存在しない場合もあり得る。図が示しているのは，データの期間が長くなると正の相関が「炙り出される」ということである。</p>
</div>
</section>
</section>
<section id="id17">
<h3>世界経済のパネルデータ<a class="headerlink" href="#id17" title="Permalink to this heading">#</a></h3>
<section id="id18">
<h4>説明<a class="headerlink" href="#id18" title="Permalink to this heading">#</a></h4>
<p>前節では日本のデータを使い，インフレ率に対するマネーストック増加率の影響が現れるには時間が掛かることを示した。一方でトレンド線の傾き（回帰分析のスロープ）は１よりも小さいが，式<a class="reference internal" href="#equation-eq-11-qtm-growth-long">(111)</a>は線形であり，<span class="math notranslate nohighlight">\(m_t\)</span>の計数は１である。即ち，マネーストックの増加率が1％上昇するとインフレ率も1％増加するという予測である。データと理論予測の齟齬をどう考えれば良いだろうか。一つの問題はノイズである。年次データであっても3年次データであってもその期間に短期的なありとあらゆるランダムな要素（ノイズ）が含まれている。ノイズは正や負の両方の影響があると考えられ，その分変化が激しいと思われる。長期的な関係は，正と負の影響が相殺し，その結果残った関係と考えることができる。この考えをデータで捉えるためにデータ全体の平均を計算すれば良いことになる。しかし前節で使用した日本の1955年から2020年のデータを使い，インフレ率とマネーストトック増加率の平均を計算すると，標本の大きさは<code class="docutils literal notranslate"><span class="pre">１</span></code>となってしまう。これではどうしようもないので，国数を増やし，観測値を増やす必要がある。従って，ここでは世界経済のパネルデータを使い２変数の関係を探ることにする。</p>
<p><code class="docutils literal notranslate"><span class="pre">py4macro</span></code>に含まれる<code class="docutils literal notranslate"><span class="pre">world-money</span></code>というデータ・セットを使うが，その内容は次のコードで確認できる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">py4macro</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;world-money&#39;</span><span class="p">,</span><span class="n">description</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    | `iso`: ISO国コード
    | `country`: 国名
    | `year`: 年
    | `income_group`: 世界銀行が定義する所得グループ
    |   * High income
    |   * Upper Middle income
    |   * Lower Middle income
    |   * Low income
    | `money`: マネーストック（M1）
    | `deflator`: GDPディフレーター
    |
    | * 年次データ
    |
    | ＜注意点＞
    | * `money`と`deflator`が10年間以上連続で欠損値がない経済（177ヵ国）のみが含まれている。
    | * 国によって含まれるデータの`year`が異なる。
    | * 所得グループに関する情報
    |   https://datahelpdesk.worldbank.org/knowledgebase/articles/906519-world-bank-country-and-lending-groups
    |
    | ＜出典＞
    | World Bank Development Indicators
</pre></div>
</div>
</div>
</div>
<p>国によってデータが使える期間が異なることに注意しよう。</p>
<p>まず変数<code class="docutils literal notranslate"><span class="pre">world</span></code>にデータを割り当てる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">world</span> <span class="o">=</span> <span class="n">py4macro</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;world-money&#39;</span><span class="p">)</span>
<span class="n">world</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>iso</th>
      <th>country</th>
      <th>year</th>
      <th>income_group</th>
      <th>money</th>
      <th>deflator</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ALB</td>
      <td>Albania</td>
      <td>1994</td>
      <td>Upper middle income</td>
      <td>3.876590e+10</td>
      <td>35.739368</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ALB</td>
      <td>Albania</td>
      <td>1995</td>
      <td>Upper middle income</td>
      <td>5.925260e+10</td>
      <td>39.302820</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ALB</td>
      <td>Albania</td>
      <td>1996</td>
      <td>Upper middle income</td>
      <td>9.040510e+10</td>
      <td>54.305537</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ALB</td>
      <td>Albania</td>
      <td>1997</td>
      <td>Upper middle income</td>
      <td>9.166720e+10</td>
      <td>60.409306</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ALB</td>
      <td>Albania</td>
      <td>1998</td>
      <td>Upper middle income</td>
      <td>8.372854e+10</td>
      <td>64.475001</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>いつも通り<code class="docutils literal notranslate"><span class="pre">.info()</span></code>を使って内容を確かめてみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">world</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 6584 entries, 0 to 6583
Data columns (total 6 columns):
 #   Column        Non-Null Count  Dtype  
---  ------        --------------  -----  
 0   iso           6584 non-null   object 
 1   country       6584 non-null   object 
 2   year          6584 non-null   int64  
 3   income_group  6584 non-null   object 
 4   money         6584 non-null   float64
 5   deflator      6584 non-null   float64
dtypes: float64(2), int64(1), object(3)
memory usage: 308.8+ KB
</pre></div>
</div>
</div>
</div>
<p>欠損値はないことが確認できる。</p>
</section>
<section id="id19">
<h4>変化率の計算<a class="headerlink" href="#id19" title="Permalink to this heading">#</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">world</span></code>には経済ごとに10年以上に渡ってインフレ率とマネーストック増加率が含まれている。国ごとの変数の変化率を計算するには，以前紹介した<code class="docutils literal notranslate"><span class="pre">.pivot()</span></code>を使うことも可能だが，少し回りくどい計算になっている。ここでは異なる方法として<code class="docutils literal notranslate"><span class="pre">.groupby()</span></code>を紹介する。<code class="docutils literal notranslate"><span class="pre">.groupby()</span></code>はグループ内で何らかの計算をする際に非常に便利なメソッドである。次のステップに従って説明する。</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">DataFram</span></code>をどの変数でグループ化するかを指定し，グループ化計算用のオブジェクトを用意する。</p>
<ul class="simple">
<li><p>ここでは経済ごとの平均を計算したいので，国<code class="docutils literal notranslate"><span class="pre">iso</span></code>（もしくは<code class="docutils literal notranslate"><span class="pre">country</span></code>）でグループ化する。</p></li>
</ul>
</li>
<li><p>グループ計算したい列を選ぶ。</p>
<ul class="simple">
<li><p>ここでは<code class="docutils literal notranslate"><span class="pre">money</span></code>と<code class="docutils literal notranslate"><span class="pre">deflation</span></code>となる。</p></li>
</ul>
</li>
<li><p>どのような計算をしたいのかを指定する。</p>
<ul class="simple">
<li><p>ここでは増加率なので<code class="docutils literal notranslate"><span class="pre">.pct_change()</span></code>を使う。</p></li>
</ul>
</li>
</ol>
<p><strong>＜ステップ１＞</strong><br>
グループ化用のオブジェクトの作成するためには<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>のメソッド<code class="docutils literal notranslate"><span class="pre">.groupby()</span></code>を使い，その引数にグループ化用の列を指定する。ここでは<code class="docutils literal notranslate"><span class="pre">world</span></code>を<code class="docutils literal notranslate"><span class="pre">iso</span></code>でグループ化した変数<code class="docutils literal notranslate"><span class="pre">world_group</span></code>に割り当てる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">world_group</span> <span class="o">=</span> <span class="n">world</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;iso&#39;</span><span class="p">)</span>
<span class="n">world_group</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x1276ebc40&gt;
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">DataFrameGroupBy</span> <span class="pre">object</span></code>が生成されたことを知らせるメッセージである。このオブジェクトは<code class="docutils literal notranslate"><span class="pre">world</span></code>自体をグループ化計算用に変換したものであり，<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>のように<code class="docutils literal notranslate"><span class="pre">.loc[]</span></code>などのメソッドは用意されていないので注意しよう。</p>
<p><strong>＜ステップ２＞</strong><br>
グループ計算したいのは<code class="docutils literal notranslate"><span class="pre">money</span></code>と<code class="docutils literal notranslate"><span class="pre">deflator</span></code>である。同時に指定しても構わないが，ここでは一つずつ指定することにする。例として<code class="docutils literal notranslate"><span class="pre">money</span></code>を考えよう。列を指定するには<code class="docutils literal notranslate"><span class="pre">[]</span></code>を使う。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">world_group</span><span class="p">[</span><span class="s1">&#39;money&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pandas.core.groupby.generic.SeriesGroupBy object at 0x127713010&gt;
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">SeriesGroupBy</span> <span class="pre">object</span></code>が生成されたことを知らせるメッセージである。ステップ１で生成された<code class="docutils literal notranslate"><span class="pre">DataFrameGroupBy</span> <span class="pre">object</span></code>から<code class="docutils literal notranslate"><span class="pre">money</span></code>の箇所を取り出したグループ計算用オブジェクトである。<code class="docutils literal notranslate"><span class="pre">Series</span></code>となっていることから分かるように，<code class="docutils literal notranslate"><span class="pre">iso</span></code>でグループ化され列<code class="docutils literal notranslate"><span class="pre">money</span></code>専用のグループ計算オブジェクトである。</p>
<p><strong>＜ステップ３＞</strong><br>
グループ計算に平均を使いたいので，ステップ２のオブジェクトに<code class="docutils literal notranslate"><span class="pre">.pct_change()</span></code>をつか加えるだけである。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">world_group</span><span class="p">[</span><span class="s1">&#39;money&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0            NaN
1       0.528472
2       0.525758
3       0.013960
4      -0.086603
          ...   
6579    1.700756
6580   -0.538285
6581   -0.547881
6582    0.479342
6583    0.936070
Name: money, Length: 6584, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>返されたのは国ごとに計算されたマネーストック増加率である。<code class="docutils literal notranslate"><span class="pre">Series</span></code>として返されているが，行の並びは<code class="docutils literal notranslate"><span class="pre">world</span></code>と同じである。従って，次のコードでマネーストック増加率の列を<code class="docutils literal notranslate"><span class="pre">world</span></code>に追加できる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">world</span><span class="p">[</span><span class="s1">&#39;money_growth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">world_group</span><span class="p">[</span><span class="s1">&#39;money&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span>
<span class="n">world</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>iso</th>
      <th>country</th>
      <th>year</th>
      <th>income_group</th>
      <th>money</th>
      <th>deflator</th>
      <th>money_growth</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ALB</td>
      <td>Albania</td>
      <td>1994</td>
      <td>Upper middle income</td>
      <td>3.876590e+10</td>
      <td>35.739368</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ALB</td>
      <td>Albania</td>
      <td>1995</td>
      <td>Upper middle income</td>
      <td>5.925260e+10</td>
      <td>39.302820</td>
      <td>52.847219</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ALB</td>
      <td>Albania</td>
      <td>1996</td>
      <td>Upper middle income</td>
      <td>9.040510e+10</td>
      <td>54.305537</td>
      <td>52.575752</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ALB</td>
      <td>Albania</td>
      <td>1997</td>
      <td>Upper middle income</td>
      <td>9.166720e+10</td>
      <td>60.409306</td>
      <td>1.396050</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ALB</td>
      <td>Albania</td>
      <td>1998</td>
      <td>Upper middle income</td>
      <td>8.372854e+10</td>
      <td>64.475001</td>
      <td>-8.660303</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>列<code class="docutils literal notranslate"><span class="pre">money_growth</span></code>が最後に追加さている。Albaniaの最初の行である0番目の行は<code class="docutils literal notranslate"><span class="pre">NaN</span></code>になっているが，増加率を計算する際に発生している。同様に，全ての国の最初の行には<code class="docutils literal notranslate"><span class="pre">NaN</span></code>が入っている（確かめてみよう）。</p>
<p>次にインフレ率を計算する。次のコードは上で説明した手順を１行で書いている。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">world</span><span class="p">[</span><span class="s1">&#39;inflation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">world_group</span><span class="p">[</span><span class="s1">&#39;deflator&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span>
</pre></div>
</div>
</div>
</div>
<p>試しに，日本のデータだけを抽出してみよう。</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">world</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;iso==&quot;JPN&quot;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>iso</th>
      <th>country</th>
      <th>year</th>
      <th>income_group</th>
      <th>money</th>
      <th>deflator</th>
      <th>money_growth</th>
      <th>inflation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3022</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1961</td>
      <td>High income</td>
      <td>4.102000e+12</td>
      <td>24.337971</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3023</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1962</td>
      <td>High income</td>
      <td>6.090000e+12</td>
      <td>25.360063</td>
      <td>48.464164</td>
      <td>4.199578</td>
    </tr>
    <tr>
      <th>3024</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1963</td>
      <td>High income</td>
      <td>7.702000e+12</td>
      <td>26.757522</td>
      <td>26.469622</td>
      <td>5.510469</td>
    </tr>
    <tr>
      <th>3025</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1964</td>
      <td>High income</td>
      <td>8.704000e+12</td>
      <td>28.183351</td>
      <td>13.009608</td>
      <td>5.328706</td>
    </tr>
    <tr>
      <th>3026</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1965</td>
      <td>High income</td>
      <td>1.028700e+13</td>
      <td>29.631090</td>
      <td>18.187040</td>
      <td>5.136857</td>
    </tr>
    <tr>
      <th>3027</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1966</td>
      <td>High income</td>
      <td>1.171600e+13</td>
      <td>31.104013</td>
      <td>13.891319</td>
      <td>4.970869</td>
    </tr>
    <tr>
      <th>3028</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1967</td>
      <td>High income</td>
      <td>1.336900e+13</td>
      <td>32.813300</td>
      <td>14.108911</td>
      <td>5.495390</td>
    </tr>
    <tr>
      <th>3029</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1968</td>
      <td>High income</td>
      <td>1.515500e+13</td>
      <td>34.427341</td>
      <td>13.359264</td>
      <td>4.918863</td>
    </tr>
    <tr>
      <th>3030</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1969</td>
      <td>High income</td>
      <td>1.828200e+13</td>
      <td>35.953642</td>
      <td>20.633454</td>
      <td>4.433399</td>
    </tr>
    <tr>
      <th>3031</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1970</td>
      <td>High income</td>
      <td>2.421400e+13</td>
      <td>44.213162</td>
      <td>32.447216</td>
      <td>22.972693</td>
    </tr>
    <tr>
      <th>3032</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1971</td>
      <td>High income</td>
      <td>3.097200e+13</td>
      <td>46.464210</td>
      <td>27.909474</td>
      <td>5.091352</td>
    </tr>
    <tr>
      <th>3033</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1972</td>
      <td>High income</td>
      <td>3.857900e+13</td>
      <td>49.068260</td>
      <td>24.560894</td>
      <td>5.604422</td>
    </tr>
    <tr>
      <th>3034</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1973</td>
      <td>High income</td>
      <td>4.561100e+13</td>
      <td>55.302577</td>
      <td>18.227533</td>
      <td>12.705396</td>
    </tr>
    <tr>
      <th>3035</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1974</td>
      <td>High income</td>
      <td>5.106500e+13</td>
      <td>66.811071</td>
      <td>11.957642</td>
      <td>20.810050</td>
    </tr>
    <tr>
      <th>3036</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1975</td>
      <td>High income</td>
      <td>5.684700e+13</td>
      <td>71.606396</td>
      <td>11.322824</td>
      <td>7.177441</td>
    </tr>
    <tr>
      <th>3037</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1976</td>
      <td>High income</td>
      <td>6.381800e+13</td>
      <td>77.340555</td>
      <td>12.262740</td>
      <td>8.007886</td>
    </tr>
    <tr>
      <th>3038</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1977</td>
      <td>High income</td>
      <td>6.893500e+13</td>
      <td>82.560351</td>
      <td>8.018114</td>
      <td>6.749107</td>
    </tr>
    <tr>
      <th>3039</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1978</td>
      <td>High income</td>
      <td>7.797000e+13</td>
      <td>86.361230</td>
      <td>13.106550</td>
      <td>4.603758</td>
    </tr>
    <tr>
      <th>3040</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1979</td>
      <td>High income</td>
      <td>8.071200e+13</td>
      <td>88.737573</td>
      <td>3.516737</td>
      <td>2.751631</td>
    </tr>
    <tr>
      <th>3041</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1980</td>
      <td>High income</td>
      <td>7.930300e+13</td>
      <td>93.563108</td>
      <td>-1.745713</td>
      <td>5.437984</td>
    </tr>
    <tr>
      <th>3042</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1981</td>
      <td>High income</td>
      <td>8.678700e+13</td>
      <td>96.301543</td>
      <td>9.437222</td>
      <td>2.926833</td>
    </tr>
    <tr>
      <th>3043</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1982</td>
      <td>High income</td>
      <td>9.193400e+13</td>
      <td>97.981975</td>
      <td>5.930612</td>
      <td>1.744969</td>
    </tr>
    <tr>
      <th>3044</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1983</td>
      <td>High income</td>
      <td>9.198900e+13</td>
      <td>98.908551</td>
      <td>0.059826</td>
      <td>0.945660</td>
    </tr>
    <tr>
      <th>3045</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1984</td>
      <td>High income</td>
      <td>9.812700e+13</td>
      <td>100.365852</td>
      <td>6.672537</td>
      <td>1.473382</td>
    </tr>
    <tr>
      <th>3046</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1985</td>
      <td>High income</td>
      <td>1.010060e+14</td>
      <td>101.630611</td>
      <td>2.933953</td>
      <td>1.260150</td>
    </tr>
    <tr>
      <th>3047</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1986</td>
      <td>High income</td>
      <td>1.112170e+14</td>
      <td>103.269102</td>
      <td>10.109300</td>
      <td>1.612202</td>
    </tr>
    <tr>
      <th>3048</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1987</td>
      <td>High income</td>
      <td>1.166330e+14</td>
      <td>103.106047</td>
      <td>4.869759</td>
      <td>-0.157894</td>
    </tr>
    <tr>
      <th>3049</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1988</td>
      <td>High income</td>
      <td>1.262110e+14</td>
      <td>103.750762</td>
      <td>8.212084</td>
      <td>0.625293</td>
    </tr>
    <tr>
      <th>3050</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1989</td>
      <td>High income</td>
      <td>1.299050e+14</td>
      <td>105.938752</td>
      <td>2.926845</td>
      <td>2.108890</td>
    </tr>
    <tr>
      <th>3051</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1990</td>
      <td>High income</td>
      <td>1.350370e+14</td>
      <td>108.698779</td>
      <td>3.950579</td>
      <td>2.605305</td>
    </tr>
    <tr>
      <th>3052</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1991</td>
      <td>High income</td>
      <td>1.428830e+14</td>
      <td>111.881314</td>
      <td>5.810259</td>
      <td>2.927848</td>
    </tr>
    <tr>
      <th>3053</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1992</td>
      <td>High income</td>
      <td>1.477900e+14</td>
      <td>113.745972</td>
      <td>3.434278</td>
      <td>1.666639</td>
    </tr>
    <tr>
      <th>3054</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1993</td>
      <td>High income</td>
      <td>1.575810e+14</td>
      <td>114.392473</td>
      <td>6.624941</td>
      <td>0.568373</td>
    </tr>
    <tr>
      <th>3055</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1994</td>
      <td>High income</td>
      <td>1.641370e+14</td>
      <td>114.696203</td>
      <td>4.160400</td>
      <td>0.265515</td>
    </tr>
    <tr>
      <th>3056</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1995</td>
      <td>High income</td>
      <td>1.907660e+14</td>
      <td>114.084345</td>
      <td>16.223642</td>
      <td>-0.533460</td>
    </tr>
    <tr>
      <th>3057</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1996</td>
      <td>High income</td>
      <td>2.087810e+14</td>
      <td>113.517931</td>
      <td>9.443507</td>
      <td>-0.496487</td>
    </tr>
    <tr>
      <th>3058</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1997</td>
      <td>High income</td>
      <td>2.498136e+14</td>
      <td>114.089868</td>
      <td>19.653417</td>
      <td>0.503830</td>
    </tr>
    <tr>
      <th>3059</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1998</td>
      <td>High income</td>
      <td>2.616490e+14</td>
      <td>114.038391</td>
      <td>4.737692</td>
      <td>-0.045120</td>
    </tr>
    <tr>
      <th>3060</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>1999</td>
      <td>High income</td>
      <td>2.903745e+14</td>
      <td>112.545067</td>
      <td>10.978639</td>
      <td>-1.309492</td>
    </tr>
    <tr>
      <th>3061</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>2000</td>
      <td>High income</td>
      <td>3.001829e+14</td>
      <td>110.987797</td>
      <td>3.377845</td>
      <td>-1.383686</td>
    </tr>
    <tr>
      <th>3062</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>2001</td>
      <td>High income</td>
      <td>3.111430e+14</td>
      <td>109.761918</td>
      <td>3.651141</td>
      <td>-1.104517</td>
    </tr>
    <tr>
      <th>3063</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>2002</td>
      <td>High income</td>
      <td>3.796386e+14</td>
      <td>108.161276</td>
      <td>22.014186</td>
      <td>-1.458286</td>
    </tr>
    <tr>
      <th>3064</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>2003</td>
      <td>High income</td>
      <td>4.506541e+14</td>
      <td>106.412328</td>
      <td>18.706080</td>
      <td>-1.616981</td>
    </tr>
    <tr>
      <th>3065</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>2004</td>
      <td>High income</td>
      <td>4.695480e+14</td>
      <td>105.241010</td>
      <td>4.192550</td>
      <td>-1.100736</td>
    </tr>
    <tr>
      <th>3066</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>2005</td>
      <td>High income</td>
      <td>4.944894e+14</td>
      <td>104.149203</td>
      <td>5.311789</td>
      <td>-1.037435</td>
    </tr>
    <tr>
      <th>3067</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>2006</td>
      <td>High income</td>
      <td>4.953890e+14</td>
      <td>103.229172</td>
      <td>0.181925</td>
      <td>-0.883378</td>
    </tr>
    <tr>
      <th>3068</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>2007</td>
      <td>High income</td>
      <td>4.967105e+14</td>
      <td>102.476136</td>
      <td>0.266760</td>
      <td>-0.729480</td>
    </tr>
    <tr>
      <th>3069</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>2008</td>
      <td>High income</td>
      <td>4.904771e+14</td>
      <td>101.470952</td>
      <td>-1.254936</td>
      <td>-0.980895</td>
    </tr>
    <tr>
      <th>3070</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>2009</td>
      <td>High income</td>
      <td>4.971079e+14</td>
      <td>100.850688</td>
      <td>1.351908</td>
      <td>-0.611273</td>
    </tr>
    <tr>
      <th>3071</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>2010</td>
      <td>High income</td>
      <td>5.133780e+14</td>
      <td>98.939403</td>
      <td>3.272951</td>
      <td>-1.895164</td>
    </tr>
    <tr>
      <th>3072</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>2011</td>
      <td>High income</td>
      <td>5.412710e+14</td>
      <td>97.282835</td>
      <td>5.433229</td>
      <td>-1.674326</td>
    </tr>
    <tr>
      <th>3073</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>2012</td>
      <td>High income</td>
      <td>5.607333e+14</td>
      <td>96.541973</td>
      <td>3.595666</td>
      <td>-0.761555</td>
    </tr>
    <tr>
      <th>3074</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>2013</td>
      <td>High income</td>
      <td>5.914823e+14</td>
      <td>96.220317</td>
      <td>5.483712</td>
      <td>-0.333177</td>
    </tr>
    <tr>
      <th>3075</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>2014</td>
      <td>High income</td>
      <td>6.203437e+14</td>
      <td>97.899664</td>
      <td>4.879504</td>
      <td>1.745314</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>上で説明したように，列<code class="docutils literal notranslate"><span class="pre">money_growth</span></code>と<code class="docutils literal notranslate"><span class="pre">inflation</span></code>の0番目の行の要素は<code class="docutils literal notranslate"><span class="pre">NaN</span></code>となっている。</p>
</section>
<section id="id20">
<h4>ハイパーインフレ<a class="headerlink" href="#id20" title="Permalink to this heading">#</a></h4>
<p>ハイパーインフレの確固たる定義はないが，Mankiwの教科書「マクロ経済学」では年率50％以上と定義している。この定義に基づき，ハイパーインフレは観測値の何％を占めるかを計算してみよう。まず<code class="docutils literal notranslate"><span class="pre">inflation</span></code>で<code class="docutils literal notranslate"><span class="pre">NaN</span></code>ではない行の数を数える。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">notna</span> <span class="o">=</span> <span class="n">world</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;inflation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">notna</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6407
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<p>欠損値である<code class="docutils literal notranslate"><span class="pre">NaN</span></code>は<code class="docutils literal notranslate"><span class="pre">na</span></code>（not available）とも呼ばれる。メソッド<code class="docutils literal notranslate"><span class="pre">.notna()</span></code>は文字通り<code class="docutils literal notranslate"><span class="pre">na</span></code>ではない要素には<code class="docutils literal notranslate"><span class="pre">True</span></code>を<code class="docutils literal notranslate"><span class="pre">na</span></code>である要素には<code class="docutils literal notranslate"><span class="pre">False</span></code>を返す。<code class="docutils literal notranslate"><span class="pre">.sum()</span></code>は<code class="docutils literal notranslate"><span class="pre">True</span></code>の数を合計している。</p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">inflation</span></code>の値が<code class="docutils literal notranslate"><span class="pre">NaN</span></code>ではない行は6407あることがわかった。次に<code class="docutils literal notranslate"><span class="pre">inflation</span></code>が50％以上の行数を数えてみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hyper</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span> <span class="n">world</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;inflation &gt;= 50&#39;</span><span class="p">)</span> <span class="p">)</span>
<span class="n">hyper</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>300
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;観測値の</span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="n">hyper</span><span class="o">/</span><span class="n">notna</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">％でハイパーインフレが発生している。&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>観測値の4.68％でハイパーインフレが発生している。
</pre></div>
</div>
</div>
</div>
<p>次に<code class="docutils literal notranslate"><span class="pre">inflation</span></code>の上位5ヵ国を表示してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">world</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;inflation&#39;</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>iso</th>
      <th>country</th>
      <th>year</th>
      <th>income_group</th>
      <th>money</th>
      <th>deflator</th>
      <th>money_growth</th>
      <th>inflation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1413</th>
      <td>COD</td>
      <td>Congo, Dem. Rep.</td>
      <td>1994</td>
      <td>Low income</td>
      <td>3725130.0</td>
      <td>0.001219</td>
      <td>5635.381062</td>
      <td>26765.858252</td>
    </tr>
    <tr>
      <th>4277</th>
      <td>NIC</td>
      <td>Nicaragua</td>
      <td>1988</td>
      <td>Lower middle income</td>
      <td>33480.0</td>
      <td>0.000091</td>
      <td>11673.429423</td>
      <td>13611.634819</td>
    </tr>
    <tr>
      <th>680</th>
      <td>BOL</td>
      <td>Bolivia</td>
      <td>1985</td>
      <td>Lower middle income</td>
      <td>111800000.0</td>
      <td>17.094034</td>
      <td>3587.821612</td>
      <td>12338.622324</td>
    </tr>
    <tr>
      <th>4719</th>
      <td>PER</td>
      <td>Peru</td>
      <td>1990</td>
      <td>Upper middle income</td>
      <td>707331500.0</td>
      <td>3.608738</td>
      <td>6724.820224</td>
      <td>6261.239559</td>
    </tr>
    <tr>
      <th>4279</th>
      <td>NIC</td>
      <td>Nicaragua</td>
      <td>1990</td>
      <td>Lower middle income</td>
      <td>52778530.0</td>
      <td>0.223530</td>
      <td>6286.714344</td>
      <td>5016.107950</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>トップはコンゴ共和国（COD）の年率26,766％！しかし，この数字はあまりピンとこないかもしれないので，次式を使って一日のインフレ率に換算してみよう。</p>
<div class="math notranslate nohighlight">
\[
(1+g_{{日}})^{365}=1+g_{\text{年}}
\quad\Rightarrow\quad
g_{{日}}=(1+g_{\text{年}})^{\frac{1}{365}}-1
\]</div>
<p>ここで<span class="math notranslate nohighlight">\(g_{{年}}\)</span>は年率のインフレ率であり，<span class="math notranslate nohighlight">\(g_{{日}}\)</span>は1日当たりのインフレ率。この式を使い１に当たりの平均インフレ率を計算してみる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inflation_cod</span> <span class="o">=</span> <span class="n">world</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;(iso==&quot;COD&quot;) &amp; (year==1994)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;inflation&#39;</span><span class="p">]</span>

<span class="n">inflation_cod_day</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span><span class="p">(</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">inflation_cod</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">365</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span> <span class="p">)</span>
<span class="n">inflation_cod_day</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1413    1.544252
Name: inflation, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>1日平均約1.54％のインフレ率となる。日本で考えると，最近の年率でのインフレ率よりも高い数字である（2021年8月現在）。もう少し身近に感じられるように，物価が２倍になるには何日かかるかを考えてみよう。<span class="math notranslate nohighlight">\(t\)</span>日後に物価は２倍になるとすると，次式が成立する。</p>
<div class="math notranslate nohighlight">
\[
2=(1+g_{\text{日}})^t
\quad\Rightarrow\quad
t=\frac{\log(2)}{\log(1+g_{\text{日}})}
\]</div>
<p>この式を使って<span class="math notranslate nohighlight">\(t\)</span>を計算してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">inflation_cod_day</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1413    45.231317
Name: inflation, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>約45日間で物価は２倍になることが分かる。</p>
</section>
<section id="id21">
<h4>プロット<a class="headerlink" href="#id21" title="Permalink to this heading">#</a></h4>
<p>全てのデータを使って散布図をプロットしトレンドを計算してみる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">world</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;money_growth&#39;</span><span class="p">,</span><span class="s1">&#39;inflation&#39;</span><span class="p">,</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6c79cd69dd18153e2b665ad447f2fd226083e1c514efd954aec176dcc8cf3bfb.png" src="_images/6c79cd69dd18153e2b665ad447f2fd226083e1c514efd954aec176dcc8cf3bfb.png" />
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<p><code class="docutils literal notranslate"><span class="pre">world</span></code>には<code class="docutils literal notranslate"><span class="pre">inflation</span></code>と<code class="docutils literal notranslate"><span class="pre">money_growth</span></code>が<code class="docutils literal notranslate"><span class="pre">NaN</span></code>となっている行が含まれるが，上の図では自動的に省かれる。<code class="docutils literal notranslate"><span class="pre">world.dropna().plot()</span></code>としても図は変わらない。</p>
</div>
<p>横軸と縦軸の値（％）を確認してみると分かるが非常に大きい。ノイズの影響により変化が非常に激しいためである。トレンドのスロープを計算してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res_world</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;inflation ~ money_growth&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">world</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;標本の大きさ：</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">res_world</span><span class="o">.</span><span class="n">nobs</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;調整済み決定係数：</span><span class="si">{</span><span class="n">res_world</span><span class="o">.</span><span class="n">rsquared_adj</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">res_world</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>標本の大きさ：6407
調整済み決定係数：0.537
</pre></div>
</div>
<div class="output text_html"><table class="simpletable">
<tr>
        <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>    <td>   -9.6447</td> <td>    3.843</td> <td>   -2.510</td> <td> 0.012</td> <td>  -17.178</td> <td>   -2.112</td>
</tr>
<tr>
  <th>money_growth</th> <td>    1.2802</td> <td>    0.015</td> <td>   86.259</td> <td> 0.000</td> <td>    1.251</td> <td>    1.309</td>
</tr>
</table></div></div>
</div>
<p>トレンドのスロープは1.28であり，1に近いがノイズの影響が大きいようである。</p>
<p>この結果と比較したいのが，次のケースである。</p>
<ul class="simple">
<li><p>それぞれの国で<code class="docutils literal notranslate"><span class="pre">inflation</span></code>と<code class="docutils literal notranslate"><span class="pre">money_growth</span></code>の平均を計算し，その散布図をプロットするとともに傾きを計算する。</p></li>
</ul>
<p>まず，それぞれの経済の２変数の平均を計算するが，一つ注意点がある。<code class="docutils literal notranslate"><span class="pre">world</span></code>に<code class="docutils literal notranslate"><span class="pre">inflation</span></code>と<code class="docutils literal notranslate"><span class="pre">money_growth</span></code>があるので，<code class="docutils literal notranslate"><span class="pre">.mean()</span></code>を使って平均を計算すれば良いと思うかもしれない。しかし<code class="docutils literal notranslate"><span class="pre">.mean()</span></code>は算術平均であり，計算したいのは増加率の平均なので可能であれば幾何平均を使うべきである。残念ながら，<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>には幾何平均のメソッドが良いされて良いないので，次のように<code class="docutils literal notranslate"><span class="pre">for</span></code>ループで計算することにする。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">money_growth_mean_list</span> <span class="o">=</span> <span class="p">[]</span>                   <span class="c1"># 1</span>
<span class="n">inflation_mean_list</span> <span class="o">=</span> <span class="p">[]</span>                      <span class="c1"># 2</span>
<span class="n">iso_list</span> <span class="o">=</span> <span class="p">[]</span>                                 <span class="c1"># 3 </span>
<span class="n">country_list</span> <span class="o">=</span> <span class="p">[]</span>                             <span class="c1"># 4</span>
<span class="n">income_group_list</span> <span class="o">=</span> <span class="p">[]</span>                        <span class="c1"># 5</span>

<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">world</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;iso&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>         <span class="c1"># 6</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">world</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;iso==@c&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span> <span class="c1"># 7</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>                               <span class="c1"># 9</span>
    
    <span class="n">money_growth_mean</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span><span class="p">(</span>                 <span class="c1"># 9</span>
        <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;money&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;money&#39;</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">-</span><span class="mi">1</span>
    <span class="p">)</span>
    <span class="n">inflation_mean</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span><span class="p">(</span>                    <span class="c1"># 10</span>
        <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;deflator&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;deflator&#39;</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">-</span><span class="mi">1</span>
    <span class="p">)</span>
                                              <span class="c1"># 11</span>
    <span class="n">money_growth_mean_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">money_growth_mean</span><span class="p">)</span>
    <span class="n">inflation_mean_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inflation_mean</span><span class="p">)</span>
    <span class="n">iso_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
                                              <span class="c1"># 12</span>
    <span class="n">country_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
    
                                              <span class="c1"># 13</span>
    <span class="n">income_group_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;income_group&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
    
                                              <span class="c1"># 14</span>
<span class="n">world_mean</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;country&#39;</span><span class="p">:</span><span class="n">country_list</span><span class="p">,</span>
                           <span class="s1">&#39;income_group&#39;</span><span class="p">:</span><span class="n">income_group_list</span><span class="p">,</span>
                           <span class="s1">&#39;money_growth_mean&#39;</span><span class="p">:</span><span class="n">money_growth_mean_list</span><span class="p">,</span>
                           <span class="s1">&#39;inflation_mean&#39;</span><span class="p">:</span><span class="n">inflation_mean_list</span><span class="p">,</span>
                           <span class="s1">&#39;iso&#39;</span><span class="p">:</span><span class="n">iso_list</span><span class="p">})</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;iso&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<ol class="arabic simple">
<li><p>マネーストックの平均増加率を格納する空のリスト。</p></li>
<li><p>平均インフレ率を格納する空のリスト。</p></li>
<li><p>国のisoを格納する空のリスト。</p></li>
<li><p>国名を格納するリスト。</p></li>
<li><p>所得グループ名を格納するリスト。</p></li>
<li><p>データにある経済全てに対しての<code class="docutils literal notranslate"><span class="pre">for</span></code>ループを開始</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">world.loc[:,'iso']</span></code>は列<code class="docutils literal notranslate"><span class="pre">iso</span></code>を抽出し，<code class="docutils literal notranslate"><span class="pre">.unique()</span></code>を使って経済のリストを作成する。</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">.query('iso==&#64;c')</span></code>で<code class="docutils literal notranslate"><span class="pre">c</span></code>国の行だけを抽出し，<code class="docutils literal notranslate"><span class="pre">reset_index()</span></code>で行インデックスを振り直す。<code class="docutils literal notranslate"><span class="pre">c</span></code>国の<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を<code class="docutils literal notranslate"><span class="pre">df</span></code>に割り当てる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">df</span></code>の行数を<code class="docutils literal notranslate"><span class="pre">n</span></code>に割り当てる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">df</span></code>の列<code class="docutils literal notranslate"><span class="pre">money</span></code>の最初と最後の行の値を使って平均増加率を計算する。<code class="docutils literal notranslate"><span class="pre">100*</span></code>で％表示にする。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">df</span></code>の列<code class="docutils literal notranslate"><span class="pre">deflator</span></code>の最初と最後の行の値を使って平均インフレ率を計算する。<code class="docutils literal notranslate"><span class="pre">100*</span></code>で％表示にする。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">money_growth_mean</span></code>，<code class="docutils literal notranslate"><span class="pre">inflation_mean</span></code>，<code class="docutils literal notranslate"><span class="pre">c</span></code>をそれぞれ対応するリストに追加する。</p></li>
<li><p>国名を<code class="docutils literal notranslate"><span class="pre">country_list</span></code>に追加する。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">df.loc[:,'country']</span></code>で列<code class="docutils literal notranslate"><span class="pre">country</span></code>を抽出し，<code class="docutils literal notranslate"><span class="pre">.unique()</span></code>で国名が入る<code class="docutils literal notranslate"><span class="pre">array</span></code>が返される。<code class="docutils literal notranslate"><span class="pre">[0]</span></code>はその0番目の要素を抽出している。</p></li>
</ul>
</li>
<li><p>所得グループ名を<code class="docutils literal notranslate"><span class="pre">income_group_list</span></code>に追加する。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">df.loc[:,'income_group']</span></code>で列<code class="docutils literal notranslate"><span class="pre">income_group</span></code>を抽出し，<code class="docutils literal notranslate"><span class="pre">.unique()</span></code>でグループ名が入る<code class="docutils literal notranslate"><span class="pre">array</span></code>が返される。<code class="docutils literal notranslate"><span class="pre">[0]</span></code>はその0番目の要素を抽出している。</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">money_growth_mean_list</span></code>，<code class="docutils literal notranslate"><span class="pre">inflation_mean_list</span></code>，<code class="docutils literal notranslate"><span class="pre">country_list</span></code>を使い<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を作成し<code class="docutils literal notranslate"><span class="pre">world_mean</span></code>に割り当てる。<code class="docutils literal notranslate"><span class="pre">.set_index('iso')</span></code>は<code class="docutils literal notranslate"><span class="pre">iso</span></code>を行ラベルに設定している。</p></li>
</ol>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>実は<code class="docutils literal notranslate"><span class="pre">.groupby()</span></code>使って幾何平均を計算することも可能である。例えば，次のコードでマネーストック増加率の幾何平均を計算できる。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">gmean</span>            <span class="c1"># 1</span>

<span class="n">world</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;iso&#39;</span><span class="p">)[</span><span class="s1">&#39;money&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">gmean</span><span class="p">)</span> <span class="c1"># 2</span>
</pre></div>
</div>
<p>簡単なコードで良いが，(1)にある関数を導入する必要があり，また(2)の<code class="docutils literal notranslate"><span class="pre">.agg()</span></code>を使う必要がある。上のコードは<code class="docutils literal notranslate"><span class="pre">for</span></code>ループに慣れることを一つの目的としている。</p>
</div>
<p>平均でハイパーインフレが発生している国は何ヵ国なるのか計算してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hyper</span> <span class="o">=</span> <span class="p">(</span> <span class="n">world_mean</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;inflation_mean&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">world_mean</span><span class="p">)</span><span class="si">}</span><span class="s1">ヵ国中</span><span class="si">{</span><span class="n">hyper</span><span class="si">}</span><span class="s1">ヵ国でハイパーインフレが発生している。&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>177ヵ国中7ヵ国でハイパーインフレが発生している。
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">world_mean.loc[:,'inflation_mean']</span></code>で<code class="docutils literal notranslate"><span class="pre">inflation_mean</span></code>の列を抽出。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">world_mean.loc[:,'inflation_mean']</span> <span class="pre">&gt;=</span> <span class="pre">50</span></code>を使い，列<code class="docutils literal notranslate"><span class="pre">inflation_mean</span></code>の要素が50以上であれば<code class="docutils literal notranslate"><span class="pre">True</span></code>，50未満であれば<code class="docutils literal notranslate"><span class="pre">False</span></code>となる<code class="docutils literal notranslate"><span class="pre">Series</span></code>を返す。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>は１，<code class="docutils literal notranslate"><span class="pre">False</span></code>は０と等しいので，<code class="docutils literal notranslate"><span class="pre">.sum()</span></code>で合計することによってハイパーインフレ国の数が計算できる。</p></li>
</ul>
</div>
<p>短期的なノイズの影響によってある年にハイパーインフレが発生する場合もあるだろう。しかしこの結果は，長期的にハイパーインフレに悩まされる国が存在することを示している。どのような国なのかを確認するために，インフレ率上位10ヵ国を表示してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">world_mean</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;inflation_mean&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>income_group</th>
      <th>money_growth_mean</th>
      <th>inflation_mean</th>
    </tr>
    <tr>
      <th>iso</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>COD</th>
      <td>Congo, Dem. Rep.</td>
      <td>Low income</td>
      <td>122.442962</td>
      <td>127.704505</td>
    </tr>
    <tr>
      <th>AGO</th>
      <td>Angola</td>
      <td>Lower middle income</td>
      <td>108.457354</td>
      <td>92.231798</td>
    </tr>
    <tr>
      <th>BRA</th>
      <td>Brazil</td>
      <td>Upper middle income</td>
      <td>92.023344</td>
      <td>88.882771</td>
    </tr>
    <tr>
      <th>ARG</th>
      <td>Argentina</td>
      <td>Upper middle income</td>
      <td>79.169900</td>
      <td>74.971614</td>
    </tr>
    <tr>
      <th>NIC</th>
      <td>Nicaragua</td>
      <td>Lower middle income</td>
      <td>67.774841</td>
      <td>62.717663</td>
    </tr>
    <tr>
      <th>BLR</th>
      <td>Belarus</td>
      <td>Upper middle income</td>
      <td>65.667637</td>
      <td>62.536094</td>
    </tr>
    <tr>
      <th>UKR</th>
      <td>Ukraine</td>
      <td>Lower middle income</td>
      <td>58.537270</td>
      <td>61.867179</td>
    </tr>
    <tr>
      <th>PER</th>
      <td>Peru</td>
      <td>Upper middle income</td>
      <td>54.905117</td>
      <td>48.305760</td>
    </tr>
    <tr>
      <th>ARM</th>
      <td>Armenia</td>
      <td>Upper middle income</td>
      <td>48.970412</td>
      <td>46.680070</td>
    </tr>
    <tr>
      <th>AZE</th>
      <td>Azerbaijan</td>
      <td>Upper middle income</td>
      <td>52.949213</td>
      <td>45.247656</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>やはり所得水準が比較的に低い国が入っている。</p>
<p><code class="docutils literal notranslate"><span class="pre">world_mean</span></code>を使いクロスセクションのデータをプロットしてみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax_</span> <span class="o">=</span> <span class="n">world_mean</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;money_growth_mean&#39;</span><span class="p">,</span><span class="s1">&#39;inflation_mean&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">)</span>
<span class="n">xpoints</span> <span class="o">=</span> <span class="n">ypoints</span> <span class="o">=</span> <span class="n">ax_</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
<span class="n">ax_</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xpoints</span><span class="p">,</span><span class="n">ypoints</span><span class="p">,</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;45度線&#39;</span><span class="p">)</span>
<span class="n">ax_</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;平均インフレ率とマネーストトックの平均成長率&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;15&#39;</span><span class="p">)</span>
<span class="n">ax_</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/19b2f8e9dc416677fcbe9c0390057294e3356f0cf87846570435486a96fca618.png" src="_images/19b2f8e9dc416677fcbe9c0390057294e3356f0cf87846570435486a96fca618.png" />
</div>
</div>
<p>綺麗に45度線上に並んでいる。国ごとに平均を計算することによって短期的なノイズが相殺され長期的な関係が浮かび上がっている。トレンド線の傾きを計算してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res_world_mean</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;inflation_mean ~ money_growth_mean&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">world_mean</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;標本の大きさ：</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">res_world_mean</span><span class="o">.</span><span class="n">nobs</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;調整済み決定係数：</span><span class="si">{</span><span class="n">res_world_mean</span><span class="o">.</span><span class="n">rsquared_adj</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res_world_mean</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>標本の大きさ：177
調整済み決定係数：0.945
=====================================================================================
                        coef    std err          t      P&gt;|t|      [0.025      0.975]
-------------------------------------------------------------------------------------
Intercept            -6.0805      0.461    -13.175      0.000      -6.991      -5.170
money_growth_mean     0.9847      0.018     54.876      0.000       0.949       1.020
=====================================================================================
</pre></div>
</div>
</div>
</div>
<p>推定値は１に非常に近い。もし図の左下にある外れ値のように見える値（ジンバブエ）を省くとスロープ係数は0.997になる。長期的には式<a class="reference internal" href="#equation-eq-11-qtm-growth-long">(111)</a>が示すように，マネーストック増加率の1％上昇はインフレ率1％上昇につかがること示す結果である。「真のメカニズム」の一部が垣間見えるような気がしませんか。</p>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="10_Data_Fluctuation.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">GDPと構成要素</p>
      </div>
    </a>
    <a class="right-next"
       href="18_ADAS-1.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">定量的マクロ経済分析：Part 1</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">はじめに</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">オークンの法則</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">説明</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sec-11-unemployment">失業率の特徴</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">回帰分析</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">フィリップス曲線</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">説明</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">インフレ率の特徴</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">フラット化するフィリップス曲線</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">インフレ率とマネーストックの増加率</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">説明</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">日本の時系列データ</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">説明</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#resample"><code class="docutils literal notranslate"><span class="pre">resample()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">データの作成</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">散布図とトレンド線</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">世界経済のパネルデータ</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">説明</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">変化率の計算</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">ハイパーインフレ</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">プロット</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By 春山 鉄源  Tetsugen HARUYAMA
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <!-- Default Statcounter code for Py4Macro https://py4macro.github.io --> <script type="text/javascript"> var sc_project=12478906; var sc_invisible=1; var sc_security="e767d225"; </script> <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script> <noscript><div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img class="statcounter" src="https://c.statcounter.com/12478906/0/e767d225/1/" alt="Web Analytics"></a></div></noscript> <!-- End of Statcounter Code -->
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>