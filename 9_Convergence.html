

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>所得分布と所得収斂 &#8212; Pythonで学ぶマクロ経済学 (中級＋レベル)</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/myadmonitions.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-3FB0WMD39P"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-3FB0WMD39P');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '9_Convergence';</script>
    <link rel="canonical" href="https://py4macro.github.io/9_Convergence.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="GDPと構成要素" href="10_Data_Fluctuation.html" />
    <link rel="prev" title="ソロー・モデル" href="8_Solow.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    <p class="title logo__title">Pythonで学ぶマクロ経済学 (中級＋レベル)</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Pythonの学習</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://py4basics.github.io">経済学のためのPython入門</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">長期分析</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="5a_Development_Accounting.html">発展会計</a></li>
<li class="toctree-l1"><a class="reference internal" href="5b_Growth_Accounting.html">成長会計</a></li>
<li class="toctree-l1"><a class="reference internal" href="6_Regression.html">回帰分析</a></li>
<li class="toctree-l1"><a class="reference internal" href="7_DifferenceEq.html">差分方程式と経済分析</a></li>
<li class="toctree-l1"><a class="reference internal" href="8_Solow.html">ソロー・モデル</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">所得分布と所得収斂</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">短期分析I</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="10_Data_Fluctuation.html">GDPと構成要素</a></li>
<li class="toctree-l1"><a class="reference internal" href="11_Macro_Variables.html">法則・曲線・増加率</a></li>
<li class="toctree-l1"><a class="reference internal" href="18_ADAS-1.html">定量的マクロ経済分析：Part 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="18_ADAS-2.html">定量的マクロ経済分析：Part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="12_IS-MP-PC.html">IS-MP-PCモデル</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">短期分析II</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="13_random_TFP.html">ランダム変数と全要素生産性</a></li>
<li class="toctree-l1"><a class="reference internal" href="14_linearsolve.html"><code class="docutils literal notranslate"><span class="pre">linearsolve</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="15_RBC.html">実物的景気循環(RBC)モデル</a></li>
<li class="toctree-l1"><a class="reference internal" href="16_data_on_money.html">古典派の二分法と金融政策</a></li>
<li class="toctree-l1"><a class="reference internal" href="Plan.html">今後の計画</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">参考</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://py4basics.github.io/Gapminder.html">Gapminder</a></li>
<li class="toctree-l1"><a class="reference external" href="https://py4etrics.github.io">Pythonで学ぶ入門計量経済学</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/Py4Macro/py4macro.github.io/source?urlpath=tree/9_Convergence.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/Py4Macro/py4macro.github.io/blob/source/9_Convergence.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/9_Convergence.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>所得分布と所得収斂</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">はじめに</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sec-9-distribution">所得分布の推移</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sec-9-convergence">所得収斂</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">説明</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">推定式の導出</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">推定結果の判断方法</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sec-9-simple-regression">単回帰分析：1970年〜2019年</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">データ</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#sec-9-saving">貯蓄率・資本減耗率・労働人口増加率の平均</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#gdp">一人当たりGDP成長率の平均</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">1970年の一人当たりGDP</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dataframe"><code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>の結合</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">成長率の分布</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sec-9-regression-result">結果</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hat-b">推定値<span class="math notranslate nohighlight">\(\hat{b}\)</span>の意味</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sec-9-multiple-regression">重回帰分析：1970年〜2019年</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#for">単回帰分析：<code class="docutils literal notranslate"><span class="pre">for</span></code>ループで回帰分析</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sec-9-multiple-for-loop">重回帰分析：<code class="docutils literal notranslate"><span class="pre">for</span></code>ループで回帰分析</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">まとめ</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="chap-distribution">
<span id="id1"></span><h1>所得分布と所得収斂<a class="headerlink" href="#chap-distribution" title="Permalink to this heading">#</a></h1>
<div name="html-admonition" style="font-size: 0.8em">
<input type="button" onclick="location.href='https://translate.google.com/translate?hl=&sl=ja&tl=en&u='+window.location;" value="Google translation" style="color:#ffffff;background-color:#008080; height:25px" onmouseover="this.style.background='#99ccff'" onmouseout="this.style.background='#008080'"/> in English or the language of your choice.
</div><br><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">japanize_matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">py4macro</span>
<span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">sm</span>
</pre></div>
</div>
</div>
</div>
<section id="id2">
<h2>はじめに<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h2>
<p><a class="reference internal" href="5a_Development_Accounting.html#chap-5a-accounting"><span class="std std-ref">発展会計</span></a>と<a class="reference internal" href="5b_Growth_Accounting.html#chap-5b-accounting"><span class="std std-ref">成長会計</span></a>の章では次の２つの問題を考察した。</p>
<blockquote>
<div><p>（問１）なぜある国は豊かで他の国は貧しいのだろうか？</p>
<p>（問２）なぜ国々の経済成長率は大きく異なるのか？</p>
</div></blockquote>
<p>ここでは関連する次の問を考える。</p>
<blockquote>
<div><p>（問３）貧しい国は豊かな国に追いついているのだろうか？</p>
</div></blockquote>
<p>この問いを考察するために２つのアプローチを使う。第一に，一人当たりGDPを使い世界経済の所得分布がどのように変化したかを図示し検討する。所得分布の形状の変化からキャッチアップ（catch-up）が発生しているかを推論しようということである。第二に，回帰分析の手法を使い所得が低い経済は先進国に追いついているかを検討する。即ち，所得収斂が起こっているかを定量的に探ってみようということである。</p>
<p>本題に入る前に，所得収斂の経済学的メカニズムを簡単に紹介する。</p>
<p><strong>＜資本の限界生産性の逓減＞</strong><br>
資本の限界生産性（MPK）とは，資本を１単位増やした場合にどれだけ産出が増加するかを示しており，完全競争の下では実質利子率と等しくなる。従って，MPKは資本投資の収益率と考えることができる。しかし資本が増加するとMPKは逓減し資本投資のリターンが減少する事になる。ソロー・モデルでは，このメカニズムにより経済は定常状態へ収束することになり，その過程で成長率が減少する事になる。即ち，資本が少ない経済（貧しい経済）の成長率は高く，資本が多い国（豊かな経済）は成長率が低くなり，所得収斂が発生すると考えられる。</p>
<p><strong>＜技術伝播＞</strong><br>
技術進歩には様々な形がある。(i)同じ財をより効率的に生産する技術，(ii)既存の財・サービスをより質が高いものへ進化させる技術，(iii)今まで存在しなかった新たな財・サービスの出現。(i)~(iii)が中間財の技術進歩であれば，その技術を採用した企業の生産性は上昇する。労働者の移動や様々なネットワークを通じて，それらは他の企業・産業に伝播し経済全体の生産性が向上することになる。技術には特許などの知的財産権に守られるものもあるが，特許権には20年間という時間的制限がある。また知的財産権で守られたとしても，そこからヒントを得た似た技術が広がることも頻繁に発生している。(ii)と(iii)が最終財であれば，消費財の伝播として広がるり効用の増加につながる。重要な点は，このような技術伝播は国内に限らず，国境をまたいで発生することである。国際貿易や人的交流，経済支援などの形で徐々に技術は広がり，新技術を採用する経済の所得は上昇することになる。また後進国にとって有利な点は，新たな技術開発費用よりも既存の技術採用費用の方が断然低いということである。一旦，新しい技術・知識が創出されると，伝播に時間は掛かるが，世界中で利用されるようになり所得収斂につながる。特に，「伝統的な財」と異なり，デジタル技術の輸送費用は低く伝播し易いと考えられる。<a class="reference external" href="https://translate.google.com/translate?hl=&amp;sl=en&amp;tl=ja&amp;u=https%3A%2F%2Fvoxeu.org%2Farticle%2Fgrowth-escalators-and-growth-convergence">参考資料</a></p>
<p><strong>＜制度の伝播＞</strong><br>
「大富豪」や「ページワン」などのトランプ・ゲームを考えよう。ルールに従ってプレーヤーはゲームを楽しむが，ルールが少しでも変わると勝つことを目的とするプレーヤーは戦略を変えることになる。即ち，ルールが変わると行動が変わるのである。法や習慣などの社会的ルールを所与として最適な行動を選択する消費者や企業の行動も同じである。法が変わり，既存の方法ではビジネスが成り立たたない場合，新たな方法で利潤を得ようとするだろう。ここでの社会的ルールとは政策を含む政治経済<strong>制度</strong>であり，制度が消費者と企業のインセンティブに影響を与えるのである。民主主義の日本と独裁国家では消費者・企業の行動は異なることになる。また所得水準が高くなる（過去の成長率が高かった）制度もあれば，富が少数に集中する搾取的な制度により所得が低いままの（過去の成長率が低かった）経済もある。ここで重要な点は，高所得を発生させる政策や制度が，それらを採用していない経済に伝播するということである。典型的な例がソビエト連邦と東側ヨーロッパ社会主義圏の崩壊である。計画に基づく経済活動は成長の鈍化・停滞を招き，最終的には市場という制度の「伝播」が起こったと解釈できる。また，中央銀行の独立性の確保はインフレのコントロールに重要だが，その究極の目的は経済全体の厚生の向上であり，その制度は各国に徐々に広がった。もっと広い意味での経済制度の伝播の例として，明治維新を含め封建社会からの脱却も挙げれるだろう。</p>
</section>
<section id="sec-9-distribution">
<span id="id3"></span><h2>所得分布の推移<a class="headerlink" href="#sec-9-distribution" title="Permalink to this heading">#</a></h2>
<p>世界経済の所得分布が時間と共にどのように変化したかを考えるが，手法としては，一人当たりGDPの分布自体の変化を図示して確認する。分析に使うデータはPenn World Talbeの次の２変数：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">rgdpe</span></code>：支出面から計算したGDP（連鎖PPPs; in mil. 2017US$）</p>
<ul>
<li><p>経済間そして時系列的にも一定な価格を使い計算されてい「実質」</p></li>
<li><p>経済間そして時間の次元での比較に適している</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">pop</span></code>：人口（in millions）</p></li>
</ul>
<p>これらのデータを使い，所得分布のヒストグラムとカーネル密度推定に基づくプロットを説明する。まず，一人当たりGDPの変数（対数）を作成する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Penn World Tableのデータ</span>
<span class="n">pwt</span> <span class="o">=</span> <span class="n">py4macro</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;pwt&#39;</span><span class="p">)</span>

<span class="c1"># 一人当たりGDP（対数）</span>
<span class="n">pwt</span><span class="p">[</span><span class="s1">&#39;gdp_pc_log&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span> <span class="n">pwt</span><span class="p">[</span><span class="s1">&#39;rgdpe&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">pwt</span><span class="p">[</span><span class="s1">&#39;pop&#39;</span><span class="p">]</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>例として2019年の日本の一人当たりGDPを表示してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_jp</span> <span class="o">=</span> <span class="n">pwt</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;country == &quot;Japan&quot; &amp; year == 2019&#39;</span><span class="p">)[</span><span class="s1">&#39;gdp_pc_log&#39;</span><span class="p">]</span>
<span class="n">y_jp</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6159    10.587516
Name: gdp_pc_log, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>このコードで返されるのは<code class="docutils literal notranslate"><span class="pre">Series</span></code>なので，<code class="docutils literal notranslate"><span class="pre">gdp_pc_log</span></code>の値自体を抽出するためには<code class="docutils literal notranslate"><span class="pre">.iloc[]</span></code>を使う。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_jp</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10.587515569810463
</pre></div>
</div>
</div>
</div>
<p>次に2019年のヒストグラムを作成しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cond</span> <span class="o">=</span> <span class="p">(</span> <span class="n">pwt</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2019</span> <span class="p">)</span>
<span class="n">pwt</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,</span><span class="s1">&#39;gdp_pc_log&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span>
                                <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                                <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e2a47e746659d7401978fc42a09d1f5b9e54387a15a584014e3d8dcc27945de9.png" src="_images/e2a47e746659d7401978fc42a09d1f5b9e54387a15a584014e3d8dcc27945de9.png" />
</div>
</div>
<p>ヒストグラムは縦軸に度数，横軸に階級を取ったグラフだが，関連する手法に<a class="reference external" href="https://en.wikipedia.org/wiki/Kernel_density_estimation">カーネル密度推定</a>と呼ばれるものがある。考え方は簡単で，上のようなヒストグラムのデータに基づき面積が１になるようにスムーズな分布を推計する手法である。詳細は割愛するが，下のコードではヒストグラムとカーネル密度関数を重ねてプロットする。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1 ヒストグラム</span>
<span class="n">ax_</span> <span class="o">=</span> <span class="n">pwt</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,</span><span class="s1">&#39;gdp_pc_log&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span>
                                      <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                                      <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span>
                                      <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># 2 密度関数</span>
<span class="n">pwt</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,</span><span class="s1">&#39;gdp_pc_log&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;density&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax_</span><span class="p">)</span>

<span class="c1"># 3 日本</span>
<span class="n">ax_</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">y_jp</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="c1"># 4 横軸の表示範囲</span>
<span class="n">ax_</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/17fd1c11b9632e6910fcc5bb33d2615ec85cf9f6e2d2c80b4aaf1c215072eb26.png" src="_images/17fd1c11b9632e6910fcc5bb33d2615ec85cf9f6e2d2c80b4aaf1c215072eb26.png" />
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">density=True</span></code>は縦軸を確率として表示する引数</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">kind='density'</span></code>は分布のスムーズな形を推定し表示する引数（密度関数を推定する）</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">axvline()</span></code>は<code class="docutils literal notranslate"><span class="pre">ax_</span></code>のメソッドであり，横軸の第一引数の値に垂直線を表示する。<code class="docutils literal notranslate"><span class="pre">color</span></code>は色を指定する引数。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">set_xlim()</span></code>は横軸の表示範囲を指定する。</p></li>
</ol>
</div>
<p>最頻値（モード）は中心より右側にあるが，横軸は対数になっていることを思い出そう。対数を取らない分布では，最頻値は分布の中心より左側に位置することになる。試してみよう。</p>
<p>ここで確かめたいのは，約70年の間に上の所得分布のどのように変化してきたか，という問題である。この問いに答えるために，カーネル密度関数（<code class="docutils literal notranslate"><span class="pre">kind=density</span></code>）を使って1950年から10年毎の分布を表示する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">yr_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1950</span><span class="p">,</span><span class="mi">2020</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span><span class="o">+</span><span class="p">[</span><span class="mi">2019</span><span class="p">]</span>                <span class="c1"># 1</span>

<span class="n">color_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">yr_list</span><span class="p">))</span>               <span class="c1"># 2</span>

<span class="k">for</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">yr_list</span><span class="p">,</span> <span class="n">color_arr</span><span class="p">):</span>                      <span class="c1"># 3</span>
    <span class="n">cond</span> <span class="o">=</span> <span class="p">(</span> <span class="n">pwt</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">y</span> <span class="p">)</span>                     <span class="c1"># 4</span>
    <span class="n">ax_</span> <span class="o">=</span> <span class="n">pwt</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,</span><span class="s1">&#39;gdp_pc_log&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;density&#39;</span><span class="p">,</span> <span class="c1"># 5</span>
                                          <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="p">),</span>   <span class="c1"># 6</span>
                                          <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>    <span class="c1"># 7</span>
                                          <span class="n">color</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>   <span class="c1"># 8</span>

<span class="n">ax_</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mf">5.5</span><span class="p">,</span><span class="mf">13.0</span><span class="p">])</span>                                  <span class="c1"># 9</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3be4347720e82a654ac504d00ac5f87f80c17d8f42a4878de389d8a43a21a3e1.png" src="_images/3be4347720e82a654ac504d00ac5f87f80c17d8f42a4878de389d8a43a21a3e1.png" />
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<ol class="arabic">
<li><p><code class="docutils literal notranslate"><span class="pre">range(start,</span> <span class="pre">end,</span> <span class="pre">step)</span></code>は<code class="docutils literal notranslate"><span class="pre">start</span></code>から<code class="docutils literal notranslate"><span class="pre">end</span></code>までの整数を<code class="docutils literal notranslate"><span class="pre">step</span></code>の間隔で準備する。更に<code class="docutils literal notranslate"><span class="pre">list()</span></code>を使ってリストに変換し，<code class="docutils literal notranslate"><span class="pre">+[2019]</span></code>を使ってリストの最後に<code class="docutils literal notranslate"><span class="pre">2019</span></code>を追加している。</p></li>
<li><p>グレーの濃淡で曲線の色指定するが，その場合<code class="docutils literal notranslate"><span class="pre">0</span></code>（黒）から<code class="docutils literal notranslate"><span class="pre">1</span></code>（白）の間の浮動小数点型を文字列型で指定する。そのために使う数字を用意している（後で文字列に変換する）。<code class="docutils literal notranslate"><span class="pre">np.linspace(0.9,0,len(yr_list))</span></code>は<code class="docutils literal notranslate"><span class="pre">0.9</span></code>から<code class="docutils literal notranslate"><span class="pre">0</span></code>までの数字（降順）で<code class="docutils literal notranslate"><span class="pre">yr_list</span></code>の要素と同じ数の値を生成し<code class="docutils literal notranslate"><span class="pre">array</span></code>として<code class="docutils literal notranslate"><span class="pre">color_arr</span></code>に割り当てている。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">zip</span></code>は引数の<code class="docutils literal notranslate"><span class="pre">yr_list</span></code>と<code class="docutils literal notranslate"><span class="pre">color_arr</span></code>の順番が同じ要素を一つのタプルにまとめる関数である。例えば，<code class="docutils literal notranslate"><span class="pre">list(zip(yr_list,color_arr))</span></code>はタプルが要素となるリストを返す。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="mi">1950</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">1960</span><span class="p">,</span> <span class="mf">0.7714285714285715</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">1970</span><span class="p">,</span> <span class="mf">0.6428571428571428</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">1980</span><span class="p">,</span> <span class="mf">0.5142857142857142</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">1990</span><span class="p">,</span> <span class="mf">0.3857142857142857</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mf">0.2571428571428571</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">2010</span><span class="p">,</span> <span class="mf">0.12857142857142845</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">2019</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)]</span>
</pre></div>
</div>
<p>このように<code class="docutils literal notranslate"><span class="pre">zip</span></code>関数は複数のリストや<code class="docutils literal notranslate"><span class="pre">array</span></code>の要素をタプルとしてまとめている。<code class="docutils literal notranslate"><span class="pre">for</span></code>ループが始まると，<code class="docutils literal notranslate"><span class="pre">0</span></code>番目の要素<code class="docutils literal notranslate"><span class="pre">(1950,</span> <span class="pre">0.9)</span></code>を使い<code class="docutils literal notranslate"><span class="pre">y</span></code>に<code class="docutils literal notranslate"><span class="pre">1950</span></code>，<code class="docutils literal notranslate"><span class="pre">c</span></code>に<code class="docutils literal notranslate"><span class="pre">0.9</span></code>が割り当てられ，その下のコードが実行される。同様に次のループでは<code class="docutils literal notranslate"><span class="pre">1</span></code>番目の要素<code class="docutils literal notranslate"><span class="pre">(1960,</span> <span class="pre">0.7714285714285715)</span></code>を使い<code class="docutils literal notranslate"><span class="pre">y</span></code>に<code class="docutils literal notranslate"><span class="pre">1960</span></code>，<code class="docutils literal notranslate"><span class="pre">c</span></code>に<code class="docutils literal notranslate"><span class="pre">0.7714285714285715</span></code>が割り当てられ，その下のコードが実行される。同じ作業が<code class="docutils literal notranslate"><span class="pre">(2019,</span> <span class="pre">0.0)</span></code>まで続くことになる。</p>
</li>
<li><p>列<code class="docutils literal notranslate"><span class="pre">year</span></code>で<code class="docutils literal notranslate"><span class="pre">y</span></code>と等しい行が<code class="docutils literal notranslate"><span class="pre">True</span></code>，そうでない行は<code class="docutils literal notranslate"><span class="pre">False</span></code>となる<code class="docutils literal notranslate"><span class="pre">Series</span></code>を<code class="docutils literal notranslate"><span class="pre">cond</span></code>に割り当てる。</p></li>
<li><p>列<code class="docutils literal notranslate"><span class="pre">'gdp_pc_log'</span></code>で<code class="docutils literal notranslate"><span class="pre">y</span></code>に該当する年の行を抽出し，密度関数を表示する。また，その「軸」を<code class="docutils literal notranslate"><span class="pre">ax_</span></code>に割り当てる。</p></li>
<li><p>凡例の表示を<code class="docutils literal notranslate"><span class="pre">y</span></code>の文字列とする。</p></li>
<li><p>凡例の表示を指定する。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">c</span></code>を文字列に変換しグレーの濃淡を指定する。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ax_</span></code>のメソッドである<code class="docutils literal notranslate"><span class="pre">set_xlim()</span></code>は横軸の表示範囲を指定する。</p>
<ul class="simple">
<li><p>最小値，最大値をリストもしくはタプルで指定する。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">set_xlim()</span></code>が設定されない場合は，自動で設定される。</p></li>
</ul>
</li>
</ol>
</div>
<p>まず分布は左から右に移動しているが，これは世界経済が成長している結果である。次に気づくのが，分布が左に偏っているが少しずつ右への偏りに変化しているように見える。これを数値として確かめるために歪度（わいど; skewness）という概念を使おう。歪度は平均や標準偏差のように簡単に計算できる統計量であり，次のように定義される。</p>
<div class="math notranslate nohighlight">
\[
S=\frac{n}{(n-1)(n-2)}
    \sum_{i=1}^n
    \left(
        \frac{
            x-\overline{x}
            }{s}
    \right)^3
\]</div>
<p>ここで<span class="math notranslate nohighlight">\(n\)</span>は標本の大きさ，<span class="math notranslate nohighlight">\(\overline{x}\)</span>は標本平均，<span class="math notranslate nohighlight">\(s\)</span>は標本標準偏差である。<a class="reference internal" href="#fig-7-skewness"><span class="std std-numref">Fig. 8</span></a>を使って歪度を説明しよう。</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(S&gt;0\)</span>：「正の歪み」がある分布と呼ばれる。</p>
<ul>
<li><p>「左に偏った」とも呼ばれる。</p></li>
<li><p>紛らわしいが，右裾が長くなっているため「右の歪み」とも呼ばれる。</p></li>
</ul>
</li>
<li><p><span class="math notranslate nohighlight">\(S&lt;0\)</span>：「負の歪み」がある分布と呼ばれる。</p>
<ul>
<li><p>「右に偏った」とも呼ばれる。</p></li>
<li><p>紛らわしいが，左裾が長くなっているため「左の歪み」があるとも呼ばれる。</p></li>
</ul>
</li>
<li><p><span class="math notranslate nohighlight">\(S=0\)</span>：左右対称分布</p></li>
</ul>
<figure class="align-default" id="fig-7-skewness">
<a class="reference internal image-reference" href="_images/skewness.jpeg"><img alt="_images/skewness.jpeg" src="_images/skewness.jpeg" style="width: 512.8000000000001px; height: 200.0px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 8 </span><span class="caption-text">Sの符号と分布の歪み（偏り）の関係</span><a class="headerlink" href="#fig-7-skewness" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>もしキャッチアップが起こると，一人当たりGDPが低い経済はより高い所得を得る経済に近づき，所得が比較的に高い国が増えることになる。従って，キャッチアップによって左側の分布から右側の分布に移り，それにつれて<span class="math notranslate nohighlight">\(S\)</span>は減少すると考えられる。では実際に歪度の推移を計算してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax_</span> <span class="o">=</span> <span class="n">pwt</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)[</span><span class="s1">&#39;gdp_pc_log&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">skew</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span>  <span class="c1"># 1</span>
                                                    <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1"># 2</span>
                                                    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;歪度&#39;</span><span class="p">)</span> <span class="c1"># 3</span>
<span class="n">ax_</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>  <span class="c1"># 4</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/51338d9443bb70621f9ed7a497a85d5d2d0a42caa7d09f71c0668d75821e6053.png" src="_images/51338d9443bb70621f9ed7a497a85d5d2d0a42caa7d09f71c0668d75821e6053.png" />
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<ol class="arabic simple">
<li><p>列<code class="docutils literal notranslate"><span class="pre">year</span></code>でグループ計算をおこなう。計算対象となる列は<code class="docutils literal notranslate"><span class="pre">gdp_pc_log</span></code>となり，計算方法はとして<code class="docutils literal notranslate"><span class="pre">.skew()</span></code>を使い歪度を計算する。ここでは<code class="docutils literal notranslate"><span class="pre">Series</span></code>が返される。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">[gdp_pc_log]</span></code>とすると<code class="docutils literal notranslate"><span class="pre">Series</span></code>を返す。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[[gdp_pc_log]]</span></code>とすると<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を返す。
<code class="docutils literal notranslate"><span class="pre">Series</span></code>のメソッド<code class="docutils literal notranslate"><span class="pre">plot</span></code>を使い図示するが，マーカーに<code class="docutils literal notranslate"><span class="pre">'o'</span></code>を指定する。</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">legend=True</span></code>は<code class="docutils literal notranslate"><span class="pre">Series</span></code>の場合に凡例を表示する際に必要となる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">label='歪度'</span></code>は凡例を変更する（<code class="docutils literal notranslate"><span class="pre">Series</span></code>の場合に有効）。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ax_</span></code>のメソッド<code class="docutils literal notranslate"><span class="pre">.axhline()</span></code>を使い<code class="docutils literal notranslate"><span class="pre">0</span></code>に赤の横線を引く。</p></li>
</ol>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>上のコードでは<code class="docutils literal notranslate"><span class="pre">Series</span></code>が返されているが，<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を返す場合は次のように書ける。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ax_</span> <span class="o">=</span> <span class="n">pwt</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)[[</span><span class="s1">&#39;gdp_pc_log&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">skew</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;gdp_pc_log&#39;</span><span class="p">:</span><span class="s1">&#39;歪度&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">ax_</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>凡例の表示を変更するために列ラベルを「歪度」に変更している。</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">forループで書く場合</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">year_list</span> <span class="o">=</span> <span class="n">pwt</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

<span class="n">skew_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">yr</span> <span class="ow">in</span> <span class="n">year_list</span><span class="p">:</span>                       <span class="c1"># 1</span>
    
    <span class="n">cond</span> <span class="o">=</span> <span class="p">(</span> <span class="n">pwt</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">yr</span> <span class="p">)</span>       <span class="c1"># 2</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">pwt</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,</span> <span class="s1">&#39;gdp_pc_log&#39;</span><span class="p">]</span>        <span class="c1"># 3</span>
    
    <span class="c1"># 歪度</span>
    <span class="n">skew_val</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">skew</span><span class="p">()</span>                    <span class="c1"># 4</span>
    <span class="n">skew_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">skew_val</span> <span class="p">)</span>           <span class="c1"># 5</span>

<span class="n">ax_</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;歪度&#39;</span><span class="p">:</span><span class="n">skew_list</span><span class="p">},</span>      <span class="c1"># 6</span>
                   <span class="n">index</span><span class="o">=</span><span class="n">year_list</span><span class="p">)</span> \
                  <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>        <span class="c1"># 7</span>
<span class="n">ax_</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>                <span class="c1"># 8</span>
</pre></div>
</div>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">year_list</span></code>に対して<code class="docutils literal notranslate"><span class="pre">for</span></code>ループの開始。</p></li>
<li><p>列<code class="docutils literal notranslate"><span class="pre">year</span></code>が<code class="docutils literal notranslate"><span class="pre">yr</span></code>と同じ場合は<code class="docutils literal notranslate"><span class="pre">True</span></code>となり，そうでない場合は<code class="docutils literal notranslate"><span class="pre">False</span></code>となる<code class="docutils literal notranslate"><span class="pre">Series</span></code>を返し<code class="docutils literal notranslate"><span class="pre">cond</span></code>に割り当てる。</p></li>
<li><p>列<code class="docutils literal notranslate"><span class="pre">gdp_pc_lo</span></code>で<code class="docutils literal notranslate"><span class="pre">cond</span></code>がTrue<code class="docutils literal notranslate"><span class="pre">となる行を</span></code>Series<code class="docutils literal notranslate"><span class="pre">として抽出し</span></code>s`に割り当てる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">s</span></code>のメソッド<code class="docutils literal notranslate"><span class="pre">.skew()</span></code>を使い，<code class="docutils literal notranslate"><span class="pre">s</span></code>の歪度を計算し<code class="docutils literal notranslate"><span class="pre">skew_val</span></code>に割り当てる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">skew_val</span></code>を<code class="docutils literal notranslate"><span class="pre">skew_list</span></code>に割り当てる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">skew_list</span></code>からなる<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を作成し，<code class="docutils literal notranslate"><span class="pre">year_list</span></code>を行インデックスに指定する。また(8)で<code class="docutils literal notranslate"><span class="pre">.plot()</span></code>によって生成される「軸」を<code class="docutils literal notranslate"><span class="pre">ax_</span></code>に割り当てる。</p></li>
<li><p>プロットのマーカーを<code class="docutils literal notranslate"><span class="pre">'o'</span></code>（点）に指定する。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ax_</span></code>のメソッド<code class="docutils literal notranslate"><span class="pre">.axhline()</span></code>を使い<code class="docutils literal notranslate"><span class="pre">0</span></code>に赤の横線を引く。</p></li>
</ol>
<p><code class="docutils literal notranslate"><span class="pre">.groupby()</span></code>の便利さとパワフルさが実感できるのではないだろうか。</p>
</div>
<p>次の特徴がある。</p>
<ul class="simple">
<li><p>1970年以降は減少トレンドが確認できる。このことからキャッチアップが発生していることを示唆している。また1990年頃を境に「正の歪み」から「負の歪み」に変化している。</p></li>
<li><p>1960年，1970年，1990年に上方・下方ジャンプが発生している。これは以下で確認するように，<code class="docutils literal notranslate"><span class="pre">gdp_pc_log</span></code>が<code class="docutils literal notranslate"><span class="pre">NaN</span></code>ではない国の数が大きく増加しているためである。</p></li>
<li><p>1970年前だけを考えると，歪度は上昇トレンドとなっている。これも欠損値がない国の数の変化による影響とも考えられる。</p></li>
</ul>
<p>これらの点を考えるために<code class="docutils literal notranslate"><span class="pre">gdp_pc_log</span></code>が<code class="docutils literal notranslate"><span class="pre">NaN</span></code>ではない国の数を確認しよう。次のコードは，2019年に<code class="docutils literal notranslate"><span class="pre">gdp_pc_log</span></code>が欠損値ではない国の数を返している。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cond</span> <span class="o">=</span> <span class="p">(</span> <span class="n">pwt</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2019</span> <span class="p">)</span>        <span class="c1"># 1</span>
<span class="n">pwt</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,</span><span class="s1">&#39;gdp_pc_log&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># 2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>183
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<p><code class="docutils literal notranslate"><span class="pre">notna()</span></code>は要素が<code class="docutils literal notranslate"><span class="pre">NaN</span></code>かどうかを調べるメソッドである。要素が<code class="docutils literal notranslate"><span class="pre">NaN</span></code>でなければ<code class="docutils literal notranslate"><span class="pre">True</span></code>を返し，<code class="docutils literal notranslate"><span class="pre">NaN</span></code>であれば<code class="docutils literal notranslate"><span class="pre">False</span></code>を返す。<code class="docutils literal notranslate"><span class="pre">notna</span></code>は英語の<code class="docutils literal notranslate"><span class="pre">not</span> <span class="pre">na</span></code>のことであり，<code class="docutils literal notranslate"><span class="pre">na</span></code>は<code class="docutils literal notranslate"><span class="pre">not</span> <span class="pre">available</span></code>の略で欠損値のこと。<code class="docutils literal notranslate"><span class="pre">True</span></code>は<code class="docutils literal notranslate"><span class="pre">1</span></code>と数えられるので，メソッド<code class="docutils literal notranslate"><span class="pre">sum()</span></code>を使うことにより<code class="docutils literal notranslate"><span class="pre">True</span></code>の数，即ち，<code class="docutils literal notranslate"><span class="pre">NaN</span></code>ではない要素の数を返す。</p>
</div>
<p>次に<code class="docutils literal notranslate"><span class="pre">for</span></code>ループを使って全ての年で<code class="docutils literal notranslate"><span class="pre">gdp_pc_log</span></code>に欠損値がない国の数を確認してみる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pwt</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)[</span><span class="s1">&#39;gdp_pc_log&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span>
                                               <span class="n">label</span><span class="o">=</span><span class="s1">&#39;国の数&#39;</span><span class="p">,</span>
                                               <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f7d0bb167fc37ad5788247f30f6a57e0166a598dc1c80447706c78a6edf6f609.png" src="_images/f7d0bb167fc37ad5788247f30f6a57e0166a598dc1c80447706c78a6edf6f609.png" />
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<ol class="arabic simple">
<li><p>列<code class="docutils literal notranslate"><span class="pre">year</span></code>でグループ計算をおこなう。計算対象となる列は<code class="docutils literal notranslate"><span class="pre">gdp_pc_log</span></code>となり，計算方法はとして<code class="docutils literal notranslate"><span class="pre">count()</span></code>を使い非欠損値の数を計算する。ここでは<code class="docutils literal notranslate"><span class="pre">Series</span></code>が返される。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">[gdp_pc_log]</span></code>とすると<code class="docutils literal notranslate"><span class="pre">Series</span></code>を返す。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[[gdp_pc_log]]</span></code>とすると<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を返す。
<code class="docutils literal notranslate"><span class="pre">Series</span></code>のメソッド<code class="docutils literal notranslate"><span class="pre">plot</span></code>を使い図示するが，マーカーに<code class="docutils literal notranslate"><span class="pre">'o'</span></code>を指定する。</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">legend=True</span></code>は<code class="docutils literal notranslate"><span class="pre">Series</span></code>の場合に凡例を表示する際に必要となる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">label='国の数'</span></code>は凡例を変更する（<code class="docutils literal notranslate"><span class="pre">Series</span></code>の場合に有効）。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ax_</span></code>のメソッド<code class="docutils literal notranslate"><span class="pre">.axhline()</span></code>を使い<code class="docutils literal notranslate"><span class="pre">0</span></code>に赤の横線を引く。</p></li>
</ol>
</div>
<div class="dropdown admonition">
<p class="admonition-title">forループで書く場合</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">year_list</span> <span class="o">=</span> <span class="n">pwt</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">notna_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">yr</span> <span class="ow">in</span> <span class="n">year_list</span><span class="p">:</span>
    <span class="n">cond</span> <span class="o">=</span> <span class="p">(</span> <span class="n">pwt</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">yr</span> <span class="p">)</span>                <span class="c1"># 1</span>
    <span class="n">no</span> <span class="o">=</span> <span class="n">pwt</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,</span> <span class="s1">&#39;gdp_pc_log&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># 2</span>
    <span class="n">notna_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">no</span><span class="p">)</span>

<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;国の数&#39;</span><span class="p">:</span><span class="n">notna_list</span><span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">year_list</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ol class="arabic simple">
<li><p>列<code class="docutils literal notranslate"><span class="pre">year</span></code>が<code class="docutils literal notranslate"><span class="pre">yr</span></code>と等しい行が<code class="docutils literal notranslate"><span class="pre">True</span></code>となり，そうでない行は<code class="docutils literal notranslate"><span class="pre">False</span></code>となる<code class="docutils literal notranslate"><span class="pre">Series</span></code>を返す。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gdp_pc_log</span></code>の列で<code class="docutils literal notranslate"><span class="pre">cond</span></code>が<code class="docutils literal notranslate"><span class="pre">True</span></code>の行を<code class="docutils literal notranslate"><span class="pre">Series</span></code>としてを返す。そのメソッド<code class="docutils literal notranslate"><span class="pre">.notna()</span></code>は欠損値でない場合は<code class="docutils literal notranslate"><span class="pre">True</span></code>を返し，欠損値の場合は<code class="docutils literal notranslate"><span class="pre">False</span></code>を返す。<code class="docutils literal notranslate"><span class="pre">.sum()</span></code>は<code class="docutils literal notranslate"><span class="pre">True</span></code>の数を返し<code class="docutils literal notranslate"><span class="pre">no</span></code>に割り当てる。</p></li>
</ol>
</div>
<p>上の図から<code class="docutils literal notranslate"><span class="pre">gdp_pc_log</span></code>が欠損値でない国は増加しており，1960年，1970年，1990年に大きく増えている。データが整備されている国は典型的に先進国であり，後から含まれる国は比較的に所得が低い経済である。従って，貧しい国が所得分布に含まれることにより，分布は左側に引っ張られる傾向にある。特に，1950年から1960年には徐々に国の数は増えているが，それが歪度の上昇につながっていると考えられる。また1960年と1970年の国の数の急激な増加が歪度の上方ジャンプとして現れている。このようなことから，1970年までの歪度の上昇トレンドは，貧しい経済がPWTのデータセットに含まれることによって引き起こされており，豊かな国と比較して貧しい国が引き離されているからではない。一方で，1970年以降も国の数は膨らんでいるが，それにも関わらず歪度は減少傾向を示しているということはキャッチアップが発生していることを示唆している。典型的な例は，台湾，シンガポール，香港，韓国，中国やインドなどである。</p>
<p>分布の形の変化を確認するために歪度を使ったが，キャッチアップを捉える統計量として変動係数を考えてみよう。変動係数は分布の広がりを示す統計量であり，次のように定義される。</p>
<div class="math notranslate nohighlight">
\[
\text{変動係数（Coefficient of Variation）}＝\dfrac{\text{標準偏差}}{\text{平均}}
\]</div>
<p>変動係数は平均値１単位あたりの標準偏差を表しており，平均値を使って標準化することにより分布の幅の程度を比べることが可能となる。キャッチアップにより経済間お所得格差を示す変動係数は減少すると予想される。次のコードを使って変動係数の推移を計算してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">cv</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>                   <span class="c1"># 1</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">/</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="n">pwt</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)[</span><span class="s1">&#39;gdp_pc_log&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">cv</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>    <span class="c1"># 2</span>
                                               <span class="n">label</span><span class="o">=</span><span class="s1">&#39;変動係数&#39;</span><span class="p">)</span> <span class="c1"># 3</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f643355bfa5f1fefb82e1e340a2f9926a57482cfa0e4912b661a1fbcbfd4add8.png" src="_images/f643355bfa5f1fefb82e1e340a2f9926a57482cfa0e4912b661a1fbcbfd4add8.png" />
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<ol class="arabic simple">
<li><p>変動係数を計算するメソッドが用意されていないので，ユーザー定義の関数を作成する。</p></li>
<li><p>列<code class="docutils literal notranslate"><span class="pre">year</span></code>でグループ計算をおこなう。計算対象となる列は<code class="docutils literal notranslate"><span class="pre">gdp_pc_log</span></code>となる。関数<code class="docutils literal notranslate"><span class="pre">cv</span></code>を使うためにメソッド<code class="docutils literal notranslate"><span class="pre">agg()</span></code>を使う。ここでは<code class="docutils literal notranslate"><span class="pre">Series</span></code>が返される。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">[gdp_pc_log]</span></code>とすると<code class="docutils literal notranslate"><span class="pre">Series</span></code>を返す。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[[gdp_pc_log]]</span></code>とすると<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を返す。
<code class="docutils literal notranslate"><span class="pre">Series</span></code>のメソッド<code class="docutils literal notranslate"><span class="pre">plot</span></code>を使い図示するが，凡例表示を指定する。</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">label='変動係数'</span></code>は凡例を変更する（<code class="docutils literal notranslate"><span class="pre">Series</span></code>の場合に有効）。</p></li>
</ol>
</div>
<div class="dropdown admonition">
<p class="admonition-title">forループの場合</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">year_list</span> <span class="o">=</span> <span class="n">pwt</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">cv_list</span> <span class="o">=</span> <span class="p">[]</span>   <span class="c1"># 空のリスト</span>

<span class="k">for</span> <span class="n">yr</span> <span class="ow">in</span> <span class="n">year_list</span><span class="p">:</span>
    <span class="n">cond</span> <span class="o">=</span> <span class="p">(</span> <span class="n">pwt</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">yr</span> <span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">pwt</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,</span> <span class="s1">&#39;gdp_pc_log&#39;</span><span class="p">]</span>
    <span class="n">stdev</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>                 <span class="c1"># 1</span>
    <span class="n">avr</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>                  <span class="c1"># 2</span>
    <span class="n">cv</span> <span class="o">=</span> <span class="n">stdev</span> <span class="o">/</span> <span class="n">avr</span>                <span class="c1"># 3</span>
    <span class="n">cv_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cv</span><span class="p">)</span>

<span class="n">df_cv</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;CV&#39;</span><span class="p">:</span><span class="n">cv_list</span><span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">year_list</span><span class="p">)</span>  <span class="c1"># 4</span>
</pre></div>
</div>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">s</span></code>は<code class="docutils literal notranslate"><span class="pre">cond</span></code>の条件を満たす<code class="docutils literal notranslate"><span class="pre">gdp_pc_log</span></code>の列の要素からなる<code class="docutils literal notranslate"><span class="pre">Series</span></code>だが，そのメソッド<code class="docutils literal notranslate"><span class="pre">.std()</span></code>を使い標準偏差を計算し<code class="docutils literal notranslate"><span class="pre">stdev</span></code>に割り当てる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">s</span></code>のメソッド<code class="docutils literal notranslate"><span class="pre">.mean()</span></code>を使い平均を計算し<code class="docutils literal notranslate"><span class="pre">avr</span></code>に割り当てる。</p></li>
<li><p>変動係数を計算し<code class="docutils literal notranslate"><span class="pre">cv</span></code>に割り当てる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">index=year_list</span></code>は行インデックスにyear_listを設定しており，それにより，次のコードでは自動的に横軸が年になる。</p></li>
</ol>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>関数<code class="docutils literal notranslate"><span class="pre">cv</span></code>の代わりに<code class="docutils literal notranslate"><span class="pre">lambda</span></code>関数を使うと１行のコードで図が描ける事になる。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pwt</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)[</span><span class="s1">&#39;gdp_pc_log&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">/</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;変動係数&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>ちなみに，１行コードをone linerと英語で表現する。注意する点は，one linerが必ずしも良いとは限らないという点である。可読性が損なわれる場合があるためである。</p>
</div>
<p>サンプルに含まれる国の数が徐々に増えており，その影響により変動係数は増える傾向にある。1990年ごろにはデータセットに含まれる国の数は安定し，その後直ぐに変動係数は減少し始めている。即ち，少なくとも1990年代半ば頃から変動係数で測る経済間の所得格差は減少している。変動係数を見る限りキャッチアップの効果が1990年代から現れていると言える。</p>
<p>上で扱った変動係数は経済間における所得格差を表す指標として解釈することができるが，その場合次の点に注意する必要がある。</p>
<ul class="simple">
<li><p>分析の対象は国であり，それぞれの国の一人当たりGDPのみを考えた。中国やインドのように大きな国も，ルクセンブルクやシンガポールのように小さな国も１つの経済として扱っている。この場合の変動係数は，全ての国には一人だけしか住んでいないと仮定した場合の経済間の所得格差と同じであり，<strong>国内</strong>の人口や所得不平等やは全く考慮されていない。</p></li>
</ul>
</section>
<section id="sec-9-convergence">
<span id="id4"></span><h2>所得収斂<a class="headerlink" href="#sec-9-convergence" title="Permalink to this heading">#</a></h2>
<section id="id5">
<h3>説明<a class="headerlink" href="#id5" title="Permalink to this heading">#</a></h3>
<p>ここでは問３を回帰分析の手法に基づき検討する。問３を捉えるにはどのような回帰式になれば良いだろうか？ヒントはソロー・モデルにある。式<a class="reference internal" href="8_Solow.html#equation-eq-8-kgrowth">(33)</a>（以下に再掲）は一人当たり資本ストックの成長率を示している。</p>
<div class="math notranslate nohighlight" id="equation-eq-9-kgrowth">
<span class="eqno">(46)<a class="headerlink" href="#equation-eq-9-kgrowth" title="Permalink to this equation">#</a></span>\[
\frac{k_{t+1}}{k_t}-1 = \frac{sAk_t^{-(1-a)}-(n+d)}{1+n}
\]</div>
<p><span class="math notranslate nohighlight">\(k_t\)</span>が増加すると右辺は減少する。即ち，資本ストックが多い経済の資本の成長率は低く，資本ストックが少ない経済の資本の成長率は高いと予測する。では一人当たりGDPではどうだろう。式<a class="reference internal" href="8_Solow.html#equation-eq-8-ygrowth">(34)</a>（以下に再掲）が成長率を示すが，同様の結果である。</p>
<div class="math notranslate nohighlight" id="equation-eq-9-ygrowth">
<span class="eqno">(47)<a class="headerlink" href="#equation-eq-9-ygrowth" title="Permalink to this equation">#</a></span>\[
\frac{y_{t+1}}{y_t}-1
=\left(\frac{k_{t+1}}{k_t}\right)^{\alpha}-1
\]</div>
<p><span class="math notranslate nohighlight">\(k_t\)</span>と<span class="math notranslate nohighlight">\(y_t\)</span>は同じ方向に動くので，所得水準が高ければ成長率は低く，所得水準が低ければ成長率は高くなることが分かる。この点を捉えるために，<span class="math notranslate nohighlight">\(T=t_0-t\)</span>期間のデータに基づく次の推定式が想定できる。</p>
<div class="math notranslate nohighlight" id="equation-eq-9-absolute-convergence">
<span class="eqno">(48)<a class="headerlink" href="#equation-eq-9-absolute-convergence" title="Permalink to this equation">#</a></span>\[
(T\text{期間の平均成長率})_i = a + b\times(t_0\text{における一人当たりGDP（対数）})_i + u_i
\]</div>
<p>説明変数は初期時点（<span class="math notranslate nohighlight">\(t_0\)</span>）の一人当たりGDPであり，その後の<span class="math notranslate nohighlight">\(T\)</span>期間における平均成長率が左辺の被説明変数となっており，式<a class="reference internal" href="#equation-eq-9-ygrowth">(47)</a>の関係を反映している。<span class="math notranslate nohighlight">\(i\)</span>は経済を表すとして推定値<span class="math notranslate nohighlight">\(\hat{b}\)</span>が<strong>負</strong>の値であれば，キャッチアップが起こっていることが確認できることになる。次のように定義としてまとめよう。</p>
<blockquote>
<div><p>＜絶対的所得収斂＞</p>
<p>資本ストックが多い（豊かな）国の一人当たりGDPの成長率は低く，資本ストックが少ない（貧しい）国の一人当たりGDPの成長率は高い。</p>
</div></blockquote>
<p>絶対的所得収斂は，貧しい国が豊かな国をキャッチアップすることを意味している。</p>
<p>ここで重要な注意点が一つある。マラソンを想像しよう。トップの選手が折り返し地点に達した時点で，最後尾の選手が走った距離はゴールまでの半分以下である。しかし最後尾の選手がトップ選手よりも速く走り，その状態が続けばゴールまでに追いつくか，もしくはゴールまでにトップ選手との距離を縮めることができる。このマラソンの話の中で前提になっているのが，「全ての選手にとってゴールは同じ」だということである。走った距離を一人当たりGDPの水準，走っている速度を成長率と考え所得収斂の話しに戻すと，マラソンのゴールに対応するのが長期均衡である定常状態である。定常状態が同じという状態は，式<a class="reference internal" href="8_Solow.html#equation-eq-8-kss">(35)</a>と<a class="reference internal" href="8_Solow.html#equation-eq-8-yss">(36)</a>が示す様に，５つのパラメータ（<span class="math notranslate nohighlight">\(s\)</span>，<span class="math notranslate nohighlight">\(A\)</span>，<span class="math notranslate nohighlight">\(a\)</span>，<span class="math notranslate nohighlight">\(n\)</span>，<span class="math notranslate nohighlight">\(d\)</span>）が同じ状態である。それが成立する場合にキャッチアップが発生することを意味しているのが絶対的所得収斂である。</p>
<p>もう一度マラソンの話に戻そう。選手ごとにゴールが違ったらどうだろう。もうマラソンとは言えないが，選手が走った距離だけでは追いついているのかどうかを語れなくなり，他の情報が必要になる。特に，ゴールの位置，そしてゴールまでの距離である。同様に，それぞれの経済のパラメータの値が異なり定常状態が違えば，キャチアップしているかは式<a class="reference internal" href="#equation-eq-9-absolute-convergence">(48)</a>では判断できなくなる。では，定常状態の違いを捉える経済構造を反映する変数<span class="math notranslate nohighlight">\(X_i\)</span>を加えた次式であれば良いのだろうか。</p>
<div class="math notranslate nohighlight" id="equation-eq-9-conditional-convergence">
<span class="eqno">(49)<a class="headerlink" href="#equation-eq-9-conditional-convergence" title="Permalink to this equation">#</a></span>\[
(T\text{期間の平均成長率})_i = a + cX_i + b\times(t_0\text{における一人当たりGDP（対数）})_i + u_i
\]</div>
<p>推定値<span class="math notranslate nohighlight">\(\hat{b}\)</span>が<strong>負</strong>の値を取った場合の解釈を考えてみよう。変数<span class="math notranslate nohighlight">\(X_i\)</span>により，<span class="math notranslate nohighlight">\(\hat{b}\)</span>は定常状態（ゴール）の位置や定常状態までの「距離」がコントロール（考慮）された推定値となっている。従って，推定値<span class="math notranslate nohighlight">\(\hat{b}\)</span>は，定常状態までの残りの「距離」が遠ければ成長率は高く，残りの「距離」がが短ければ成長率は低い，ということを示している。これで経済間のキャッチアップを捉えているのだろうか。答えは「否」である。この点を説明するために，貧しい国の定常状態は豊かな国のそれよりも低いケースを考えてみよう。この場合，長期的に絶対的所得収斂は発生しないことは明らかである。しかし，貧しい国は定常状態から遠く離れ，一時的に豊かな経済よりも成長速度が高いことはあり得るのである。即ち，推定値<span class="math notranslate nohighlight">\(\hat{b}\)</span>が<strong>負</strong>の値であっても絶対的所得収斂は成立しない可能性は排除できないのである。</p>
<p>絶対的所得収斂をマラソンに例えたが，２つには決定的な違いがある。マラソンはゴールに到達する順番が重要である。選手毎にゴールの位置が違う「変形マラソン」でも同じである。一方，所得収斂では定常状態に到達する順番は重要ではない。重要なのな定常状態（ゴール）の<strong>位置</strong>である。長期的に所得が収斂するかは定常状態の位置で決定され，定常状態の到達順位は全く関係ない。従って，定常状態が異なることが前提となる式<a class="reference internal" href="#equation-eq-9-conditional-convergence">(49)</a>の推定値<span class="math notranslate nohighlight">\(\hat{b}\)</span>は問３についての明白な答えとはならない。もちろん式<a class="reference internal" href="#equation-eq-9-conditional-convergence">(49)</a>を推定する意味がないということではない。推定値<span class="math notranslate nohighlight">\(\hat{c}\)</span>は，成長率に対する経済構造の違いを明らかにする事になる。</p>
<div class="warning admonition">
<p class="admonition-title">条件付き所得収斂</p>
<p>回帰式<a class="reference internal" href="#equation-eq-9-conditional-convergence">(49)</a>の推定値<span class="math notranslate nohighlight">\(\hat{b}\)</span>が統計的に有意な負の値を取る場合を<strong>条件付き所得収斂</strong>呼ぶ。しかし説明したように，所得収斂には無関係の値であり誤解を招きやすい用語となっている。</p>
</div>
</section>
<section id="id6">
<h3>推定式の導出<a class="headerlink" href="#id6" title="Permalink to this heading">#</a></h3>
<p>推定式<a class="reference internal" href="#equation-eq-9-absolute-convergence">(48)</a>と<a class="reference internal" href="#equation-eq-9-conditional-convergence">(49)</a>はソロー・モデルに基づいている。具体的には，式<a class="reference internal" href="8_Solow.html#equation-eq-8-y-difference-eq">(44)</a>は，ソロー・モデルの均衡式を定常状態の近傍で線形近似して導出された<span class="math notranslate nohighlight">\(y_t\)</span>の差分方程式だが，この式を整理すると推定式が導出される。この節では導出方法を示すのが目的であり，技術的なものに興味がなければ次に進んでも良いだろう。</p>
<p>式<a class="reference internal" href="8_Solow.html#equation-eq-8-y-difference-eq">(44)</a>を1期ずらして次のように書き換える。</p>
<div class="math notranslate nohighlight">
\[
y_t-y_{t-1}=\lambda(y_*-y_{t-1})
\]</div>
<p>更に両辺を<span class="math notranslate nohighlight">\(y_{t-1}\)</span>で割り，<span class="math notranslate nohighlight">\(\log(1+x-1)\approx x-1\)</span>の近似を使い整理すると次式となる。</p>
<div class="math notranslate nohighlight">
\[
m_t=(1-\lambda)m_{t-1}+\lambda m_*
\]</div>
<p>ここで</p>
<div class="math notranslate nohighlight" id="equation-eq-9-mt">
<span class="eqno">(50)<a class="headerlink" href="#equation-eq-9-mt" title="Permalink to this equation">#</a></span>\[
m_t\equiv\log(y_t)
\]</div>
<p>次に逐次的代入をおこなう。</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
m_t
&amp;=(1-\lambda)m_{t-1}+\lambda m_* \\
&amp;=(1-\lambda)[(1-\lambda)m_{t-2}+\lambda m_*]+\lambda m_* \\
&amp;=(1-\lambda)^2m_{t-2}+[(1-\lambda) + 1]\lambda m_* \\
&amp;=(1-\lambda)^2[(1-\lambda)m_{t-3}+\lambda m_*]+[(1-\lambda) + 1]\lambda m_* \\
&amp;=(1-\lambda)^3m_{t-3}+[(1-\lambda)^2+(1-\lambda)+ 1]\lambda m_* \\
&amp;=\quad\vdots \\
&amp;=(1-\lambda)^tm_{0}+\lambda m_*\sum_{i=0}^{t-1}(1-\lambda)^i \\
&amp;=(1-\lambda)^tm_{0}+\left[1-(1-\lambda)^t\right]m_*
\end{align*}
\end{split}\]</div>
<p>両辺から<span class="math notranslate nohighlight">\(m_0\)</span>を引き，<span class="math notranslate nohighlight">\(t\)</span>で割り，式<a class="reference internal" href="#equation-eq-9-mt">(50)</a>を使うと次式を得る。</p>
<div class="math notranslate nohighlight" id="equation-eq-9-regression">
<span class="eqno">(51)<a class="headerlink" href="#equation-eq-9-regression" title="Permalink to this equation">#</a></span>\[
\frac{1}{t}\log\left(\frac{y_t}{y_0}\right)
=a + b\log(y_0)
\]</div>
<div class="math notranslate nohighlight" id="equation-eq-9-a">
<span class="eqno">(52)<a class="headerlink" href="#equation-eq-9-a" title="Permalink to this equation">#</a></span>\[
a\equiv\frac{1-(1-\lambda)^t}{t}\log(y_*)&gt;0,
\]</div>
<div class="math notranslate nohighlight" id="equation-eq-9-b">
<span class="eqno">(53)<a class="headerlink" href="#equation-eq-9-b" title="Permalink to this equation">#</a></span>\[
b\equiv\frac{(1-\lambda)^t-1}{t}&lt;0
\]</div>
<p>式<a class="reference internal" href="#equation-eq-9-regression">(51)</a>の左辺は<span class="math notranslate nohighlight">\(t\)</span>期間の一人当たりGDPの平均成長率であり，右辺には定数項と初期の一人当たりGDP（対数）が説明変数として配置されている。式<a class="reference internal" href="#equation-eq-9-regression">(51)</a>が推定式<a class="reference internal" href="#equation-eq-9-absolute-convergence">(48)</a>と<a class="reference internal" href="#equation-eq-9-conditional-convergence">(49)</a>と同じであることは明白である。</p>
<p>２つ重要な点がある。</p>
<ul>
<li><p>定数項<span class="math notranslate nohighlight">\(a\)</span>は一人当たりGDPの定常値<span class="math notranslate nohighlight">\(y_*\)</span>によって決定される。ソロー・モデルにおける定常値は式<a class="reference internal" href="8_Solow.html#equation-eq-8-yss">(36)</a>であり，パラメータである貯蓄率<span class="math notranslate nohighlight">\(s\)</span>，労働人口増加率<span class="math notranslate nohighlight">\(n\)</span>そして資本減耗率<span class="math notranslate nohighlight">\(d\)</span>に依存している。より一般的に考えると，定数項<span class="math notranslate nohighlight">\(a\)</span>は経済構造を捉えるあらゆる変数に依存しているとも考えられる。また式<a class="reference internal" href="8_Solow.html#equation-eq-8-lambda-g">(42)</a>で定義される<span class="math notranslate nohighlight">\(\lambda\)</span>にも依存する。</p>
<ul class="simple">
<li><p>推定式<a class="reference internal" href="#equation-eq-9-absolute-convergence">(48)</a>は全てのパラメータが同じであることを仮定している。</p></li>
<li><p>推定式<a class="reference internal" href="#equation-eq-9-conditional-convergence">(49)</a>は式<a class="reference internal" href="#equation-eq-9-a">(52)</a>の違いを捉えるために<span class="math notranslate nohighlight">\(X_i\)</span>が含まれている。</p></li>
</ul>
</li>
<li><p>パラメータ<span class="math notranslate nohighlight">\(b\)</span>は<span class="math notranslate nohighlight">\(\lambda\)</span>に依存しており，次式を使い推定値<span class="math notranslate nohighlight">\(\hat{b}\)</span>から収束速度<span class="math notranslate nohighlight">\(\lambda\)</span>を計算できる。</p>
<div class="math notranslate nohighlight" id="equation-eq-9-lambdahat">
<span class="eqno">(54)<a class="headerlink" href="#equation-eq-9-lambdahat" title="Permalink to this equation">#</a></span>\[
    \lambda=1-(1+bt)^{\frac{1}{t}}
    \]</div>
</li>
</ul>
</section>
<section id="id7">
<h3>推定結果の判断方法<a class="headerlink" href="#id7" title="Permalink to this heading">#</a></h3>
<p>次の順序で推定する。</p>
<ol class="arabic simple">
<li><p>回帰式<a class="reference internal" href="#equation-eq-9-absolute-convergence">(48)</a>推定する。</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\hat{b}\)</span>が負であり統計的有意性が高ければ，絶対的所得収斂を示唆する結果として次に進む。</p></li>
</ul>
</li>
<li><p>回帰式<a class="reference internal" href="#equation-eq-9-conditional-convergence">(49)</a>推定する。</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\hat{b}\)</span>が負であり統計的有意性が高く，また他の説明変数の有意性が低ければ絶対的所得収斂が成立すると判断する（<span class="math notranslate nohighlight">\(F\)</span>検定）。</p></li>
<li><p>その他の場合は絶対的所得収斂は成立しないと判断する。</p></li>
</ul>
</li>
</ol>
</section>
<section id="sec-9-simple-regression">
<span id="id8"></span><h3>単回帰分析：1970年〜2019年<a class="headerlink" href="#sec-9-simple-regression" title="Permalink to this heading">#</a></h3>
<section id="id9">
<h4>データ<a class="headerlink" href="#id9" title="Permalink to this heading">#</a></h4>
<p>ここではPenn World Talbeに含まれる次の変数を使う。後で使う変数も含めてデータを整形することにしよう。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">rgdpna</span></code>：GDP（国民計算）</p>
<ul>
<li><p>平均成長率の計算に使う</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">cgdpo</span></code>：GDP（生産側）</p>
<ul>
<li><p>初期時点の一人当たりGDPの計算に使う</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">emp</span></code>：雇用者数</p>
<ul>
<li><p>労働人口の代わりに使う。</p></li>
<li><p>労働人口増加率<span class="math notranslate nohighlight">\(n\)</span>の計算に使う。</p></li>
<li><p>平均増加率として定常状態を捉える変数として使う。</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">csh_i</span></code>：GDPに対しての資本形成の比率</p>
<ul>
<li><p>投資の対GDP比である。</p></li>
<li><p>貯蓄率<span class="math notranslate nohighlight">\(s\)</span>の代わりに使う。</p></li>
<li><p>平均値を定常状態を捉える変数として使う。</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">delta</span></code>：資本ストックの年平均減耗率</p>
<ul>
<li><p>平均値を定常状態を捉える変数として使う。</p></li>
</ul>
</li>
</ul>
<p>最初に1970年以降のデータを抽出する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1970</span> <span class="o">=</span> <span class="n">py4macro</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;pwt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;year &gt;= 1970&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="sec-9-saving">
<span id="id10"></span><h5>貯蓄率・資本減耗率・労働人口増加率の平均<a class="headerlink" href="#sec-9-saving" title="Permalink to this heading">#</a></h5>
<p>1970年〜2019年の貯蓄率，資本減耗率の平均，労働人口増加率を計算するが，<a class="reference internal" href="8_Solow.html#sec-8-data"><span class="std std-ref">ソロー・モデル</span></a>の章で使ったコードを再利用することもできる。ここでは<code class="docutils literal notranslate"><span class="pre">.groupby()</span></code>を使った計算を紹介することにする。<code class="docutils literal notranslate"><span class="pre">.groupby()</span></code>を使いデータのグループ計算をする際，自作関数を使うことができる。まずその自作関数を定義しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mean_nan</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>         <span class="c1"># 1</span>
    <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>  <span class="c1"># 2</span>
        <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>  <span class="c1"># 3</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>    <span class="c1"># 4</span>
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">groupby()</span></code>に使うので，引数<code class="docutils literal notranslate"><span class="pre">x</span></code>は，各グループのデータと解釈する。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.notna()</span></code>は<code class="docutils literal notranslate"><span class="pre">x</span></code>が欠損値でない場合に<code class="docutils literal notranslate"><span class="pre">True</span></code>を返し，欠損値の場合は<code class="docutils literal notranslate"><span class="pre">False</span></code>を返す。<code class="docutils literal notranslate"><span class="pre">x.notna()</span></code>はグループのデータを<code class="docutils literal notranslate"><span class="pre">True/False</span></code>として置き換えたデータを返すことになる。一方，<code class="docutils literal notranslate"><span class="pre">.all()</span></code>は全てが<code class="docutils literal notranslate"><span class="pre">True</span></code>であれば<code class="docutils literal notranslate"><span class="pre">True</span></code>を返し，１つ以上<code class="docutils literal notranslate"><span class="pre">False</span></code>があれば<code class="docutils literal notranslate"><span class="pre">False</span></code>を返す。従って，<code class="docutils literal notranslate"><span class="pre">x.notna().all()</span></code>はグループのデータに欠損値がなければ<code class="docutils literal notranslate"><span class="pre">True</span></code>を，１つでも<code class="docutils literal notranslate"><span class="pre">False</span></code>があれば<code class="docutils literal notranslate"><span class="pre">False</span></code>を返す。</p></li>
<li><p>グループ・データに欠損値がない場合にのみ，その平均を返す。</p></li>
<li><p>１つ以上<code class="docutils literal notranslate"><span class="pre">False</span></code>があれば<code class="docutils literal notranslate"><span class="pre">np.nan</span></code>を返す。ここで<code class="docutils literal notranslate"><span class="pre">np.nan</span></code>とは<code class="docutils literal notranslate"><span class="pre">NumPy</span></code>で生成する浮動小数点型であり，欠損値を示す<code class="docutils literal notranslate"><span class="pre">NaN</span></code>のことである。</p></li>
</ol>
</div>
<p>以下では関数<code class="docutils literal notranslate"><span class="pre">mean_na()</span></code>を使いグループ計算することにしよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 平均貯蓄率の計算</span>
<span class="n">saving</span> <span class="o">=</span> <span class="n">df1970</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;country&#39;</span><span class="p">)[[</span><span class="s1">&#39;csh_i&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">mean_nan</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>  <span class="c1"># 1</span>
<span class="n">saving</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;saving_rate&#39;</span><span class="p">]</span>

<span class="c1"># 資本減耗率の平均の計算</span>
<span class="n">depreciation</span> <span class="o">=</span> <span class="n">df1970</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;country&#39;</span><span class="p">)[[</span><span class="s1">&#39;delta&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">mean_nan</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span> <span class="c1"># 2</span>
<span class="n">depreciation</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;depreciation&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<ol class="arabic simple">
<li><p>ここで重要な点は，最後に<code class="docutils literal notranslate"><span class="pre">.dropna()</span></code>を使って<code class="docutils literal notranslate"><span class="pre">np.nan</span></code>で作られた欠損値の行を削除している点である。これにより1970年〜2019年まで全てのデータが揃っている国だけが含まれていることになる。</p></li>
<li><p>同様のことが言える。</p></li>
</ol>
</div>
<p>次に労働人口の平均成長率を計算するが，成長率を計算する必要があるので次の関数を定義する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mean_growth_nan</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
    <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
        <span class="n">x_growth</span> <span class="o">=</span> <span class="p">(</span> <span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">t</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>  <span class="c1"># 1</span>
        <span class="k">return</span> <span class="n">x_growth</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<p>1 のみが<code class="docutils literal notranslate"><span class="pre">mean_na()</span></code>と異なる。ここではグループ・データ<code class="docutils literal notranslate"><span class="pre">x</span></code>を使い，平均成長率を計算している。<code class="docutils literal notranslate"><span class="pre">x.iloc[-1]</span></code>は2019年の値であり，<code class="docutils literal notranslate"><span class="pre">x.iloc[0]</span></code>は1970年のデータとなっている。また<code class="docutils literal notranslate"><span class="pre">len(x)</span></code>は<code class="docutils literal notranslate"><span class="pre">x</span></code>の行数を返しており，ここでは<code class="docutils literal notranslate"><span class="pre">2019-1970+1=50</span></code>と同じである。<code class="docutils literal notranslate"><span class="pre">50</span></code>年間の平均成長率であることがわかる。</p>
</div>
<p>この関数を使い労働人口の平均増加率を計算しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">emp_growth</span> <span class="o">=</span> <span class="n">df1970</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;country&#39;</span><span class="p">)[[</span><span class="s1">&#39;emp&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">mean_growth_nan</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">emp_growth</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;emp_growth&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>ここでも<code class="docutils literal notranslate"><span class="pre">.dropna()</span></code>を使い欠損値を削除し，全ての年でデータが揃っている国だけを抽出している。</p>
</section>
<section id="gdp">
<h5>一人当たりGDP成長率の平均<a class="headerlink" href="#gdp" title="Permalink to this heading">#</a></h5>
<p>まず一人当たりGDPの列を作成する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1970</span><span class="p">[</span><span class="s1">&#39;rgdpna_pc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df1970</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;rgdpna&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">df1970</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;emp&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>平均成長率は関数<code class="docutils literal notranslate"><span class="pre">mean_growth_nan()</span></code>を使い，労働人口の平均増加率の計算と同じ方法で計算しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">growth</span> <span class="o">=</span> <span class="n">df1970</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;country&#39;</span><span class="p">)[[</span><span class="s1">&#39;rgdpna_pc&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">mean_growth_nan</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">growth</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;gdp_pc_growth&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id11">
<h5>1970年の一人当たりGDP<a class="headerlink" href="#id11" title="Permalink to this heading">#</a></h5>
<p>３つの列<code class="docutils literal notranslate"><span class="pre">country</span></code>，<code class="docutils literal notranslate"><span class="pre">cgdpo</span></code>，<code class="docutils literal notranslate"><span class="pre">emp</span></code>からなる回帰分析用の<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>として<code class="docutils literal notranslate"><span class="pre">df_convergence</span></code>を作成する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_convergence</span> <span class="o">=</span> <span class="n">df1970</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;year == 1970&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,[</span><span class="s1">&#39;country&#39;</span><span class="p">,</span><span class="s1">&#39;cgdpo&#39;</span><span class="p">,</span><span class="s1">&#39;emp&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">df_convergence</span></code>に上で作成した貯蓄率などの<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を結合していくが，その前に1960年の一人当たりGDP（対数）の列を付け加えよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_convergence</span><span class="p">[</span><span class="s1">&#39;gdp_pc_init_log&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span> <span class="n">df1970</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;cgdpo&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">df1970</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;emp&#39;</span><span class="p">]</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>必須ではないが，２つの列<code class="docutils literal notranslate"><span class="pre">country</span></code>と<code class="docutils literal notranslate"><span class="pre">gdp_pc_init</span></code>とだけからなる<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>に整形する。その際，欠損値がある行は削除し，<code class="docutils literal notranslate"><span class="pre">country</span></code>を行ラベルに設定する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_convergence</span> <span class="o">=</span> <span class="n">df_convergence</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,[</span><span class="s1">&#39;country&#39;</span><span class="p">,</span><span class="s1">&#39;gdp_pc_init_log&#39;</span><span class="p">]]</span> \
                               <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;country&#39;</span><span class="p">)</span> \
                               <span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="dataframe">
<h5><code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>の結合<a class="headerlink" href="#dataframe" title="Permalink to this heading">#</a></h5>
<p>上で作成した<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を結合するが，<code class="docutils literal notranslate"><span class="pre">df_convergence</span></code>にまとめることにする。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">df_right</span> <span class="ow">in</span> <span class="p">[</span><span class="n">saving</span><span class="p">,</span> <span class="n">depreciation</span><span class="p">,</span> <span class="n">emp_growth</span><span class="p">,</span> <span class="n">growth</span><span class="p">]:</span>
    <span class="n">df_convergence</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_convergence</span><span class="p">,</span> <span class="n">df_right</span><span class="p">,</span>
                              <span class="n">left_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>最後に欠損値がある行は全て削除する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_convergence</span> <span class="o">=</span> <span class="n">df_convergence</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>確認してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_convergence</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gdp_pc_init_log</th>
      <th>saving_rate</th>
      <th>depreciation</th>
      <th>emp_growth</th>
      <th>gdp_pc_growth</th>
    </tr>
    <tr>
      <th>country</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Albania</th>
      <td>8.998807</td>
      <td>0.184254</td>
      <td>0.029523</td>
      <td>0.006873</td>
      <td>0.022165</td>
    </tr>
    <tr>
      <th>Algeria</th>
      <td>10.769834</td>
      <td>0.357435</td>
      <td>0.041668</td>
      <td>0.034988</td>
      <td>-0.001228</td>
    </tr>
    <tr>
      <th>Angola</th>
      <td>8.969764</td>
      <td>0.356462</td>
      <td>0.038600</td>
      <td>0.031358</td>
      <td>-0.002099</td>
    </tr>
    <tr>
      <th>Argentina</th>
      <td>9.310948</td>
      <td>0.151055</td>
      <td>0.031929</td>
      <td>0.017905</td>
      <td>0.001031</td>
    </tr>
    <tr>
      <th>Australia</th>
      <td>10.820099</td>
      <td>0.277189</td>
      <td>0.028591</td>
      <td>0.017601</td>
      <td>0.012187</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="id12">
<h4>成長率の分布<a class="headerlink" href="#id12" title="Permalink to this heading">#</a></h4>
<p>平均成長率のヒストグラムを図示してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">growth_average</span> <span class="o">=</span> <span class="n">df_convergence</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;gdp_pc_growth&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="c1"># 1</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="s1">&#39;gdp_pc_growth&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_convergence</span><span class="p">,</span>            <span class="c1"># 2 </span>
                         <span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>         <span class="c1"># 3</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">growth_average</span> <span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>                     <span class="c1"># 4</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;国の数&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;赤い線は平均&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>                      <span class="c1"># 5</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df_convergence</span><span class="p">)</span><span class="si">}</span><span class="s1">ヵ国の平均成長率 (%)&#39;</span><span class="p">,</span>  <span class="c1"># 6</span>
             <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7b726bf01e8f26db688dafdc30c5e84ced1e975a7c94a30483c87073bc15b046.png" src="_images/7b726bf01e8f26db688dafdc30c5e84ced1e975a7c94a30483c87073bc15b046.png" />
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<ol class="arabic simple">
<li><p>平均成長率の平均を計算し，結果を変数<code class="docutils literal notranslate"><span class="pre">growth_average</span></code>に割り当てている。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.hist</span></code>はヒストグラムをプロットする<code class="docutils literal notranslate"><span class="pre">ax</span></code>のメソッド。</p>
<ul class="simple">
<li><p>第一引数はプロットしたい列ラベル（ここでは<code class="docutils literal notranslate"><span class="pre">gdp_pc_growth</span></code>）</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">data</span></code>は使用する<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を指定する（ここでは<code class="docutils literal notranslate"><span class="pre">df_convergence</span></code>）</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">bins</span></code>は階級の数を指定する引数（ここでは<code class="docutils literal notranslate"><span class="pre">25</span></code>）。<code class="docutils literal notranslate"><span class="pre">edgecolor</span></code>はヒストグラムの棒の枠線の色を指定する引数で，<code class="docutils literal notranslate"><span class="pre">k</span></code>は黒を示す。<code class="docutils literal notranslate"><span class="pre">black</span></code>としても構わない。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">axvline()</span></code>は縦の線を引く<code class="docutils literal notranslate"><span class="pre">ax</span></code>のメソッド</p>
<ul class="simple">
<li><p>第一引数は横軸の値</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">c</span></code>は色を指定する引数</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">plt.subplots()</span></code>によって「軸」が<code class="docutils literal notranslate"><span class="pre">ax</span></code>に割り当てられるが，「軸」のタイトルを設定する<code class="docutils literal notranslate"><span class="pre">ax</span></code>のメソッドが<code class="docutils literal notranslate"><span class="pre">.set_title()</span></code>。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">size</span></code>はフォントの大きさを指定する。</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">plt.subplots()</span></code>によって「キャンバス」が<code class="docutils literal notranslate"><span class="pre">fig</span></code>に割り当てられるが，「キャンバス」のタイトルを設定する<code class="docutils literal notranslate"><span class="pre">fig</span></code>のメソッドが<code class="docutils literal notranslate"><span class="pre">.suptitle()</span></code>。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">f-string</span></code>を使って<code class="docutils literal notranslate"><span class="pre">{}</span></code>の中に<code class="docutils literal notranslate"><span class="pre">len(df_reg)</span></code>を代入している。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">size</span></code>はフォントの大きさを指定する。</p></li>
</ul>
</li>
</ol>
<p>上のヒストグラムは<a class="reference internal" href="5a_Development_Accounting.html#chap-5a-accounting"><span class="std std-ref">発展会計</span></a>の章の「はじめに」で表示したヒストグラムと次の点で異なる。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">df_convergence</span></code>は1970年以降のデータを使っている，「はじめに」のヒストグラムは1960年以降のデータを使っている。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">df_convergence</span></code>では労働者一人当たりGDPの成長率を使っているが，「はじめに」のヒストグラムは人口一人当たりGDPの成長率を使っている。前者は生産性，後者厚生を表していると解釈できる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">df_convergence</span></code>は<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>のメソッド<code class="docutils literal notranslate"><span class="pre">.pivot()</span></code>を使いデータ整形をおこなったが，「はじめに」のヒストグラムでは<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>のメソッド<code class="docutils literal notranslate"><span class="pre">.groupby</span></code>を使っており，それを使うと国ごとの統計量を簡単に計算することができる。詳細については<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.groupby.html">このサイト</a>を参照するか，「pandas groupby」で検索してみよう。</p></li>
</ul>
</div>
<p>何％の国で平均を下回るか確認してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span> <span class="n">df_convergence</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;gdp_pc_growth&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">growth_average</span> <span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_convergence</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.48214285714285715
</pre></div>
</div>
</div>
</div>
<p>約半分の国の成長率は平均より低いことになる。しかし上でも説明したが，キャッチアップが起こっているかは平均の成長率との比較では確認できない。一方で，平均成長率が負の国もあり，それらの国は経済が縮小しており先進国に追いついているとは言えない。では，<strong>平均</strong>で貧しい国は豊かな国に追いついているのだろうか？回帰分析で検討する。</p>
</section>
<section id="sec-9-regression-result">
<span id="id13"></span><h4>結果<a class="headerlink" href="#sec-9-regression-result" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">formula_absolute</span> <span class="o">=</span> <span class="s1">&#39;gdp_pc_growth ~ gdp_pc_init_log&#39;</span>
<span class="n">res_absolute</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula_absolute</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_convergence</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res_absolute</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>===================================================================================
                      coef    std err          t      P&gt;|t|      [0.025      0.975]
-----------------------------------------------------------------------------------
Intercept           0.0747      0.012      6.402      0.000       0.052       0.098
gdp_pc_init_log    -0.0064      0.001     -5.297      0.000      -0.009      -0.004
===================================================================================
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 予測値の列の作成</span>
<span class="n">df_convergence</span><span class="p">[</span><span class="s1">&#39;fitted_absolute&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">res_absolute</span><span class="o">.</span><span class="n">fittedvalues</span>

<span class="c1"># 図示</span>
<span class="n">ax_</span> <span class="o">=</span> <span class="n">df_convergence</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;gdp_pc_init_log&#39;</span><span class="p">,</span>
                          <span class="n">y</span><span class="o">=</span><span class="s1">&#39;gdp_pc_growth&#39;</span><span class="p">,</span>
                          <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">)</span>
<span class="n">df_convergence</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;fitted_absolute&#39;</span><span class="p">)</span> \
              <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;gdp_pc_init_log&#39;</span><span class="p">,</span>
                    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;fitted_absolute&#39;</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
                    <span class="n">ax</span><span class="o">=</span><span class="n">ax_</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2d4bf94691807ced1b5fe8b55a70bdd8b10f37e3805bee6834fd8ff9a6ee3121.png" src="_images/2d4bf94691807ced1b5fe8b55a70bdd8b10f37e3805bee6834fd8ff9a6ee3121.png" />
</div>
</div>
<p>絶対的所得収斂が発生していることを示唆する結果になっている。しかし注意が必要な点がある。定常状態の<strong>位置</strong>の問題である。この回帰分析結果は，全ての国で定常状態が同じだということは示しておらず，むしろ，定常状態が全ての国で同一という仮定の下での推定結果である。次に，たの変数を含めた重回帰分析をおこなう必要があるが，その前に推定結果から所得収束速度計算してみよう。</p>
</section>
<section id="hat-b">
<h4>推定値<span class="math notranslate nohighlight">\(\hat{b}\)</span>の意味<a class="headerlink" href="#hat-b" title="Permalink to this heading">#</a></h4>
<p>実際に<a class="reference internal" href="#sec-9-regression-result"><span class="std std-ref">上の回帰分析</span></a>の<span class="math notranslate nohighlight">\(b\)</span>の推定値を使って収束速度を計算してみることにする。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">period</span> <span class="o">=</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">1970</span><span class="o">+</span><span class="mi">1</span>
<span class="n">bhat</span> <span class="o">=</span> <span class="n">res_absolute</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">speed1970</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">bhat</span><span class="o">*</span><span class="n">period</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">period</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;収束速度は約</span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="n">speed1970</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">％です&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>収束速度は約0.771％です
</pre></div>
</div>
</div>
</div>
<p>この結果は，定常状態までの「距離」は年平均で約0.75％減少することを意味する。ではこの数字をどう理解すれば良いだろうか。仮にもし絶対的所得収斂が成立しているとすると，この数字は大きいのだろうか，小さいのだろうか。この点を探るために，2019年の米国と平均の一人当たりGDPを使って0.75％の意味を考えてみる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1970</span><span class="p">[</span><span class="s1">&#39;gdp_pc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df1970</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;rgdpna&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">df1970</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;emp&#39;</span><span class="p">]</span>

<span class="n">cond</span> <span class="o">=</span> <span class="p">(</span> <span class="n">df1970</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2019</span> <span class="p">)</span>
<span class="n">gdp_pc</span> <span class="o">=</span> <span class="n">df1970</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,</span><span class="s1">&#39;gdp_pc&#39;</span><span class="p">]</span>
<span class="n">no</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">gdp_pc</span><span class="p">)</span>                                   <span class="c1"># 1</span>
<span class="n">gdp_pc_mean</span> <span class="o">=</span> <span class="n">gdp_pc</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="n">cond</span> <span class="o">=</span> <span class="p">(</span> <span class="p">(</span><span class="n">df1970</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2019</span><span class="p">)</span> <span class="o">&amp;</span>               <span class="c1"># 2</span>
         <span class="p">(</span><span class="n">df1970</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;countrycode&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;USA&#39;</span><span class="p">)</span> <span class="p">)</span>
<span class="n">gdp_pc_us</span> <span class="o">=</span> <span class="n">df1970</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,</span><span class="s1">&#39;gdp_pc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>   <span class="c1"># 3</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">--- 2019年の一人当たりGDP ---------</span><span class="se">\n\n</span><span class="s1">&#39;</span>
     <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">no</span><span class="si">}</span><span class="s1">ヵ国の平均：</span><span class="se">\t</span><span class="si">{</span><span class="n">gdp_pc_mean</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>        <span class="c1"># 4</span>
     <span class="sa">f</span><span class="s1">&#39;米国：</span><span class="se">\t\t</span><span class="si">{</span><span class="n">gdp_pc_us</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
     <span class="sa">f</span><span class="s1">&#39;米国は平均の</span><span class="si">{</span><span class="n">gdp_pc_us</span><span class="o">/</span><span class="n">gdp_pc_mean</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">倍&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- 2019年の一人当たりGDP ---------

183ヵ国の平均：	46739.5
米国：		129903.0
米国は平均の2.8倍
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">len()</span></code>は<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>の行数を返す。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cond</span></code>は<code class="docutils literal notranslate"><span class="pre">True/False</span></code>の<code class="docutils literal notranslate"><span class="pre">Series</span></code></p>
<ul class="simple">
<li><p>右辺は２行にまたがっているので，右辺の一番外側の<code class="docutils literal notranslate"><span class="pre">()</span></code>が必要となる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&amp;</span></code>を使っているため<code class="docutils literal notranslate"><span class="pre">pwt.loc[:,'year']==2019</span></code>と<code class="docutils literal notranslate"><span class="pre">pwt.loc[:,'countrycode']=='USA'</span></code>はそれぞれ<code class="docutils literal notranslate"><span class="pre">()</span></code>に入れる。</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">pwt.loc[cond,'gdp_pc']</span></code>は<code class="docutils literal notranslate"><span class="pre">Series</span></code>を返すため，<code class="docutils literal notranslate"><span class="pre">.to_numpy()</span></code>で<code class="docutils literal notranslate"><span class="pre">Numpy</span></code>の<code class="docutils literal notranslate"><span class="pre">array</span></code>に変換し<code class="docutils literal notranslate"><span class="pre">0</span></code>番目の要素を抽出する。その抽出した値を<code class="docutils literal notranslate"><span class="pre">gdp_pc_us</span></code>に割り当てる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">f-string</span></code>を使い<code class="docutils literal notranslate"><span class="pre">{}</span></code>に<code class="docutils literal notranslate"><span class="pre">no</span></code>，<code class="docutils literal notranslate"><span class="pre">gdp_pc_mean</span></code>，<code class="docutils literal notranslate"><span class="pre">gdp_pc_us</span></code>，<code class="docutils literal notranslate"><span class="pre">gdp_pc_us/gdp_pc_mean</span></code>の値を代入している。<code class="docutils literal notranslate"><span class="pre">:.1f</span></code>は小数点第一位までの表示を指定している。また<code class="docutils literal notranslate"><span class="pre">\t</span></code>はタブ。</p></li>
</ol>
</div>
<p>この数字を使って，<code class="docutils literal notranslate"><span class="pre">n</span></code>年後に平均の経済が2019年の米国との所得格差を何％縮めることができるかを計算してみよう。まず次の変数を使って簡単な数式を考えてみよう。</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(s\)</span>：収束速度（率）</p></li>
<li><p><span class="math notranslate nohighlight">\(x_0\)</span>：所得格差</p></li>
<li><p><span class="math notranslate nohighlight">\(x_t\)</span>：<span class="math notranslate nohighlight">\(t\)</span>期に残る所得差</p></li>
</ul>
<p>1年後の格差は</p>
<div class="math notranslate nohighlight">
\[x_1=x_0-sx_0=(1-s)x_0\]</div>
<p>であり，一般的には</p>
<div class="math notranslate nohighlight">
\[x_{t}=(1-s)x_{t-1}\]</div>
<p>逐次的に代入すると次式となる。</p>
<div class="math notranslate nohighlight">
\[x_{t}=(1-s)^tx_{0}\]</div>
<p>この式を使って<code class="docutils literal notranslate"><span class="pre">n</span></code>年後に2019年当時の格差が何％残っているかを関数としてまとめる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">remaining_percent</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">speed1970</span><span class="p">):</span>
    
    <span class="n">x0</span> <span class="o">=</span> <span class="n">gdp_pc_us</span><span class="o">-</span><span class="n">gdp_pc_mean</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">(</span> <span class="mi">1</span><span class="o">-</span><span class="n">s</span> <span class="p">)</span><span class="o">**</span><span class="n">n</span><span class="o">*</span><span class="n">x0</span>
    
    <span class="k">return</span> <span class="mi">100</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="n">x0</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">for</span></code>ループを使って計算してみる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">--- X年後に残る2019年当時の所得格差 ----------</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span><span class="mi">500</span><span class="p">,</span><span class="mi">1000</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s1">年後：</span><span class="si">{</span><span class="n">remaining_percent</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">％&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- X年後に残る2019年当時の所得格差 ----------

10年後：92.56％
20年後：85.67％
50年後：67.92％
100年後：46.14％
200年後：21.29％
300年後：9.82％
500年後：2.09％
1000年後：0.04％
</pre></div>
</div>
</div>
</div>
<p>この計算から収束速度0.75％の意味が理解できるたと思う。仮に絶対的所得収斂が成立したとしても，経済間の所得格差の解消には気が遠くなる程長い時間が掛かることを意味している。もちろんこの予測は過去50年間の経験がそのまま続いたらの話であり，GAFAやAI，中国の台頭やコロナ禍など今後様々な不確定要因が重なることを想定すると，この予測どおりにはならないだろうが，経済間の所得格差の解消は長い道のりであることは間違いなさそうである。</p>
</section>
</section>
<section id="sec-9-multiple-regression">
<span id="id14"></span><h3>重回帰分析：1970年〜2019年<a class="headerlink" href="#sec-9-multiple-regression" title="Permalink to this heading">#</a></h3>
<p><a class="reference internal" href="#sec-9-simple-regression"><span class="std std-ref">単回帰分析</span></a>では絶対的所得収斂を示唆する結果が示された。しかし推定結果は，貯蓄率など全ての経済構造が同じだと仮定し推定をおこなった。この仮定を取り除いた場合，初期の一人当たりGDPの推定値<span class="math notranslate nohighlight">\(\hat{b}\)</span>は統計的有意性を保つことができるだろうか。そして他の変数の統計的有意性はどうだろうか。この点を確認するために，重回帰分析をおこなう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">formula_conditional</span> <span class="o">=</span> <span class="p">(</span> <span class="s1">&#39;gdp_pc_growth ~ saving_rate +&#39;</span>
                                        <span class="s1">&#39;emp_growth +&#39;</span>
                                        <span class="s1">&#39;depreciation +&#39;</span>
                                        <span class="s1">&#39;gdp_pc_init_log&#39;</span> <span class="p">)</span>

<span class="n">res_conditional</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula_conditional</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_convergence</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">res_conditional</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>===================================================================================
                      coef    std err          t      P&gt;|t|      [0.025      0.975]
-----------------------------------------------------------------------------------
Intercept           0.0536      0.011      5.019      0.000       0.032       0.075
saving_rate         0.0735      0.015      4.748      0.000       0.043       0.104
emp_growth         -0.5701      0.069     -8.210      0.000      -0.708      -0.432
depreciation        0.5045      0.096      5.236      0.000       0.313       0.695
gdp_pc_init_log    -0.0068      0.001     -6.377      0.000      -0.009      -0.005
===================================================================================
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<p><code class="docutils literal notranslate"><span class="pre">formula_conditional</span></code>に回帰式が割り当てられているが，右辺は文字列が複数行にまたがっている。この場合は両端を<code class="docutils literal notranslate"><span class="pre">()</span></code>で囲み，文字列を一行毎<code class="docutils literal notranslate"><span class="pre">'</span></code>と<code class="docutils literal notranslate"><span class="pre">'</span></code>で囲む必要がある。もちろんシングル・クオート<code class="docutils literal notranslate"><span class="pre">'</span></code>の代わりにダブル・クオート<code class="docutils literal notranslate"><span class="pre">&quot;</span></code>を使っても良い。</p>
</div>
<p>まず推定値の符号に関するソロー・モデルの予測を考えるために，式<a class="reference internal" href="8_Solow.html#equation-eq-8-kss">(35)</a>，<a class="reference internal" href="8_Solow.html#equation-eq-8-lambda">(38)</a>，<a class="reference internal" href="#equation-eq-9-a">(52)</a>を使って定数項<span class="math notranslate nohighlight">\(a\)</span>を３つのパラメータで表してみる。</p>
<div class="math notranslate nohighlight">
\[
a\equiv\frac{1}{t}
\left[
1-\left(
    1-\frac{(1-a)(n+d)}{1+n}
    \right)^t
\right]
\times
\log
\left(
     \frac{As}{n+d}
\right)^{\frac{1}{1-a}}
\]</div>
<p>この式から次のことが分かる。</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(a\)</span>は<span class="math notranslate nohighlight">\(s\)</span>の増加関数 <span class="math notranslate nohighlight">\(\Rightarrow\)</span> <code class="docutils literal notranslate"><span class="pre">saving_rate</span></code>の係数は正の値と予想される。</p></li>
<li><p><span class="math notranslate nohighlight">\(a\)</span>は<span class="math notranslate nohighlight">\(n\)</span>の単調関数ではない <span class="math notranslate nohighlight">\(\Rightarrow\)</span> <code class="docutils literal notranslate"><span class="pre">emp_growth</span></code>の係数に関する予想は不明確。</p></li>
<li><p><span class="math notranslate nohighlight">\(a\)</span>は<span class="math notranslate nohighlight">\(d\)</span>の単調関数ではない <span class="math notranslate nohighlight">\(\Rightarrow\)</span> <code class="docutils literal notranslate"><span class="pre">depreciation</span></code>の係数に関する予想は不明確。</p></li>
</ul>
<p>この予想に基づいて係数の統計的有意性を検討しよう。全ての係数の<span class="math notranslate nohighlight">\(p\)</span>値は非常に小さく統計的な有意性は高い。確認のために<span class="math notranslate nohighlight">\(F\)</span>検定を行ってみよう。ここでは次の帰無仮説と対立仮説を立てることにする。</p>
<p><span class="math notranslate nohighlight">\(H_0\)</span>：貯蓄率，労働人口増加率，資本減耗率の推定値は全て<code class="docutils literal notranslate"><span class="pre">0</span></code><br>
<span class="math notranslate nohighlight">\(H_A\)</span>：<span class="math notranslate nohighlight">\(H_0\)</span>は成立しない。</p>
<p><code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>を使って<span class="math notranslate nohighlight">\(F\)</span>検定をおこなう方法については<a class="reference external" href="https://py4etrics.github.io/11_Inference.html#f">このサイト</a>参考にして欲しいが，ここでは簡単い説明する。まず帰無仮説を捉える制約式を設定しよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hypothesis</span> <span class="o">=</span> <span class="s1">&#39;saving_rate = 0, emp_growth = 0, depreciation = 0&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>３つの説明変数の推定値が全て同時に<code class="docutils literal notranslate"><span class="pre">0</span></code>だという制約式である。次に，回帰結果<code class="docutils literal notranslate"><span class="pre">res_conditional</span></code>には<span class="math notranslate nohighlight">\(F\)</span>検定をおこなうメソッド<code class="docutils literal notranslate"><span class="pre">.f_test()</span></code>が実装されている。使い方は簡単で，制約式である<code class="docutils literal notranslate"><span class="pre">hypothesis</span></code>を引数として渡すことで結果を表示できる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span> <span class="n">res_conditional</span><span class="o">.</span><span class="n">f_test</span><span class="p">(</span><span class="n">hypothesis</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;F test: F=33.56525620536771, p=2.271308673585614e-15, df_denom=107, df_num=3&gt;
</pre></div>
</div>
</div>
</div>
<p>＜表示にある記号の意味＞<br>
<code class="docutils literal notranslate"><span class="pre">F</span></code>：<span class="math notranslate nohighlight">\(F\)</span>値<br>
<code class="docutils literal notranslate"><span class="pre">p</span></code>：<span class="math notranslate nohighlight">\(p\)</span>値<br>
<code class="docutils literal notranslate"><span class="pre">df_denom</span></code>：分母の自由度<br>
<code class="docutils literal notranslate"><span class="pre">df_num</span></code>：分子の自由度<br></p>
<p>ここで興味があるのは<span class="math notranslate nohighlight">\(p\)</span>値であり，非常に小さい。従って，1%の有意水準であっても帰無仮説は棄却できる。データに含まれている全ての経済の定常値が同じとは言い難く，絶対的所得収斂が成立していると判断できない。</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><span class="math notranslate nohighlight">\(F\)</span>検定の結果の値は属性として抽出できる。例えば，<span class="math notranslate nohighlight">\(p\)</span>値は次のコードでアクセスできる。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">res_conditional</span><span class="o">.</span><span class="n">f_test</span><span class="p">(</span><span class="n">hypothesis</span><span class="p">)</span><span class="o">.</span><span class="n">pvalue</span>
</pre></div>
</div>
</div>
</section>
<section id="for">
<h3>単回帰分析：<code class="docutils literal notranslate"><span class="pre">for</span></code>ループで回帰分析<a class="headerlink" href="#for" title="Permalink to this heading">#</a></h3>
<p>上の単回帰・重回帰分析は1970年〜2019年のデータを使っている。他の期間ではどうだろうか。例えば，1980年〜2019年。一回ずつ推定するのも面倒なので<code class="docutils literal notranslate"><span class="pre">for</span></code>ループを使って一気に計算してみよう。もしかすると何か見えて来るかも知れない。最終年は全てのパターンで2019年として推定期間は次のようにしよう。</p>
<ul class="simple">
<li><p>1950~2019年</p></li>
<li><p>1951~2019年</p></li>
<li><p>・・・</p></li>
<li><p>・・・</p></li>
<li><p>1980~2019年</p></li>
<li><p>・・・</p></li>
<li><p>・・・</p></li>
<li><p>2008~2019年</p></li>
<li><p>2009~2019年</p></li>
</ul>
<p>まず単回帰の場合を考え次の３つのステップに分けてコードを書いていく。</p>
<ol class="arabic simple">
<li><p>関数<code class="docutils literal notranslate"><span class="pre">data_for_regression()</span></code>を作成する。</p>
<ul class="simple">
<li><p>引数</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">init_yr</span></code>：年（例えば，1970）</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">df</span></code>：<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>（デフォルトは<code class="docutils literal notranslate"><span class="pre">pwt</span></code>）</p></li>
</ul>
</li>
<li><p>戻り値</p>
<ul>
<li><p>次の変数から構成される<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">init_yr</span></code>から2019年までのデータから計算された<code class="docutils literal notranslate"><span class="pre">saving_rate</span></code>, <code class="docutils literal notranslate"><span class="pre">depreciation</span></code>, <code class="docutils literal notranslate"><span class="pre">emp_growth</span></code>, <code class="docutils literal notranslate"><span class="pre">gdp_pc_growth</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">init_yr</span></code>で指定された年の<code class="docutils literal notranslate"><span class="pre">gdp_pc_init_log</span></code></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">for</span></code>ループで<code class="docutils literal notranslate"><span class="pre">data_for_regression()</span></code>から生成される<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を使い，次の４つの変数の推移を示す変数からなる<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を作成する。</p>
<ul class="simple">
<li><p>初期時点の一人当たりGDP（対数）の係数の推定値</p></li>
<li><p><span class="math notranslate nohighlight">\(p\)</span>値</p></li>
<li><p>決定係数</p></li>
<li><p>標本に含まれる国の数</p></li>
</ul>
</li>
<li><p>４つの変数の時系列プロット</p></li>
</ol>
<p>ステップ１の<code class="docutils literal notranslate"><span class="pre">data_for_regression()</span></code>は基本的に上で使ったコードを関数としてまとめることで作成する。重回帰分析も後で行うので，貯蓄率などの平均値も含む<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を返す関数とする。コード自体は上で使ったコードを再利用して関数にまとめている。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">data_for_regression</span><span class="p">(</span><span class="n">init_yr</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">pwt</span><span class="p">):</span>
    
    <span class="c1"># === groupby用の集計関数 ======================</span>
    <span class="k">def</span> <span class="nf">mean_nan</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    
    <span class="k">def</span> <span class="nf">mean_growth_nan</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
            <span class="n">x_growth</span> <span class="o">=</span> <span class="p">(</span> <span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">t</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>  <span class="c1"># 1</span>
            <span class="k">return</span> <span class="n">x_growth</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        
    <span class="c1"># === 初期時点の年からのDataFrameを作成 ======================</span>
    <span class="n">cond</span> <span class="o">=</span> <span class="p">(</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">&gt;=</span><span class="n">init_yr</span> <span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>          <span class="c1"># .copy()は警告が出ないようにする</span>
    
    <span class="c1"># === 平均貯蓄率の計算 ======================</span>
    <span class="n">saving</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;country&#39;</span><span class="p">)[[</span><span class="s1">&#39;csh_i&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">mean_nan</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="n">saving</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;saving_rate&#39;</span><span class="p">]</span>
    
    <span class="c1"># === 資本減耗率の平均の計算 ======================</span>
    <span class="n">depreciation</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;country&#39;</span><span class="p">)[[</span><span class="s1">&#39;delta&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">mean_nan</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="n">depreciation</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;depreciation&#39;</span><span class="p">]</span>

    <span class="c1"># === 労働人口成長率の平均の計算 ======================</span>
    <span class="n">emp_growth</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;country&#39;</span><span class="p">)[[</span><span class="s1">&#39;emp&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">mean_growth_nan</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="n">emp_growth</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;emp_growth&#39;</span><span class="p">]</span>

    <span class="c1"># === 一人当たりGDP成長率の平均の計算 ======================</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;rgdpna_pc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;rgdpna&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;emp&#39;</span><span class="p">]</span>
    <span class="n">growth</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;country&#39;</span><span class="p">)[[</span><span class="s1">&#39;rgdpna_pc&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">mean_growth_nan</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="n">growth</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;gdp_pc_growth&#39;</span><span class="p">]</span>

    <span class="c1"># === 初期の一人当たりGDPの計算 ======================</span>
    <span class="n">cond</span> <span class="o">=</span> <span class="p">(</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">init_yr</span> <span class="p">)</span>
    <span class="n">df_convergence</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,[</span><span class="s1">&#39;country&#39;</span><span class="p">,</span><span class="s1">&#39;cgdpo&#39;</span><span class="p">,</span><span class="s1">&#39;emp&#39;</span><span class="p">]]</span>    
    <span class="n">df_convergence</span><span class="p">[</span><span class="s1">&#39;gdp_pc_init_log&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;cgdpo&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;emp&#39;</span><span class="p">]</span> <span class="p">)</span>
    <span class="n">df_convergence</span> <span class="o">=</span> <span class="n">df_convergence</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,[</span><span class="s1">&#39;country&#39;</span><span class="p">,</span><span class="s1">&#39;gdp_pc_init_log&#39;</span><span class="p">]]</span> \
                                   <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;country&#39;</span><span class="p">)</span> \
                                   <span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

    <span class="c1"># === DataFrameの結合 ======================</span>
    <span class="k">for</span> <span class="n">df_right</span> <span class="ow">in</span> <span class="p">[</span><span class="n">saving</span><span class="p">,</span> <span class="n">depreciation</span><span class="p">,</span> <span class="n">emp_growth</span><span class="p">,</span> <span class="n">growth</span><span class="p">]:</span>
        <span class="n">df_convergence</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_convergence</span><span class="p">,</span> <span class="n">df_right</span><span class="p">,</span>
                                  <span class="n">left_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                  <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                  <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">df_convergence</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">init_yr=1970</span></code>として関数を実行して内容を確認してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_for_regression</span><span class="p">(</span><span class="mi">1970</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gdp_pc_init_log</th>
      <th>saving_rate</th>
      <th>depreciation</th>
      <th>emp_growth</th>
      <th>gdp_pc_growth</th>
    </tr>
    <tr>
      <th>country</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Albania</th>
      <td>8.998807</td>
      <td>0.184254</td>
      <td>0.029523</td>
      <td>0.006873</td>
      <td>0.022165</td>
    </tr>
    <tr>
      <th>Algeria</th>
      <td>10.769834</td>
      <td>0.357435</td>
      <td>0.041668</td>
      <td>0.034988</td>
      <td>-0.001228</td>
    </tr>
    <tr>
      <th>Angola</th>
      <td>8.969764</td>
      <td>0.356462</td>
      <td>0.038600</td>
      <td>0.031358</td>
      <td>-0.002099</td>
    </tr>
    <tr>
      <th>Argentina</th>
      <td>9.310948</td>
      <td>0.151055</td>
      <td>0.031929</td>
      <td>0.017905</td>
      <td>0.001031</td>
    </tr>
    <tr>
      <th>Australia</th>
      <td>10.820099</td>
      <td>0.277189</td>
      <td>0.028591</td>
      <td>0.017601</td>
      <td>0.012187</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>ステップ２として，<code class="docutils literal notranslate"><span class="pre">for</span></code>ループを使って４つの変数からなる<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を作成する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b_coef_list</span> <span class="o">=</span> <span class="p">[]</span>     <span class="c1"># 1</span>
<span class="n">b_pval_list</span> <span class="o">=</span> <span class="p">[]</span>     <span class="c1"># 2</span>
<span class="n">rsquared_list</span> <span class="o">=</span> <span class="p">[]</span>   <span class="c1"># 3</span>
<span class="n">nobs_list</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># 4</span>
<span class="n">yr_list</span> <span class="o">=</span> <span class="p">[]</span>         <span class="c1"># 5</span>

<span class="n">formula</span> <span class="o">=</span> <span class="s1">&#39;gdp_pc_growth ~ gdp_pc_init_log&#39;</span> <span class="c1"># 6</span>

<span class="k">for</span> <span class="n">yr</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1950</span><span class="p">,</span> <span class="mi">2010</span><span class="p">):</span>                <span class="c1"># 7</span>
    
    <span class="n">df0</span> <span class="o">=</span> <span class="n">data_for_regression</span><span class="p">(</span><span class="n">yr</span><span class="p">)</span>           <span class="c1"># 8 </span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df0</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>   <span class="c1"># 9</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">params</span>                          <span class="c1"># 10</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">pvalues</span>                         <span class="c1"># 11</span>
    
    <span class="n">b_coef_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>              <span class="c1"># 12</span>
    <span class="n">b_pval_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>              <span class="c1"># 13</span>

    <span class="n">rsquared_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">res</span><span class="o">.</span><span class="n">rsquared</span> <span class="p">)</span>    <span class="c1"># 14</span>
    <span class="n">nobs_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="nb">int</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">nobs</span><span class="p">)</span> <span class="p">)</span>       <span class="c1"># 15</span>
    <span class="n">yr_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">yr</span><span class="p">)</span>                      <span class="c1"># 16</span>

                                            <span class="c1"># 17</span>
<span class="n">df_simple_result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;初期の一人当たりGDPの係数&#39;</span><span class="p">:</span><span class="n">b_coef_list</span><span class="p">,</span>
                                 <span class="s1">&#39;p値（初期の一人当たりGDP）&#39;</span><span class="p">:</span><span class="n">b_pval_list</span><span class="p">,</span>
                                 <span class="s1">&#39;決定係数&#39;</span><span class="p">:</span><span class="n">rsquared_list</span><span class="p">,</span>
                                 <span class="s1">&#39;国の数&#39;</span><span class="p">:</span><span class="n">nobs_list</span><span class="p">},</span>
                                 <span class="n">index</span><span class="o">=</span><span class="n">yr_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<ol class="arabic simple">
<li><p>初期の一人当たりGDP（対数）の係数の推定値を格納する空のリスト</p></li>
<li><p>初期の一人当たりGDP（対数）p値を格納する空のリスト</p></li>
<li><p>決定係数を格納する空のリスト</p></li>
<li><p>標本の大きさ（国数）を格納する空のリスト</p></li>
<li><p>回帰分析で初期時点の<code class="docutils literal notranslate"><span class="pre">year</span></code>を格納する空のリスト</p></li>
<li><p>回帰式。<code class="docutils literal notranslate"><span class="pre">for</span></code>ループの中では同じ回帰式を使うので<code class="docutils literal notranslate"><span class="pre">for</span></code>ループの外に配置している。</p></li>
<li><p>1950-2009年を初期時点とする<code class="docutils literal notranslate"><span class="pre">for</span></code>ループの開始</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">data_for_regression(yr)</span></code>を使い<code class="docutils literal notranslate"><span class="pre">yr</span></code>を初期時点として回帰分析に使う<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を<code class="docutils literal notranslate"><span class="pre">df0</span></code>に割り当てる。</p></li>
<li><p>回帰分析の計算結果を<code class="docutils literal notranslate"><span class="pre">res</span></code>に割り当てる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">res</span></code>の属性<code class="docutils literal notranslate"><span class="pre">.params</span></code>（推定値の値）を<code class="docutils literal notranslate"><span class="pre">c</span></code>に割り当てる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">res</span></code>の属性<code class="docutils literal notranslate"><span class="pre">.pvalues</span></code>（p値）を<code class="docutils literal notranslate"><span class="pre">p</span></code>に割り当てる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">c</span></code>の一番目の要素を<code class="docutils literal notranslate"><span class="pre">b_coef_list</span></code>に追加する。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code>の一番目の要素を<code class="docutils literal notranslate"><span class="pre">b_pval_list</span></code>に追加する。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">res</span></code>の属性<code class="docutils literal notranslate"><span class="pre">.rsquared</span></code>は決定係数を返す。それを<code class="docutils literal notranslate"><span class="pre">rsquared_list</span></code>に追加する。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">res</span></code>の属性<code class="docutils literal notranslate"><span class="pre">.nobs</span></code>は標本の大きさ（国数と同じ）を返す。それを<code class="docutils literal notranslate"><span class="pre">nobs_list</span></code>に追加する。</p></li>
<li><p>初期に使った<code class="docutils literal notranslate"><span class="pre">yr</span></code>を<code class="docutils literal notranslate"><span class="pre">yr_list</span></code>に追加する。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">for</span></code>ループの結果を使い<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を作成し<code class="docutils literal notranslate"><span class="pre">df_simple_result</span></code>に割り当てる。</p></li>
</ol>
</div>
<p>作成した<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を確認してみる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_simple_result</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>初期の一人当たりGDPの係数</th>
      <th>p値（初期の一人当たりGDP）</th>
      <th>決定係数</th>
      <th>国の数</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1950</th>
      <td>-0.001436</td>
      <td>0.364623</td>
      <td>0.016803</td>
      <td>51</td>
    </tr>
    <tr>
      <th>1951</th>
      <td>-0.002255</td>
      <td>0.189701</td>
      <td>0.031635</td>
      <td>56</td>
    </tr>
    <tr>
      <th>1952</th>
      <td>-0.002594</td>
      <td>0.121773</td>
      <td>0.042979</td>
      <td>57</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>それぞれの列には計算した変数が並んでおり，行インデックスには年が配置されている。初期時点を1970年とする結果を確かめてみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_simple_result</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">1970</span><span class="p">],:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>初期の一人当たりGDPの係数</th>
      <th>p値（初期の一人当たりGDP）</th>
      <th>決定係数</th>
      <th>国の数</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1970</th>
      <td>-0.006415</td>
      <td>6.090842e-07</td>
      <td>0.203257</td>
      <td>112</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><a class="reference internal" href="#sec-9-multiple-regression"><span class="std std-ref">上の</span></a>の結果と同じになることが確認できる。</p>
<p>ステップ３として<code class="docutils literal notranslate"><span class="pre">df_reg_result</span></code>のメソッド<code class="docutils literal notranslate"><span class="pre">.plot()</span></code>を使い時系列データをプロットする。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_simple_result</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5cc8247cb655ce1beca8ca568422c0d06e08e57b6bba113c6a67c0d62aeec9da.png" src="_images/5cc8247cb655ce1beca8ca568422c0d06e08e57b6bba113c6a67c0d62aeec9da.png" />
</div>
</div>
<p>一番上の図から初期の一人当たりGDPの係数の推定値は全て負の値となることがわかる。しかし二番目の図からわかるように，1950年年代半ばまでの推定値の統計的優位性低いが，それ以降は高いようだ。1955年以降だけを表示してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col_name</span> <span class="o">=</span> <span class="n">df_simple_result</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># 1</span>

<span class="n">ax_</span> <span class="o">=</span> <span class="n">df_simple_result</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1955</span><span class="p">:,</span><span class="n">col_name</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">ax_</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>              <span class="c1"># 2</span>
<span class="n">ax_</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;初期時点の一人当たりGDPの係数のp値&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/48347bc267625e9edc78b7dea381c830140220224808f667b06341af3cc75291.png" src="_images/48347bc267625e9edc78b7dea381c830140220224808f667b06341af3cc75291.png" />
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(p\)</span>値が格納される列のラベルは<code class="docutils literal notranslate"><span class="pre">p値（初期の一人当たりGDP）</span></code>であり，これを直接書くには面倒であり，また全角を使うのを極力避けたい。その為に列ラベルを抽出している。<code class="docutils literal notranslate"><span class="pre">.columns</span></code>は列ラベルを返する属性であり，その一番目の要素が目的の列ラベルである。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.axhline()</span></code>は横線を引くメソッド。</p></li>
</ol>
</div>
<p>推定値は0となる帰無仮説を5%の優位水準で棄却できる。即ち，少なくとも1955年以降は絶対的所得収斂を示唆している。</p>
</section>
<section id="sec-9-multiple-for-loop">
<span id="id15"></span><h3>重回帰分析：<code class="docutils literal notranslate"><span class="pre">for</span></code>ループで回帰分析<a class="headerlink" href="#sec-9-multiple-for-loop" title="Permalink to this heading">#</a></h3>
<p>次のステップとして定常状態に関する３つの変数を追加して回帰分析をおこなう。ここでも<code class="docutils literal notranslate"><span class="pre">for</span></code>ループを使い，最終的にはプロットで結果を確認することにする。基本的には<code class="docutils literal notranslate"><span class="pre">for</span></code>ループを使った単回帰分析と同じ方法をとるが，ステップ１の関数<code class="docutils literal notranslate"><span class="pre">data_for_regression(yr)</span></code>は重回帰分析でもそのまま使えるので，ステップ２から始める。次のコードは上で使ったコードの修正版である。新たに追加した箇所だけに番号を振って説明することにする。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">saving_coef_list</span> <span class="o">=</span> <span class="p">[]</span>                            <span class="c1"># 1</span>
<span class="n">emp_growth_coef_list</span> <span class="o">=</span> <span class="p">[]</span>                        <span class="c1"># 2</span>
<span class="n">depreciation_coef_list</span> <span class="o">=</span> <span class="p">[]</span>                      <span class="c1"># 3</span>
<span class="n">b_coef_list</span> <span class="o">=</span> <span class="p">[]</span>                                 <span class="c1"># 4</span>
<span class="n">b_pval_list</span> <span class="o">=</span> <span class="p">[]</span>                                 <span class="c1"># 5</span>
<span class="n">f_pval_list</span> <span class="o">=</span> <span class="p">[]</span>                                 <span class="c1"># 6</span>
<span class="n">rsquared_list</span> <span class="o">=</span> <span class="p">[]</span>                               <span class="c1"># 7</span>
<span class="n">nobs_list</span> <span class="o">=</span> <span class="p">[]</span>                                   <span class="c1"># 8</span>
<span class="n">yr_list</span> <span class="o">=</span> <span class="p">[]</span>                                     <span class="c1"># 9</span>

<span class="n">formula</span> <span class="o">=</span> <span class="p">(</span> <span class="s1">&#39;gdp_pc_growth ~ saving_rate +&#39;</span>      <span class="c1"># 10</span>
                            <span class="s1">&#39;emp_growth +&#39;</span>
                            <span class="s1">&#39;depreciation +&#39;</span>
                            <span class="s1">&#39;gdp_pc_init_log&#39;</span> <span class="p">)</span>

<span class="k">for</span> <span class="n">yr</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1950</span><span class="p">,</span> <span class="mi">2000</span><span class="p">):</span>                     <span class="c1"># 11</span>
    
    <span class="n">df0</span> <span class="o">=</span> <span class="n">data_for_regression</span><span class="p">(</span><span class="n">yr</span><span class="p">)</span>                <span class="c1"># 12</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df0</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>        <span class="c1"># 13</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">params</span>                               <span class="c1"># 14</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">pvalues</span>                              <span class="c1"># 15</span>
    <span class="n">hypothesis</span> <span class="o">=</span> <span class="p">(</span> <span class="s1">&#39;saving_rate=0,&#39;</span>              <span class="c1"># 16</span>
                   <span class="s1">&#39; emp_growth=0,&#39;</span>
                   <span class="s1">&#39; depreciation=0&#39;</span><span class="p">)</span>
    <span class="n">f_pval</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">f_test</span><span class="p">(</span><span class="n">hypothesis</span><span class="p">)</span><span class="o">.</span><span class="n">pvalue</span>       <span class="c1"># 17</span>

    <span class="n">saving_coef_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>              <span class="c1"># 18</span>
    <span class="n">emp_growth_coef_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">c</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">)</span>          <span class="c1"># 19</span>
    <span class="n">depreciation_coef_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">c</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="p">)</span>        <span class="c1"># 20</span>
    <span class="n">b_coef_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">c</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="p">)</span>                   <span class="c1"># 21</span>
    <span class="n">b_pval_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="p">)</span>                   <span class="c1"># 22</span>
    <span class="n">f_pval_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">f_pval</span> <span class="p">)</span>                 <span class="c1"># 23</span>
    <span class="n">rsquared_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">res</span><span class="o">.</span><span class="n">rsquared_adj</span> <span class="p">)</span>     <span class="c1"># 24</span>
    <span class="n">nobs_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="nb">int</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">nobs</span><span class="p">)</span> <span class="p">)</span>            <span class="c1"># 25</span>
    <span class="n">yr_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">yr</span><span class="p">)</span>                           <span class="c1"># 26</span>

                                                 <span class="c1"># 27</span>
<span class="n">df_multiple_result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;貯蓄率の係数&#39;</span><span class="p">:</span><span class="n">saving_coef_list</span><span class="p">,</span>
                                   <span class="s1">&#39;労働人口成長率の係数&#39;</span><span class="p">:</span><span class="n">emp_growth_coef_list</span><span class="p">,</span>
                                   <span class="s1">&#39;資本減耗率の係数&#39;</span><span class="p">:</span><span class="n">depreciation_coef_list</span><span class="p">,</span>
                                   <span class="s1">&#39;初期の一人当たりGDPの係数&#39;</span><span class="p">:</span><span class="n">b_coef_list</span><span class="p">,</span>
                                   <span class="s1">&#39;p値（初期の一人当たりGDP）&#39;</span><span class="p">:</span><span class="n">b_pval_list</span><span class="p">,</span>
                                   <span class="s1">&#39;p値（F検定）&#39;</span><span class="p">:</span><span class="n">f_pval_list</span><span class="p">,</span>                                   
                                   <span class="s1">&#39;決定係数（調整済み）&#39;</span><span class="p">:</span><span class="n">rsquared_list</span><span class="p">,</span>                                   
                                   <span class="s1">&#39;国の数&#39;</span><span class="p">:</span><span class="n">nobs_list</span><span class="p">},</span>
                                   <span class="n">index</span><span class="o">=</span><span class="n">yr_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<ol class="arabic simple">
<li><p>貯蓄率<span class="math notranslate nohighlight">\(s\)</span>の係数を格納する空のリスト</p></li>
<li><p>労働人口増加率<span class="math notranslate nohighlight">\(n\)</span>の係数を格納する空のリスト</p></li>
<li><p>資本減耗率<span class="math notranslate nohighlight">\(d\)</span>の係数を格納する空のリスト</p></li>
<li><p>初期の一人当たりGDPの係数を格納する空のリスト</p></li>
<li><p>初期の一人当たりGDPの<span class="math notranslate nohighlight">\(p\)</span>値を格納する空のリスト</p></li>
<li><p><span class="math notranslate nohighlight">\(F\)</span>検定の<span class="math notranslate nohighlight">\(p\)</span>値を格納する空のリスト</p></li>
<li><p>調整済み決定係数を格納する空のリスト</p></li>
<li><p>国の数（標本の大きさ）を格納する空のリスト</p></li>
<li><p>年を格納する空のリスト</p></li>
<li><p>回帰式が複数行に続いているので，右辺の両端に<code class="docutils literal notranslate"><span class="pre">()</span></code>を使っている。また文字列は一行ずつ<code class="docutils literal notranslate"><span class="pre">'</span></code>と<code class="docutils literal notranslate"><span class="pre">'</span></code>で囲むこと。もちろんシングル・クオート<code class="docutils literal notranslate"><span class="pre">'</span></code>の代わりにダブル・クオート<code class="docutils literal notranslate"><span class="pre">&quot;</span></code>を使っても良い。</p></li>
<li><p>初期を1950年から1999年までの<code class="docutils literal notranslate"><span class="pre">for</span></code>ループとする。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>の作成し<code class="docutils literal notranslate"><span class="pre">df0</span></code>に割り当てる</p></li>
<li><p>推定結果を<code class="docutils literal notranslate"><span class="pre">res</span></code>に割り当てる</p></li>
<li><p>係数の推定値を<code class="docutils literal notranslate"><span class="pre">c</span></code>に割り当てる</p></li>
<li><p>係数の<span class="math notranslate nohighlight">\(p\)</span>値を<code class="docutils literal notranslate"><span class="pre">p</span></code>に割り当てる</p></li>
<li><p><span class="math notranslate nohighlight">\(F\)</span>検定の制約式を定義する</p></li>
<li><p><span class="math notranslate nohighlight">\(F\)</span>検定の<span class="math notranslate nohighlight">\(p\)</span>値を<code class="docutils literal notranslate"><span class="pre">f_pval</span></code>に割り当てる</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">c</span></code>には推定値が<code class="docutils literal notranslate"><span class="pre">Series</span></code>として入っているので，<code class="docutils literal notranslate"><span class="pre">c[1]</span></code>で<span class="math notranslate nohighlight">\(s\)</span>の推定値を取得し<code class="docutils literal notranslate"><span class="pre">saving_coef_list</span></code>に割り当てる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">c[2]</span></code>で<span class="math notranslate nohighlight">\(n\)</span>の推定値を取得し<code class="docutils literal notranslate"><span class="pre">emp_growth_coef_list</span></code>に割り当てる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">c[3]</span></code>で<span class="math notranslate nohighlight">\(d\)</span>の推定値を取得し<code class="docutils literal notranslate"><span class="pre">depreciation_coef_list</span></code>に割り当てる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">c[4]</span></code>で初期時点の一人当たりGDPの係数の推定値を取得し<code class="docutils literal notranslate"><span class="pre">b_coef_list</span></code>に割り当てる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p[4]</span></code>で初期時点の一人当たりGDPの係数の<span class="math notranslate nohighlight">\(p\)</span>値を取得し<code class="docutils literal notranslate"><span class="pre">b_pval_list</span></code>に割り当てる。</p></li>
<li><p><span class="math notranslate nohighlight">\(F\)</span>検定の<span class="math notranslate nohighlight">\(p\)</span>値を<code class="docutils literal notranslate"><span class="pre">f_pval_list</span></code>に割り当てる</p></li>
<li><p>決定係数（調整済み）を<code class="docutils literal notranslate"><span class="pre">rsquared_list</span></code>に割り当てる</p></li>
<li><p>国の数（標本の大きさ）を整数型として<code class="docutils literal notranslate"><span class="pre">nobs_list</span></code>に割り当てる</p></li>
<li><p>年を整数型として<code class="docutils literal notranslate"><span class="pre">yr_list</span></code>に割り当てる</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">for</span></code>ループの結果を使い<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を作成し<code class="docutils literal notranslate"><span class="pre">df_multiple_result</span></code>に割り当てる。</p></li>
</ol>
</div>
<p>作成した<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>を確認してみる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_multiple_result</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>貯蓄率の係数</th>
      <th>労働人口成長率の係数</th>
      <th>資本減耗率の係数</th>
      <th>初期の一人当たりGDPの係数</th>
      <th>p値（初期の一人当たりGDP）</th>
      <th>p値（F検定）</th>
      <th>決定係数（調整済み）</th>
      <th>国の数</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1950</th>
      <td>0.028718</td>
      <td>-0.676494</td>
      <td>0.339102</td>
      <td>-0.004448</td>
      <td>0.004282</td>
      <td>0.000002</td>
      <td>0.425710</td>
      <td>51</td>
    </tr>
    <tr>
      <th>1951</th>
      <td>0.035472</td>
      <td>-0.643201</td>
      <td>0.358196</td>
      <td>-0.005268</td>
      <td>0.002228</td>
      <td>0.000006</td>
      <td>0.382586</td>
      <td>56</td>
    </tr>
    <tr>
      <th>1952</th>
      <td>0.035000</td>
      <td>-0.658218</td>
      <td>0.360233</td>
      <td>-0.005224</td>
      <td>0.001680</td>
      <td>0.000003</td>
      <td>0.400802</td>
      <td>57</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>定常状態に関連する変数の推定値や<span class="math notranslate nohighlight">\(F\)</span>検定の<span class="math notranslate nohighlight">\(p\)</span>値などが追加されているのが確認できる。1970年からの結果を表示してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_multiple_result</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1970</span><span class="p">,:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>貯蓄率の係数             7.350840e-02
労働人口成長率の係数        -5.700815e-01
資本減耗率の係数           5.044795e-01
初期の一人当たりGDPの係数    -6.825011e-03
p値（初期の一人当たりGDP）    4.691781e-09
p値（F検定）            2.271309e-15
決定係数（調整済み）         5.741920e-01
国の数                1.120000e+02
Name: 1970, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>係数の推定値は<a class="reference internal" href="#sec-9-regression-result"><span class="std std-ref">上の</span></a>の結果と同じになることが確認できる。</p>
<p>ステップ３として<code class="docutils literal notranslate"><span class="pre">df_multiple_result</span></code>のメソッド<code class="docutils literal notranslate"><span class="pre">.plot()</span></code>を使い時系列データをプロットする。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_multiple_result</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>                <span class="c1"># 1</span>
                                             <span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># 2</span>
                                             <span class="n">layout</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>   <span class="c1"># 3</span>
                                             <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span> <span class="c1"># 4</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/888411978b20011a584b1154da4221c06cd73e0dccc795f17d4c68307bccd576.png" src="_images/888411978b20011a584b1154da4221c06cd73e0dccc795f17d4c68307bccd576.png" />
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">コードの説明</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>には10の列があるが，ここでは８つだけ表示するために<code class="docutils literal notranslate"><span class="pre">.iloc</span></code>を使っている。この場合，列をインデックスで指定する必要がある。<code class="docutils literal notranslate"><span class="pre">[0,1,2,3,4,5,6,7,8]</span></code>を作成するために<code class="docutils literal notranslate"><span class="pre">range(0,9)</span></code>で0~8の整数を準備し関数<code class="docutils literal notranslate"><span class="pre">list()</span></code>を使ってリストに変換している。次の内包表記でも同じ結果となる。</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">)]</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p><code class="docutils literal notranslate"><span class="pre">subplots=True</span></code>として複数の「軸」を表示している。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">layout=(4,2)</span></code>は４つの行と２の列の形で「軸」が表示されるようにレイアウトを指定している。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">figsize=(10,8)</span></code>はキャンバスの大きさを指定している。</p></li>
</ol>
</div>
<p>係数の符号は資本減耗率以外は期待どおりである。<span class="math notranslate nohighlight">\(F\)</span>検定の<span class="math notranslate nohighlight">\(p\)</span>値に関しては，1960年以降一貫して非常に小さな値となっている。1950年代に高い値になっているのは，国の数が少なく比較的に所得水準が高い国が集まっていたためだと思われる。国の数が多くなる1960年以降，それぞれの期間で絶対的所得収斂が成立しているとは判断できない。</p>
</section>
</section>
<section id="id16">
<h2>まとめ<a class="headerlink" href="#id16" title="Permalink to this heading">#</a></h2>
<p><a class="reference internal" href="#sec-9-distribution"><span class="std std-ref">「所得分布の推移」の節</span></a>ではキャッチアップを示唆する結果が示された。一方，<a class="reference internal" href="#sec-9-convergence"><span class="std std-ref">「所得収斂」の節</span></a>では絶対的所得収斂のエビデンスはなかった。相反する結果をどのように解釈すれば良いのだろうか。一つの可能性は「クラブ収斂」という概念である。世界全ての経済の定常状態が同じだと仮定するのは無理があると感じるの当たり前かも知れない。日本を含むOECD諸国とサブサハラ・アフリカ地域の国の違いを漠然と考えても，納得できるかも知れない。しかし，ある特性を共有する国では定常状態が概ね同じだとする仮定が成り立つかも知れない。典型的な例がOECD諸国である。ある「クラブ」（複数あり得る）に属している国の中で絶対的所得収斂が発生し，それが世界全体の所得分布の変化に現れているが，世界全体での絶対的所得収斂としては現れない，という可能性を否定できない。国の集合である「クラブ」は様々な特徴でグループ化できるので，多くの組み合わせがあり得る。<code class="docutils literal notranslate"><span class="pre">py4macro</span></code>に含まれるデータ<code class="docutils literal notranslate"><span class="pre">pwt</span></code>は次の変数を使い，データを様々な形でグループ化している。試してみてはどうだろうか。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">oecd</span></code>：1990年代に始まった中央ヨーロッパへの拡大前のOECDメンバー国</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">income_group</span></code>：世界銀行が所得水準に従って分けた４つのグループ</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">High</span> <span class="pre">income</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Upper</span> <span class="pre">middle</span> <span class="pre">income</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Lower</span> <span class="pre">middle</span> <span class="pre">income</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Low</span> <span class="pre">income</span></code></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">region</span></code>：世界銀行が国・地域に従って分けた７つのグループ</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">East</span> <span class="pre">Asia</span> <span class="pre">&amp;</span> <span class="pre">Pacific</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Europe</span> <span class="pre">&amp;</span> <span class="pre">Central</span> <span class="pre">Asia</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Latin</span> <span class="pre">America</span> <span class="pre">&amp;</span> <span class="pre">Caribbean</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Middle</span> <span class="pre">East</span> <span class="pre">&amp;</span> <span class="pre">North</span> <span class="pre">Africa</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">North</span> <span class="pre">America</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">South</span> <span class="pre">Asia</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Sub-Saharan</span> <span class="pre">Africa</span></code></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">continent</span></code>：南極以外の6大陸</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Africa</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Asia</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Australia</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Europe</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">North</span> <span class="pre">America</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">South</span> <span class="pre">America</span></code></p></li>
</ul>
</li>
</ul>
<p>【注意】<br>
<code class="docutils literal notranslate"><span class="pre">region</span></code>の<code class="docutils literal notranslate"><span class="pre">South</span> <span class="pre">Asia</span></code>と<code class="docutils literal notranslate"><span class="pre">North</span> <span class="pre">America</span></code>，<code class="docutils literal notranslate"><span class="pre">continent</span></code>の<code class="docutils literal notranslate"><span class="pre">Australia</span></code>は標本の大きさが少ないため回帰分析をするとエラーになるので注意しよう。</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="8_Solow.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">ソロー・モデル</p>
      </div>
    </a>
    <a class="right-next"
       href="10_Data_Fluctuation.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">GDPと構成要素</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">はじめに</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sec-9-distribution">所得分布の推移</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sec-9-convergence">所得収斂</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">説明</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">推定式の導出</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">推定結果の判断方法</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sec-9-simple-regression">単回帰分析：1970年〜2019年</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">データ</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#sec-9-saving">貯蓄率・資本減耗率・労働人口増加率の平均</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#gdp">一人当たりGDP成長率の平均</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">1970年の一人当たりGDP</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dataframe"><code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>の結合</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">成長率の分布</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sec-9-regression-result">結果</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hat-b">推定値<span class="math notranslate nohighlight">\(\hat{b}\)</span>の意味</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sec-9-multiple-regression">重回帰分析：1970年〜2019年</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#for">単回帰分析：<code class="docutils literal notranslate"><span class="pre">for</span></code>ループで回帰分析</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sec-9-multiple-for-loop">重回帰分析：<code class="docutils literal notranslate"><span class="pre">for</span></code>ループで回帰分析</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">まとめ</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By 春山 鉄源  Tetsugen HARUYAMA
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <!-- Default Statcounter code for Py4Macro https://py4macro.github.io --> <script type="text/javascript"> var sc_project=12478906; var sc_invisible=1; var sc_security="e767d225"; </script> <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script> <noscript><div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img class="statcounter" src="https://c.statcounter.com/12478906/0/e767d225/1/" alt="Web Analytics"></a></div></noscript> <!-- End of Statcounter Code -->
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>